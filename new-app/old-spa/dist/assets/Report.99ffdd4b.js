import{a as L}from"./axios.3fa379ca.js";import"./exceljs.4eeb6046.js";import"./numfmt.50579c65.js";import{_ as M}from"./SpreadSheet.5622495f.js";import{o,A as s,F as h,e as y,y as e,i as p,b as g,j,r as c,c as N,q as A,B as F,f as O,C as R,h as T,V as U,W}from"./vendor.7b6f695f.js";import{U as m}from"./uikit.bf3afdb6.js";import{a as q,S as z,s as D}from"./index.ad6f86f2.js";const E={key:0,class:"uk-subnav uk-subnav-pill","uk-switcher":""},Q={href:"#"},G={key:1,class:"uk-switcher uk-margin"},H={props:{book:Object},setup(t){const i=t,d=()=>{const n=[];return i.book.eachSheet((r,a)=>{r&&n.push(r)}),n};return(n,r)=>(o(),s(h,null,[t.book?(o(),s("ul",E,[(o(!0),s(h,null,y(d(),a=>(o(),s("li",null,[e("a",Q,p(a&&a.name),1)]))),256))])):g("",!0),t.book?(o(),s("ul",G,[(o(!0),s(h,null,y(d(),a=>(o(),s("li",null,[j(M,{sheet:a,class:"uk-table uk-table-divider"},null,8,["sheet"])]))),256))])):g("",!0)],64))}},b=t=>(U("data-v-eff28be0"),t=t(),W(),t),J={class:"uk-card uk-card-default uk-card-small"},K={class:"uk-open"},P={class:"uk-accordion-title uk-padding-small"},X={class:"uk-width-expand uk-text-center",style:{margin:"0"}},Y={class:"uk-fieldset"},Z=T(" This is where things will appear"),ee={class:"uk-modal-dialog uk-modal-body uk-margin-auto-vertical"},te=b(()=>e("button",{class:"uk-modal-close-default",type:"button","uk-close":""},null,-1)),oe=b(()=>e("div",{class:"uk-align-right","uk-spinner":"ratio: 3"},null,-1)),se={key:0,class:"uk-alert-danger","uk-alert":""},ae=b(()=>e("a",{class:"uk-alert-close","uk-close":""},null,-1)),le={style:{"text-align":"center"}},ne={key:1,class:"uk-background-default uk-padding"},ce={props:{title:String,workbook:Object,cardClass:{type:String,default:"uk-width-xlarge"}},setup(t){const i=t,d=c(),n=N(()=>i.workbook||d.value),r=c(),a=c(),w=()=>{console.log("toggle",a.value),m.accordion(a.value).toggle(0,!0)},x=c();let k;A(()=>{a.value=r.value,k=x.value});const C=c(),f=c(),u=c(),$=()=>{u.value=!u.value;const l=m.modal(k);u.value?l.show():l.hide(),console.log(l,"load")};function B(l,_,V=i.title){console.warn("Running",l,"with",_),f.value=void 0,u.value=!0,m.modal(k).show(),L.post(l,_).then(v=>{u.value=!1;const S=new z(v.data);w(),m.modal(k).hide(),C.value=S,d.value=S.spreadsheet(V).workbook}).catch(v=>{f.value=v,u.value=!1})}const I=()=>{D(i.title+".xlsx",n.value)};return(l,_)=>(o(),s(h,null,[e("div",J,[e("ul",{"uk-accordion":"",class:"ecm-single",ref_key:"refAccordion",ref:r},[e("li",K,[e("a",P,[e("h2",X,p(t.title||"Report"),1)]),e("div",{class:F("uk-accordion-content uk-card uk-card-default uk-card-body uk-align-center "+t.cardClass)},[e("fieldset",Y,[O(l.$slots,"default",{toggle:w,runReport:B,toggleLoading:$},()=>[Z],!0)])],2)])],512)]),e("div",{id:"modal-center",class:"uk-flex-top","uk-modal":"",ref_key:"refModal",ref:x},[e("div",ee,[te,oe,e("h3",null," Running "+p(t.title),1)])],512),f.value?(o(),s("div",se,[ae,e("p",le,p(f.value),1)])):g("",!0),R(n)?(o(),s("div",ne,[e("button",{onClick:I,class:"uk-align-right uk-button"}," Save Spreadsheet"),j(H,{book:R(n)},null,8,["book"])])):g("",!0)],64))}};var pe=q(ce,[["__scopeId","data-v-eff28be0"]]);export{pe as R};
