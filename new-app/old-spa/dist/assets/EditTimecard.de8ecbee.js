import{r as n,c as j,a1 as D,w as R,q as w,ah as S,o as v,A as h,h as C,i as E,C as d,j as q,y as o,a as P,b as I,O as A,d as $}from"./vendor.7b6f695f.js";import{U as z}from"./uikit.bf3afdb6.js";import{_ as Q}from"./TimecardTRs.7a606f78.js";import{a as W}from"./axios.3fa379ca.js";import{h as F,i as G}from"./index.ad6f86f2.js";/* empty css                            */import"./vue3-date-time-picker.9548981a.js";import"./@vueup/vue-quill.d043588b.js";import{h as J}from"./html-to-text.ad1fe50c.js";import{_ as K}from"./SelectClaim.42dc4fa1.js";/* empty css                                                     */import"./DateTimePicker.7ab0efe6.js";/* empty css                                                    */import"./vuex.df26a1fd.js";import"./exceljs.4eeb6046.js";import"./numfmt.50579c65.js";import"./hyperformula.40eff455.js";import"./@babel/core.ed44cf94.js";import"./@vueform/multiselect.69d395cc.js";import"./vue3-datepicker.8db1d195.js";import"./xlsx-js-style.0235676d.js";import"./clusterize.js.78919985.js";import"./file-saver.55724082.js";import"./vue-cookie-next.8cb9bd86.js";import"./luxon.1f9cfc03.js";import"./react-cookie.6c5c119f.js";import"./@vitejs/plugin-react.a2cc522e.js";import"./localforage.432ba2b7.js";const X=async r=>{if(!isNaN(r))return(await W.post("/rpc/db/claim",{claim_id:parseInt(r)})).data},Y={class:"actualpage"},Z={class:"carlito"},ee=o("tr",null,[o("td",{colspan:"6"},[o("h3",null,"Public Activity Log")])],-1),ae=o("td",null,"Claim Number:",-1),te={colspan:"2"},le=["innerHTML"],oe=o("td",null,"Insured:",-1),se={colspan:"2"},ie=["innerHTML"],ne=o("td",{colspan:"2"},[o("br"),C(),o("hr")],-1),ce={colspan:"4"},ue=["onClick"],Ee={props:{modelValue:Object,inPlace:{type:Boolean,default:!1},collapse:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:y}){const u=r,B=F(),f=n(),t=u.inPlace?j({get:()=>u.modelValue,set:e=>{y("update:modelValue",e)}}):n(Object.assign({date:new Date,message:null,internal_message:null},u.modelValue));t.value.date||(t.value.date=new Date),j({get:()=>{t.value.attachment_id},set:e=>{t.value.attachment_id=e.attachment_id}});const p=D({type:void 0,date:void 0,claim_id:void 0,hours:void 0,unbillable_hours:void 0,subject:void 0,message:void 0,mileage:void 0,disbursable:void 0}),c=(e,a)=>j({get:()=>{const l=p[e],m=u.modelValue&&u.modelValue[e];return l===void 0?m||a:l},set:l=>p[e]=l}),N=c("date",new Date),O=c("type"),L=c("hours"),M=c("unbillable_hours");c("mileage"),c("disbursement");const i=c("claim_id");c("subject"),c("message",t.value&&t.value.text||"");const T=async e=>{const a=x[e];if(a){s.value=a;return}s.value={loading:"loading"},console.log("loadClaiim",e);const l=await X(e);console.log("loaded",l),l&&(s.value=l,x[e]=l)},k=async()=>{i.value&&!s.value?await T(i.value):s.value&&i.value&&s.value.loading!=="loading"&&s.value.claim_id!==i.value&&await T(i.value)},s=n();R(s,(e,a)=>{console.log("claim watch",!e,i.value),e?i.value=e.claim_id:i.value=!1,console.log("claim afterwatch",e,i.value)});const x=[];n(!1),n([]);const _=n();n(),n(),n(),n(),w(()=>{k()}),S(()=>{!s.value&&i.value&&k()});const H=n(),U=()=>{const e=f.value;if(console.log("quill.value?",f.value,t.value),console.log("quilltxt",e?e.getText():!1),console.log("quillcons",e&&J.convert(e.getHTML())),O.value==="timecard"&&!L.value&&!M.value){_.value="Timecard must have Billable or Unbillable hours";return}s.value||(_.value="Timecard must be for claim"),N.value||(_.value="Timecard must have a date");const a=Object.assign({},p,{claim_id:t.value.claim_id===i.value?void 0:i.value});Object.keys(a).forEach(m=>a[m]===void 0&&delete a[m]),Object.keys(a).length===0&&(z.tooltip(H.value).show(),B.add({severity:"info",summary:"No Changes",detail:"There are no changes to save",life:3e3}));const l=Object.assign({type:t.value.type,timecard_interim_id:t.value.timecard_interim_id},a);console.log("Save Timecard:",l,a),t.value=Object.assign(t.value,l)},b=n(),V=n(),g=n();return w(()=>{const e=b.value&&b.value.querySelector(".ql-toolbar");e&&b.value.append(e),console.log("Have Quill?",V.value),f.value=V.value,console.log(g.value,g)}),(e,a)=>(v(),h("div",Y,[C(E(d(t))+" ",1),q(d(G)),o("table",Z,[ee,o("tr",null,[ae,o("td",te,[d(i)?(v(),h("span",{key:1,innerHTML:d(i)},null,8,le)):(v(),P(K,{key:0,modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l)},null,8,["modelValue"]))])]),o("tr",null,[oe,o("td",se,[s.value&&!s.value.loading?(v(),h("span",{key:0,innerHTML:s.value.risk.policy.insured.name},null,8,ie)):I("",!0)])]),q(Q,{ref_key:"TimecardTRe",ref:g,modelValue:d(t),"onUpdate:modelValue":a[1]||(a[1]=l=>A(t)?t.value=l:null),edit:""},null,8,["modelValue"]),o("tr",null,[ne,o("td",ce,[o("button",{href:"#",onClick:$(U,["prevent"]),class:"uk-button uk-button-default uk-align-right","uk-tooltip":"title: Log Timecard","uk-icon":"icon: check; ratio: 1.5",style:{color:"green",margin:"0 1.5rem"}}," Save Timecard",8,ue)])])])]))}};export{Ee as default};
