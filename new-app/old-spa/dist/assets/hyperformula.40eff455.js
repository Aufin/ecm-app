import{k as Gl}from"./vendor.7b6f695f.js";var Ro=function(r){return r&&r.Math==Math&&r},H=Ro(typeof globalThis=="object"&&globalThis)||Ro(typeof window=="object"&&window)||Ro(typeof self=="object"&&self)||Ro(typeof Gl=="object"&&Gl)||function(){return this}()||Function("return this")(),Ir={},re=function(r){try{return!!r()}catch{return!0}},MR=re,tt=!MR(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),kR=re,Xa=!kR(function(){var r=function(){}.bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),FR=Xa,bo=Function.prototype.call,rt=FR?bo.bind(bo):function(){return bo.apply(bo,arguments)},qa={},Dd={}.propertyIsEnumerable,Ld=Object.getOwnPropertyDescriptor,PR=Ld&&!Dd.call({1:2},1);qa.f=PR?function(t){var e=Ld(this,t);return!!e&&e.enumerable}:Dd;var Qa=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},Ud=Xa,xd=Function.prototype,$R=xd.bind,jl=xd.call,DR=Ud&&$R.bind(jl,jl),Q=Ud?function(r){return r&&DR(r)}:function(r){return r&&function(){return jl.apply(r,arguments)}},Bd=Q,LR=Bd({}.toString),UR=Bd("".slice),Qr=function(r){return UR(LR(r),8,-1)},xR=H,BR=Q,VR=re,GR=Qr,Hl=xR.Object,jR=BR("".split),Za=VR(function(){return!Hl("z").propertyIsEnumerable(0)})?function(r){return GR(r)=="String"?jR(r,""):Hl(r)}:Hl,HR=H,WR=HR.TypeError,nr=function(r){if(r==null)throw WR("Can't call method on "+r);return r},zR=Za,YR=nr,ar=function(r){return zR(YR(r))},xe=function(r){return typeof r=="function"},KR=xe,ze=function(r){return typeof r=="object"?r!==null:KR(r)},Wl=H,XR=xe,qR=function(r){return XR(r)?r:void 0},yr=function(r,t){return arguments.length<2?qR(Wl[r]):Wl[r]&&Wl[r][t]},QR=Q,Zr=QR({}.isPrototypeOf),ZR=yr,Ja=ZR("navigator","userAgent")||"",Vd=H,zl=Ja,Gd=Vd.process,jd=Vd.Deno,Hd=Gd&&Gd.versions||jd&&jd.version,Wd=Hd&&Hd.v8,ir,So;Wd&&(ir=Wd.split("."),So=ir[0]>0&&ir[0]<4?1:+(ir[0]+ir[1]));!So&&zl&&(ir=zl.match(/Edge\/(\d+)/),(!ir||ir[1]>=74)&&(ir=zl.match(/Chrome\/(\d+)/),ir&&(So=+ir[1])));var ei=So,zd=ei,JR=re,Jn=!!Object.getOwnPropertySymbols&&!JR(function(){var r=Symbol();return!String(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&zd&&zd<41}),eb=Jn,Yd=eb&&!Symbol.sham&&typeof Symbol.iterator=="symbol",tb=H,rb=yr,nb=xe,ab=Zr,ib=Yd,ob=tb.Object,ti=ib?function(r){return typeof r=="symbol"}:function(r){var t=rb("Symbol");return nb(t)&&ab(t.prototype,ob(r))},ub=H,sb=ub.String,ri=function(r){try{return sb(r)}catch{return"Object"}},lb=H,fb=xe,cb=ri,hb=lb.TypeError,ea=function(r){if(fb(r))return r;throw hb(cb(r)+" is not a function")},pb=ea,ni=function(r,t){var e=r[t];return e==null?void 0:pb(e)},db=H,Yl=rt,Kl=xe,Xl=ze,vb=db.TypeError,yb=function(r,t){var e,n;if(t==="string"&&Kl(e=r.toString)&&!Xl(n=Yl(e,r))||Kl(e=r.valueOf)&&!Xl(n=Yl(e,r))||t!=="string"&&Kl(e=r.toString)&&!Xl(n=Yl(e,r)))return n;throw vb("Can't convert object to primitive value")},Tn={exports:{}},Kd=H,mb=Object.defineProperty,ql=function(r,t){try{mb(Kd,r,{value:t,configurable:!0,writable:!0})}catch{Kd[r]=t}return t},gb=H,Eb=ql,Xd="__core-js_shared__",Rb=gb[Xd]||Eb(Xd,{}),Ql=Rb,qd=Ql;(Tn.exports=function(r,t){return qd[r]||(qd[r]=t!==void 0?t:{})})("versions",[]).push({version:"3.22.3",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.3/LICENSE",source:"https://github.com/zloirock/core-js"});var bb=H,Sb=nr,Ab=bb.Object,At=function(r){return Ab(Sb(r))},Tb=Q,Ob=At,wb=Tb({}.hasOwnProperty),Be=Object.hasOwn||function(t,e){return wb(Ob(t),e)},Nb=Q,Cb=0,_b=Math.random(),Ib=Nb(1 .toString),Ao=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Ib(++Cb+_b,36)},Mb=H,kb=Tn.exports,Qd=Be,Fb=Ao,Zd=Jn,Jd=Yd,ta=kb("wks"),On=Mb.Symbol,ev=On&&On.for,Pb=Jd?On:On&&On.withoutSetter||Fb,Ne=function(r){if(!Qd(ta,r)||!(Zd||typeof ta[r]=="string")){var t="Symbol."+r;Zd&&Qd(On,r)?ta[r]=On[r]:Jd&&ev?ta[r]=ev(t):ta[r]=Pb(t)}return ta[r]},$b=H,Db=rt,tv=ze,rv=ti,Lb=ni,Ub=yb,xb=Ne,Bb=$b.TypeError,Vb=xb("toPrimitive"),nv=function(r,t){if(!tv(r)||rv(r))return r;var e=Lb(r,Vb),n;if(e){if(t===void 0&&(t="default"),n=Db(e,r,t),!tv(n)||rv(n))return n;throw Bb("Can't convert object to primitive value")}return t===void 0&&(t="number"),Ub(r,t)},Gb=nv,jb=ti,To=function(r){var t=Gb(r,"string");return jb(t)?t:t+""},Hb=H,av=ze,Zl=Hb.document,Wb=av(Zl)&&av(Zl.createElement),Jl=function(r){return Wb?Zl.createElement(r):{}},zb=tt,Yb=re,Kb=Jl,iv=!zb&&!Yb(function(){return Object.defineProperty(Kb("div"),"a",{get:function(){return 7}}).a!=7}),Xb=tt,qb=rt,Qb=qa,Zb=Qa,Jb=ar,eS=To,tS=Be,rS=iv,ov=Object.getOwnPropertyDescriptor;Ir.f=Xb?ov:function(t,e){if(t=Jb(t),e=eS(e),rS)try{return ov(t,e)}catch{}if(tS(t,e))return Zb(!qb(Qb.f,t,e),t[e])};var lt={},nS=tt,aS=re,uv=nS&&aS(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),sv=H,iS=ze,oS=sv.String,uS=sv.TypeError,Qe=function(r){if(iS(r))return r;throw uS(oS(r)+" is not an object")},sS=H,lS=tt,fS=iv,cS=uv,Oo=Qe,lv=To,hS=sS.TypeError,ef=Object.defineProperty,pS=Object.getOwnPropertyDescriptor,tf="enumerable",rf="configurable",nf="writable";lt.f=lS?cS?function(t,e,n){if(Oo(t),e=lv(e),Oo(n),typeof t=="function"&&e==="prototype"&&"value"in n&&nf in n&&!n[nf]){var a=pS(t,e);a&&a[nf]&&(t[e]=n.value,n={configurable:rf in n?n[rf]:a[rf],enumerable:tf in n?n[tf]:a[tf],writable:!1})}return ef(t,e,n)}:ef:function(t,e,n){if(Oo(t),e=lv(e),Oo(n),fS)try{return ef(t,e,n)}catch{}if("get"in n||"set"in n)throw hS("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var dS=tt,vS=lt,yS=Qa,Jr=dS?function(r,t,e){return vS.f(r,t,yS(1,e))}:function(r,t,e){return r[t]=e,r},Lt={exports:{}},mS=Q,gS=xe,af=Ql,ES=mS(Function.toString);gS(af.inspectSource)||(af.inspectSource=function(r){return ES(r)});var of=af.inspectSource,RS=H,bS=xe,SS=of,fv=RS.WeakMap,cv=bS(fv)&&/native code/.test(SS(fv)),AS=Tn.exports,TS=Ao,hv=AS("keys"),wo=function(r){return hv[r]||(hv[r]=TS(r))},ai={},OS=cv,pv=H,uf=Q,wS=ze,NS=Jr,sf=Be,lf=Ql,CS=wo,_S=ai,dv="Object already initialized",ff=pv.TypeError,IS=pv.WeakMap,No,ii,Co,MS=function(r){return Co(r)?ii(r):No(r,{})},kS=function(r){return function(t){var e;if(!wS(t)||(e=ii(t)).type!==r)throw ff("Incompatible receiver, "+r+" required");return e}};if(OS||lf.state){var wn=lf.state||(lf.state=new IS),FS=uf(wn.get),vv=uf(wn.has),PS=uf(wn.set);No=function(r,t){if(vv(wn,r))throw new ff(dv);return t.facade=r,PS(wn,r,t),t},ii=function(r){return FS(wn,r)||{}},Co=function(r){return vv(wn,r)}}else{var ra=CS("state");_S[ra]=!0,No=function(r,t){if(sf(r,ra))throw new ff(dv);return t.facade=r,NS(r,ra,t),t},ii=function(r){return sf(r,ra)?r[ra]:{}},Co=function(r){return sf(r,ra)}}var Mr={set:No,get:ii,has:Co,enforce:MS,getterFor:kS},cf=tt,$S=Be,yv=Function.prototype,DS=cf&&Object.getOwnPropertyDescriptor,hf=$S(yv,"name"),LS=hf&&function(){}.name==="something",US=hf&&(!cf||cf&&DS(yv,"name").configurable),oi={EXISTS:hf,PROPER:LS,CONFIGURABLE:US},xS=H,mv=xe,BS=Be,gv=Jr,VS=ql,GS=of,Ev=Mr,jS=oi.CONFIGURABLE,HS=Ev.get,WS=Ev.enforce,zS=String(String).split("String");(Lt.exports=function(r,t,e,n){var a=n?!!n.unsafe:!1,i=n?!!n.enumerable:!1,o=n?!!n.noTargetGet:!1,u=n&&n.name!==void 0?n.name:t,s;if(mv(e)&&(String(u).slice(0,7)==="Symbol("&&(u="["+String(u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!BS(e,"name")||jS&&e.name!==u)&&gv(e,"name",u),s=WS(e),s.source||(s.source=zS.join(typeof u=="string"?u:""))),r===xS){i?r[t]=e:VS(t,e);return}else a?!o&&r[t]&&(i=!0):delete r[t];i?r[t]=e:gv(r,t,e)})(Function.prototype,"toString",function(){return mv(this)&&HS(this).source||GS(this)});var Nn={},YS=Math.ceil,KS=Math.floor,Cn=function(r){var t=+r;return t!==t||t===0?0:(t>0?KS:YS)(t)},XS=Cn,qS=Math.max,QS=Math.min,na=function(r,t){var e=XS(r);return e<0?qS(e+t,0):QS(e,t)},ZS=Cn,JS=Math.min,aa=function(r){return r>0?JS(ZS(r),9007199254740991):0},eA=aa,or=function(r){return eA(r.length)},tA=ar,rA=na,nA=or,Rv=function(r){return function(t,e,n){var a=tA(t),i=nA(a),o=rA(n,i),u;if(r&&e!=e){for(;i>o;)if(u=a[o++],u!=u)return!0}else for(;i>o;o++)if((r||o in a)&&a[o]===e)return r||o||0;return!r&&-1}},bv={includes:Rv(!0),indexOf:Rv(!1)},aA=Q,pf=Be,iA=ar,oA=bv.indexOf,uA=ai,Sv=aA([].push),Av=function(r,t){var e=iA(r),n=0,a=[],i;for(i in e)!pf(uA,i)&&pf(e,i)&&Sv(a,i);for(;t.length>n;)pf(e,i=t[n++])&&(~oA(a,i)||Sv(a,i));return a},df=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],sA=Av,lA=df,fA=lA.concat("length","prototype");Nn.f=Object.getOwnPropertyNames||function(t){return sA(t,fA)};var ui={};ui.f=Object.getOwnPropertySymbols;var cA=yr,hA=Q,pA=Nn,dA=ui,vA=Qe,yA=hA([].concat),mA=cA("Reflect","ownKeys")||function(t){var e=pA.f(vA(t)),n=dA.f;return n?yA(e,n(t)):e},Tv=Be,gA=mA,EA=Ir,RA=lt,Ov=function(r,t,e){for(var n=gA(t),a=RA.f,i=EA.f,o=0;o<n.length;o++){var u=n[o];!Tv(r,u)&&!(e&&Tv(e,u))&&a(r,u,i(t,u))}},bA=re,SA=xe,AA=/#|\.prototype\./,si=function(r,t){var e=OA[TA(r)];return e==NA?!0:e==wA?!1:SA(t)?bA(t):!!t},TA=si.normalize=function(r){return String(r).replace(AA,".").toLowerCase()},OA=si.data={},wA=si.NATIVE="N",NA=si.POLYFILL="P",_o=si,vf=H,CA=Ir.f,_A=Jr,IA=Lt.exports,MA=ql,kA=Ov,FA=_o,z=function(r,t){var e=r.target,n=r.global,a=r.stat,i,o,u,s,l,f;if(n?o=vf:a?o=vf[e]||MA(e,{}):o=(vf[e]||{}).prototype,o)for(u in t){if(l=t[u],r.noTargetGet?(f=CA(o,u),s=f&&f.value):s=o[u],i=FA(n?u:e+(a?".":"#")+u,r.forced),!i&&s!==void 0){if(typeof l==typeof s)continue;kA(l,s)}(r.sham||s&&s.sham)&&_A(l,"sham",!0),IA(o,u,l,r)}},PA=re,wv=!PA(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),$A=H,DA=Be,LA=xe,UA=At,xA=wo,BA=wv,Nv=xA("IE_PROTO"),yf=$A.Object,VA=yf.prototype,Io=BA?yf.getPrototypeOf:function(r){var t=UA(r);if(DA(t,Nv))return t[Nv];var e=t.constructor;return LA(e)&&t instanceof e?e.prototype:t instanceof yf?VA:null},GA=z,jA=re,HA=At,Cv=Io,WA=wv,zA=jA(function(){Cv(1)});GA({target:"Object",stat:!0,forced:zA,sham:!WA},{getPrototypeOf:function(t){return Cv(HA(t))}});var Mo={},YA=To,KA=lt,XA=Qa,li=function(r,t,e){var n=YA(t);n in r?KA.f(r,n,XA(0,e)):r[n]=e},qA=H,_v=na,QA=or,ZA=li,JA=qA.Array,eT=Math.max,mf=function(r,t,e){for(var n=QA(r),a=_v(t,n),i=_v(e===void 0?n:e,n),o=JA(eT(i-a,0)),u=0;a<i;a++,u++)ZA(o,u,r[a]);return o.length=u,o},tT=Qr,rT=ar,Iv=Nn.f,nT=mf,Mv=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],aT=function(r){try{return Iv(r)}catch{return nT(Mv)}};Mo.f=function(t){return Mv&&tT(t)=="Window"?aT(t):Iv(rT(t))};var iT=z,oT=re,uT=Mo.f,sT=oT(function(){return!Object.getOwnPropertyNames(1)});iT({target:"Object",stat:!0,forced:sT},{getOwnPropertyNames:uT});var lT=Ne,fT=lT("toStringTag"),kv={};kv[fT]="z";var gf=String(kv)==="[object z]",cT=H,hT=gf,pT=xe,ko=Qr,dT=Ne,vT=dT("toStringTag"),yT=cT.Object,mT=ko(function(){return arguments}())=="Arguments",gT=function(r,t){try{return r[t]}catch{}},Fo=hT?ko:function(r){var t,e,n;return r===void 0?"Undefined":r===null?"Null":typeof(e=gT(t=yT(r),vT))=="string"?e:mT?ko(t):(n=ko(t))=="Object"&&pT(t.callee)?"Arguments":n},ET=H,RT=Fo,bT=ET.String,ft=function(r){if(RT(r)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return bT(r)},ST=ze,AT=Qr,TT=Ne,OT=TT("match"),Ef=function(r){var t;return ST(r)&&((t=r[OT])!==void 0?!!t:AT(r)=="RegExp")},wT=H,NT=Ef,CT=wT.TypeError,Rf=function(r){if(NT(r))throw CT("The method doesn't accept regular expressions");return r},_T=Ne,IT=_T("match"),bf=function(r){var t=/./;try{"/./"[r](t)}catch{try{return t[IT]=!1,"/./"[r](t)}catch{}}return!1},MT=z,Fv=Q,kT=Ir.f,FT=aa,Pv=ft,PT=Rf,$T=nr,DT=bf,$v=Fv("".startsWith),LT=Fv("".slice),UT=Math.min,Dv=DT("startsWith"),xT=!Dv&&!!function(){var r=kT(String.prototype,"startsWith");return r&&!r.writable}();MT({target:"String",proto:!0,forced:!xT&&!Dv},{startsWith:function(t){var e=Pv($T(this));PT(t);var n=FT(UT(arguments.length>1?arguments[1]:void 0,e.length)),a=Pv(t);return $v?$v(e,a,n):LT(e,n,n+a.length)===a}});var BT=gf,VT=Fo,GT=BT?{}.toString:function(){return"[object "+VT(this)+"]"},jT=gf,HT=Lt.exports,WT=GT;jT||HT(Object.prototype,"toString",WT,{unsafe:!0});var zT=Xa,Lv=Function.prototype,Uv=Lv.apply,xv=Lv.call,Po=typeof Reflect=="object"&&Reflect.apply||(zT?xv.bind(Uv):function(){return xv.apply(Uv,arguments)}),YT=Q,Sf=YT([].slice),KT=H,Bv=Q,XT=ea,qT=ze,QT=Be,Vv=Sf,ZT=Xa,Gv=KT.Function,JT=Bv([].concat),eO=Bv([].join),Af={},tO=function(r,t,e){if(!QT(Af,t)){for(var n=[],a=0;a<t;a++)n[a]="a["+a+"]";Af[t]=Gv("C,a","return new C("+eO(n,",")+")")}return Af[t](r,e)},rO=ZT?Gv.bind:function(t){var e=XT(this),n=e.prototype,a=Vv(arguments,1),i=function(){var u=JT(a,Vv(arguments));return this instanceof i?tO(e,u.length,u):e.apply(t,u)};return qT(n)&&(i.prototype=n),i},nO=Q,aO=re,jv=xe,iO=Fo,oO=yr,uO=of,Hv=function(){},sO=[],Wv=oO("Reflect","construct"),Tf=/^\s*(?:class|function)\b/,lO=nO(Tf.exec),fO=!Tf.exec(Hv),fi=function(t){if(!jv(t))return!1;try{return Wv(Hv,sO,t),!0}catch{return!1}},zv=function(t){if(!jv(t))return!1;switch(iO(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return fO||!!lO(Tf,uO(t))}catch{return!0}};zv.sham=!0;var $o=!Wv||aO(function(){var r;return fi(fi.call)||!fi(Object)||!fi(function(){r=!0})||r})?zv:fi,cO=H,hO=$o,pO=ri,dO=cO.TypeError,Yv=function(r){if(hO(r))return r;throw dO(pO(r)+" is not a constructor")},Of={},vO=Av,yO=df,ci=Object.keys||function(t){return vO(t,yO)},mO=tt,gO=uv,EO=lt,RO=Qe,bO=ar,SO=ci;Of.f=mO&&!gO?Object.defineProperties:function(t,e){RO(t);for(var n=bO(e),a=SO(e),i=a.length,o=0,u;i>o;)EO.f(t,u=a[o++],n[u]);return t};var AO=yr,TO=AO("document","documentElement"),OO=Qe,wO=Of,Kv=df,NO=ai,CO=TO,_O=Jl,IO=wo,Xv=">",qv="<",wf="prototype",Nf="script",Qv=IO("IE_PROTO"),Cf=function(){},Zv=function(r){return qv+Nf+Xv+r+qv+"/"+Nf+Xv},Jv=function(r){r.write(Zv("")),r.close();var t=r.parentWindow.Object;return r=null,t},MO=function(){var r=_O("iframe"),t="java"+Nf+":",e;return r.style.display="none",CO.appendChild(r),r.src=String(t),e=r.contentWindow.document,e.open(),e.write(Zv("document.F=Object")),e.close(),e.F},Do,Lo=function(){try{Do=new ActiveXObject("htmlfile")}catch{}Lo=typeof document!="undefined"?document.domain&&Do?Jv(Do):MO():Jv(Do);for(var r=Kv.length;r--;)delete Lo[wf][Kv[r]];return Lo()};NO[Qv]=!0;var ia=Object.create||function(t,e){var n;return t!==null?(Cf[wf]=OO(t),n=new Cf,Cf[wf]=null,n[Qv]=t):n=Lo(),e===void 0?n:wO.f(n,e)},kO=z,FO=yr,_f=Po,PO=rO,e6=Yv,$O=Qe,t6=ze,DO=ia,r6=re,If=FO("Reflect","construct"),LO=Object.prototype,UO=[].push,n6=r6(function(){function r(){}return!(If(function(){},[],r)instanceof r)}),a6=!r6(function(){If(function(){})}),i6=n6||a6;kO({target:"Reflect",stat:!0,forced:i6,sham:i6},{construct:function(t,e){e6(t),$O(e);var n=arguments.length<3?t:e6(arguments[2]);if(a6&&!n6)return If(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var a=[null];return _f(UO,a,e),new(_f(PO,t,a))}var i=n.prototype,o=DO(t6(i)?i:LO),u=_f(t,o,e);return t6(u)?u:o}});var xO=Qr,hi=Array.isArray||function(t){return xO(t)=="Array"},BO=re,VO=Ne,GO=ei,jO=VO("species"),pi=function(r){return GO>=51||!BO(function(){var t=[],e=t.constructor={};return e[jO]=function(){return{foo:1}},t[r](Boolean).foo!==1})},HO=z,WO=H,o6=hi,zO=$o,YO=ze,u6=na,KO=or,XO=ar,qO=li,QO=Ne,ZO=pi,JO=Sf,ew=ZO("slice"),tw=QO("species"),Mf=WO.Array,rw=Math.max;HO({target:"Array",proto:!0,forced:!ew},{slice:function(t,e){var n=XO(this),a=KO(n),i=u6(t,a),o=u6(e===void 0?a:e,a),u,s,l;if(o6(n)&&(u=n.constructor,zO(u)&&(u===Mf||o6(u.prototype))?u=void 0:YO(u)&&(u=u[tw],u===null&&(u=void 0)),u===Mf||u===void 0))return JO(n,i,o);for(s=new(u===void 0?Mf:u)(rw(o-i,0)),l=0;i<o;i++,l++)i in n&&qO(s,l,n[i]);return s.length=l,s}});var nw=tt,aw=oi.EXISTS,s6=Q,iw=lt.f,l6=Function.prototype,ow=s6(l6.toString),f6=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,uw=s6(f6.exec),sw="name";nw&&!aw&&iw(l6,sw,{configurable:!0,get:function(){try{return uw(f6,ow(this))[1]}catch{return""}}});var c6=Q,lw=ea,fw=Xa,cw=c6(c6.bind),Uo=function(r,t){return lw(r),t===void 0?r:fw?cw(r,t):function(){return r.apply(t,arguments)}},hw=rt,h6=Qe,pw=ni,p6=function(r,t,e){var n,a;h6(r);try{if(n=pw(r,"return"),!n){if(t==="throw")throw e;return e}n=hw(n,r)}catch(i){a=!0,n=i}if(t==="throw")throw e;if(a)throw n;return h6(n),e},dw=Qe,vw=p6,yw=function(r,t,e,n){try{return n?t(dw(e)[0],e[1]):t(e)}catch(a){vw(r,"throw",a)}},di={},mw=Ne,gw=di,Ew=mw("iterator"),Rw=Array.prototype,d6=function(r){return r!==void 0&&(gw.Array===r||Rw[Ew]===r)},bw=Fo,v6=ni,Sw=di,Aw=Ne,Tw=Aw("iterator"),kf=function(r){if(r!=null)return v6(r,Tw)||v6(r,"@@iterator")||Sw[bw(r)]},Ow=H,ww=rt,Nw=ea,Cw=Qe,_w=ri,Iw=kf,Mw=Ow.TypeError,y6=function(r,t){var e=arguments.length<2?Iw(r):t;if(Nw(e))return Cw(ww(e,r));throw Mw(_w(r)+" is not iterable")},kw=H,Fw=Uo,Pw=rt,$w=At,Dw=yw,Lw=d6,Uw=$o,xw=or,m6=li,Bw=y6,Vw=kf,g6=kw.Array,Gw=function(t){var e=$w(t),n=Uw(this),a=arguments.length,i=a>1?arguments[1]:void 0,o=i!==void 0;o&&(i=Fw(i,a>2?arguments[2]:void 0));var u=Vw(e),s=0,l,f,c,h,p,y;if(u&&!(this==g6&&Lw(u)))for(h=Bw(e,u),p=h.next,f=n?new this:[];!(c=Pw(p,h)).done;s++)y=o?Dw(h,i,[c.value,s],!0):c.value,m6(f,s,y);else for(l=xw(e),f=n?new this(l):g6(l);l>s;s++)y=o?i(e[s],s):e[s],m6(f,s,y);return f.length=s,f},jw=Ne,E6=jw("iterator"),R6=!1;try{var Hw=0,b6={next:function(){return{done:!!Hw++}},return:function(){R6=!0}};b6[E6]=function(){return this},Array.from(b6,function(){throw 2})}catch{}var S6=function(r,t){if(!t&&!R6)return!1;var e=!1;try{var n={};n[E6]=function(){return{next:function(){return{done:e=!0}}}},r(n)}catch{}return e},Ww=z,zw=Gw,Yw=S6,Kw=!Yw(function(r){Array.from(r)});Ww({target:"Array",stat:!0,forced:Kw},{from:zw});var Ff=Q,Xw=Cn,qw=ft,Qw=nr,Zw=Ff("".charAt),A6=Ff("".charCodeAt),Jw=Ff("".slice),T6=function(r){return function(t,e){var n=qw(Qw(t)),a=Xw(e),i=n.length,o,u;return a<0||a>=i?r?"":void 0:(o=A6(n,a),o<55296||o>56319||a+1===i||(u=A6(n,a+1))<56320||u>57343?r?Zw(n,a):o:r?Jw(n,a,a+2):(o-55296<<10)+(u-56320)+65536)}},Pf={codeAt:T6(!1),charAt:T6(!0)},eN=re,tN=xe,O6=Io,rN=Lt.exports,nN=Ne,$f=nN("iterator"),w6=!1,_n,Df,Lf;[].keys&&(Lf=[].keys(),"next"in Lf?(Df=O6(O6(Lf)),Df!==Object.prototype&&(_n=Df)):w6=!0);var aN=_n==null||eN(function(){var r={};return _n[$f].call(r)!==r});aN&&(_n={});tN(_n[$f])||rN(_n,$f,function(){return this});var N6={IteratorPrototype:_n,BUGGY_SAFARI_ITERATORS:w6},iN=lt.f,oN=Be,uN=Ne,C6=uN("toStringTag"),xo=function(r,t,e){r&&!e&&(r=r.prototype),r&&!oN(r,C6)&&iN(r,C6,{configurable:!0,value:t})},sN=N6.IteratorPrototype,lN=ia,fN=Qa,cN=xo,hN=di,pN=function(){return this},dN=function(r,t,e,n){var a=t+" Iterator";return r.prototype=lN(sN,{next:fN(+!n,e)}),cN(r,a,!1),hN[a]=pN,r},_6=H,vN=xe,yN=_6.String,mN=_6.TypeError,gN=function(r){if(typeof r=="object"||vN(r))return r;throw mN("Can't set "+yN(r)+" as a prototype")},EN=Q,RN=Qe,bN=gN,I6=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,t={},e;try{e=EN(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(t,[]),r=t instanceof Array}catch{}return function(a,i){return RN(a),bN(i),r?e(a,i):a.__proto__=i,a}}():void 0),SN=z,AN=rt,M6=oi,TN=xe,ON=dN,k6=Io,F6=I6,wN=xo,NN=Jr,Uf=Lt.exports,CN=Ne,_N=di,P6=N6,IN=M6.PROPER,MN=M6.CONFIGURABLE,$6=P6.IteratorPrototype,Bo=P6.BUGGY_SAFARI_ITERATORS,vi=CN("iterator"),D6="keys",yi="values",L6="entries",kN=function(){return this},xf=function(r,t,e,n,a,i,o){ON(e,t,n);var u=function(g){if(g===a&&h)return h;if(!Bo&&g in f)return f[g];switch(g){case D6:return function(){return new e(this,g)};case yi:return function(){return new e(this,g)};case L6:return function(){return new e(this,g)}}return function(){return new e(this)}},s=t+" Iterator",l=!1,f=r.prototype,c=f[vi]||f["@@iterator"]||a&&f[a],h=!Bo&&c||u(a),p=t=="Array"&&f.entries||c,y,v,R;if(p&&(y=k6(p.call(new r)),y!==Object.prototype&&y.next&&(k6(y)!==$6&&(F6?F6(y,$6):TN(y[vi])||Uf(y,vi,kN)),wN(y,s,!0))),IN&&a==yi&&c&&c.name!==yi&&(MN?NN(f,"name",yi):(l=!0,h=function(){return AN(c,this)})),a)if(v={values:u(yi),keys:i?h:u(D6),entries:u(L6)},o)for(R in v)(Bo||l||!(R in f))&&Uf(f,R,v[R]);else SN({target:t,proto:!0,forced:Bo||l},v);return f[vi]!==h&&Uf(f,vi,h,{name:a}),_N[t]=h,v},FN=Pf.charAt,PN=ft,U6=Mr,$N=xf,x6="String Iterator",DN=U6.set,LN=U6.getterFor(x6);$N(String,"String",function(r){DN(this,{type:x6,string:PN(r),index:0})},function(){var t=LN(this),e=t.string,n=t.index,a;return n>=e.length?{value:void 0,done:!0}:(a=FN(e,n),t.index+=a.length,{value:a,done:!1})});var UN=Qe,B6=function(){var r=UN(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.sticky&&(t+="y"),t},Bf=re,xN=H,Vf=xN.RegExp,Gf=Bf(function(){var r=Vf("a","y");return r.lastIndex=2,r.exec("abcd")!=null}),BN=Gf||Bf(function(){return!Vf("a","y").sticky}),VN=Gf||Bf(function(){var r=Vf("^r","gy");return r.lastIndex=2,r.exec("str")!=null}),jf={BROKEN_CARET:VN,MISSED_STICKY:BN,UNSUPPORTED_Y:Gf},GN=re,jN=H,HN=jN.RegExp,V6=GN(function(){var r=HN(".","s");return!(r.dotAll&&r.exec(`
`)&&r.flags==="s")}),WN=re,zN=H,YN=zN.RegExp,G6=WN(function(){var r=YN("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),oa=rt,Vo=Q,KN=ft,XN=B6,qN=jf,QN=Tn.exports,ZN=ia,JN=Mr.get,eC=V6,tC=G6,rC=QN("native-string-replace",String.prototype.replace),Go=RegExp.prototype.exec,Hf=Go,nC=Vo("".charAt),aC=Vo("".indexOf),iC=Vo("".replace),Wf=Vo("".slice),zf=function(){var r=/a/,t=/b*/g;return oa(Go,r,"a"),oa(Go,t,"a"),r.lastIndex!==0||t.lastIndex!==0}(),j6=qN.BROKEN_CARET,Yf=/()??/.exec("")[1]!==void 0,oC=zf||Yf||j6||eC||tC;oC&&(Hf=function(t){var e=this,n=JN(e),a=KN(t),i=n.raw,o,u,s,l,f,c,h;if(i)return i.lastIndex=e.lastIndex,o=oa(Hf,i,a),e.lastIndex=i.lastIndex,o;var p=n.groups,y=j6&&e.sticky,v=oa(XN,e),R=e.source,g=0,A=a;if(y&&(v=iC(v,"y",""),aC(v,"g")===-1&&(v+="g"),A=Wf(a,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&nC(a,e.lastIndex-1)!==`
`)&&(R="(?: "+R+")",A=" "+A,g++),u=new RegExp("^(?:"+R+")",v)),Yf&&(u=new RegExp("^"+R+"$(?!\\s)",v)),zf&&(s=e.lastIndex),l=oa(Go,y?u:e,A),y?l?(l.input=Wf(l.input,g),l[0]=Wf(l[0],g),l.index=e.lastIndex,e.lastIndex+=l[0].length):e.lastIndex=0:zf&&l&&(e.lastIndex=e.global?l.index+l[0].length:s),Yf&&l&&l.length>1&&oa(rC,l[0],u,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(l[f]=void 0)}),l&&p)for(l.groups=c=ZN(null),f=0;f<p.length;f++)h=p[f],c[h[0]]=l[h[1]];return l});var jo=Hf,uC=z,H6=jo;uC({target:"RegExp",proto:!0,forced:/./.exec!==H6},{exec:H6});var Kf={},sC=Ne;Kf.f=sC;var lC=H,fC=lC,W6=fC,cC=Be,hC=Kf,pC=lt.f,z6=function(r){var t=W6.Symbol||(W6.Symbol={});cC(t,r)||pC(t,r,{value:hC.f(r)})},dC=rt,vC=yr,yC=Ne,mC=Lt.exports,gC=function(){var r=vC("Symbol"),t=r&&r.prototype,e=t&&t.valueOf,n=yC("toPrimitive");t&&!t[n]&&mC(t,n,function(a){return dC(e,this)})},EC=H,Y6=hi,RC=$o,bC=ze,SC=Ne,AC=SC("species"),K6=EC.Array,TC=function(r){var t;return Y6(r)&&(t=r.constructor,RC(t)&&(t===K6||Y6(t.prototype))?t=void 0:bC(t)&&(t=t[AC],t===null&&(t=void 0))),t===void 0?K6:t},OC=TC,Xf=function(r,t){return new(OC(r))(t===0?0:t)},wC=Uo,NC=Q,CC=Za,_C=At,IC=or,MC=Xf,X6=NC([].push),en=function(r){var t=r==1,e=r==2,n=r==3,a=r==4,i=r==6,o=r==7,u=r==5||i;return function(s,l,f,c){for(var h=_C(s),p=CC(h),y=wC(l,f),v=IC(p),R=0,g=c||MC,A=t?g(s,v):e||o?g(s,0):void 0,T,N;v>R;R++)if((u||R in p)&&(T=p[R],N=y(T,R,h),r))if(t)A[R]=N;else if(N)switch(r){case 3:return!0;case 5:return T;case 6:return R;case 2:X6(A,T)}else switch(r){case 4:return!1;case 7:X6(A,T)}return i?-1:n||a?a:A}},In={forEach:en(0),map:en(1),filter:en(2),some:en(3),every:en(4),find:en(5),findIndex:en(6),filterReject:en(7)},Ho=z,qf=H,Qf=rt,kC=Q,ua=tt,sa=Jn,FC=re,nt=Be,PC=Zr,Zf=Qe,Wo=ar,Jf=To,$C=ft,ec=Qa,mi=ia,q6=ci,DC=Nn,Q6=Mo,LC=ui,Z6=Ir,J6=lt,UC=Of,e0=qa,tc=Lt.exports,rc=Tn.exports,xC=wo,t0=ai,r0=Ao,BC=Ne,VC=Kf,GC=z6,jC=gC,HC=xo,n0=Mr,zo=In.forEach,Tt=xC("hidden"),Yo="Symbol",gi="prototype",WC=n0.set,a0=n0.getterFor(Yo),Ht=Object[gi],Mn=qf.Symbol,Ei=Mn&&Mn[gi],zC=qf.TypeError,nc=qf.QObject,i0=Z6.f,tn=J6.f,o0=Q6.f,YC=e0.f,u0=kC([].push),kr=rc("symbols"),Ri=rc("op-symbols"),KC=rc("wks"),ac=!nc||!nc[gi]||!nc[gi].findChild,ic=ua&&FC(function(){return mi(tn({},"a",{get:function(){return tn(this,"a",{value:7}).a}})).a!=7})?function(r,t,e){var n=i0(Ht,t);n&&delete Ht[t],tn(r,t,e),n&&r!==Ht&&tn(Ht,t,n)}:tn,oc=function(r,t){var e=kr[r]=mi(Ei);return WC(e,{type:Yo,tag:r,description:t}),ua||(e.description=t),e},Ko=function(t,e,n){t===Ht&&Ko(Ri,e,n),Zf(t);var a=Jf(e);return Zf(n),nt(kr,a)?(n.enumerable?(nt(t,Tt)&&t[Tt][a]&&(t[Tt][a]=!1),n=mi(n,{enumerable:ec(0,!1)})):(nt(t,Tt)||tn(t,Tt,ec(1,{})),t[Tt][a]=!0),ic(t,a,n)):tn(t,a,n)},uc=function(t,e){Zf(t);var n=Wo(e),a=q6(n).concat(f0(n));return zo(a,function(i){(!ua||Qf(sc,n,i))&&Ko(t,i,n[i])}),t},XC=function(t,e){return e===void 0?mi(t):uc(mi(t),e)},sc=function(t){var e=Jf(t),n=Qf(YC,this,e);return this===Ht&&nt(kr,e)&&!nt(Ri,e)?!1:n||!nt(this,e)||!nt(kr,e)||nt(this,Tt)&&this[Tt][e]?n:!0},s0=function(t,e){var n=Wo(t),a=Jf(e);if(!(n===Ht&&nt(kr,a)&&!nt(Ri,a))){var i=i0(n,a);return i&&nt(kr,a)&&!(nt(n,Tt)&&n[Tt][a])&&(i.enumerable=!0),i}},l0=function(t){var e=o0(Wo(t)),n=[];return zo(e,function(a){!nt(kr,a)&&!nt(t0,a)&&u0(n,a)}),n},f0=function(r){var t=r===Ht,e=o0(t?Ri:Wo(r)),n=[];return zo(e,function(a){nt(kr,a)&&(!t||nt(Ht,a))&&u0(n,kr[a])}),n};sa||(Mn=function(){if(PC(Ei,this))throw zC("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:$C(arguments[0]),e=r0(t),n=function(a){this===Ht&&Qf(n,Ri,a),nt(this,Tt)&&nt(this[Tt],e)&&(this[Tt][e]=!1),ic(this,e,ec(1,a))};return ua&&ac&&ic(Ht,e,{configurable:!0,set:n}),oc(e,t)},Ei=Mn[gi],tc(Ei,"toString",function(){return a0(this).tag}),tc(Mn,"withoutSetter",function(r){return oc(r0(r),r)}),e0.f=sc,J6.f=Ko,UC.f=uc,Z6.f=s0,DC.f=Q6.f=l0,LC.f=f0,VC.f=function(r){return oc(BC(r),r)},ua&&(tn(Ei,"description",{configurable:!0,get:function(){return a0(this).description}}),tc(Ht,"propertyIsEnumerable",sc,{unsafe:!0})));Ho({global:!0,wrap:!0,forced:!sa,sham:!sa},{Symbol:Mn});zo(q6(KC),function(r){GC(r)});Ho({target:Yo,stat:!0,forced:!sa},{useSetter:function(){ac=!0},useSimple:function(){ac=!1}});Ho({target:"Object",stat:!0,forced:!sa,sham:!ua},{create:XC,defineProperty:Ko,defineProperties:uc,getOwnPropertyDescriptor:s0});Ho({target:"Object",stat:!0,forced:!sa},{getOwnPropertyNames:l0});jC();HC(Mn,Yo);t0[Tt]=!0;var qC=Jn,c0=qC&&!!Symbol.for&&!!Symbol.keyFor,QC=z,ZC=yr,JC=Be,e_=ft,h0=Tn.exports,t_=c0,lc=h0("string-to-symbol-registry"),r_=h0("symbol-to-string-registry");QC({target:"Symbol",stat:!0,forced:!t_},{for:function(r){var t=e_(r);if(JC(lc,t))return lc[t];var e=ZC("Symbol")(t);return lc[t]=e,r_[e]=t,e}});var n_=z,a_=Be,i_=ti,o_=ri,u_=Tn.exports,s_=c0,p0=u_("symbol-to-string-registry");n_({target:"Symbol",stat:!0,forced:!s_},{keyFor:function(t){if(!i_(t))throw TypeError(o_(t)+" is not a symbol");if(a_(p0,t))return p0[t]}});var l_=z,d0=yr,v0=Po,f_=rt,bi=Q,y0=re,c_=hi,h_=xe,p_=ze,m0=ti,g0=Sf,d_=Jn,rn=d0("JSON","stringify"),Xo=bi(/./.exec),E0=bi("".charAt),v_=bi("".charCodeAt),y_=bi("".replace),m_=bi(1 .toString),g_=/[\uD800-\uDFFF]/g,R0=/^[\uD800-\uDBFF]$/,b0=/^[\uDC00-\uDFFF]$/,S0=!d_||y0(function(){var r=d0("Symbol")();return rn([r])!="[null]"||rn({a:r})!="{}"||rn(Object(r))!="{}"}),A0=y0(function(){return rn("\uDF06\uD834")!=='"\\udf06\\ud834"'||rn("\uDEAD")!=='"\\udead"'}),E_=function(r,t){var e=g0(arguments),n=t;if(!(!p_(t)&&r===void 0||m0(r)))return c_(t)||(t=function(a,i){if(h_(n)&&(i=f_(n,this,a,i)),!m0(i))return i}),e[1]=t,v0(rn,null,e)},R_=function(r,t,e){var n=E0(e,t-1),a=E0(e,t+1);return Xo(R0,r)&&!Xo(b0,a)||Xo(b0,r)&&!Xo(R0,n)?"\\u"+m_(v_(r,0),16):r};rn&&l_({target:"JSON",stat:!0,forced:S0||A0},{stringify:function(t,e,n){var a=g0(arguments),i=v0(S0?E_:rn,null,a);return A0&&typeof i=="string"?y_(i,g_,R_):i}});var b_=z,S_=Jn,A_=re,T0=ui,T_=At,O_=!S_||A_(function(){T0.f(1)});b_({target:"Object",stat:!0,forced:O_},{getOwnPropertySymbols:function(t){var e=T0.f;return e?e(T_(t)):[]}});var w_=z,N_=tt,C_=H,qo=Q,__=Be,I_=xe,M_=Zr,k_=ft,F_=lt.f,P_=Ov,Fr=C_.Symbol,kn=Fr&&Fr.prototype;if(N_&&I_(Fr)&&(!("description"in kn)||Fr().description!==void 0)){var O0={},Qo=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:k_(arguments[0]),e=M_(kn,this)?new Fr(t):t===void 0?Fr():Fr(t);return t===""&&(O0[e]=!0),e};P_(Qo,Fr),Qo.prototype=kn,kn.constructor=Qo;var $_=String(Fr("test"))=="Symbol(test)",D_=qo(kn.toString),L_=qo(kn.valueOf),U_=/^Symbol\((.*)\)[^)]+$/,x_=qo("".replace),B_=qo("".slice);F_(kn,"description",{configurable:!0,get:function(){var t=L_(this),e=D_(t);if(__(O0,t))return"";var n=$_?B_(e,7,-1):x_(e,U_,"$1");return n===""?void 0:n}}),w_({global:!0,forced:!0},{Symbol:Qo})}var V_=z6;V_("iterator");var G_=Ne,j_=ia,H_=lt,fc=G_("unscopables"),cc=Array.prototype;cc[fc]==null&&H_.f(cc,fc,{configurable:!0,value:j_(null)});var Si=function(r){cc[fc][r]=!0},W_=ar,hc=Si,w0=di,N0=Mr,z_=lt.f,Y_=xf,K_=tt,C0="Array Iterator",X_=N0.set,q_=N0.getterFor(C0),Q_=Y_(Array,"Array",function(r,t){X_(this,{type:C0,target:W_(r),index:0,kind:t})},function(){var r=q_(this),t=r.target,e=r.kind,n=r.index++;return!t||n>=t.length?(r.target=void 0,{value:void 0,done:!0}):e=="keys"?{value:n,done:!1}:e=="values"?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}},"values"),_0=w0.Arguments=w0.Array;hc("keys");hc("values");hc("entries");if(K_&&_0.name!=="values")try{z_(_0,"name",{value:"values"})}catch{}var I0={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Z_=Jl,pc=Z_("span").classList,M0=pc&&pc.constructor&&pc.constructor.prototype,k0=M0===Object.prototype?void 0:M0,F0=H,P0=I0,J_=k0,Ai=Q_,dc=Jr,$0=Ne,vc=$0("iterator"),D0=$0("toStringTag"),yc=Ai.values,L0=function(r,t){if(r){if(r[vc]!==yc)try{dc(r,vc,yc)}catch{r[vc]=yc}if(r[D0]||dc(r,D0,t),P0[t]){for(var e in Ai)if(r[e]!==Ai[e])try{dc(r,e,Ai[e])}catch{r[e]=Ai[e]}}}};for(var mc in P0)L0(F0[mc]&&F0[mc].prototype,mc);L0(J_,"DOMTokenList");var U0=tt,eI=Q,tI=rt,rI=re,gc=ci,nI=ui,aI=qa,iI=At,oI=Za,la=Object.assign,x0=Object.defineProperty,uI=eI([].concat),sI=!la||rI(function(){if(U0&&la({b:1},la(x0({},"a",{enumerable:!0,get:function(){x0(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},t={},e=Symbol(),n="abcdefghijklmnopqrst";return r[e]=7,n.split("").forEach(function(a){t[a]=a}),la({},r)[e]!=7||gc(la({},t)).join("")!=n})?function(t,e){for(var n=iI(t),a=arguments.length,i=1,o=nI.f,u=aI.f;a>i;)for(var s=oI(arguments[i++]),l=o?uI(gc(s),o(s)):gc(s),f=l.length,c=0,h;f>c;)h=l[c++],(!U0||tI(u,s,h))&&(n[h]=s[h]);return n}:la,lI=z,B0=sI;lI({target:"Object",stat:!0,forced:Object.assign!==B0},{assign:B0});var fI=z,cI=H,hI=re,pI=hi,dI=ze,vI=At,yI=or,V0=li,mI=Xf,gI=pi,EI=Ne,RI=ei,G0=EI("isConcatSpreadable"),j0=9007199254740991,H0="Maximum allowed index exceeded",W0=cI.TypeError,bI=RI>=51||!hI(function(){var r=[];return r[G0]=!1,r.concat()[0]!==r}),SI=gI("concat"),AI=function(r){if(!dI(r))return!1;var t=r[G0];return t!==void 0?!!t:pI(r)},TI=!bI||!SI;fI({target:"Array",proto:!0,forced:TI},{concat:function(t){var e=vI(this),n=mI(e,0),a=0,i,o,u,s,l;for(i=-1,u=arguments.length;i<u;i++)if(l=i===-1?e:arguments[i],AI(l)){if(s=yI(l),a+s>j0)throw W0(H0);for(o=0;o<s;o++,a++)o in l&&V0(n,a,l[o])}else{if(a>=j0)throw W0(H0);V0(n,a++,l)}return n.length=a,n}});var OI={exports:{}};(function(r){var t=function(e){var n=Object.prototype,a=n.hasOwnProperty,i,o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function f(w,O,C){return Object.defineProperty(w,O,{value:C,enumerable:!0,configurable:!0,writable:!0}),w[O]}try{f({},"")}catch{f=function(O,C,k){return O[C]=k}}function c(w,O,C,k){var B=O&&O.prototype instanceof A?O:A,ae=Object.create(B.prototype),J=new pe(k||[]);return ae._invoke=Z(w,C,J),ae}e.wrap=c;function h(w,O,C){try{return{type:"normal",arg:w.call(O,C)}}catch(k){return{type:"throw",arg:k}}}var p="suspendedStart",y="suspendedYield",v="executing",R="completed",g={};function A(){}function T(){}function N(){}var M={};f(M,u,function(){return this});var _=Object.getPrototypeOf,$=_&&_(_(Re([])));$&&$!==n&&a.call($,u)&&(M=$);var x=N.prototype=A.prototype=Object.create(M);T.prototype=N,f(x,"constructor",N),f(N,"constructor",T),T.displayName=f(N,l,"GeneratorFunction");function D(w){["next","throw","return"].forEach(function(O){f(w,O,function(C){return this._invoke(O,C)})})}e.isGeneratorFunction=function(w){var O=typeof w=="function"&&w.constructor;return O?O===T||(O.displayName||O.name)==="GeneratorFunction":!1},e.mark=function(w){return Object.setPrototypeOf?Object.setPrototypeOf(w,N):(w.__proto__=N,f(w,l,"GeneratorFunction")),w.prototype=Object.create(x),w},e.awrap=function(w){return{__await:w}};function K(w,O){function C(ae,J,Ae,Ce){var Je=h(w[ae],w,J);if(Je.type==="throw")Ce(Je.arg);else{var vt=Je.arg,et=vt.value;return et&&typeof et=="object"&&a.call(et,"__await")?O.resolve(et.__await).then(function(yt){C("next",yt,Ae,Ce)},function(yt){C("throw",yt,Ae,Ce)}):O.resolve(et).then(function(yt){vt.value=yt,Ae(vt)},function(yt){return C("throw",yt,Ae,Ce)})}}var k;function B(ae,J){function Ae(){return new O(function(Ce,Je){C(ae,J,Ce,Je)})}return k=k?k.then(Ae,Ae):Ae()}this._invoke=B}D(K.prototype),f(K.prototype,s,function(){return this}),e.AsyncIterator=K,e.async=function(w,O,C,k,B){B===void 0&&(B=Promise);var ae=new K(c(w,O,C,k),B);return e.isGeneratorFunction(O)?ae:ae.next().then(function(J){return J.done?J.value:ae.next()})};function Z(w,O,C){var k=p;return function(ae,J){if(k===v)throw new Error("Generator is already running");if(k===R){if(ae==="throw")throw J;return we()}for(C.method=ae,C.arg=J;;){var Ae=C.delegate;if(Ae){var Ce=ie(Ae,C);if(Ce){if(Ce===g)continue;return Ce}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(k===p)throw k=R,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);k=v;var Je=h(w,O,C);if(Je.type==="normal"){if(k=C.done?R:y,Je.arg===g)continue;return{value:Je.arg,done:C.done}}else Je.type==="throw"&&(k=R,C.method="throw",C.arg=Je.arg)}}}function ie(w,O){var C=w.iterator[O.method];if(C===i){if(O.delegate=null,O.method==="throw"){if(w.iterator.return&&(O.method="return",O.arg=i,ie(w,O),O.method==="throw"))return g;O.method="throw",O.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var k=h(C,w.iterator,O.arg);if(k.type==="throw")return O.method="throw",O.arg=k.arg,O.delegate=null,g;var B=k.arg;if(!B)return O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,g;if(B.done)O[w.resultName]=B.value,O.next=w.nextLoc,O.method!=="return"&&(O.method="next",O.arg=i);else return B;return O.delegate=null,g}D(x),f(x,l,"Generator"),f(x,u,function(){return this}),f(x,"toString",function(){return"[object Generator]"});function q(w){var O={tryLoc:w[0]};1 in w&&(O.catchLoc=w[1]),2 in w&&(O.finallyLoc=w[2],O.afterLoc=w[3]),this.tryEntries.push(O)}function le(w){var O=w.completion||{};O.type="normal",delete O.arg,w.completion=O}function pe(w){this.tryEntries=[{tryLoc:"root"}],w.forEach(q,this),this.reset(!0)}e.keys=function(w){var O=[];for(var C in w)O.push(C);return O.reverse(),function k(){for(;O.length;){var B=O.pop();if(B in w)return k.value=B,k.done=!1,k}return k.done=!0,k}};function Re(w){if(w){var O=w[u];if(O)return O.call(w);if(typeof w.next=="function")return w;if(!isNaN(w.length)){var C=-1,k=function B(){for(;++C<w.length;)if(a.call(w,C))return B.value=w[C],B.done=!1,B;return B.value=i,B.done=!0,B};return k.next=k}}return{next:we}}e.values=Re;function we(){return{value:i,done:!0}}return pe.prototype={constructor:pe,reset:function(w){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(le),!w)for(var O in this)O.charAt(0)==="t"&&a.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=i)},stop:function(){this.done=!0;var w=this.tryEntries[0],O=w.completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(w){if(this.done)throw w;var O=this;function C(Ce,Je){return ae.type="throw",ae.arg=w,O.next=Ce,Je&&(O.method="next",O.arg=i),!!Je}for(var k=this.tryEntries.length-1;k>=0;--k){var B=this.tryEntries[k],ae=B.completion;if(B.tryLoc==="root")return C("end");if(B.tryLoc<=this.prev){var J=a.call(B,"catchLoc"),Ae=a.call(B,"finallyLoc");if(J&&Ae){if(this.prev<B.catchLoc)return C(B.catchLoc,!0);if(this.prev<B.finallyLoc)return C(B.finallyLoc)}else if(J){if(this.prev<B.catchLoc)return C(B.catchLoc,!0)}else if(Ae){if(this.prev<B.finallyLoc)return C(B.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(w,O){for(var C=this.tryEntries.length-1;C>=0;--C){var k=this.tryEntries[C];if(k.tryLoc<=this.prev&&a.call(k,"finallyLoc")&&this.prev<k.finallyLoc){var B=k;break}}B&&(w==="break"||w==="continue")&&B.tryLoc<=O&&O<=B.finallyLoc&&(B=null);var ae=B?B.completion:{};return ae.type=w,ae.arg=O,B?(this.method="next",this.next=B.finallyLoc,g):this.complete(ae)},complete:function(w,O){if(w.type==="throw")throw w.arg;return w.type==="break"||w.type==="continue"?this.next=w.arg:w.type==="return"?(this.rval=this.arg=w.arg,this.method="return",this.next="end"):w.type==="normal"&&O&&(this.next=O),g},finish:function(w){for(var O=this.tryEntries.length-1;O>=0;--O){var C=this.tryEntries[O];if(C.finallyLoc===w)return this.complete(C.completion,C.afterLoc),le(C),g}},catch:function(w){for(var O=this.tryEntries.length-1;O>=0;--O){var C=this.tryEntries[O];if(C.tryLoc===w){var k=C.completion;if(k.type==="throw"){var B=k.arg;le(C)}return B}}throw new Error("illegal catch attempt")},delegateYield:function(w,O,C){return this.delegate={iterator:Re(w),resultName:O,nextLoc:C},this.method==="next"&&(this.arg=i),g}},e}(r.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(OI);var wI=z,NI=In.map,CI=pi,_I=CI("map");wI({target:"Array",proto:!0,forced:!_I},{map:function(t){return NI(this,t,arguments.length>1?arguments[1]:void 0)}});var Ti={exports:{}},II=re,MI=II(function(){if(typeof ArrayBuffer=="function"){var r=new ArrayBuffer(8);Object.isExtensible(r)&&Object.defineProperty(r,"a",{value:8})}}),kI=re,FI=ze,PI=Qr,z0=MI,Zo=Object.isExtensible,$I=kI(function(){Zo(1)}),Y0=$I||z0?function(t){return!FI(t)||z0&&PI(t)=="ArrayBuffer"?!1:Zo?Zo(t):!0}:Zo,DI=re,LI=!DI(function(){return Object.isExtensible(Object.preventExtensions({}))}),UI=z,xI=Q,BI=ai,VI=ze,Ec=Be,GI=lt.f,K0=Nn,jI=Mo,Rc=Y0,HI=Ao,WI=LI,X0=!1,Pr=HI("meta"),zI=0,bc=function(r){GI(r,Pr,{value:{objectID:"O"+zI++,weakData:{}}})},YI=function(r,t){if(!VI(r))return typeof r=="symbol"?r:(typeof r=="string"?"S":"P")+r;if(!Ec(r,Pr)){if(!Rc(r))return"F";if(!t)return"E";bc(r)}return r[Pr].objectID},KI=function(r,t){if(!Ec(r,Pr)){if(!Rc(r))return!0;if(!t)return!1;bc(r)}return r[Pr].weakData},XI=function(r){return WI&&X0&&Rc(r)&&!Ec(r,Pr)&&bc(r),r},qI=function(){QI.enable=function(){},X0=!0;var r=K0.f,t=xI([].splice),e={};e[Pr]=1,r(e).length&&(K0.f=function(n){for(var a=r(n),i=0,o=a.length;i<o;i++)if(a[i]===Pr){t(a,i,1);break}return a},UI({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:jI.f}))},QI=Ti.exports={enable:qI,fastKey:YI,getWeakData:KI,onFreeze:XI};BI[Pr]=!0;var ZI=H,JI=Uo,eM=rt,tM=Qe,rM=ri,nM=d6,aM=or,q0=Zr,iM=y6,oM=kf,Q0=p6,uM=ZI.TypeError,Jo=function(r,t){this.stopped=r,this.result=t},Z0=Jo.prototype,Sc=function(r,t,e){var n=e&&e.that,a=!!(e&&e.AS_ENTRIES),i=!!(e&&e.IS_ITERATOR),o=!!(e&&e.INTERRUPTED),u=JI(t,n),s,l,f,c,h,p,y,v=function(g){return s&&Q0(s,"normal",g),new Jo(!0,g)},R=function(g){return a?(tM(g),o?u(g[0],g[1],v):u(g[0],g[1])):o?u(g,v):u(g)};if(i)s=r;else{if(l=oM(r),!l)throw uM(rM(r)+" is not iterable");if(nM(l)){for(f=0,c=aM(r);c>f;f++)if(h=R(r[f]),h&&q0(Z0,h))return h;return new Jo(!1)}s=iM(r,l)}for(p=s.next;!(y=eM(p,s)).done;){try{h=R(y.value)}catch(g){Q0(s,"throw",g)}if(typeof h=="object"&&h&&q0(Z0,h))return h}return new Jo(!1)},sM=H,lM=Zr,fM=sM.TypeError,Ac=function(r,t){if(lM(t,r))return r;throw fM("Incorrect invocation")},cM=xe,hM=ze,J0=I6,Tc=function(r,t,e){var n,a;return J0&&cM(n=t.constructor)&&n!==e&&hM(a=n.prototype)&&a!==e.prototype&&J0(r,a),r},pM=z,dM=H,vM=Q,ey=_o,yM=Lt.exports,mM=Ti.exports,gM=Sc,EM=Ac,RM=xe,Oc=ze,wc=re,bM=S6,SM=xo,AM=Tc,Nc=function(r,t,e){var n=r.indexOf("Map")!==-1,a=r.indexOf("Weak")!==-1,i=n?"set":"add",o=dM[r],u=o&&o.prototype,s=o,l={},f=function(g){var A=vM(u[g]);yM(u,g,g=="add"?function(N){return A(this,N===0?0:N),this}:g=="delete"?function(T){return a&&!Oc(T)?!1:A(this,T===0?0:T)}:g=="get"?function(N){return a&&!Oc(N)?void 0:A(this,N===0?0:N)}:g=="has"?function(N){return a&&!Oc(N)?!1:A(this,N===0?0:N)}:function(N,M){return A(this,N===0?0:N,M),this})},c=ey(r,!RM(o)||!(a||u.forEach&&!wc(function(){new o().entries().next()})));if(c)s=e.getConstructor(t,r,n,i),mM.enable();else if(ey(r,!0)){var h=new s,p=h[i](a?{}:-0,1)!=h,y=wc(function(){h.has(1)}),v=bM(function(g){new o(g)}),R=!a&&wc(function(){for(var g=new o,A=5;A--;)g[i](A,A);return!g.has(-0)});v||(s=t(function(g,A){EM(g,u);var T=AM(new o,g,s);return A!=null&&gM(A,T[i],{that:T,AS_ENTRIES:n}),T}),s.prototype=u,u.constructor=s),(y||R)&&(f("delete"),f("has"),n&&f("get")),(R||p)&&f(i),a&&u.clear&&delete u.clear}return l[r]=s,pM({global:!0,forced:s!=o},l),SM(s,r),a||e.setStrong(s,r,n),s},TM=Lt.exports,Cc=function(r,t,e){for(var n in t)TM(r,n,t[n],e);return r},OM=yr,wM=lt,NM=Ne,CM=tt,ty=NM("species"),ry=function(r){var t=OM(r),e=wM.f;CM&&t&&!t[ty]&&e(t,ty,{configurable:!0,get:function(){return this}})},_M=lt.f,IM=ia,ny=Cc,MM=Uo,kM=Ac,FM=Sc,PM=xf,$M=ry,Oi=tt,ay=Ti.exports.fastKey,iy=Mr,oy=iy.set,_c=iy.getterFor,uy={getConstructor:function(r,t,e,n){var a=r(function(l,f){kM(l,i),oy(l,{type:t,index:IM(null),first:void 0,last:void 0,size:0}),Oi||(l.size=0),f!=null&&FM(f,l[n],{that:l,AS_ENTRIES:e})}),i=a.prototype,o=_c(t),u=function(l,f,c){var h=o(l),p=s(l,f),y,v;return p?p.value=c:(h.last=p={index:v=ay(f,!0),key:f,value:c,previous:y=h.last,next:void 0,removed:!1},h.first||(h.first=p),y&&(y.next=p),Oi?h.size++:l.size++,v!=="F"&&(h.index[v]=p)),l},s=function(l,f){var c=o(l),h=ay(f),p;if(h!=="F")return c.index[h];for(p=c.first;p;p=p.next)if(p.key==f)return p};return ny(i,{clear:function(){for(var f=this,c=o(f),h=c.index,p=c.first;p;)p.removed=!0,p.previous&&(p.previous=p.previous.next=void 0),delete h[p.index],p=p.next;c.first=c.last=void 0,Oi?c.size=0:f.size=0},delete:function(l){var f=this,c=o(f),h=s(f,l);if(h){var p=h.next,y=h.previous;delete c.index[h.index],h.removed=!0,y&&(y.next=p),p&&(p.previous=y),c.first==h&&(c.first=p),c.last==h&&(c.last=y),Oi?c.size--:f.size--}return!!h},forEach:function(f){for(var c=o(this),h=MM(f,arguments.length>1?arguments[1]:void 0),p;p=p?p.next:c.first;)for(h(p.value,p.key,this);p&&p.removed;)p=p.previous},has:function(f){return!!s(this,f)}}),ny(i,e?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return u(this,f===0?0:f,c)}}:{add:function(f){return u(this,f=f===0?0:f,f)}}),Oi&&_M(i,"size",{get:function(){return o(this).size}}),a},setStrong:function(r,t,e){var n=t+" Iterator",a=_c(t),i=_c(n);PM(r,t,function(o,u){oy(this,{type:n,target:o,state:a(o),kind:u,last:void 0})},function(){for(var o=i(this),u=o.kind,s=o.last;s&&s.removed;)s=s.previous;return!o.target||!(o.last=s=s?s.next:o.state.first)?(o.target=void 0,{value:void 0,done:!0}):u=="keys"?{value:s.key,done:!1}:u=="values"?{value:s.value,done:!1}:{value:[s.key,s.value],done:!1}},e?"entries":"values",!e,!0),$M(t)}},DM=Nc,LM=uy;DM("Set",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},LM);var UM=re,eu=function(r,t){var e=[][r];return!!e&&UM(function(){e.call(null,t||function(){return 1},1)})},xM=In.forEach,BM=eu,VM=BM("forEach"),GM=VM?[].forEach:function(t){return xM(this,t,arguments.length>1?arguments[1]:void 0)},sy=H,ly=I0,jM=k0,Ic=GM,HM=Jr,fy=function(r){if(r&&r.forEach!==Ic)try{HM(r,"forEach",Ic)}catch{r.forEach=Ic}};for(var Mc in ly)ly[Mc]&&fy(sy[Mc]&&sy[Mc].prototype);fy(jM);var WM=z,zM=In.filter,YM=pi,KM=YM("filter");WM({target:"Array",proto:!0,forced:!KM},{filter:function(t){return zM(this,t,arguments.length>1?arguments[1]:void 0)}});var XM=H,qM=XM.isFinite,QM=Number.isFinite||function(t){return typeof t=="number"&&qM(t)},ZM=z,JM=QM;ZM({target:"Number",stat:!0},{isFinite:JM});var ek=Q,cy=ek(1 .valueOf),hy=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,tk=Q,rk=nr,nk=ft,ak=hy,py=tk("".replace),tu="["+ak+"]",ik=RegExp("^"+tu+tu+"*"),ok=RegExp(tu+tu+"*$"),kc=function(r){return function(t){var e=nk(rk(t));return r&1&&(e=py(e,ik,"")),r&2&&(e=py(e,ok,"")),e}},dy={start:kc(1),end:kc(2),trim:kc(3)},uk=tt,Fc=H,vy=Q,sk=_o,lk=Lt.exports,yy=Be,fk=Tc,ck=Zr,hk=ti,my=nv,pk=re,dk=Nn.f,vk=Ir.f,yk=lt.f,mk=cy,gk=dy.trim,Pc="Number",nn=Fc[Pc],$c=nn.prototype,Ek=Fc.TypeError,Rk=vy("".slice),ru=vy("".charCodeAt),bk=function(r){var t=my(r,"number");return typeof t=="bigint"?t:Sk(t)},Sk=function(r){var t=my(r,"number"),e,n,a,i,o,u,s,l;if(hk(t))throw Ek("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=gk(t),e=ru(t,0),e===43||e===45){if(n=ru(t,2),n===88||n===120)return NaN}else if(e===48){switch(ru(t,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+t}for(o=Rk(t,2),u=o.length,s=0;s<u;s++)if(l=ru(o,s),l<48||l>i)return NaN;return parseInt(o,a)}}return+t};if(sk(Pc,!nn(" 0o1")||!nn("0b1")||nn("+0x1"))){for(var fa=function(t){var e=arguments.length<1?0:nn(bk(t)),n=this;return ck($c,n)&&pk(function(){mk(n)})?fk(Object(e),n,fa):e},gy=uk?dk(nn):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Dc=0,nu;gy.length>Dc;Dc++)yy(nn,nu=gy[Dc])&&!yy(fa,nu)&&yk(fa,nu,vk(nn,nu));fa.prototype=$c,$c.constructor=fa,lk(Fc,Pc,fa)}var Ak=rt,Tk=Be,Ok=Zr,wk=B6,Ey=RegExp.prototype,Ry=function(r){var t=r.flags;return t===void 0&&!("flags"in Ey)&&!Tk(r,"flags")&&Ok(Ey,r)?Ak(wk,r):t},Nk=oi.PROPER,Ck=Lt.exports,_k=Qe,by=ft,Ik=re,Mk=Ry,Lc="toString",kk=RegExp.prototype,Sy=kk[Lc],Fk=Ik(function(){return Sy.call({source:"a",flags:"b"})!="/a/b"}),Pk=Nk&&Sy.name!=Lc;(Fk||Pk)&&Ck(RegExp.prototype,Lc,function(){var t=_k(this),e=by(t.source),n=by(Mk(t));return"/"+e+"/"+n},{unsafe:!0});var $k=lt.f,Dk=function(r,t,e){e in r||$k(r,e,{configurable:!0,get:function(){return t[e]},set:function(n){t[e]=n}})},Lk=tt,Uc=H,wi=Q,Uk=_o,xk=Tc,Bk=Jr,Vk=Nn.f,Ay=Zr,Gk=Ef,Ty=ft,jk=Ry,Oy=jf,Hk=Dk,Wk=Lt.exports,zk=re,Yk=Be,Kk=Mr.enforce,Xk=ry,qk=Ne,wy=V6,Ny=G6,Qk=qk("match"),an=Uc.RegExp,ca=an.prototype,Zk=Uc.SyntaxError,Jk=wi(ca.exec),au=wi("".charAt),Cy=wi("".replace),_y=wi("".indexOf),eF=wi("".slice),tF=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Fn=/a/g,xc=/a/g,rF=new an(Fn)!==Fn,Iy=Oy.MISSED_STICKY,nF=Oy.UNSUPPORTED_Y,aF=Lk&&(!rF||Iy||wy||Ny||zk(function(){return xc[Qk]=!1,an(Fn)!=Fn||an(xc)==xc||an(Fn,"i")!="/a/i"})),iF=function(r){for(var t=r.length,e=0,n="",a=!1,i;e<=t;e++){if(i=au(r,e),i==="\\"){n+=i+au(r,++e);continue}!a&&i==="."?n+="[\\s\\S]":(i==="["?a=!0:i==="]"&&(a=!1),n+=i)}return n},oF=function(r){for(var t=r.length,e=0,n="",a=[],i={},o=!1,u=!1,s=0,l="",f;e<=t;e++){if(f=au(r,e),f==="\\")f=f+au(r,++e);else if(f==="]")o=!1;else if(!o)switch(!0){case f==="[":o=!0;break;case f==="(":Jk(tF,eF(r,e+1))&&(e+=2,u=!0),n+=f,s++;continue;case(f===">"&&u):if(l===""||Yk(i,l))throw new Zk("Invalid capture group name");i[l]=!0,a[a.length]=[l,s],u=!1,l="";continue}u?l+=f:n+=f}return[n,a]};if(Uk("RegExp",aF)){for(var Pn=function(t,e){var n=Ay(ca,this),a=Gk(t),i=e===void 0,o=[],u=t,s,l,f,c,h,p;if(!n&&a&&i&&t.constructor===Pn)return t;if((a||Ay(ca,t))&&(t=t.source,i&&(e=jk(u))),t=t===void 0?"":Ty(t),e=e===void 0?"":Ty(e),u=t,wy&&"dotAll"in Fn&&(l=!!e&&_y(e,"s")>-1,l&&(e=Cy(e,/s/g,""))),s=e,Iy&&"sticky"in Fn&&(f=!!e&&_y(e,"y")>-1,f&&nF&&(e=Cy(e,/y/g,""))),Ny&&(c=oF(t),t=c[0],o=c[1]),h=xk(an(t,e),n?this:ca,Pn),(l||f||o.length)&&(p=Kk(h),l&&(p.dotAll=!0,p.raw=Pn(iF(t),s)),f&&(p.sticky=!0),o.length&&(p.groups=o)),t!==u)try{Bk(h,"source",u===""?"(?:)":u)}catch{}return h},My=Vk(an),ky=0;My.length>ky;)Hk(Pn,an,My[ky++]);ca.constructor=Pn,Pn.prototype=ca,Wk(Uc,"RegExp",Pn)}Xk("RegExp");var uF=Nc,sF=uy;uF("Map",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},sF);function iu(r){return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(r)}function Fy(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function ve(r,t,e){return t&&Fy(r.prototype,t),e&&Fy(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ye(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function me(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ni(r,t)}function ge(r){var t=Py();return function(){var n=Ci(r),a;if(t){var i=Ci(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return lF(this,a)}}function lF(r,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fF(r)}function fF(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ce(r){var t=typeof Map=="function"?new Map:void 0;return ce=function(n){if(n===null||!cF(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(n))return t.get(n);t.set(n,a)}function a(){return ou(n,arguments,Ci(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Ni(a,n)},ce(r)}function ou(r,t,e){return Py()?ou=Reflect.construct:ou=function(a,i,o){var u=[null];u.push.apply(u,i);var s=Function.bind.apply(a,u),l=new s;return o&&Ni(l,o.prototype),l},ou.apply(null,arguments)}function Py(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cF(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function Ni(r,t){return Ni=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Ni(r,t)}function Ci(r){return Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ci(r)}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var Me=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"There's no sheet with id = ".concat(n))}return ve(e)}(ce(Error)),$y=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"There's no sheet with name '".concat(n,"'"))}return ve(e)}(ce(Error)),_i=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Sheet with name ".concat(n," already exists"))}return ve(e)}(ce(Error)),$n=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Sheet size limit exceeded")}return ve(e)}(ce(Error)),Bc=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"This is not a formula")}return ve(e)}(ce(Error)),Dy=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Address (row = ".concat(n.row,", col = ").concat(n.col,") is invalid"))}return ve(e)}(ce(Error)),Ye=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Invalid arguments, expected ".concat(n))}return ve(e)}(ce(Error)),uu=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Sheets ".concat(n," and ").concat(a," are not equal."))}return ve(e)}(ce(Error)),Ly=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Name of Named Expression '".concat(n,"' is already present"))}return ve(e)}(ce(Error)),Uy=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Name of Named Expression '".concat(n,"' is invalid"))}return ve(e)}(ce(Error)),Ii=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Named Expression '".concat(n,"' does not exist"))}return ve(e)}(ce(Error)),xy=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"There is no operation to undo")}return ve(e)}(ce(Error)),By=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"There is no operation to redo")}return ve(e)}(ce(Error)),Vy=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"There is nothing to paste")}return ve(e)}(ce(Error));function hF(r,t){switch(iu(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}var Gy=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Unable to parse value: ".concat(JSON.stringify(n,hF,4)))}return ve(e)}(ce(Error)),he=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Expected value of type: ".concat(n," for config parameter: ").concat(a))}return ve(e)}(ce(Error)),pF=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Config parameter ".concat(n," cannot be empty."))}return ve(e)}(ce(Error)),jy=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Config parameter ".concat(n," should be at least ").concat(a))}return ve(e)}(ce(Error)),Hy=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Config parameter ".concat(n," should be at most ").concat(a))}return ve(e)}(ce(Error)),Wy=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Expected one of ".concat(n," for config parameter: ").concat(a))}return ve(e)}(ce(Error)),zy=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Computations are suspended")}return ve(e)}(ce(Error)),ha=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Translation for ".concat(n," is missing in the translation package you're using."))}return ve(e)}(ce(Error)),Yy=function(r){me(e,r);var t=ge(e);function e(n){return ye(this,e),t.call(this,"Cannot register translation for function with id: ".concat(n))}return ve(e)}(ce(Error)),Vc=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Language not registered.")}return ve(e)}(ce(Error)),Ky=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Language already registered.")}return ve(e)}(ce(Error)),Gc=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.apply(this,arguments)}return ve(e,null,[{key:"functionNotDeclaredInPlugin",value:function(a,i){return new e("Function with id ".concat(a," not declared in plugin ").concat(i))}},{key:"functionMethodNotFound",value:function(a,i){return new e("Function method ".concat(a," not found in plugin ").concat(i))}}]),e}(ce(Error)),jc=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.apply(this,arguments)}return ve(e,null,[{key:"cannotRegisterFunctionWithId",value:function(a){return new e("Cannot register function with id ".concat(a))}},{key:"cannotUnregisterFunctionWithId",value:function(a){return new e("Cannot unregister function with id ".concat(a))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new e("Cannot unregister protected plugin")}}]),e}(ce(Error)),pa=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Cannot perform this operation, source location has an array inside.")}return ve(e)}(ce(Error)),su=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Cannot perform this operation, target location has an array inside.")}return ve(e)}(ce(Error)),Hc=function(r){me(e,r);var t=ge(e);function e(){return ye(this,e),t.call(this,"Relative addresses not allowed in named expressions.")}return ve(e)}(ce(Error)),dF=function(r){me(e,r);var t=ge(e);function e(n,a){return ye(this,e),t.call(this,"Alias id ".concat(n," in plugin ").concat(a," already defined as a function or alias."))}return ve(e)}(ce(Error)),Xy=Q,qy=Lt.exports,vF=jo,Qy=re,Zy=Ne,yF=Jr,mF=Zy("species"),Wc=RegExp.prototype,Jy=function(r,t,e,n){var a=Zy(r),i=!Qy(function(){var l={};return l[a]=function(){return 7},""[r](l)!=7}),o=i&&!Qy(function(){var l=!1,f=/a/;return r==="split"&&(f={},f.constructor={},f.constructor[mF]=function(){return f},f.flags="",f[a]=/./[a]),f.exec=function(){return l=!0,null},f[a](""),!l});if(!i||!o||e){var u=Xy(/./[a]),s=t(a,""[r],function(l,f,c,h,p){var y=Xy(l),v=f.exec;return v===vF||v===Wc.exec?i&&!p?{done:!0,value:u(f,c,h)}:{done:!0,value:y(c,f,h)}:{done:!1}});qy(String.prototype,r,s[0]),qy(Wc,a,s[1])}n&&yF(Wc[a],"sham",!0)},em=Qe,gF=Yv,EF=Ne,RF=EF("species"),bF=function(r,t){var e=em(r).constructor,n;return e===void 0||(n=em(e)[RF])==null?t:gF(n)},SF=Pf.charAt,tm=function(r,t,e){return t+(e?SF(r,t).length:1)},AF=H,rm=rt,TF=Qe,OF=xe,wF=Qr,NF=jo,CF=AF.TypeError,nm=function(r,t){var e=r.exec;if(OF(e)){var n=rm(e,r,t);return n!==null&&TF(n),n}if(wF(r)==="RegExp")return rm(NF,r,t);throw CF("RegExp#exec called on incompatible receiver")},_F=Po,Mi=rt,zc=Q,IF=Jy,MF=Ef,kF=Qe,am=nr,FF=bF,PF=tm,$F=aa,Yc=ft,DF=ni,im=mf,om=nm,LF=jo,UF=jf,xF=re,da=UF.UNSUPPORTED_Y,um=4294967295,BF=Math.min,sm=[].push,VF=zc(/./.exec),va=zc(sm),ki=zc("".slice),GF=!xF(function(){var r=/(?:)/,t=r.exec;r.exec=function(){return t.apply(this,arguments)};var e="ab".split(r);return e.length!==2||e[0]!=="a"||e[1]!=="b"});IF("split",function(r,t,e){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(a,i){var o=Yc(am(this)),u=i===void 0?um:i>>>0;if(u===0)return[];if(a===void 0)return[o];if(!MF(a))return Mi(t,o,a,u);for(var s=[],l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(a.sticky?"y":""),f=0,c=new RegExp(a.source,l+"g"),h,p,y;(h=Mi(LF,c,o))&&(p=c.lastIndex,!(p>f&&(va(s,ki(o,f,h.index)),h.length>1&&h.index<o.length&&_F(sm,s,im(h,1)),y=h[0].length,f=p,s.length>=u)));)c.lastIndex===h.index&&c.lastIndex++;return f===o.length?(y||!VF(c,""))&&va(s,""):va(s,ki(o,f)),s.length>u?im(s,0,u):s}:"0".split(void 0,0).length?n=function(a,i){return a===void 0&&i===0?[]:Mi(t,this,a,i)}:n=t,[function(i,o){var u=am(this),s=i==null?void 0:DF(i,r);return s?Mi(s,i,u,o):Mi(n,Yc(u),i,o)},function(a,i){var o=kF(this),u=Yc(a),s=e(n,o,u,i,n!==t);if(s.done)return s.value;var l=FF(o,RegExp),f=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(da?"g":"y"),h=new l(da?"^(?:"+o.source+")":o,c),p=i===void 0?um:i>>>0;if(p===0)return[];if(u.length===0)return om(h,u)===null?[u]:[];for(var y=0,v=0,R=[];v<u.length;){h.lastIndex=da?0:v;var g=om(h,da?ki(u,v):u),A;if(g===null||(A=BF($F(h.lastIndex+(da?v:0)),u.length))===y)v=PF(u,v,f);else{if(va(R,ki(u,y,v)),R.length===p)return R;for(var T=1;T<=g.length-1;T++)if(va(R,g[T]),R.length===p)return R;v=y=A}}return va(R,ki(u,y)),R}]},!GF,da);var jF=H,HF=ea,WF=At,zF=Za,YF=or,KF=jF.TypeError,lm=function(r){return function(t,e,n,a){HF(e);var i=WF(t),o=zF(i),u=YF(i),s=r?u-1:0,l=r?-1:1;if(n<2)for(;;){if(s in o){a=o[s],s+=l;break}if(s+=l,r?s<0:u<=s)throw KF("Reduce of empty array with no initial value")}for(;r?s>=0:u>s;s+=l)s in o&&(a=e(a,o[s],s,i));return a}},XF={left:lm(!1),right:lm(!0)},qF=Qr,QF=H,ZF=qF(QF.process)=="process",JF=z,eP=XF.left,tP=eu,fm=ei,rP=ZF,nP=tP("reduce"),aP=!rP&&fm>79&&fm<83;JF({target:"Array",proto:!0,forced:!nP||aP},{reduce:function(t){var e=arguments.length;return eP(this,t,e,e>1?arguments[1]:void 0)}});var Kc=Q,iP=At,oP=Math.floor,Xc=Kc("".charAt),uP=Kc("".replace),qc=Kc("".slice),sP=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,lP=/\$([$&'`]|\d{1,2})/g,fP=function(r,t,e,n,a,i){var o=e+r.length,u=n.length,s=lP;return a!==void 0&&(a=iP(a),s=sP),uP(i,s,function(l,f){var c;switch(Xc(f,0)){case"$":return"$";case"&":return r;case"`":return qc(t,0,e);case"'":return qc(t,o);case"<":c=a[qc(f,1,-1)];break;default:var h=+f;if(h===0)return l;if(h>u){var p=oP(h/10);return p===0?l:p<=u?n[p-1]===void 0?Xc(f,1):n[p-1]+Xc(f,1):l}c=n[h-1]}return c===void 0?"":c})},cP=Po,cm=rt,lu=Q,hP=Jy,pP=re,dP=Qe,vP=xe,yP=Cn,mP=aa,ya=ft,gP=nr,EP=tm,RP=ni,bP=fP,SP=nm,AP=Ne,Qc=AP("replace"),TP=Math.max,OP=Math.min,wP=lu([].concat),Zc=lu([].push),hm=lu("".indexOf),pm=lu("".slice),NP=function(r){return r===void 0?r:String(r)},CP=function(){return"a".replace(/./,"$0")==="$0"}(),dm=function(){return/./[Qc]?/./[Qc]("a","$0")==="":!1}(),_P=!pP(function(){var r=/./;return r.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(r,"$<a>")!=="7"});hP("replace",function(r,t,e){var n=dm?"$":"$0";return[function(i,o){var u=gP(this),s=i==null?void 0:RP(i,Qc);return s?cm(s,i,u,o):cm(t,ya(u),i,o)},function(a,i){var o=dP(this),u=ya(a);if(typeof i=="string"&&hm(i,n)===-1&&hm(i,"$<")===-1){var s=e(t,o,u,i);if(s.done)return s.value}var l=vP(i);l||(i=ya(i));var f=o.global;if(f){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var p=SP(o,u);if(p===null||(Zc(h,p),!f))break;var y=ya(p[0]);y===""&&(o.lastIndex=EP(u,mP(o.lastIndex),c))}for(var v="",R=0,g=0;g<h.length;g++){p=h[g];for(var A=ya(p[0]),T=TP(OP(yP(p.index),u.length),0),N=[],M=1;M<p.length;M++)Zc(N,NP(p[M]));var _=p.groups;if(l){var $=wP([A],N,T,u);_!==void 0&&Zc($,_);var x=ya(cP(i,void 0,$))}else x=bP(A,u,T,N,_,i);T>=R&&(v+=pm(u,R,T)+x,R=T+A.length)}return v+pm(u,R)}]},!_P||!CP||dm);function IP(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function vm(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function MP(r,t,e){return t&&vm(r.prototype,t),e&&vm(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var $e;(function(r){r.RELATIVE="RELATIVE",r.ABSOLUTE="ABSOLUTE"})($e||($e={}));var Dn=function(){function r(t,e,n){IP(this,r),this.type=t,this.col=e,this.sheet=n}return MP(r,[{key:"isColumnAbsolute",value:function(){return this.type===$e.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===$e.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===$e.ABSOLUTE&&this.sheet!==void 0}},{key:"moved",value:function(e,n,a){var i=this.sheet===void 0?void 0:e;return new r(this.type,this.col+n,i)}},{key:"shiftedByColumns",value:function(e){return new r(this.type,this.col+e,this.sheet)}},{key:"toSimpleColumnAddress",value:function(e){var n=hr(this,e),a=this.col;return this.isColumnRelative()&&(a=e.col+this.col),i4(n,a)}},{key:"shiftRelativeDimensions",value:function(e,n){var a=this.isColumnRelative()?this.col+e:this.col;return new r(this.type,a,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,n){var a=this.isColumnAbsolute()?this.col+e:this.col;return new r(this.type,a,this.sheet)}},{key:"withSheet",value:function(e){return new r(this.type,this.col,e)}},{key:"isInvalid",value:function(e){return this.toSimpleColumnAddress(e).col<0}},{key:"hash",value:function(e){var n=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case $e.RELATIVE:return"".concat(n,"#COLR").concat(this.col);case $e.ABSOLUTE:return"".concat(n,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var n=this.toSimpleColumnAddress(e);if(!KG(n)){var a=kh(n.col),i=this.type===$e.ABSOLUTE?"$":"";return"".concat(i).concat(a)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}],[{key:"absolute",value:function(e,n){return new r($e.ABSOLUTE,e,n)}},{key:"relative",value:function(e,n){return new r($e.RELATIVE,e,n)}},{key:"compareByAbsoluteAddress",value:function(e){return function(n,a){return n.toSimpleColumnAddress(e).col-a.toSimpleColumnAddress(e).col}}}]),r}();function kP(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function ym(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function FP(r,t,e){return t&&ym(r.prototype,t),e&&ym(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var on=function(){function r(t,e,n){kP(this,r),this.type=t,this.row=e,this.sheet=n}return FP(r,[{key:"isRowAbsolute",value:function(){return this.type===$e.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===$e.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===$e.ABSOLUTE&&this.sheet!==void 0}},{key:"moved",value:function(e,n,a){var i=this.sheet===void 0?void 0:e;return new r(this.type,this.row+a,i)}},{key:"shiftedByRows",value:function(e){return new r(this.type,this.row+e,this.sheet)}},{key:"toSimpleRowAddress",value:function(e){var n=hr(this,e),a=this.row;return this.isRowRelative()&&(a=e.row+this.row),a4(n,a)}},{key:"shiftRelativeDimensions",value:function(e,n){var a=this.isRowRelative()?this.row+n:this.row;return new r(this.type,a,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,n){var a=this.isRowAbsolute()?this.row+n:this.row;return new r(this.type,a,this.sheet)}},{key:"withSheet",value:function(e){return new r(this.type,this.row,e)}},{key:"isInvalid",value:function(e){return this.toSimpleRowAddress(e).row<0}},{key:"hash",value:function(e){var n=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case $e.RELATIVE:return"".concat(n,"#ROWR").concat(this.row);case $e.ABSOLUTE:return"".concat(n,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var n=this.toSimpleRowAddress(e);if(!YG(n)){var a=this.type===$e.ABSOLUTE?"$":"";return"".concat(a).concat(n.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}],[{key:"absolute",value:function(e,n){return new r($e.ABSOLUTE,e,n)}},{key:"relative",value:function(e,n){return new r($e.RELATIVE,e,n)}},{key:"compareByAbsoluteAddress",value:function(e){return function(n,a){return n.toSimpleRowAddress(e).row-a.toSimpleRowAddress(e).row}}}]),r}();function PP(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function mm(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function $P(r,t,e){return t&&mm(r.prototype,t),e&&mm(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var be;(function(r){r.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",r.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",r.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",r.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(be||(be={}));var Ut=function(){function r(t,e,n,a){PP(this,r),this.col=t,this.row=e,this.type=n,this.sheet=a}return $P(r,[{key:"toSimpleCellAddress",value:function(e){var n=hr(this,e);return this.type===be.CELL_REFERENCE_ABSOLUTE?P(n,this.col,this.row):this.type===be.CELL_REFERENCE_ABSOLUTE_ROW?P(n,e.col+this.col,this.row):this.type===be.CELL_REFERENCE_ABSOLUTE_COL?P(n,this.col,e.row+this.row):P(n,e.col+this.col,e.row+this.row)}},{key:"toColumnAddress",value:function(){var e=this.isColumnRelative()?$e.RELATIVE:$e.ABSOLUTE;return new Dn(e,this.col,this.sheet)}},{key:"toRowAddress",value:function(){var e=this.isRowRelative()?$e.RELATIVE:$e.ABSOLUTE;return new on(e,this.row,this.sheet)}},{key:"toSimpleColumnAddress",value:function(e){var n=hr(this,e),a=this.col;return this.isColumnRelative()&&(a+=e.col),i4(n,a)}},{key:"toSimpleRowAddress",value:function(e){var n=hr(this,e),a=this.row;return this.isRowRelative()&&(a+=e.row),a4(n,a)}},{key:"isRowAbsolute",value:function(){return this.type===be.CELL_REFERENCE_ABSOLUTE||this.type===be.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===be.CELL_REFERENCE_ABSOLUTE||this.type===be.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===be.CELL_REFERENCE_RELATIVE||this.type===be.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===be.CELL_REFERENCE_RELATIVE||this.type===be.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===be.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}},{key:"shiftedByRows",value:function(e){return new r(this.col,this.row+e,this.type,this.sheet)}},{key:"shiftedByColumns",value:function(e){return new r(this.col+e,this.row,this.type,this.sheet)}},{key:"moved",value:function(e,n,a){var i=this.sheet===void 0?void 0:e;return new r(this.col+n,this.row+a,this.type,i)}},{key:"withSheet",value:function(e){return new r(this.col,this.row,this.type,e)}},{key:"isInvalid",value:function(e){return Ft(this.toSimpleCellAddress(e))}},{key:"shiftRelativeDimensions",value:function(e,n){var a=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+n;return new r(a,i,this.type,this.sheet)}},{key:"shiftAbsoluteDimensions",value:function(e,n){var a=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+n;return new r(a,i,this.type,this.sheet)}},{key:"hash",value:function(e){var n=e&&this.sheet!==void 0?"#".concat(this.sheet):"";switch(this.type){case be.CELL_REFERENCE_RELATIVE:return"".concat(n,"#").concat(this.row,"R").concat(this.col);case be.CELL_REFERENCE_ABSOLUTE:return"".concat(n,"#").concat(this.row,"A").concat(this.col);case be.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(n,"#").concat(this.row,"AC").concat(this.col);case be.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(n,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var n=this.toSimpleCellAddress(e);if(!Ft(n)){var a=kh(n.col),i=this.type===be.CELL_REFERENCE_ABSOLUTE||this.type===be.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",o=this.type===be.CELL_REFERENCE_ABSOLUTE||this.type===be.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(o).concat(a).concat(i).concat(n.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e,n){return this.row>=n||this.col>=e}}],[{key:"fromColAndRow",value:function(e,n,a){var i=e.isColumnAbsolute()&&n.isRowAbsolute()?r.absolute.bind(this):e.isColumnAbsolute()?r.absoluteCol.bind(this):n.isRowAbsolute()?r.absoluteRow.bind(this):function(o,u,s){return r.relative(u,o,s)};return i(e.col,n.row,a)}},{key:"relative",value:function(e,n,a){return new r(n,e,be.CELL_REFERENCE_RELATIVE,a)}},{key:"absolute",value:function(e,n,a){return new r(e,n,be.CELL_REFERENCE_ABSOLUTE,a)}},{key:"absoluteCol",value:function(e,n,a){return new r(e,n,be.CELL_REFERENCE_ABSOLUTE_COL,a)}},{key:"absoluteRow",value:function(e,n,a){return new r(e,n,be.CELL_REFERENCE_ABSOLUTE_ROW,a)}}]),r}();function Te(r){return r&&r.length===0}function $r(r){return r==null?[]:Object.keys(r)}function mt(r){for(var t=[],e=Object.keys(r),n=0;n<e.length;n++)t.push(r[e[n]]);return t}function DP(r,t){for(var e=[],n=$r(r),a=0;a<n.length;a++){var i=n[a];e.push(t.call(null,r[i],i))}return e}function L(r,t){for(var e=[],n=0;n<r.length;n++)e.push(t.call(null,r[n],n));return e}function Ot(r){for(var t=[],e=0;e<r.length;e++){var n=r[e];Array.isArray(n)?t=t.concat(Ot(n)):t.push(n)}return t}function Wt(r){return Te(r)?void 0:r[0]}function gm(r){var t=r&&r.length;return t?r[t-1]:void 0}function G(r,t){if(Array.isArray(r))for(var e=0;e<r.length;e++)t.call(null,r[e],e);else if(eh(r))for(var n=$r(r),e=0;e<n.length;e++){var a=n[e],i=r[a];t.call(null,i,a)}else throw Error("non exhaustive match")}function mr(r){return typeof r=="string"}function zt(r){return r===void 0}function un(r){return r instanceof Function}function ct(r,t){return t===void 0&&(t=1),r.slice(t,r.length)}function Fi(r,t){return t===void 0&&(t=1),r.slice(0,r.length-t)}function ur(r,t){var e=[];if(Array.isArray(r))for(var n=0;n<r.length;n++){var a=r[n];t.call(null,a)&&e.push(a)}return e}function Ln(r,t){return ur(r,function(e){return!t(e)})}function Yt(r,t){for(var e=Object.keys(r),n={},a=0;a<e.length;a++){var i=e[a],o=r[i];t(o)&&(n[i]=o)}return n}function j(r,t){return eh(r)?r.hasOwnProperty(t):!1}function Ze(r,t){return ma(r,function(e){return e===t})!==void 0}function wt(r){for(var t=[],e=0;e<r.length;e++)t.push(r[e]);return t}function Pi(r){var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t}function ma(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(t.call(null,n))return n}}function LP(r,t){for(var e=[],n=0;n<r.length;n++){var a=r[n];t.call(null,a)&&e.push(a)}return e}function ht(r,t,e){for(var n=Array.isArray(r),a=n?r:mt(r),i=n?[]:$r(r),o=e,u=0;u<a.length;u++)o=t.call(null,o,a[u],n?u:i[u]);return o}function $i(r){return Ln(r,function(t){return t==null})}function Jc(r,t){t===void 0&&(t=function(n){return n});var e=[];return ht(r,function(n,a){var i=t(a);return Ze(e,i)?n:(e.push(i),n.concat(a))},[])}function sr(r){return Array.isArray(r)}function Dr(r){return r instanceof RegExp}function eh(r){return r instanceof Object}function Kt(r,t){for(var e=0;e<r.length;e++)if(!t(r[e],e))return!1;return!0}function fu(r,t){return Ln(r,function(e){return Ze(t,e)})}function Em(r,t){for(var e=0;e<r.length;e++)if(t(r[e]))return!0;return!1}function UP(r,t){for(var e=0;e<r.length;e++)if(r[e]===t)return e;return-1}function lr(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n++)for(var a=t[n],i=$r(a),o=0;o<i.length;o++){var u=i[o];r[u]=a[u]}return r}function xP(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n++){var a=t[n];if(!zt(a))for(var i=$r(a),o=0;o<i.length;o++){var u=i[o];j(r,u)||(r[u]=a[u])}}return r}function cu(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return xP.apply(null,[{}].concat(r))}function Rm(r,t){var e={};return G(r,function(n){var a=t(n),i=e[a];i?i.push(n):e[a]=[n]}),e}function bm(r,t){for(var e=Pi(r),n=$r(t),a=0;a<n.length;a++){var i=n[a],o=t[i];e[i]=o}return e}function at(){}function Sm(r){return r}function BP(r){for(var t=[],e=0;e<r.length;e++){var n=r[e];t.push(n!==void 0?n:void 0)}return t}function th(r){console&&console.error&&console.error("Error: "+r)}function rh(r){console&&console.warn&&console.warn("Warning: "+r)}function Am(){return typeof Map=="function"}function VP(r,t){t.forEach(function(e){var n=e.prototype;Object.getOwnPropertyNames(n).forEach(function(a){if(a!=="constructor"){var i=Object.getOwnPropertyDescriptor(n,a);i&&(i.get||i.set)?Object.defineProperty(r.prototype,a,i):r.prototype[a]=e.prototype[a]}})})}function Tm(r){function t(){}t.prototype=r;var e=new t;function n(){return typeof e.bar}return n(),n(),r}function hu(r){return r[r.length-1]}function Om(r){var t=new Date().getTime(),e=r(),n=new Date().getTime(),a=n-t;return{time:a,value:e}}var ga={exports:{}};(function(r){(function(t,e){r.exports?r.exports=e():t.regexpToAst=e()})(typeof self!="undefined"?self:Gl,function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(v){this.idx=v.idx,this.input=v.input,this.groupIdx=v.groupIdx},t.prototype.pattern=function(v){this.idx=0,this.input=v,this.groupIdx=0,this.consumeChar("/");var R=this.disjunction();this.consumeChar("/");for(var g={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":u(g,"global");break;case"i":u(g,"ignoreCase");break;case"m":u(g,"multiLine");break;case"u":u(g,"unicode");break;case"y":u(g,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:g,value:R}},t.prototype.disjunction=function(){var v=[];for(v.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),v.push(this.alternative());return{type:"Disjunction",value:v}},t.prototype.alternative=function(){for(var v=[];this.isTerm();)v.push(this.term());return{type:"Alternative",value:v}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var v;switch(this.popChar()){case"=":v="Lookahead";break;case"!":v="NegativeLookahead";break}s(v);var R=this.disjunction();return this.consumeChar(")"),{type:v,value:R}}l()},t.prototype.quantifier=function(v){var R;switch(this.popChar()){case"*":R={atLeast:0,atMost:1/0};break;case"+":R={atLeast:1,atMost:1/0};break;case"?":R={atLeast:0,atMost:1};break;case"{":var g=this.integerIncludingZero();switch(this.popChar()){case"}":R={atLeast:g,atMost:g};break;case",":var A;this.isDigit()?(A=this.integerIncludingZero(),R={atLeast:g,atMost:A}):R={atLeast:g,atMost:1/0},this.consumeChar("}");break}if(v===!0&&R===void 0)return;s(R);break}if(!(v===!0&&R===void 0))return s(R),this.peekChar(0)==="?"?(this.consumeChar("?"),R.greedy=!1):R.greedy=!0,R.type="Quantifier",R},t.prototype.atom=function(){var v;switch(this.peekChar()){case".":v=this.dotAll();break;case"\\":v=this.atomEscape();break;case"[":v=this.characterClass();break;case"(":v=this.group();break}return v===void 0&&this.isPatternCharacter()&&(v=this.patternCharacter()),s(v),this.isQuantifier()&&(v.quantifier=this.quantifier()),v},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var v=this.positiveInteger();return{type:"GroupBackReference",value:v}},t.prototype.characterClassEscape=function(){var v,R=!1;switch(this.popChar()){case"d":v=c;break;case"D":v=c,R=!0;break;case"s":v=p;break;case"S":v=p,R=!0;break;case"w":v=h;break;case"W":v=h,R=!0;break}return s(v),{type:"Set",value:v,complement:R}},t.prototype.controlEscapeAtom=function(){var v;switch(this.popChar()){case"f":v=i("\f");break;case"n":v=i(`
`);break;case"r":v=i("\r");break;case"t":v=i("	");break;case"v":v=i("\v");break}return s(v),{type:"Character",value:v}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var v=this.popChar();if(/[a-zA-Z]/.test(v)===!1)throw Error("Invalid ");var R=v.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:R}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var v=this.popChar();return{type:"Character",value:i(v)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var v=this.popChar();return{type:"Character",value:i(v)}}},t.prototype.characterClass=function(){var v=[],R=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),R=!0);this.isClassAtom();){var g=this.classAtom(),A=g.type==="Character";if(A&&this.isRangeDash()){this.consumeChar("-");var T=this.classAtom(),N=T.type==="Character";if(N){if(T.value<g.value)throw Error("Range out of order in character class");v.push({from:g.value,to:T.value})}else o(g.value,v),v.push(i("-")),o(T.value,v)}else o(g.value,v)}return this.consumeChar("]"),{type:"Set",complement:R,value:v}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var v=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),v=!1;break;default:this.groupIdx++;break}var R=this.disjunction();this.consumeChar(")");var g={type:"Group",capturing:v,value:R};return v&&(g.idx=this.groupIdx),g},t.prototype.positiveInteger=function(){var v=this.popChar();if(a.test(v)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},t.prototype.integerIncludingZero=function(){var v=this.popChar();if(n.test(v)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},t.prototype.patternCharacter=function(){var v=this.popChar();switch(v){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(v)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(v){switch(v===void 0&&(v=0),this.peekChar(v)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},t.prototype.isQuantifier=function(){var v=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(v)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(v){for(var R="",g=0;g<v;g++){var A=this.popChar();if(e.test(A)===!1)throw Error("Expecting a HexDecimal digits");R+=A}var T=parseInt(R,16);return{type:"Character",value:T}},t.prototype.peekChar=function(v){return v===void 0&&(v=0),this.input[this.idx+v]},t.prototype.popChar=function(){var v=this.peekChar(0);return this.consumeChar(),v},t.prototype.consumeChar=function(v){if(v!==void 0&&this.input[this.idx]!==v)throw Error("Expected: '"+v+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var e=/[0-9a-fA-F]/,n=/[0-9]/,a=/[1-9]/;function i(v){return v.charCodeAt(0)}function o(v,R){v.length!==void 0?v.forEach(function(g){R.push(g)}):R.push(v)}function u(v,R){if(v[R]===!0)throw"duplicate flag "+R;v[R]=!0}function s(v){if(v===void 0)throw Error("Internal Error - Should never get here!")}function l(){throw Error("Internal Error - Should never get here!")}var f,c=[];for(f=i("0");f<=i("9");f++)c.push(f);var h=[i("_")].concat(c);for(f=i("a");f<=i("z");f++)h.push(f);for(f=i("A");f<=i("Z");f++)h.push(f);var p=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i("\xA0"),i("\u1680"),i("\u2000"),i("\u2001"),i("\u2002"),i("\u2003"),i("\u2004"),i("\u2005"),i("\u2006"),i("\u2007"),i("\u2008"),i("\u2009"),i("\u200A"),i("\u2028"),i("\u2029"),i("\u202F"),i("\u205F"),i("\u3000"),i("\uFEFF")];function y(){}return y.prototype.visitChildren=function(v){for(var R in v){var g=v[R];v.hasOwnProperty(R)&&(g.type!==void 0?this.visit(g):Array.isArray(g)&&g.forEach(function(A){this.visit(A)},this))}},y.prototype.visit=function(v){switch(v.type){case"Pattern":this.visitPattern(v);break;case"Flags":this.visitFlags(v);break;case"Disjunction":this.visitDisjunction(v);break;case"Alternative":this.visitAlternative(v);break;case"StartAnchor":this.visitStartAnchor(v);break;case"EndAnchor":this.visitEndAnchor(v);break;case"WordBoundary":this.visitWordBoundary(v);break;case"NonWordBoundary":this.visitNonWordBoundary(v);break;case"Lookahead":this.visitLookahead(v);break;case"NegativeLookahead":this.visitNegativeLookahead(v);break;case"Character":this.visitCharacter(v);break;case"Set":this.visitSet(v);break;case"Group":this.visitGroup(v);break;case"GroupBackReference":this.visitGroupBackReference(v);break;case"Quantifier":this.visitQuantifier(v);break}this.visitChildren(v)},y.prototype.visitPattern=function(v){},y.prototype.visitFlags=function(v){},y.prototype.visitDisjunction=function(v){},y.prototype.visitAlternative=function(v){},y.prototype.visitStartAnchor=function(v){},y.prototype.visitEndAnchor=function(v){},y.prototype.visitWordBoundary=function(v){},y.prototype.visitNonWordBoundary=function(v){},y.prototype.visitLookahead=function(v){},y.prototype.visitNegativeLookahead=function(v){},y.prototype.visitCharacter=function(v){},y.prototype.visitSet=function(v){},y.prototype.visitGroup=function(v){},y.prototype.visitGroupBackReference=function(v){},y.prototype.visitQuantifier=function(v){},{RegExpParser:t,BaseRegExpVisitor:y,VERSION:"0.4.0"}})})(ga);var pu={},GP=new ga.exports.RegExpParser;function du(r){var t=r.toString();if(pu.hasOwnProperty(t))return pu[t];var e=GP.pattern(t);return pu[t]=e,e}function jP(){pu={}}var HP=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wm="Complement Sets are not supported for first char optimization",vu=`Unable to use "first char" lexer optimizations:
`;function WP(r,t){t===void 0&&(t=!1);try{var e=du(r),n=nh(e.value,{},e.flags.ignoreCase);return n}catch(i){if(i.message===wm)t&&rh(""+vu+("	Unable to optimize: < "+r.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var a="";t&&(a=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),th(vu+`
`+("	Failed parsing: < "+r.toString()+` >
`)+("	Using the regexp-to-ast library version: "+ga.exports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+a)}}return[]}function nh(r,t,e){switch(r.type){case"Disjunction":for(var n=0;n<r.value.length;n++)nh(r.value[n],t,e);break;case"Alternative":for(var a=r.value,n=0;n<a.length;n++){var i=a[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=i;switch(o.type){case"Character":yu(o.value,t,e);break;case"Set":if(o.complement===!0)throw Error(wm);G(o.value,function(l){if(typeof l=="number")yu(l,t,e);else{var f=l;if(e===!0)for(var c=f.from;c<=f.to;c++)yu(c,t,e);else{for(var c=f.from;c<=f.to&&c<Di;c++)yu(c,t,e);if(f.to>=Di)for(var h=f.from>=Di?f.from:Di,p=f.to,y=sn(h),v=sn(p),R=y;R<=v;R++)t[R]=R}}});break;case"Group":nh(o.value,t,e);break;default:throw Error("Non Exhaustive Match")}var u=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&ah(o)===!1||o.type!=="Group"&&u===!1)break}break;default:throw Error("non exhaustive match!")}return mt(t)}function yu(r,t,e){var n=sn(r);t[n]=n,e===!0&&zP(r,t)}function zP(r,t){var e=String.fromCharCode(r),n=e.toUpperCase();if(n!==e){var a=sn(n.charCodeAt(0));t[a]=a}else{var i=e.toLowerCase();if(i!==e){var a=sn(i.charCodeAt(0));t[a]=a}}}function Nm(r,t){return ma(r.value,function(e){if(typeof e=="number")return Ze(t,e);var n=e;return ma(t,function(a){return n.from<=a&&a<=n.to})!==void 0})}function ah(r){return r.quantifier&&r.quantifier.atLeast===0?!0:r.value?sr(r.value)?Kt(r.value,ah):ah(r.value):!1}var YP=function(r){HP(t,r);function t(e){var n=r.call(this)||this;return n.targetCharCodes=e,n.found=!1,n}return t.prototype.visitChildren=function(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}r.prototype.visitChildren.call(this,e)}},t.prototype.visitCharacter=function(e){Ze(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?Nm(e,this.targetCharCodes)===void 0&&(this.found=!0):Nm(e,this.targetCharCodes)!==void 0&&(this.found=!0)},t}(ga.exports.BaseRegExpVisitor);function ih(r,t){if(t instanceof RegExp){var e=du(t),n=new YP(r);return n.visit(e),n.found}else return ma(t,function(a){return Ze(r,a.charCodeAt(0))})!==void 0}var Cm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),gr="PATTERN",Un="defaultMode",mu="modes",_m=typeof new RegExp("(?:)").sticky=="boolean";function KP(r,t){t=cu(t,{useSticky:_m,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(A,T){return T()}});var e=t.tracer;e("initCharCodeToOptimizedIndexMap",function(){m$()});var n;e("Reject Lexer.NA",function(){n=Ln(r,function(A){return A[gr]===Nt.NA})});var a=!1,i;e("Transform Patterns",function(){a=!1,i=L(n,function(A){var T=A[gr];if(Dr(T)){var N=T.source;return N.length===1&&N!=="^"&&N!=="$"&&N!=="."?N:N.length===2&&N[0]==="\\"&&!Ze(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],N[1])?N[1]:t.useSticky?Mm(T):Im(T)}else{if(un(T))return a=!0,{exec:T};if(j(T,"exec"))return a=!0,T;if(typeof T=="string"){if(T.length===1)return T;var M=T.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),_=new RegExp(M);return t.useSticky?Mm(_):Im(_)}else throw Error("non exhaustive match")}})});var o,u,s,l,f;e("misc mapping",function(){o=L(n,function(A){return A.tokenTypeIdx}),u=L(n,function(A){var T=A.GROUP;if(T!==Nt.SKIPPED){if(mr(T))return T;if(zt(T))return!1;throw Error("non exhaustive match")}}),s=L(n,function(A){var T=A.LONGER_ALT;if(T){var N=UP(n,T);return N}}),l=L(n,function(A){return A.PUSH_MODE}),f=L(n,function(A){return j(A,"POP_MODE")})});var c;e("Line Terminator Handling",function(){var A=Pm(t.lineTerminatorCharacters);c=L(n,function(T){return!1}),t.positionTracking!=="onlyOffset"&&(c=L(n,function(T){if(j(T,"LINE_BREAKS"))return T.LINE_BREAKS;if(Fm(T,A)===!1)return ih(A,T.PATTERN)}))});var h,p,y,v;e("Misc Mapping #2",function(){h=L(n,km),p=L(i,d$),y=ht(n,function(A,T){var N=T.GROUP;return mr(N)&&N!==Nt.SKIPPED&&(A[N]=[]),A},{}),v=L(i,function(A,T){return{pattern:i[T],longerAlt:s[T],canLineTerminator:c[T],isCustom:h[T],short:p[T],group:u[T],push:l[T],pop:f[T],tokenTypeIdx:o[T],tokenType:n[T]}})});var R=!0,g=[];return t.safeMode||e("First Char Optimization",function(){g=ht(n,function(A,T,N){if(typeof T.PATTERN=="string"){var M=T.PATTERN.charCodeAt(0),_=sn(M);oh(A,_,v[N])}else if(sr(T.START_CHARS_HINT)){var $;G(T.START_CHARS_HINT,function(D){var K=typeof D=="string"?D.charCodeAt(0):D,Z=sn(K);$!==Z&&($=Z,oh(A,Z,v[N]))})}else if(Dr(T.PATTERN))if(T.PATTERN.unicode)R=!1,t.ensureOptimizations&&th(""+vu+("	Unable to analyze < "+T.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var x=WP(T.PATTERN,t.ensureOptimizations);Te(x)&&(R=!1),G(x,function(D){oh(A,D,v[N])})}else t.ensureOptimizations&&th(""+vu+("	TokenType: <"+T.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),R=!1;return A},[])}),e("ArrayPacking",function(){g=BP(g)}),{emptyGroups:y,patternIdxToConfig:v,charCodeToPatternIdxToConfig:g,hasCustom:a,canBeOptimized:R}}function XP(r,t){var e=[],n=QP(r);e=e.concat(n.errors);var a=ZP(n.valid),i=a.valid;return e=e.concat(a.errors),e=e.concat(qP(i)),e=e.concat(o$(i)),e=e.concat(u$(i,t)),e=e.concat(s$(i)),e}function qP(r){var t=[],e=ur(r,function(n){return Dr(n[gr])});return t=t.concat(e$(e)),t=t.concat(n$(e)),t=t.concat(a$(e)),t=t.concat(i$(e)),t=t.concat(t$(e)),t}function QP(r){var t=ur(r,function(a){return!j(a,gr)}),e=L(t,function(a){return{message:"Token Type: ->"+a.name+"<- missing static 'PATTERN' property",type:Ve.MISSING_PATTERN,tokenTypes:[a]}}),n=fu(r,t);return{errors:e,valid:n}}function ZP(r){var t=ur(r,function(a){var i=a[gr];return!Dr(i)&&!un(i)&&!j(i,"exec")&&!mr(i)}),e=L(t,function(a){return{message:"Token Type: ->"+a.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ve.INVALID_PATTERN,tokenTypes:[a]}}),n=fu(r,t);return{errors:e,valid:n}}var JP=/[^\\][\$]/;function e$(r){var t=function(a){Cm(i,a);function i(){var o=a!==null&&a.apply(this,arguments)||this;return o.found=!1,o}return i.prototype.visitEndAnchor=function(o){this.found=!0},i}(ga.exports.BaseRegExpVisitor),e=ur(r,function(a){var i=a[gr];try{var o=du(i),u=new t;return u.visit(o),u.found}catch{return JP.test(i.source)}}),n=L(e,function(a){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+a.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ve.EOI_ANCHOR_FOUND,tokenTypes:[a]}});return n}function t$(r){var t=ur(r,function(n){var a=n[gr];return a.test("")}),e=L(t,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:Ve.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return e}var r$=/[^\\[][\^]|^\^/;function n$(r){var t=function(a){Cm(i,a);function i(){var o=a!==null&&a.apply(this,arguments)||this;return o.found=!1,o}return i.prototype.visitStartAnchor=function(o){this.found=!0},i}(ga.exports.BaseRegExpVisitor),e=ur(r,function(a){var i=a[gr];try{var o=du(i),u=new t;return u.visit(o),u.found}catch{return r$.test(i.source)}}),n=L(e,function(a){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+a.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ve.SOI_ANCHOR_FOUND,tokenTypes:[a]}});return n}function a$(r){var t=ur(r,function(n){var a=n[gr];return a instanceof RegExp&&(a.multiline||a.global)}),e=L(t,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ve.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return e}function i$(r){var t=[],e=L(r,function(i){return ht(r,function(o,u){return i.PATTERN.source===u.PATTERN.source&&!Ze(t,u)&&u.PATTERN!==Nt.NA&&(t.push(u),o.push(u)),o},[])});e=$i(e);var n=ur(e,function(i){return i.length>1}),a=L(n,function(i){var o=L(i,function(s){return s.name}),u=Wt(i).PATTERN;return{message:"The same RegExp pattern ->"+u+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:Ve.DUPLICATE_PATTERNS_FOUND,tokenTypes:i}});return a}function o$(r){var t=ur(r,function(n){if(!j(n,"GROUP"))return!1;var a=n.GROUP;return a!==Nt.SKIPPED&&a!==Nt.NA&&!mr(a)}),e=L(t,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ve.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return e}function u$(r,t){var e=ur(r,function(a){return a.PUSH_MODE!==void 0&&!Ze(t,a.PUSH_MODE)}),n=L(e,function(a){var i="Token Type: ->"+a.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+a.PUSH_MODE+"<-which does not exist";return{message:i,type:Ve.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[a]}});return n}function s$(r){var t=[],e=ht(r,function(n,a,i){var o=a.PATTERN;return o===Nt.NA||(mr(o)?n.push({str:o,idx:i,tokenType:a}):Dr(o)&&f$(o)&&n.push({str:o.source,idx:i,tokenType:a})),n},[]);return G(r,function(n,a){G(e,function(i){var o=i.str,u=i.idx,s=i.tokenType;if(a<u&&l$(o,n.PATTERN)){var l="Token: ->"+s.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:l,type:Ve.UNREACHABLE_PATTERN,tokenTypes:[n,s]})}})}),t}function l$(r,t){if(Dr(t)){var e=t.exec(r);return e!==null&&e.index===0}else{if(un(t))return t(r,0,[],{});if(j(t,"exec"))return t.exec(r,0,[],{});if(typeof t=="string")return t===r;throw Error("non exhaustive match")}}function f$(r){var t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return ma(t,function(e){return r.source.indexOf(e)!==-1})===void 0}function Im(r){var t=r.ignoreCase?"i":"";return new RegExp("^(?:"+r.source+")",t)}function Mm(r){var t=r.ignoreCase?"iy":"y";return new RegExp(""+r.source,t)}function c$(r,t,e){var n=[];return j(r,Un)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Un+`> property in its definition
`,type:Ve.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),j(r,mu)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+mu+`> property in its definition
`,type:Ve.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),j(r,mu)&&j(r,Un)&&!j(r.modes,r.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Un+": <"+r.defaultMode+`>which does not exist
`,type:Ve.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),j(r,mu)&&G(r.modes,function(a,i){G(a,function(o,u){zt(o)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+i+"> at index: <"+u+`>
`),type:Ve.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function h$(r,t,e){var n=[],a=!1,i=$i(Ot(DP(r.modes,function(s){return s}))),o=Ln(i,function(s){return s[gr]===Nt.NA}),u=Pm(e);return t&&G(o,function(s){var l=Fm(s,u);if(l!==!1){var f=y$(s,l),c={message:f,type:l.issue,tokenType:s};n.push(c)}else j(s,"LINE_BREAKS")?s.LINE_BREAKS===!0&&(a=!0):ih(u,s.PATTERN)&&(a=!0)}),t&&!a&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Ve.NO_LINE_BREAKS_FLAGS}),n}function p$(r){var t={},e=$r(r);return G(e,function(n){var a=r[n];if(sr(a))t[n]=[];else throw Error("non exhaustive match")}),t}function km(r){var t=r.PATTERN;if(Dr(t))return!1;if(un(t))return!0;if(j(t,"exec"))return!0;if(mr(t))return!1;throw Error("non exhaustive match")}function d$(r){return mr(r)&&r.length===1?r.charCodeAt(0):!1}var v$={test:function(r){for(var t=r.length,e=this.lastIndex;e<t;e++){var n=r.charCodeAt(e);if(n===10)return this.lastIndex=e+1,!0;if(n===13)return r.charCodeAt(e+1)===10?this.lastIndex=e+2:this.lastIndex=e+1,!0}return!1},lastIndex:0};function Fm(r,t){if(j(r,"LINE_BREAKS"))return!1;if(Dr(r.PATTERN)){try{ih(t,r.PATTERN)}catch(e){return{issue:Ve.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}else{if(mr(r.PATTERN))return!1;if(km(r))return{issue:Ve.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function y$(r,t){if(t.issue===Ve.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+r.name+`> Token Type
`)+("	 Root cause: "+t.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===Ve.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+r.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function Pm(r){var t=L(r,function(e){return mr(e)&&e.length>0?e.charCodeAt(0):e});return t}function oh(r,t,e){r[t]===void 0?r[t]=[e]:r[t].push(e)}var Di=256;function sn(r){return r<Di?r:gu[r]}var gu=[];function m$(){if(Te(gu)){gu=new Array(65536);for(var r=0;r<65536;r++)gu[r]=r>255?255+~~(r/255):r}}function Eu(r,t){var e=r.tokenTypeIdx;return e===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[e]===!0}function Ru(r,t){return r.tokenTypeIdx===t.tokenTypeIdx}var $m=1,Dm={};function Li(r){var t=g$(r);E$(t),b$(t),R$(t),G(t,function(e){e.isParent=e.categoryMatches.length>0})}function g$(r){for(var t=wt(r),e=r,n=!0;n;){e=$i(Ot(L(e,function(i){return i.CATEGORIES})));var a=fu(e,t);t=t.concat(a),Te(a)?n=!1:e=a}return t}function E$(r){G(r,function(t){Um(t)||(Dm[$m]=t,t.tokenTypeIdx=$m++),xm(t)&&!sr(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),xm(t)||(t.CATEGORIES=[]),S$(t)||(t.categoryMatches=[]),A$(t)||(t.categoryMatchesMap={})})}function R$(r){G(r,function(t){t.categoryMatches=[],G(t.categoryMatchesMap,function(e,n){t.categoryMatches.push(Dm[n].tokenTypeIdx)})})}function b$(r){G(r,function(t){Lm([],t)})}function Lm(r,t){G(r,function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0}),G(t.CATEGORIES,function(e){var n=r.concat(t);Ze(n,e)||Lm(n,e)})}function Um(r){return j(r,"tokenTypeIdx")}function xm(r){return j(r,"CATEGORIES")}function S$(r){return j(r,"categoryMatches")}function A$(r){return j(r,"categoryMatchesMap")}function T$(r){return j(r,"tokenTypeIdx")}var O$={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->"+r.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(r,t,e,n,a){return"unexpected character: ->"+r.charAt(t)+"<- at offset: "+t+","+(" skipped "+e+" characters.")}},Ve;(function(r){r[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Ve||(Ve={}));var Ui={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:O$,traceInitPerf:!1,skipValidations:!1};Object.freeze(Ui);var Nt=function(){function r(t,e){var n=this;if(e===void 0&&(e=Ui),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof e=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=bm(Ui,e);var a=this.config.traceInitPerf;a===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof a=="number"&&(this.traceInitMaxIdent=a,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var i,o=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===Ui.lineTerminatorsPattern)n.config.lineTerminatorsPattern=v$;else if(n.config.lineTerminatorCharacters===Ui.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),sr(t)?(i={modes:{}},i.modes[Un]=wt(t),i[Un]=Un):(o=!1,i=Pi(t))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(c$(i,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(h$(i,n.trackStartLines,n.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},G(i.modes,function(f,c){i.modes[c]=Ln(f,function(h){return zt(h)})});var u=$r(i.modes);if(G(i.modes,function(f,c){n.TRACE_INIT("Mode: <"+c+"> processing",function(){if(n.modes.push(c),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(XP(f,u))}),Te(n.lexerDefinitionErrors)){Li(f);var h;n.TRACE_INIT("analyzeTokenTypes",function(){h=KP(f,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[c]=h.patternIdxToConfig,n.charCodeToPatternIdxToConfig[c]=h.charCodeToPatternIdxToConfig,n.emptyGroups=bm(n.emptyGroups,h.emptyGroups),n.hasCustom=h.hasCustom||n.hasCustom,n.canModeBeOptimized[c]=h.canBeOptimized}})}),n.defaultMode=i.defaultMode,!Te(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var s=L(n.lexerDefinitionErrors,function(f){return f.message}),l=s.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}G(n.lexerDefinitionWarning,function(f){rh(f.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(_m?(n.chopInput=Sm,n.match=n.matchWithTest):(n.updateLastIndex=at,n.match=n.matchWithExec),o&&(n.handleModes=at),n.trackStartLines===!1&&(n.computeNewColumn=Sm),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=at),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var f=ht(n.canModeBeOptimized,function(c,h,p){return h===!1&&c.push(p),c},[]);if(e.ensureOptimizations&&!Te(f))throw Error("Lexer Modes: < "+f.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){jP()}),n.TRACE_INIT("toFastProperties",function(){Tm(n)})})}return r.prototype.tokenize=function(t,e){if(e===void 0&&(e=this.defaultMode),!Te(this.lexerDefinitionErrors)){var n=L(this.lexerDefinitionErrors,function(o){return o.message}),a=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+a)}var i=this.tokenizeInternal(t,e);return i},r.prototype.tokenizeInternal=function(t,e){var n=this,a,i,o,u,s,l,f,c,h,p,y,v,R,g,A=t,T=A.length,N=0,M=0,_=this.hasCustom?0:Math.floor(t.length/10),$=new Array(_),x=[],D=this.trackStartLines?1:void 0,K=this.trackStartLines?1:void 0,Z=p$(this.emptyGroups),ie=this.trackStartLines,q=this.config.lineTerminatorsPattern,le=0,pe=[],Re=[],we=[],w=[];Object.freeze(w);var O=void 0;function C(){return pe}function k(Rt){var Ka=sn(Rt),Zn=Re[Ka];return Zn===void 0?w:Zn}var B=function(Rt){if(we.length===1&&Rt.tokenType.PUSH_MODE===void 0){var Ka=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Rt);x.push({offset:Rt.startOffset,line:Rt.startLine!==void 0?Rt.startLine:void 0,column:Rt.startColumn!==void 0?Rt.startColumn:void 0,length:Rt.image.length,message:Ka})}else{we.pop();var Zn=gm(we);pe=n.patternIdxToConfig[Zn],Re=n.charCodeToPatternIdxToConfig[Zn],le=pe.length;var IR=n.canModeBeOptimized[Zn]&&n.config.safeMode===!1;Re&&IR?O=k:O=C}};function ae(Rt){we.push(Rt),Re=this.charCodeToPatternIdxToConfig[Rt],pe=this.patternIdxToConfig[Rt],le=pe.length,le=pe.length;var Ka=this.canModeBeOptimized[Rt]&&this.config.safeMode===!1;Re&&Ka?O=k:O=C}ae.call(this,e);for(var J;N<T;){s=null;var Ae=A.charCodeAt(N),Ce=O(Ae),Je=Ce.length;for(a=0;a<Je;a++){J=Ce[a];var vt=J.pattern;l=null;var et=J.short;if(et!==!1?Ae===et&&(s=vt):J.isCustom===!0?(g=vt.exec(A,N,$,Z),g!==null?(s=g[0],g.payload!==void 0&&(l=g.payload)):s=null):(this.updateLastIndex(vt,N),s=this.match(vt,t,N)),s!==null){if(u=J.longerAlt,u!==void 0){var yt=pe[u],qn=yt.pattern;f=null,yt.isCustom===!0?(g=qn.exec(A,N,$,Z),g!==null?(o=g[0],g.payload!==void 0&&(f=g.payload)):o=null):(this.updateLastIndex(qn,N),o=this.match(qn,t,N)),o&&o.length>s.length&&(s=o,l=f,J=yt)}break}}if(s!==null){if(c=s.length,h=J.group,h!==void 0&&(p=J.tokenTypeIdx,y=this.createTokenInstance(s,N,p,J.tokenType,D,K,c),this.handlePayload(y,l),h===!1?M=this.addToken($,M,y):Z[h].push(y)),t=this.chopInput(t,c),N=N+c,K=this.computeNewColumn(K,c),ie===!0&&J.canLineTerminator===!0){var Qn=0,Sn=void 0,An=void 0;q.lastIndex=0;do Sn=q.test(s),Sn===!0&&(An=q.lastIndex-1,Qn++);while(Sn===!0);Qn!==0&&(D=D+Qn,K=c-An,this.updateTokenEndLineColumnLocation(y,h,An,Qn,D,K,c))}this.handleModes(J,B,ae,y)}else{for(var qr=N,za=D,Ya=K,_r=!1;!_r&&N<T;)for(A.charCodeAt(N),t=this.chopInput(t,1),N++,i=0;i<le;i++){var Vl=pe[i],vt=Vl.pattern,et=Vl.short;if(et!==!1?A.charCodeAt(N)===et&&(_r=!0):Vl.isCustom===!0?_r=vt.exec(A,N,$,Z)!==null:(this.updateLastIndex(vt,N),_r=vt.exec(t)!==null),_r===!0)break}v=N-qr,R=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(A,qr,v,za,Ya),x.push({offset:qr,line:za,column:Ya,length:v,message:R})}}return this.hasCustom||($.length=M),{tokens:$,groups:Z,errors:x}},r.prototype.handleModes=function(t,e,n,a){if(t.pop===!0){var i=t.push;e(a),i!==void 0&&n.call(this,i)}else t.push!==void 0&&n.call(this,t.push)},r.prototype.chopInput=function(t,e){return t.substring(e)},r.prototype.updateLastIndex=function(t,e){t.lastIndex=e},r.prototype.updateTokenEndLineColumnLocation=function(t,e,n,a,i,o,u){var s,l;e!==void 0&&(s=n===u-1,l=s?-1:0,a===1&&s===!0||(t.endLine=i+l,t.endColumn=o-1+-l))},r.prototype.computeNewColumn=function(t,e){return t+e},r.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},r.prototype.createOffsetOnlyToken=function(t,e,n,a){return{image:t,startOffset:e,tokenTypeIdx:n,tokenType:a}},r.prototype.createStartOnlyToken=function(t,e,n,a,i,o){return{image:t,startOffset:e,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:a}},r.prototype.createFullToken=function(t,e,n,a,i,o,u){return{image:t,startOffset:e,endOffset:e+u-1,startLine:i,endLine:i,startColumn:o,endColumn:o+u-1,tokenTypeIdx:n,tokenType:a}},r.prototype.addToken=function(t,e,n){return 666},r.prototype.addTokenUsingPush=function(t,e,n){return t.push(n),e},r.prototype.addTokenUsingMemberAccess=function(t,e,n){return t[e]=n,e++,e},r.prototype.handlePayload=function(t,e){},r.prototype.handlePayloadNoCustom=function(t,e){},r.prototype.handlePayloadWithCustom=function(t,e){e!==null&&(t.payload=e)},r.prototype.match=function(t,e,n){return null},r.prototype.matchWithTest=function(t,e,n){var a=t.test(e);return a===!0?e.substring(n,t.lastIndex):null},r.prototype.matchWithExec=function(t,e){var n=t.exec(e);return n!==null?n[0]:n},r.prototype.TRACE_INIT=function(t,e){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+t+">");var a=Om(e),i=a.time,o=a.value,u=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,o}else return e()},r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",r.NA=/NOT_APPLICABLE/,r}();function Ea(r){return Bm(r)?r.LABEL:r.name}function Bm(r){return mr(r.LABEL)&&r.LABEL!==""}var w$="parent",Vm="categories",Gm="label",jm="group",Hm="push_mode",Wm="pop_mode",zm="longer_alt",Ym="line_breaks",Km="start_chars_hint";function oe(r){return N$(r)}function N$(r){var t=r.pattern,e={};if(e.name=r.name,zt(t)||(e.PATTERN=t),j(r,w$))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return j(r,Vm)&&(e.CATEGORIES=r[Vm]),Li([e]),j(r,Gm)&&(e.LABEL=r[Gm]),j(r,jm)&&(e.GROUP=r[jm]),j(r,Wm)&&(e.POP_MODE=r[Wm]),j(r,Hm)&&(e.PUSH_MODE=r[Hm]),j(r,zm)&&(e.LONGER_ALT=r[zm]),j(r,Ym)&&(e.LINE_BREAKS=r[Ym]),j(r,Km)&&(e.START_CHARS_HINT=r[Km]),e}var xn=oe({name:"EOF",pattern:Nt.NA});Li([xn]);function uh(r,t,e,n,a,i,o,u){return{image:t,startOffset:e,endOffset:n,startLine:a,endLine:i,startColumn:o,endColumn:u,tokenTypeIdx:r.tokenTypeIdx,tokenType:r}}function Se(r,t){return Eu(r,t)}var Lr=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Er=function(){function r(t){this.definition=t}return r.prototype.accept=function(t){t.visit(this),G(this.definition,function(e){e.accept(t)})},r}(),xt=function(r){Lr(t,r);function t(e){var n=r.call(this,[])||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return Object.defineProperty(t.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(Er),Ra=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.orgText="",lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),Ct=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.ignoreAmbiguities=!1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),pt=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),Xt=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),qt=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),Ge=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),Bt=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),Vt=function(r){Lr(t,r);function t(e){var n=r.call(this,e.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,lr(n,Yt(e,function(a){return a!==void 0})),n}return t}(Er),ke=function(){function r(t){this.idx=1,lr(this,Yt(t,function(e){return e!==void 0}))}return r.prototype.accept=function(t){t.visit(this)},r}();function C$(r){return L(r,bu)}function bu(r){function t(a){return L(a,bu)}if(r instanceof xt)return{type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};if(r instanceof Ct)return{type:"Flat",definition:t(r.definition)};if(r instanceof pt)return{type:"Option",idx:r.idx,definition:t(r.definition)};if(r instanceof Xt)return{type:"RepetitionMandatory",name:r.name,idx:r.idx,definition:t(r.definition)};if(r instanceof qt)return{type:"RepetitionMandatoryWithSeparator",name:r.name,idx:r.idx,separator:bu(new ke({terminalType:r.separator})),definition:t(r.definition)};if(r instanceof Bt)return{type:"RepetitionWithSeparator",name:r.name,idx:r.idx,separator:bu(new ke({terminalType:r.separator})),definition:t(r.definition)};if(r instanceof Ge)return{type:"Repetition",name:r.name,idx:r.idx,definition:t(r.definition)};if(r instanceof Vt)return{type:"Alternation",name:r.name,idx:r.idx,definition:t(r.definition)};if(r instanceof ke){var e={type:"Terminal",name:r.terminalType.name,label:Ea(r.terminalType),idx:r.idx},n=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(e.pattern=Dr(n)?n.source:n),e}else{if(r instanceof Ra)return{type:"Rule",name:r.name,orgText:r.orgText,definition:t(r.definition)};throw Error("non exhaustive match")}}var Su=function(){function r(){}return r.prototype.walk=function(t,e){var n=this;e===void 0&&(e=[]),G(t.definition,function(a,i){var o=ct(t.definition,i+1);if(a instanceof xt)n.walkProdRef(a,o,e);else if(a instanceof ke)n.walkTerminal(a,o,e);else if(a instanceof Ct)n.walkFlat(a,o,e);else if(a instanceof pt)n.walkOption(a,o,e);else if(a instanceof Xt)n.walkAtLeastOne(a,o,e);else if(a instanceof qt)n.walkAtLeastOneSep(a,o,e);else if(a instanceof Bt)n.walkManySep(a,o,e);else if(a instanceof Ge)n.walkMany(a,o,e);else if(a instanceof Vt)n.walkOr(a,o,e);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(t,e,n){},r.prototype.walkProdRef=function(t,e,n){},r.prototype.walkFlat=function(t,e,n){var a=e.concat(n);this.walk(t,a)},r.prototype.walkOption=function(t,e,n){var a=e.concat(n);this.walk(t,a)},r.prototype.walkAtLeastOne=function(t,e,n){var a=[new pt({definition:t.definition})].concat(e,n);this.walk(t,a)},r.prototype.walkAtLeastOneSep=function(t,e,n){var a=Xm(t,e,n);this.walk(t,a)},r.prototype.walkMany=function(t,e,n){var a=[new pt({definition:t.definition})].concat(e,n);this.walk(t,a)},r.prototype.walkManySep=function(t,e,n){var a=Xm(t,e,n);this.walk(t,a)},r.prototype.walkOr=function(t,e,n){var a=this,i=e.concat(n);G(t.definition,function(o){var u=new Ct({definition:[o]});a.walk(u,i)})},r}();function Xm(r,t,e){var n=[new pt({definition:[new ke({terminalType:r.separator})].concat(r.definition)})],a=n.concat(t,e);return a}var Bn=function(){function r(){}return r.prototype.visit=function(t){var e=t;switch(e.constructor){case xt:return this.visitNonTerminal(e);case Ct:return this.visitFlat(e);case pt:return this.visitOption(e);case Xt:return this.visitRepetitionMandatory(e);case qt:return this.visitRepetitionMandatoryWithSeparator(e);case Bt:return this.visitRepetitionWithSeparator(e);case Ge:return this.visitRepetition(e);case Vt:return this.visitAlternation(e);case ke:return this.visitTerminal(e);case Ra:return this.visitRule(e);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(t){},r.prototype.visitFlat=function(t){},r.prototype.visitOption=function(t){},r.prototype.visitRepetition=function(t){},r.prototype.visitRepetitionMandatory=function(t){},r.prototype.visitRepetitionMandatoryWithSeparator=function(t){},r.prototype.visitRepetitionWithSeparator=function(t){},r.prototype.visitAlternation=function(t){},r.prototype.visitTerminal=function(t){},r.prototype.visitRule=function(t){},r}(),_$=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function I$(r){return r instanceof Ct||r instanceof pt||r instanceof Ge||r instanceof Xt||r instanceof qt||r instanceof Bt||r instanceof ke||r instanceof Ra}function Au(r,t){t===void 0&&(t=[]);var e=r instanceof pt||r instanceof Ge||r instanceof Bt;return e?!0:r instanceof Vt?Em(r.definition,function(n){return Au(n,t)}):r instanceof xt&&Ze(t,r)?!1:r instanceof Er?(r instanceof xt&&t.push(r),Kt(r.definition,function(n){return Au(n,t)})):!1}function M$(r){return r instanceof Vt}function fr(r){if(r instanceof xt)return"SUBRULE";if(r instanceof pt)return"OPTION";if(r instanceof Vt)return"OR";if(r instanceof Xt)return"AT_LEAST_ONE";if(r instanceof qt)return"AT_LEAST_ONE_SEP";if(r instanceof Bt)return"MANY_SEP";if(r instanceof Ge)return"MANY";if(r instanceof ke)return"CONSUME";throw Error("non exhaustive match")}var k$=function(r){_$(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var n=e.terminalType.name+this.separator+"Terminal";j(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(e)},t.prototype.visitNonTerminal=function(e){var n=e.nonTerminalName+this.separator+"Terminal";j(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(Bn),Tu=new k$;function F$(r){Tu.reset(),r.accept(Tu);var t=Tu.dslMethods;return Tu.reset(),t}function xi(r){if(r instanceof xt)return xi(r.referencedRule);if(r instanceof ke)return D$(r);if(I$(r))return P$(r);if(M$(r))return $$(r);throw Error("non exhaustive match")}function P$(r){for(var t=[],e=r.definition,n=0,a=e.length>n,i,o=!0;a&&o;)i=e[n],o=Au(i),t=t.concat(xi(i)),n=n+1,a=e.length>n;return Jc(t)}function $$(r){var t=L(r.definition,function(e){return xi(e)});return Jc(Ot(t))}function D$(r){return[r.terminalType]}var qm="_~IN~_",L$=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),U$=function(r){L$(t,r);function t(e){var n=r.call(this)||this;return n.topProd=e,n.follows={},n}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,n,a){},t.prototype.walkProdRef=function(e,n,a){var i=B$(e.referencedRule,e.idx)+this.topProd.name,o=n.concat(a),u=new Ct({definition:o}),s=xi(u);this.follows[i]=s},t}(Su);function x$(r){var t={};return G(r,function(e){var n=new U$(e).startWalking();lr(t,n)}),t}function B$(r,t){return r.name+t+qm}var V$=4,ln=8,G$=8,ba=1<<ln,Ou=2<<ln,Bi=3<<ln,Vi=4<<ln,Gi=5<<ln,Sa=6<<ln;function ji(r,t,e){return e|t|r}var j$=32-G$;function Qm(r,t,e,n){var a=n+1<<j$;return ji(r,t,e)|a}var H$=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function Zm(r,t){isNaN(r.startOffset)===!0?(r.startOffset=t.startOffset,r.endOffset=t.endOffset):r.endOffset<t.endOffset&&(r.endOffset=t.endOffset)}function Jm(r,t){isNaN(r.startOffset)===!0?(r.startOffset=t.startOffset,r.startColumn=t.startColumn,r.startLine=t.startLine,r.endOffset=t.endOffset,r.endColumn=t.endColumn,r.endLine=t.endLine):r.endOffset<t.endOffset&&(r.endOffset=t.endOffset,r.endColumn=t.endColumn,r.endLine=t.endLine)}function W$(r,t,e){r.children[e]===void 0?r.children[e]=[t]:r.children[e].push(t)}function e5(r,t,e){r.children[t]===void 0?r.children[t]=[e]:r.children[t].push(e)}var sh=function(r){H$(t,r);function t(e){var n=r.call(this)||this;return n.result=[],n.ruleIdx=e,n}return t.prototype.collectNamedDSLMethod=function(e,n,a){if(!zt(e.name)){var i=void 0;if(e instanceof pt||e instanceof Ge||e instanceof Xt||e instanceof Vt)i=new n({definition:e.definition,idx:e.idx});else if(e instanceof qt||e instanceof Bt)i=new n({definition:e.definition,idx:e.idx,separator:e.separator});else throw Error("non exhaustive match");var o=[i],u=ji(this.ruleIdx,a,e.idx);this.result.push({def:o,key:u,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,pt,Ou)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,Ge,Bi)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,Xt,Vi)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,qt,Sa)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,Bt,Gi)},t.prototype.visitAlternation=function(e){var n=this;this.collectNamedDSLMethod(e,Vt,ba);var a=e.definition.length>1;G(e.definition,function(i,o){if(!zt(i.name)){var u=i.definition;a?u=[new pt({definition:i.definition})]:u=i.definition;var s=Qm(n.ruleIdx,ba,e.idx,o);n.result.push({def:u,key:s,name:i.name,orgProd:i})}})},t}(Bn);function z$(r,t){var e={allRuleNames:[]};return G(r,function(n){var a=t[n.name];e.allRuleNames.push(n.name);var i=new sh(a);n.accept(i),G(i.result,function(o){o.def,o.key;var u=o.name;e.allRuleNames.push(n.name+u)})}),e}var Vn=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Y$=function(r){Vn(t,r);function t(e,n){var a=r.call(this)||this;return a.topProd=e,a.path=n,a.possibleTokTypes=[],a.nextProductionName="",a.nextProductionOccurrence=0,a.found=!1,a.isAtEndOfPath=!1,a}return t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=wt(this.path.ruleStack).reverse(),this.occurrenceStack=wt(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(e,n){n===void 0&&(n=[]),this.found||r.prototype.walk.call(this,e,n)},t.prototype.walkProdRef=function(e,n,a){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var i=n.concat(a);this.updateExpectedNext(),this.walk(e.referencedRule,i)}},t.prototype.updateExpectedNext=function(){Te(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(Su),K$=function(r){Vn(t,r);function t(e,n){var a=r.call(this,e,n)||this;return a.path=n,a.nextTerminalName="",a.nextTerminalOccurrence=0,a.nextTerminalName=a.path.lastTok.name,a.nextTerminalOccurrence=a.path.lastTokOccurrence,a}return t.prototype.walkTerminal=function(e,n,a){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var i=n.concat(a),o=new Ct({definition:i});this.possibleTokTypes=xi(o),this.found=!0}},t}(Y$),wu=function(r){Vn(t,r);function t(e,n){var a=r.call(this)||this;return a.topRule=e,a.occurrence=n,a.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},a}return t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(Su),X$=function(r){Vn(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.walkMany=function(e,n,a){if(e.idx===this.occurrence){var i=Wt(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof ke&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkMany.call(this,e,n,a)},t}(wu),t5=function(r){Vn(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.walkManySep=function(e,n,a){if(e.idx===this.occurrence){var i=Wt(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof ke&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkManySep.call(this,e,n,a)},t}(wu),q$=function(r){Vn(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.walkAtLeastOne=function(e,n,a){if(e.idx===this.occurrence){var i=Wt(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof ke&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkAtLeastOne.call(this,e,n,a)},t}(wu),r5=function(r){Vn(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.walkAtLeastOneSep=function(e,n,a){if(e.idx===this.occurrence){var i=Wt(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof ke&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkAtLeastOneSep.call(this,e,n,a)},t}(wu);function lh(r,t,e){e===void 0&&(e=[]),e=wt(e);var n=[],a=0;function i(l){return l.concat(ct(r,a+1))}function o(l){var f=lh(i(l),t,e);return n.concat(f)}for(;e.length<t&&a<r.length;){var u=r[a];if(u instanceof Ct)return o(u.definition);if(u instanceof xt)return o(u.definition);if(u instanceof pt)n=o(u.definition);else if(u instanceof Xt){var s=u.definition.concat([new Ge({definition:u.definition})]);return o(s)}else if(u instanceof qt){var s=[new Ct({definition:u.definition}),new Ge({definition:[new ke({terminalType:u.separator})].concat(u.definition)})];return o(s)}else if(u instanceof Bt){var s=u.definition.concat([new Ge({definition:[new ke({terminalType:u.separator})].concat(u.definition)})]);n=o(s)}else if(u instanceof Ge){var s=u.definition.concat([new Ge({definition:u.definition})]);n=o(s)}else{if(u instanceof Vt)return G(u.definition,function(l){n=o(l.definition)}),n;if(u instanceof ke)e.push(u.terminalType);else throw Error("non exhaustive match")}a++}return n.push({partialPath:e,suffixDef:ct(r,a)}),n}function n5(r,t,e,n){var a="EXIT_NONE_TERMINAL",i=[a],o="EXIT_ALTERNATIVE",u=!1,s=t.length,l=s-n-1,f=[],c=[];for(c.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!Te(c);){var h=c.pop();if(h===o){u&&gm(c).idx<=l&&c.pop();continue}var p=h.def,y=h.idx,v=h.ruleStack,R=h.occurrenceStack;if(!Te(p)){var g=p[0];if(g===a){var A={idx:y,def:ct(p),ruleStack:Fi(v),occurrenceStack:Fi(R)};c.push(A)}else if(g instanceof ke)if(y<s-1){var T=y+1,N=t[T];if(e(N,g.terminalType)){var A={idx:T,def:ct(p),ruleStack:v,occurrenceStack:R};c.push(A)}}else if(y===s-1)f.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:v,occurrenceStack:R}),u=!0;else throw Error("non exhaustive match");else if(g instanceof xt){var M=wt(v);M.push(g.nonTerminalName);var _=wt(R);_.push(g.idx);var A={idx:y,def:g.definition.concat(i,ct(p)),ruleStack:M,occurrenceStack:_};c.push(A)}else if(g instanceof pt){var $={idx:y,def:ct(p),ruleStack:v,occurrenceStack:R};c.push($),c.push(o);var x={idx:y,def:g.definition.concat(ct(p)),ruleStack:v,occurrenceStack:R};c.push(x)}else if(g instanceof Xt){var D=new Ge({definition:g.definition,idx:g.idx}),K=g.definition.concat([D],ct(p)),A={idx:y,def:K,ruleStack:v,occurrenceStack:R};c.push(A)}else if(g instanceof qt){var Z=new ke({terminalType:g.separator}),D=new Ge({definition:[Z].concat(g.definition),idx:g.idx}),K=g.definition.concat([D],ct(p)),A={idx:y,def:K,ruleStack:v,occurrenceStack:R};c.push(A)}else if(g instanceof Bt){var $={idx:y,def:ct(p),ruleStack:v,occurrenceStack:R};c.push($),c.push(o);var Z=new ke({terminalType:g.separator}),ie=new Ge({definition:[Z].concat(g.definition),idx:g.idx}),K=g.definition.concat([ie],ct(p)),x={idx:y,def:K,ruleStack:v,occurrenceStack:R};c.push(x)}else if(g instanceof Ge){var $={idx:y,def:ct(p),ruleStack:v,occurrenceStack:R};c.push($),c.push(o);var ie=new Ge({definition:g.definition,idx:g.idx}),K=g.definition.concat([ie],ct(p)),x={idx:y,def:K,ruleStack:v,occurrenceStack:R};c.push(x)}else if(g instanceof Vt)for(var q=g.definition.length-1;q>=0;q--){var le=g.definition[q],pe={idx:y,def:le.definition.concat(ct(p)),ruleStack:v,occurrenceStack:R};c.push(pe),c.push(o)}else if(g instanceof Ct)c.push({idx:y,def:g.definition.concat(ct(p)),ruleStack:v,occurrenceStack:R});else if(g instanceof Ra)c.push(Q$(g,y,v,R));else throw Error("non exhaustive match")}}return f}function Q$(r,t,e,n){var a=wt(e);a.push(r.name);var i=wt(n);return i.push(1),{idx:t,def:r.definition,ruleStack:a,occurrenceStack:i}}var a5=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Oe;(function(r){r[r.OPTION=0]="OPTION",r[r.REPETITION=1]="REPETITION",r[r.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",r[r.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",r[r.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",r[r.ALTERNATION=5]="ALTERNATION"})(Oe||(Oe={}));function Z$(r){if(r instanceof pt)return Oe.OPTION;if(r instanceof Ge)return Oe.REPETITION;if(r instanceof Xt)return Oe.REPETITION_MANDATORY;if(r instanceof qt)return Oe.REPETITION_MANDATORY_WITH_SEPARATOR;if(r instanceof Bt)return Oe.REPETITION_WITH_SEPARATOR;if(r instanceof Vt)return Oe.ALTERNATION;throw Error("non exhaustive match")}function J$(r,t,e,n,a,i){var o=ch(r,t,e),u=s5(o)?Ru:Eu;return i(o,n,u,a)}function eD(r,t,e,n,a,i){var o=hh(r,t,a,e),u=s5(o)?Ru:Eu;return i(o[0],u,n)}function tD(r,t,e,n){var a=r.length,i=Kt(r,function(s){return Kt(s,function(l){return l.length===1})});if(t)return function(s){for(var l=L(s,function(T){return T.GATE}),f=0;f<a;f++){var c=r[f],h=c.length,p=l[f];if(p!==void 0&&p.call(this)===!1)continue;e:for(var y=0;y<h;y++){for(var v=c[y],R=v.length,g=0;g<R;g++){var A=this.LA(g+1);if(e(A,v[g])===!1)continue e}return f}}};if(i&&!n){var o=L(r,function(s){return Ot(s)}),u=ht(o,function(s,l,f){return G(l,function(c){j(s,c.tokenTypeIdx)||(s[c.tokenTypeIdx]=f),G(c.categoryMatches,function(h){j(s,h)||(s[h]=f)})}),s},[]);return function(){var s=this.LA(1);return u[s.tokenTypeIdx]}}else return function(){for(var s=0;s<a;s++){var l=r[s],f=l.length;e:for(var c=0;c<f;c++){for(var h=l[c],p=h.length,y=0;y<p;y++){var v=this.LA(y+1);if(e(v,h[y])===!1)continue e}return s}}}}function rD(r,t,e){var n=Kt(r,function(l){return l.length===1}),a=r.length;if(n&&!e){var i=Ot(r);if(i.length===1&&Te(i[0].categoryMatches)){var o=i[0],u=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===u}}else{var s=ht(i,function(l,f,c){return l[f.tokenTypeIdx]=!0,G(f.categoryMatches,function(h){l[h]=!0}),l},[]);return function(){var l=this.LA(1);return s[l.tokenTypeIdx]===!0}}}else return function(){e:for(var l=0;l<a;l++){for(var f=r[l],c=f.length,h=0;h<c;h++){var p=this.LA(h+1);if(t(p,f[h])===!1)continue e}return!0}return!1}}var nD=function(r){a5(t,r);function t(e,n,a){var i=r.call(this)||this;return i.topProd=e,i.targetOccurrence=n,i.targetProdType=a,i}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,n,a,i){return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=a.concat(i),!0):!1},t.prototype.walkOption=function(e,n,a){this.checkIsTarget(e,Oe.OPTION,n,a)||r.prototype.walkOption.call(this,e,n,a)},t.prototype.walkAtLeastOne=function(e,n,a){this.checkIsTarget(e,Oe.REPETITION_MANDATORY,n,a)||r.prototype.walkOption.call(this,e,n,a)},t.prototype.walkAtLeastOneSep=function(e,n,a){this.checkIsTarget(e,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,n,a)||r.prototype.walkOption.call(this,e,n,a)},t.prototype.walkMany=function(e,n,a){this.checkIsTarget(e,Oe.REPETITION,n,a)||r.prototype.walkOption.call(this,e,n,a)},t.prototype.walkManySep=function(e,n,a){this.checkIsTarget(e,Oe.REPETITION_WITH_SEPARATOR,n,a)||r.prototype.walkOption.call(this,e,n,a)},t}(Su),i5=function(r){a5(t,r);function t(e,n,a){var i=r.call(this)||this;return i.targetOccurrence=e,i.targetProdType=n,i.targetRef=a,i.result=[],i}return t.prototype.checkIsTarget=function(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,Oe.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,Oe.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,Oe.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,Oe.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,Oe.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,Oe.ALTERNATION)},t}(Bn);function o5(r){for(var t=new Array(r),e=0;e<r;e++)t[e]=[];return t}function fh(r){for(var t=[""],e=0;e<r.length;e++){for(var n=r[e],a=[],i=0;i<t.length;i++){var o=t[i];a.push(o+"_"+n.tokenTypeIdx);for(var u=0;u<n.categoryMatches.length;u++){var s="_"+n.categoryMatches[u];a.push(o+s)}}t=a}return t}function aD(r,t,e){for(var n=0;n<r.length;n++)if(n!==e)for(var a=r[n],i=0;i<t.length;i++){var o=t[i];if(a[o]===!0)return!1}return!0}function u5(r,t){for(var e=L(r,function(f){return lh([f],1)}),n=o5(e.length),a=L(e,function(f){var c={};return G(f,function(h){var p=fh(h.partialPath);G(p,function(y){c[y]=!0})}),c}),i=e,o=1;o<=t;o++){var u=i;i=o5(u.length);for(var s=function(f){for(var c=u[f],h=0;h<c.length;h++){var p=c[h].partialPath,y=c[h].suffixDef,v=fh(p),R=aD(a,v,f);if(R||Te(y)||p.length===t){var g=n[f];if(ph(g,p)===!1){g.push(p);for(var A=0;A<v.length;A++){var T=v[A];a[f][T]=!0}}}else{var N=lh(y,o+1,p);i[f]=i[f].concat(N),G(N,function(M){var _=fh(M.partialPath);G(_,function($){a[f][$]=!0})})}}},l=0;l<u.length;l++)s(l)}return n}function ch(r,t,e,n){var a=new i5(r,Oe.ALTERNATION,n);return t.accept(a),u5(a.result,e)}function hh(r,t,e,n){var a=new i5(r,e);t.accept(a);var i=a.result,o=new nD(t,r,e),u=o.startWalking(),s=new Ct({definition:i}),l=new Ct({definition:u});return u5([s,l],n)}function ph(r,t){e:for(var e=0;e<r.length;e++){var n=r[e];if(n.length===t.length){for(var a=0;a<n.length;a++){var i=t[a],o=n[a],u=i===o||o.categoryMatchesMap[i.tokenTypeIdx]!==void 0;if(u===!1)continue e}return!0}}return!1}function iD(r,t){return r.length<t.length&&Kt(r,function(e,n){var a=t[n];return e===a||a.categoryMatchesMap[e.tokenTypeIdx]})}function s5(r){return Kt(r,function(t){return Kt(t,function(e){return Kt(e,function(n){return Te(n.categoryMatches)})})})}var dh=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function oD(r,t,e,n,a,i){var o=L(r,function(A){return sD(A,a)}),u=L(r,function(A){return c5(A,A,a)}),s=[],l=[],f=[];Kt(u,Te)&&(s=L(r,function(A){return yD(A,a)}),l=L(r,function(A){return mD(A,t,n,a)}),f=RD(r,t,a));var c=AD(r,e,a),h=L(e,function(A){return pD(A,a)}),p=uD(r,a),y=TD(r,a),v=L(r,function(A){return ED(A,a)}),R=L(r,function(A){return cD(A,a)}),g=L(r,function(A){return dD(A,r,i,a)});return Ot(o.concat(h,p,y,f,u,s,l,c,v,R,g))}function uD(r,t){var e=[];return G(r,function(n){var a=new sh("");n.accept(a);var i=L(a.result,function(o){return o.orgProd});e.push(L(i,function(o){return hD(n,o,t)}))}),Ot(e)}function sD(r,t){var e=new fD;r.accept(e);var n=e.allProductions,a=Rm(n,lD),i=Yt(a,function(u){return u.length>1}),o=L(mt(i),function(u){var s=Wt(u),l=t.buildDuplicateFoundError(r,u),f=fr(s),c={message:l,type:it.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:f,occurrence:s.idx},h=l5(s);return h&&(c.parameter=h),c});return o}function lD(r){return fr(r)+"_#_"+r.idx+"_#_"+l5(r)}function l5(r){return r instanceof ke?r.terminalType.name:r instanceof xt?r.nonTerminalName:""}var fD=function(r){dh(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.allProductions=[],e}return t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(Bn),Gn=/^[a-zA-Z_]\w*$/,f5=new RegExp(Gn.source.replace("^","^\\$"));function cD(r,t){var e=[],n=r.name;return n.match(Gn)||e.push({message:t.buildInvalidRuleNameError({topLevelRule:r,expectedPattern:Gn}),type:it.INVALID_RULE_NAME,ruleName:n}),e}function hD(r,t,e){var n=[],a;return t.name.match(f5)||(a=e.buildInvalidNestedRuleNameError(r,t),n.push({message:a,type:it.INVALID_NESTED_RULE_NAME,ruleName:r.name})),n}function pD(r,t){var e=[],n=r.name;return n.match(Gn)||e.push({message:t.buildTokenNameError({tokenType:r,expectedPattern:Gn}),type:it.INVALID_TOKEN_NAME}),e}function dD(r,t,e,n){var a=[],i=ht(t,function(u,s){return s.name===r.name?u+1:u},0);if(i>1){var o=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:e});a.push({message:o,type:it.DUPLICATE_RULE_NAME,ruleName:r.name})}return a}function vD(r,t,e){var n=[],a;return Ze(t,r)||(a="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+e+"<-as it is not defined in any of the super grammars ",n.push({message:a,type:it.INVALID_RULE_OVERRIDE,ruleName:r})),n}function c5(r,t,e,n){n===void 0&&(n=[]);var a=[],i=Nu(t.definition);if(Te(i))return[];var o=r.name,u=Ze(i,r);u&&a.push({message:e.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:n}),type:it.LEFT_RECURSION,ruleName:o});var s=fu(i,n.concat([r])),l=L(s,function(f){var c=wt(n);return c.push(f),c5(r,f,e,c)});return a.concat(Ot(l))}function Nu(r){var t=[];if(Te(r))return t;var e=Wt(r);if(e instanceof xt)t.push(e.referencedRule);else if(e instanceof Ct||e instanceof pt||e instanceof Xt||e instanceof qt||e instanceof Bt||e instanceof Ge)t=t.concat(Nu(e.definition));else if(e instanceof Vt)t=Ot(L(e.definition,function(o){return Nu(o.definition)}));else if(!(e instanceof ke))throw Error("non exhaustive match");var n=Au(e),a=r.length>1;if(n&&a){var i=ct(r);return t.concat(Nu(i))}else return t}var vh=function(r){dh(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.alternations=[],e}return t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(Bn);function yD(r,t){var e=new vh;r.accept(e);var n=e.alternations,a=ht(n,function(i,o){var u=Fi(o.definition),s=L(u,function(l,f){var c=n5([l],[],null,1);return Te(c)?{message:t.buildEmptyAlternationError({topLevelRule:r,alternation:o,emptyChoiceIdx:f}),type:it.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:o.idx,alternative:f+1}:null});return i.concat($i(s))},[]);return a}function mD(r,t,e,n){var a=new vh;r.accept(a);var i=a.alternations,o=e[r.name];o&&(i=Ln(i,function(s){return o[fr(s)+(s.idx===0?"":s.idx)]})),i=Ln(i,function(s){return s.ignoreAmbiguities===!0});var u=ht(i,function(s,l){var f=l.idx,c=l.maxLookahead||t,h=ch(f,r,c,l),p=bD(h,l,r,n),y=SD(h,l,r,n);return s.concat(p,y)},[]);return u}var gD=function(r){dh(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.allProductions=[],e}return t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(Bn);function ED(r,t){var e=new vh;r.accept(e);var n=e.alternations,a=ht(n,function(i,o){return o.definition.length>255&&i.push({message:t.buildTooManyAlternativesError({topLevelRule:r,alternation:o}),type:it.TOO_MANY_ALTS,ruleName:r.name,occurrence:o.idx}),i},[]);return a}function RD(r,t,e){var n=[];return G(r,function(a){var i=new gD;a.accept(i);var o=i.allProductions;G(o,function(u){var s=Z$(u),l=u.maxLookahead||t,f=u.idx,c=hh(f,a,s,l),h=c[0];if(Te(Ot(h))){var p=e.buildEmptyRepetitionError({topLevelRule:a,repetition:u});n.push({message:p,type:it.NO_NON_EMPTY_LOOKAHEAD,ruleName:a.name})}})}),n}function bD(r,t,e,n){var a=[],i=ht(r,function(u,s,l){return t.definition[l].ignoreAmbiguities===!0||G(s,function(f){var c=[l];G(r,function(h,p){l!==p&&ph(h,f)&&t.definition[p].ignoreAmbiguities!==!0&&c.push(p)}),c.length>1&&!ph(a,f)&&(a.push(f),u.push({alts:c,path:f}))}),u},[]),o=L(i,function(u){var s=L(u.alts,function(f){return f+1}),l=n.buildAlternationAmbiguityError({topLevelRule:e,alternation:t,ambiguityIndices:s,prefixPath:u.path});return{message:l,type:it.AMBIGUOUS_ALTS,ruleName:e.name,occurrence:t.idx,alternatives:[u.alts]}});return o}function SD(r,t,e,n){var a=[],i=ht(r,function(o,u,s){var l=L(u,function(f){return{idx:s,path:f}});return o.concat(l)},[]);return G(i,function(o){var u=t.definition[o.idx];if(u.ignoreAmbiguities!==!0){var s=o.idx,l=o.path,f=LP(i,function(h){return t.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<s&&iD(h.path,l)}),c=L(f,function(h){var p=[h.idx+1,s+1],y=t.idx===0?"":t.idx,v=n.buildAlternationPrefixAmbiguityError({topLevelRule:e,alternation:t,ambiguityIndices:p,prefixPath:h.path});return{message:v,type:it.AMBIGUOUS_PREFIX_ALTS,ruleName:e.name,occurrence:y,alternatives:p}});a=a.concat(c)}}),a}function AD(r,t,e){var n=[],a=L(t,function(i){return i.name});return G(r,function(i){var o=i.name;if(Ze(a,o)){var u=e.buildNamespaceConflictError(i);n.push({message:u,type:it.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),n}function TD(r,t){var e=[];return G(r,function(n){var a=new sh("");n.accept(a);var i=Rm(a.result,function(u){return u.name}),o=Yt(i,function(u){return u.length>1});G(mt(o),function(u){var s=L(u,function(f){return f.orgProd}),l=t.buildDuplicateNestedRuleNameError(n,s);e.push({message:l,type:it.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),e}var h5={buildMismatchTokenMessage:function(r){var t=r.expected,e=r.actual;r.previous,r.ruleName;var n=Bm(t),a=n?"--> "+Ea(t)+" <--":"token of type --> "+t.name+" <--",i="Expecting "+a+" but found --> '"+e.image+"' <--";return i},buildNotAllInputParsedMessage:function(r){var t=r.firstRedundant;return r.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(r){var t=r.expectedPathsPerAlt,e=r.actual;r.previous;var n=r.customUserDescription;r.ruleName;var a="Expecting: ",i=Wt(e).image,o=`
but found: '`+i+"'";if(n)return a+n+o;var u=ht(t,function(c,h){return c.concat(h)},[]),s=L(u,function(c){return"["+L(c,function(h){return Ea(h)}).join(", ")+"]"}),l=L(s,function(c,h){return"  "+(h+1)+". "+c}),f=`one of these possible Token sequences:
`+l.join(`
`);return a+f+o},buildEarlyExitMessage:function(r){var t=r.expectedIterationPaths,e=r.actual,n=r.customUserDescription;r.ruleName;var a="Expecting: ",i=Wt(e).image,o=`
but found: '`+i+"'";if(n)return a+n+o;var u=L(t,function(l){return"["+L(l,function(f){return Ea(f)}).join(",")+"]"}),s=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+u.join(" ,")+">");return a+s+o}};Object.freeze(h5);var OD={buildRuleNotFoundError:function(r,t){var e="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+r.name+"<-";return e}},yh={buildDuplicateFoundError:function(r,t){function e(f){return f instanceof ke?f.terminalType.name:f instanceof xt?f.nonTerminalName:""}var n=r.name,a=Wt(t),i=a.idx,o=fr(a),u=e(a),s=i>0,l="->"+o+(s?i:"")+"<- "+(u?"with argument: ->"+u+"<-":"")+`
                  appears more than once (`+t.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildInvalidNestedRuleNameError:function(r,t){var e="Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+r.name+`<-
`+("it must match the pattern: ->"+f5.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return e},buildDuplicateNestedRuleNameError:function(r,t){var e=Wt(t).name,n="Duplicate nested rule name: ->"+e+"<- inside rule: ->"+r.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(r){var t=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+r.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return t},buildAlternationPrefixAmbiguityError:function(r){var t=L(r.prefixPath,function(a){return Ea(a)}).join(", "),e=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous alternatives: <"+r.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+e+"> inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(r){var t=L(r.prefixPath,function(a){return Ea(a)}).join(", "),e=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous Alternatives Detected: <"+r.ambiguityIndices.join(" ,")+"> in <OR"+e+">"+(" inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(r){var t=fr(r.repetition);r.repetition.idx!==0&&(t+=r.repetition.idx);var e="The repetition <"+t+"> within Rule <"+r.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return e},buildTokenNameError:function(r){var t=r.tokenType.name,e="Invalid Grammar Token name: ->"+t+"<- it must match the pattern: ->"+r.expectedPattern.toString()+"<-";return e},buildEmptyAlternationError:function(r){var t="Ambiguous empty alternative: <"+(r.emptyChoiceIdx+1)+">"+(" in <OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return t},buildTooManyAlternativesError:function(r){var t=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
 has `+(r.alternation.definition.length+1)+" alternatives.");return t},buildLeftRecursionError:function(r){var t=r.topLevelRule.name,e=L(r.leftRecursionPath,function(i){return i.name}),n=t+" --> "+e.concat([t]).join(" --> "),a=`Left Recursion found in grammar.
`+("rule: <"+t+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return a},buildInvalidRuleNameError:function(r){var t=r.topLevelRule.name,e=r.expectedPattern.toString(),n="Invalid grammar rule name: ->"+t+"<- it must match the pattern: ->"+e+"<-";return n},buildDuplicateRuleNameError:function(r){var t;r.topLevelRule instanceof Ra?t=r.topLevelRule.name:t=r.topLevelRule;var e="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+r.grammarName+"<-";return e}},wD=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function ND(r,t){var e=new CD(r,t);return e.resolveRefs(),e.errors}var CD=function(r){wD(t,r);function t(e,n){var a=r.call(this)||this;return a.nameToTopRule=e,a.errMsgProvider=n,a.errors=[],a}return t.prototype.resolveRefs=function(){var e=this;G(mt(this.nameToTopRule),function(n){e.currTopLevel=n,n.accept(e)})},t.prototype.visitNonTerminal=function(e){var n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{var a=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:a,type:it.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(Bn);function _D(r){r=cu(r,{errMsgProvider:OD});var t={};return G(r.rules,function(e){t[e.name]=e}),ND(t,r.errMsgProvider)}function ID(r){return r=cu(r,{errMsgProvider:yh,ignoredIssues:{}}),oD(r.rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName)}var p5="MismatchedTokenException",d5="NoViableAltException",v5="EarlyExitException",y5="NotAllInputParsedException",m5=[p5,d5,v5,y5];Object.freeze(m5);function Cu(r){return Ze(m5,r.name)}function mh(r,t,e){this.name=p5,this.message=r,this.token=t,this.previousToken=e,this.resyncedTokens=[]}mh.prototype=Error.prototype;function g5(r,t,e){this.name=d5,this.message=r,this.token=t,this.previousToken=e,this.resyncedTokens=[]}g5.prototype=Error.prototype;function E5(r,t){this.name=y5,this.message=r,this.token=t,this.resyncedTokens=[]}E5.prototype=Error.prototype;function R5(r,t,e){this.name=v5,this.message=r,this.token=t,this.previousToken=e,this.resyncedTokens=[]}R5.prototype=Error.prototype;var gh={},b5="InRuleRecoveryException";function S5(r){this.name=b5,this.message=r}S5.prototype=Error.prototype;var MD=function(){function r(){}return r.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=j(t,"recoveryEnabled")?t.recoveryEnabled:_t.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=kD)},r.prototype.getTokenToInsert=function(t){var e=uh(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},r.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},r.prototype.tryInRepetitionRecovery=function(t,e,n,a){for(var i=this,o=this.findReSyncTokenType(),u=this.exportLexerState(),s=[],l=!1,f=this.LA(1),c=this.LA(1),h=function(){var p=i.LA(0),y=i.errorMessageProvider.buildMismatchTokenMessage({expected:a,actual:f,previous:p,ruleName:i.getCurrRuleFullName()}),v=new mh(y,f,i.LA(0));v.resyncedTokens=Fi(s),i.SAVE_ERROR(v)};!l;)if(this.tokenMatcher(c,a)){h();return}else if(n.call(this)){h(),t.apply(this,e);return}else this.tokenMatcher(c,o)?l=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,s));this.importLexerState(u)},r.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,n){return!(n===!1||t===void 0||e===void 0||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))},r.prototype.getFollowsForInRuleRecovery=function(t,e){var n=this.getCurrentGrammarPath(t,e),a=this.getNextPossibleTokenTypes(n);return a},r.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var n=this.getTokenToInsert(t);return n}if(this.canRecoverWithSingleTokenDeletion(t)){var a=this.SKIP_TOKEN();return this.consumeToken(),a}throw new S5("sad sad panda")},r.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},r.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(t)||Te(e))return!1;var a=this.LA(1),i=ma(e,function(o){return n.tokenMatcher(a,o)})!==void 0;return i},r.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.tokenMatcher(this.LA(2),t);return e},r.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return Ze(n,t)},r.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),n=2;;){var a=e.tokenType;if(Ze(t,a))return a;e=this.LA(n),n++}},r.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return gh;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(n)}},r.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Te(this.LAST_EXPLICIT_RULE_STACK)||(e=L(this.LAST_EXPLICIT_RULE_STACK,function(a){return t.RULE_STACK[a]}),n=L(this.LAST_EXPLICIT_RULE_STACK,function(a){return t.RULE_OCCURRENCE_STACK[a]})),L(e,function(a,i){return i===0?gh:{ruleName:t.shortRuleNameToFullName(a),idxInCallingRule:n[i],inRule:t.shortRuleNameToFullName(e[i-1])}})},r.prototype.flattenFollowSet=function(){var t=this,e=L(this.buildFullFollowKeyStack(),function(n){return t.getFollowSetFromFollowKey(n)});return Ot(e)},r.prototype.getFollowSetFromFollowKey=function(t){if(t===gh)return[xn];var e=t.ruleName+t.idxInCallingRule+qm+t.inRule;return this.resyncFollows[e]},r.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,xn)||e.push(t),e},r.prototype.reSyncTo=function(t){for(var e=[],n=this.LA(1);this.tokenMatcher(n,t)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return Fi(e)},r.prototype.attemptInRepetitionRecovery=function(t,e,n,a,i,o,u){},r.prototype.getCurrentGrammarPath=function(t,e){var n=this.getHumanReadableRuleStack(),a=wt(this.RULE_OCCURRENCE_STACK),i={ruleStack:n,occurrenceStack:a,lastTok:t,lastTokOccurrence:e};return i},r.prototype.getHumanReadableRuleStack=function(){var t=this;return Te(this.LAST_EXPLICIT_RULE_STACK)?L(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)}):L(this.LAST_EXPLICIT_RULE_STACK,function(e){return t.shortRuleNameToFullName(t.RULE_STACK[e])})},r}();function kD(r,t,e,n,a,i,o){var u=this.getKeyForAutomaticLookahead(n,a),s=this.firstAfterRepMap[u];if(s===void 0){var l=this.getCurrRuleFullName(),f=this.getGAstProductions()[l],c=new i(f,a);s=c.startWalking(),this.firstAfterRepMap[u]=s}var h=s.token,p=s.occurrence,y=s.isEndOfRule;this.RULE_STACK.length===1&&y&&h===void 0&&(h=xn,p=1),this.shouldInRepetitionRecoveryBeTried(h,p,o)&&this.tryInRepetitionRecovery(r,t,e,h)}var FD=function(){function r(){}return r.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=j(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:_t.dynamicTokensEnabled,this.maxLookahead=j(t,"maxLookahead")?t.maxLookahead:_t.maxLookahead,this.lookAheadFuncsCache=Am()?new Map:[],Am()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},r.prototype.preComputeLookaheadFunctions=function(t){var e=this;G(t,function(n){e.TRACE_INIT(n.name+" Rule Lookahead",function(){var a=F$(n),i=a.alternation,o=a.repetition,u=a.option,s=a.repetitionMandatory,l=a.repetitionMandatoryWithSeparator,f=a.repetitionWithSeparator;G(i,function(c){var h=c.idx===0?"":c.idx;e.TRACE_INIT(""+fr(c)+h,function(){var p=J$(c.idx,n,c.maxLookahead||e.maxLookahead,c.hasPredicates,e.dynamicTokensEnabled,e.lookAheadBuilderForAlternatives),y=ji(e.fullRuleNameToShort[n.name],ba,c.idx);e.setLaFuncCache(y,p)})}),G(o,function(c){e.computeLookaheadFunc(n,c.idx,Bi,Oe.REPETITION,c.maxLookahead,fr(c))}),G(u,function(c){e.computeLookaheadFunc(n,c.idx,Ou,Oe.OPTION,c.maxLookahead,fr(c))}),G(s,function(c){e.computeLookaheadFunc(n,c.idx,Vi,Oe.REPETITION_MANDATORY,c.maxLookahead,fr(c))}),G(l,function(c){e.computeLookaheadFunc(n,c.idx,Sa,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,c.maxLookahead,fr(c))}),G(f,function(c){e.computeLookaheadFunc(n,c.idx,Gi,Oe.REPETITION_WITH_SEPARATOR,c.maxLookahead,fr(c))})})})},r.prototype.computeLookaheadFunc=function(t,e,n,a,i,o){var u=this;this.TRACE_INIT(""+o+(e===0?"":e),function(){var s=eD(e,t,i||u.maxLookahead,u.dynamicTokensEnabled,a,u.lookAheadBuilderForOptional),l=ji(u.fullRuleNameToShort[t.name],n,e);u.setLaFuncCache(l,s)})},r.prototype.lookAheadBuilderForOptional=function(t,e,n){return rD(t,e,n)},r.prototype.lookAheadBuilderForAlternatives=function(t,e,n,a){return tD(t,e,n,a)},r.prototype.getKeyForAutomaticLookahead=function(t,e){var n=this.getLastExplicitRuleShortName();return ji(n,t,e)},r.prototype.getLaFuncFromCache=function(t){},r.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},r.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},r.prototype.setLaFuncCache=function(t,e){},r.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},r.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},r}();function PD(r){return _u(r.constructor)}var $D=/^\s*function\s*(\S*)\s*\(/,A5="name";function _u(r){var t=r.name;if(t)return t;var e=r.toString().match($D)[1];return e}function T5(r,t){var e=Object.getOwnPropertyDescriptor(r,A5);return zt(e)||e.configurable?(Object.defineProperty(r,A5,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0):!1}function DD(r,t){for(var e=$r(r),n=e.length,a=0;a<n;a++)for(var i=e[a],o=r[i],u=o.length,s=0;s<u;s++){var l=o[s];l.tokenTypeIdx===void 0&&(l.fullName!==void 0?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function LD(r,t){var e=function(){};T5(e,r+"BaseSemantics");var n={visit:function(a,i){if(sr(a)&&(a=a[0]),!zt(a))return a.fullName!==void 0?this[a.fullName](a.children,i):this[a.name](a.children,i)},validateVisitor:function(){var a=xD(this,t);if(!Te(a)){var i=L(a,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+_u(this.constructor)+`>:
	`+(""+i.join(`

`).replace(/\n/g,`
	`)))}}};return e.prototype=n,e.prototype.constructor=e,e._RULE_NAMES=t,e}function UD(r,t,e){var n=function(){};T5(n,r+"BaseSemanticsWithDefaults");var a=Object.create(e.prototype);return G(t,function(i){a[i]=DD}),n.prototype=a,n.prototype.constructor=n,n}var Iu;(function(r){r[r.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",r[r.MISSING_METHOD=1]="MISSING_METHOD"})(Iu||(Iu={}));function xD(r,t){var e=BD(r,t),n=GD(r,t);return e.concat(n)}function BD(r,t){var e=L(t,function(n){if(!un(r[n]))return{msg:"Missing visitor method: <"+n+"> on "+_u(r.constructor)+" CST Visitor.",type:Iu.MISSING_METHOD,methodName:n}});return $i(e)}var VD=["constructor","visit","validateVisitor"];function GD(r,t){var e=[];for(var n in r)Gn.test(n)&&un(r[n])&&!Ze(VD,n)&&!Ze(t,n)&&e.push({msg:"Redundant visitor method: <"+n+"> on "+_u(r.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+Gn.source+"/."),type:Iu.REDUNDANT_METHOD,methodName:n});return e}var jD=function(){function r(){}return r.prototype.initTreeBuilder=function(t){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=j(t,"outputCst")?t.outputCst:_t.outputCst,this.nodeLocationTracking=j(t,"nodeLocationTracking")?t.nodeLocationTracking:_t.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=at,this.cstFinallyStateUpdate=at,this.cstPostTerminal=at,this.cstPostNonTerminal=at,this.cstPostRule=at,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Jm,this.setNodeLocationFromNode=Jm,this.cstPostRule=at,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=at,this.setNodeLocationFromNode=at,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Zm,this.setNodeLocationFromNode=Zm,this.cstPostRule=at,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=at,this.setNodeLocationFromNode=at,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=at,this.setNodeLocationFromNode=at,this.cstPostRule=at,this.setInitialNodeLocation=at;else throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"')},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstNestedInvocationStateUpdate=function(t,e){var n={name:t,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+t,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstInvocationStateUpdate=function(t,e){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:t,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},r.prototype.cstNestedFinallyStateUpdate=function(){var t=this.CST_STACK.pop();this.cstPostRule(t)},r.prototype.cstPostRuleFull=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset?(n.endOffset=e.endOffset,n.endLine=e.endLine,n.endColumn=e.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset?n.endOffset=e.endOffset:n.startOffset=NaN},r.prototype.cstPostTerminal=function(t,e){var n=this.CST_STACK[this.CST_STACK.length-1];W$(n,e,t),this.setNodeLocationFromToken(n.location,e)},r.prototype.cstPostNonTerminal=function(t,e){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];e5(n,e,t),this.setNodeLocationFromNode(n.location,t.location)}},r.prototype.getBaseCstVisitorConstructor=function(){if(zt(this.baseCstVisitorConstructor)){var t=LD(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(zt(this.baseCstVisitorWithDefaultsConstructor)){var t=UD(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.nestedRuleBeforeClause=function(t,e){var n;if(t.NAME!==void 0)return n=t.NAME,this.nestedRuleInvocationStateUpdate(n,e),n},r.prototype.nestedAltBeforeClause=function(t,e,n,a){var i=this.getLastExplicitRuleShortName(),o=Qm(i,n,e,a),u;if(t.NAME!==void 0)return u=t.NAME,this.nestedRuleInvocationStateUpdate(u,o),{shortName:o,nestedName:u}},r.prototype.nestedRuleFinallyClause=function(t,e){var n=this.CST_STACK,a=n[n.length-1];this.nestedRuleFinallyStateUpdate();var i=n[n.length-1];e5(i,e,a),this.setNodeLocationFromNode(i.location,a.location)},r.prototype.getLastExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[t]},r.prototype.getLastExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[t]},r.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[t]},r.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},r.prototype.nestedRuleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(e),this.cstNestedInvocationStateUpdate(t,e)},r.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},r}(),HD=function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!0,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Fu},r.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?Fu:this.tokVector[e]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(t){this.currIdx=t},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r}(),WD=function(){function r(){}return r.prototype.ACTION=function(t){return t.call(this)},r.prototype.consume=function(t,e,n){return this.consumeInternal(e,t,n)},r.prototype.subrule=function(t,e,n){return this.subruleInternal(e,t,n)},r.prototype.option=function(t,e){return this.optionInternal(e,t)},r.prototype.or=function(t,e){return this.orInternal(e,t)},r.prototype.many=function(t,e){return this.manyInternal(t,e)},r.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},r.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},r.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},r.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},r.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},r.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},r.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},r.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},r.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},r.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},r.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},r.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},r.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},r.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},r.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},r.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},r.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},r.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},r.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},r.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},r.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},r.prototype.OPTION=function(t){return this.optionInternal(t,0)},r.prototype.OPTION1=function(t){return this.optionInternal(t,1)},r.prototype.OPTION2=function(t){return this.optionInternal(t,2)},r.prototype.OPTION3=function(t){return this.optionInternal(t,3)},r.prototype.OPTION4=function(t){return this.optionInternal(t,4)},r.prototype.OPTION5=function(t){return this.optionInternal(t,5)},r.prototype.OPTION6=function(t){return this.optionInternal(t,6)},r.prototype.OPTION7=function(t){return this.optionInternal(t,7)},r.prototype.OPTION8=function(t){return this.optionInternal(t,8)},r.prototype.OPTION9=function(t){return this.optionInternal(t,9)},r.prototype.OR=function(t){return this.orInternal(t,0)},r.prototype.OR1=function(t){return this.orInternal(t,1)},r.prototype.OR2=function(t){return this.orInternal(t,2)},r.prototype.OR3=function(t){return this.orInternal(t,3)},r.prototype.OR4=function(t){return this.orInternal(t,4)},r.prototype.OR5=function(t){return this.orInternal(t,5)},r.prototype.OR6=function(t){return this.orInternal(t,6)},r.prototype.OR7=function(t){return this.orInternal(t,7)},r.prototype.OR8=function(t){return this.orInternal(t,8)},r.prototype.OR9=function(t){return this.orInternal(t,9)},r.prototype.MANY=function(t){this.manyInternal(0,t)},r.prototype.MANY1=function(t){this.manyInternal(1,t)},r.prototype.MANY2=function(t){this.manyInternal(2,t)},r.prototype.MANY3=function(t){this.manyInternal(3,t)},r.prototype.MANY4=function(t){this.manyInternal(4,t)},r.prototype.MANY5=function(t){this.manyInternal(5,t)},r.prototype.MANY6=function(t){this.manyInternal(6,t)},r.prototype.MANY7=function(t){this.manyInternal(7,t)},r.prototype.MANY8=function(t){this.manyInternal(8,t)},r.prototype.MANY9=function(t){this.manyInternal(9,t)},r.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},r.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},r.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},r.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},r.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},r.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},r.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},r.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},r.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},r.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},r.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},r.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},r.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},r.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},r.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},r.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},r.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},r.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},r.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},r.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},r.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},r.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},r.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},r.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},r.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},r.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},r.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},r.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},r.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},r.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},r.prototype.RULE=function(t,e,n){if(n===void 0&&(n=Pu),Ze(this.definedRulesNames,t)){var a=yh.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:a,type:it.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var o=this.defineRule(t,e,n);return this[t]=o,o},r.prototype.OVERRIDE_RULE=function(t,e,n){n===void 0&&(n=Pu);var a=[];a=a.concat(vD(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,a);var i=this.defineRule(t,e,n);return this[t]=i,i},r.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return t.apply(this,e),!0}catch(a){if(Cu(a))return!1;throw a}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return C$(mt(this.gastProductionsCache))},r}(),zD=function(){function r(){}return r.prototype.initRecognizerEngine=function(t,e){if(this.className=PD(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Ru,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},j(e,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(sr(t)){if(Te(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(sr(t))this.tokensMap=ht(t,function(o,u){return o[u.name]=u,o},{});else if(j(t,"modes")&&Kt(Ot(mt(t.modes)),T$)){var n=Ot(mt(t.modes)),a=Jc(n);this.tokensMap=ht(a,function(o,u){return o[u.name]=u,o},{})}else if(eh(t))this.tokensMap=Pi(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=xn;var i=Kt(mt(t),function(o){return Te(o.categoryMatches)});this.tokenMatcher=i?Ru:Eu,Li(mt(this.tokensMap))},r.prototype.defineRule=function(t,e,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var a=j(n,"resyncEnabled")?n.resyncEnabled:Pu.resyncEnabled,i=j(n,"recoveryValueFunc")?n.recoveryValueFunc:Pu.recoveryValueFunc,o=this.ruleShortNameIdx<<V$+ln;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=t,this.fullRuleNameToShort[t]=o;function u(f){try{if(this.outputCst===!0){e.apply(this,f);var c=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(c),c}else return e.apply(this,f)}catch(h){return this.invokeRuleCatch(h,a,i)}finally{this.ruleFinallyStateUpdate()}}var s;s=function(f,c){return f===void 0&&(f=0),this.ruleInvocationStateUpdate(o,t,f),u.call(this,c)};var l="ruleName";return s[l]=t,s.originalGrammarAction=e,s},r.prototype.invokeRuleCatch=function(t,e,n){var a=this.RULE_STACK.length===1,i=e&&!this.isBackTracking()&&this.recoveryEnabled;if(Cu(t)){var o=t;if(i){var u=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(u))if(o.resyncedTokens=this.reSyncTo(u),this.outputCst){var s=this.CST_STACK[this.CST_STACK.length-1];return s.recoveredNode=!0,s}else return n();else{if(this.outputCst){var s=this.CST_STACK[this.CST_STACK.length-1];s.recoveredNode=!0,o.partialCstResult=s}throw o}}else{if(a)return this.moveToTerminatedState(),n();throw o}}else throw t},r.prototype.optionInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Ou,e),a=this.nestedRuleBeforeClause(t,n);try{return this.optionInternalLogic(t,e,n)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.optionInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(Ou,e);return this.optionInternalLogic(t,e,n)},r.prototype.optionInternalLogic=function(t,e,n){var a=this,i=this.getLaFuncFromCache(n),o,u;if(t.DEF!==void 0){if(o=t.DEF,u=t.GATE,u!==void 0){var s=i;i=function(){return u.call(a)&&s.call(a)}}}else o=t;if(i.call(this)===!0)return o.call(this)},r.prototype.atLeastOneInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Vi,t),a=this.nestedRuleBeforeClause(e,n);try{return this.atLeastOneInternalLogic(t,e,n)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.atLeastOneInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(Vi,t);this.atLeastOneInternalLogic(t,e,n)},r.prototype.atLeastOneInternalLogic=function(t,e,n){var a=this,i=this.getLaFuncFromCache(n),o,u;if(e.DEF!==void 0){if(o=e.DEF,u=e.GATE,u!==void 0){var s=i;i=function(){return u.call(a)&&s.call(a)}}}else o=e;if(i.call(this)===!0)for(var l=this.doSingleRepetition(o);i.call(this)===!0&&l===!0;)l=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(t,Oe.REPETITION_MANDATORY,e.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],i,Vi,t,q$)},r.prototype.atLeastOneSepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Sa,t),a=this.nestedRuleBeforeClause(e,n);try{this.atLeastOneSepFirstInternalLogic(t,e,n)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.atLeastOneSepFirstInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(Sa,t);this.atLeastOneSepFirstInternalLogic(t,e,n)},r.prototype.atLeastOneSepFirstInternalLogic=function(t,e,n){var a=this,i=e.DEF,o=e.SEP,u=this.getLaFuncFromCache(n);if(u.call(this)===!0){i.call(this);for(var s=function(){return a.tokenMatcher(a.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,o,s,i,r5],s,Sa,t,r5)}else throw this.raiseEarlyExitException(t,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG)},r.prototype.manyInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Bi,t),a=this.nestedRuleBeforeClause(e,n);try{return this.manyInternalLogic(t,e,n)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.manyInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(Bi,t);return this.manyInternalLogic(t,e,n)},r.prototype.manyInternalLogic=function(t,e,n){var a=this,i=this.getLaFuncFromCache(n),o,u;if(e.DEF!==void 0){if(o=e.DEF,u=e.GATE,u!==void 0){var s=i;i=function(){return u.call(a)&&s.call(a)}}}else o=e;for(var l=!0;i.call(this)===!0&&l===!0;)l=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,Bi,t,X$,l)},r.prototype.manySepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Gi,t),a=this.nestedRuleBeforeClause(e,n);try{this.manySepFirstInternalLogic(t,e,n)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.manySepFirstInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(Gi,t);this.manySepFirstInternalLogic(t,e,n)},r.prototype.manySepFirstInternalLogic=function(t,e,n){var a=this,i=e.DEF,o=e.SEP,u=this.getLaFuncFromCache(n);if(u.call(this)===!0){i.call(this);for(var s=function(){return a.tokenMatcher(a.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,o,s,i,t5],s,Gi,t,t5)}},r.prototype.repetitionSepSecondInternal=function(t,e,n,a,i){for(;n();)this.CONSUME(e),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,a,i],n,Sa,t,i)},r.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();t.call(this);var n=this.getLexerPosition();return n>e},r.prototype.orInternalNoCst=function(t,e){var n=sr(t)?t:t.DEF,a=this.getKeyForAutomaticLookahead(ba,e),i=this.getLaFuncFromCache(a),o=i.call(this,n);if(o!==void 0){var u=n[o];return u.ALT.call(this)}this.raiseNoAltException(e,t.ERR_MSG)},r.prototype.orInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(ba,e),a=this.nestedRuleBeforeClause(t,n);try{var i=sr(t)?t:t.DEF,o=this.getLaFuncFromCache(n),u=o.call(this,i);if(u!==void 0){var s=i[u],l=this.nestedAltBeforeClause(s,e,ba,u);try{return s.ALT.call(this)}finally{l!==void 0&&this.nestedRuleFinallyClause(l.shortName,l.nestedName)}}this.raiseNoAltException(e,t.ERR_MSG)}finally{a!==void 0&&this.nestedRuleFinallyClause(n,a)}},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new E5(e,t))}},r.prototype.subruleInternal=function(t,e,n){var a;try{var i=n!==void 0?n.ARGS:void 0;return a=t.call(this,e,i),this.cstPostNonTerminal(a,n!==void 0&&n.LABEL!==void 0?n.LABEL:t.ruleName),a}catch(o){this.subruleInternalError(o,n,t.ruleName)}},r.prototype.subruleInternalError=function(t,e,n){throw Cu(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,e!==void 0&&e.LABEL!==void 0?e.LABEL:n),delete t.partialCstResult),t},r.prototype.consumeInternal=function(t,e,n){var a;try{var i=this.LA(1);this.tokenMatcher(i,t)===!0?(this.consumeToken(),a=i):this.consumeInternalError(t,i,n)}catch(o){a=this.consumeInternalRecovery(t,e,o)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:t.name,a),a},r.prototype.consumeInternalError=function(t,e,n){var a,i=this.LA(0);throw n!==void 0&&n.ERR_MSG?a=n.ERR_MSG:a=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new mh(a,e,i))},r.prototype.consumeInternalRecovery=function(t,e,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var a=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,a)}catch(i){throw i.name===b5?n:i}}else throw n},r.prototype.saveRecogState=function(){var t=this.errors,e=wt(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},r.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(t,e,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},r.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),xn)},r.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r}(),YD=function(){function r(){}return r.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=cu(t.errorMessageProvider,_t.errorMessageProvider)},r.prototype.SAVE_ERROR=function(t){if(Cu(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:wt(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return wt(this._errors)},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),r.prototype.raiseEarlyExitException=function(t,e,n){for(var a=this.getCurrRuleFullName(),i=this.getGAstProductions()[a],o=hh(t,i,e,this.maxLookahead),u=o[0],s=[],l=1;l<=this.maxLookahead;l++)s.push(this.LA(l));var f=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:u,actual:s,previous:this.LA(0),customUserDescription:n,ruleName:a});throw this.SAVE_ERROR(new R5(f,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(t,e){for(var n=this.getCurrRuleFullName(),a=this.getGAstProductions()[n],i=ch(t,a,this.maxLookahead),o=[],u=1;u<=this.maxLookahead;u++)o.push(this.LA(u));var s=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:o,previous:s,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new g5(l,this.LA(1),s))},r}(),KD=function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(t,e){var n=this.gastProductionsCache[t];if(zt(n))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return n5([n],e,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(t){var e=Wt(t.ruleStack),n=this.getGAstProductions(),a=n[e],i=new K$(a,t).startWalking();return i},r}(),Mu={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Mu);var O5=!0,w5=Math.pow(2,ln)-1,N5=oe({name:"RECORDING_PHASE_TOKEN",pattern:Nt.NA});Li([N5]);var C5=uh(N5,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(C5);var XD={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},qD=function(){function r(){}return r.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=function(a){var i=a>0?a:"";t["CONSUME"+i]=function(o,u){return this.consumeInternalRecord(o,a,u)},t["SUBRULE"+i]=function(o,u){return this.subruleInternalRecord(o,a,u)},t["OPTION"+i]=function(o){return this.optionInternalRecord(o,a)},t["OR"+i]=function(o){return this.orInternalRecord(o,a)},t["MANY"+i]=function(o){this.manyInternalRecord(a,o)},t["MANY_SEP"+i]=function(o){this.manySepFirstInternalRecord(a,o)},t["AT_LEAST_ONE"+i]=function(o){this.atLeastOneInternalRecord(a,o)},t["AT_LEAST_ONE_SEP"+i]=function(o){this.atLeastOneSepFirstInternalRecord(a,o)}},n=0;n<10;n++)e(n);t.consume=function(a,i,o){return this.consumeInternalRecord(i,a,o)},t.subrule=function(a,i,o){return this.subruleInternalRecord(i,a,o)},t.option=function(a,i){return this.optionInternalRecord(i,a)},t.or=function(a,i){return this.orInternalRecord(i,a)},t.many=function(a,i){this.manyInternalRecord(a,i)},t.atLeastOne=function(a,i){this.atLeastOneInternalRecord(a,i)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},r.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var n=e>0?e:"";delete t["CONSUME"+n],delete t["SUBRULE"+n],delete t["OPTION"+n],delete t["OR"+n],delete t["MANY"+n],delete t["MANY_SEP"+n],delete t["AT_LEAST_ONE"+n],delete t["AT_LEAST_ONE_SEP"+n]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})},r.prototype.ACTION_RECORD=function(t){},r.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},r.prototype.LA_RECORD=function(t){return Fu},r.prototype.topLevelRuleRecord=function(t,e){try{var n=new Ra({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),e.call(this),this.recordingProdStack.pop(),n}catch(a){if(a.KNOWN_RECORDER_ERROR!==!0)try{a.message=a.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw a}throw a}},r.prototype.optionInternalRecord=function(t,e){return Hi.call(this,pt,t,e)},r.prototype.atLeastOneInternalRecord=function(t,e){Hi.call(this,Xt,e,t)},r.prototype.atLeastOneSepFirstInternalRecord=function(t,e){Hi.call(this,qt,e,t,O5)},r.prototype.manyInternalRecord=function(t,e){Hi.call(this,Ge,e,t)},r.prototype.manySepFirstInternalRecord=function(t,e){Hi.call(this,Bt,e,t,O5)},r.prototype.orInternalRecord=function(t,e){return QD.call(this,t,e)},r.prototype.subruleInternalRecord=function(t,e,n){if(ku(e),!t||j(t,"ruleName")===!1){var a=new Error("<SUBRULE"+_5(e)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=hu(this.recordingProdStack),o=t.ruleName,u=new xt({idx:e,nonTerminalName:o,referencedRule:void 0});return i.definition.push(u),this.outputCst?XD:Mu},r.prototype.consumeInternalRecord=function(t,e,n){if(ku(e),!Um(t)){var a=new Error("<CONSUME"+_5(e)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=hu(this.recordingProdStack),o=new ke({idx:e,terminalType:t});return i.definition.push(o),C5},r}();function Hi(r,t,e,n){n===void 0&&(n=!1),ku(e);var a=hu(this.recordingProdStack),i=un(t)?t:t.DEF,o=new r({definition:[],idx:e});return j(t,"NAME")&&(o.name=t.NAME),n&&(o.separator=t.SEP),j(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(o),i.call(this),a.definition.push(o),this.recordingProdStack.pop(),Mu}function QD(r,t){var e=this;ku(t);var n=hu(this.recordingProdStack),a=sr(r)===!1,i=a===!1?r:r.DEF,o=new Vt({definition:[],idx:t,ignoreAmbiguities:a&&r.IGNORE_AMBIGUITIES===!0});j(r,"NAME")&&(o.name=r.NAME),j(r,"MAX_LOOKAHEAD")&&(o.maxLookahead=r.MAX_LOOKAHEAD);var u=Em(i,function(s){return un(s.GATE)});return o.hasPredicates=u,n.definition.push(o),G(i,function(s){var l=new Ct({definition:[]});o.definition.push(l),j(s,"NAME")&&(l.name=s.NAME),j(s,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=s.IGNORE_AMBIGUITIES:j(s,"GATE")&&(l.ignoreAmbiguities=!0),e.recordingProdStack.push(l),s.ALT.call(e),e.recordingProdStack.pop()}),Mu}function _5(r){return r===0?"":""+r}function ku(r){if(r<0||r>w5){var t=new Error("Invalid DSL Method idx value: <"+r+`>
	`+("Idx value must be a none negative value smaller than "+(w5+1)));throw t.KNOWN_RECORDER_ERROR=!0,t}}var ZD=function(){function r(){}return r.prototype.initPerformanceTracer=function(t){if(j(t,"traceInitPerf")){var e=t.traceInitPerf,n=typeof e=="number";this.traceInitMaxIdent=n?e:1/0,this.traceInitPerf=n?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=_t.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(t,e){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+t+">");var a=Om(e),i=a.time,o=a.value,u=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,o}else return e()},r}(),I5=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Fu=uh(xn,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Fu);var _t=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:h5,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Pu=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),it;(function(r){r[r.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",r[r.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",r[r.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",r[r.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",r[r.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",r[r.LEFT_RECURSION=5]="LEFT_RECURSION",r[r.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",r[r.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",r[r.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",r[r.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",r[r.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",r[r.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",r[r.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",r[r.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",r[r.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(it||(it={}));function JD(r){return r===void 0&&(r=void 0),function(){return r}}var Eh=function(){function r(t,e){e===void 0&&(e=_t),this.ignoredIssues=_t.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(e),n.initLexerAdapter(),n.initLooksAhead(e),n.initRecognizerEngine(t,e),n.initRecoverable(e),n.initTreeBuilder(e),n.initContentAssist(),n.initGastRecorder(e),n.initPerformanceTracer(e),j(e,"ignoredIssues")&&e.ignoredIssues!==_t.ignoredIssues&&rh(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=j(e,"ignoredIssues")?e.ignoredIssues:_t.ignoredIssues,this.skipValidations=j(e,"skipValidations")?e.skipValidations:_t.skipValidations}return r.performSelfAnalysis=function(t){t.performSelfAnalysis()},r.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",function(){var e;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",function(){Tm(t)}),t.TRACE_INIT("Grammar Recording",function(){try{t.enableRecording(),G(t.definedRulesNames,function(i){var o=t[i],u=o.originalGrammarAction,s=void 0;t.TRACE_INIT(i+" Rule",function(){s=t.topLevelRuleRecord(i,u)}),t.gastProductionsCache[i]=s})}finally{t.disableRecording()}});var a=[];if(t.TRACE_INIT("Grammar Resolving",function(){a=_D({rules:mt(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,a)}),t.TRACE_INIT("Grammar Validations",function(){if(Te(a)&&t.skipValidations===!1){var i=ID({rules:mt(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:mt(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:yh,grammarName:n});t.definitionErrors.push.apply(t.definitionErrors,i)}}),Te(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",function(){var i=x$(mt(t.gastProductionsCache));t.resyncFollows=i}),t.TRACE_INIT("ComputeLookaheadFunctions",function(){t.preComputeLookaheadFunctions(mt(t.gastProductionsCache))})),t.TRACE_INIT("expandAllNestedRuleNames",function(){var i=z$(mt(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=i.allRuleNames}),!r.DEFER_DEFINITION_ERRORS_HANDLING&&!Te(t.definitionErrors))throw e=L(t.definitionErrors,function(i){return i.message}),new Error(`Parser Definition Errors detected:
 `+e.join(`
-------------------------------
`))})},r.DEFER_DEFINITION_ERRORS_HANDLING=!1,r}();VP(Eh,[MD,FD,jD,HD,zD,WD,YD,KD,qD,ZD]);(function(r){I5(t,r);function t(e,n){n===void 0&&(n=_t);var a=this,i=Pi(n);return i.outputCst=!0,a=r.call(this,e,i)||this,a}return t})(Eh);var eL=function(r){I5(t,r);function t(e,n){n===void 0&&(n=_t);var a=this,i=Pi(n);return i.outputCst=!1,a=r.call(this,e,i)||this,a}return t}(Eh);function tL(r){return iL(r)||aL(r)||nL(r)||rL()}function rL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nL(r,t){if(!!r){if(typeof r=="string")return Rh(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Rh(r,t)}}function aL(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function iL(r){if(Array.isArray(r))return Rh(r)}function Rh(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}var Wi=":",gt="$",oL=/\s+/,uL=/[ \t\n\r]+/,zi=oe({name:"AdditionOp",pattern:Nt.NA}),bh=oe({name:"PlusOp",pattern:/\+/,categories:zi}),Sh=oe({name:"MinusOp",pattern:/-/,categories:zi}),$u=oe({name:"MultiplicationOp",pattern:Nt.NA}),M5=oe({name:"TimesOp",pattern:/\*/,categories:$u}),k5=oe({name:"DivOp",pattern:/\//,categories:$u}),Ah=oe({name:"PowerOp",pattern:/\^/}),F5=oe({name:"PercentOp",pattern:/%/}),fn=oe({name:"BooleanOp",pattern:Nt.NA}),Th=oe({name:"EqualsOp",pattern:/=/,categories:fn}),P5=oe({name:"NotEqualOp",pattern:/<>/,categories:fn}),$5=oe({name:"GreaterThanOp",pattern:/>/,categories:fn}),D5=oe({name:"LessThanOp",pattern:/</,categories:fn}),L5=oe({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:fn}),U5=oe({name:"LessThanOrEqualOp",pattern:/<=/,categories:fn}),x5=oe({name:"ConcatenateOp",pattern:/&/}),B5="[A-Za-z0-9_\xC0-\u02AF]+",sL="'(((?!').|'')*)'",cn="(".concat(B5,"|").concat(sL,")!"),hn=oe({name:"CellReference",pattern:new RegExp("(".concat(cn,")?\\").concat(gt,"?[A-Za-z]+\\").concat(gt,"?[0-9]+"))}),Oh=oe({name:"ColumnRange",pattern:new RegExp("(".concat(cn,")?\\").concat(gt,"?[A-Za-z]+").concat(Wi,"(").concat(cn,")?\\").concat(gt,"?[A-Za-z]+"))}),wh=oe({name:"RowRange",pattern:new RegExp("(".concat(cn,")?\\").concat(gt,"?[0-9]+").concat(Wi,"(").concat(cn,")?\\").concat(gt,"?[0-9]+"))}),Yi=oe({name:"RangeSeparator",pattern:"".concat(Wi)}),Nh=oe({name:"LParen",pattern:/\(/}),Du=oe({name:"RParen",pattern:/\)/}),V5=oe({name:"ArrayLParen",pattern:/{/}),G5=oe({name:"ArrayRParen",pattern:/}/}),Ch=oe({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/}),j5=oe({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/}),H5=oe({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),W5=oe({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),_h=function(t){var e=t.translationPackage.getFunctionTranslation("OFFSET"),n=t.errorMapping,a=t.translationPackage.buildFunctionMapping(),i=t.ignoreWhiteSpace==="standard"?uL:oL,o=oe({name:"WhiteSpace",pattern:i}),u=oe({name:"ArrayRowSep",pattern:t.arrayRowSeparator}),s=oe({name:"ArrayColSep",pattern:t.arrayColumnSeparator}),l,f;t.functionArgSeparator===t.arrayColumnSeparator?(l=s,f=[]):t.functionArgSeparator===t.arrayRowSeparator?(l=u,f=[]):(l=oe({name:"ArgSeparator",pattern:t.functionArgSeparator}),f=[l]);var c=oe({name:"NumberLiteral",pattern:new RegExp("(([".concat(t.decimalSeparator,"]\\d+)|(\\d+([").concat(t.decimalSeparator,"]\\d*)?))(e[+-]?\\d+)?"))}),h=oe({name:"OffsetProcedureName",pattern:new RegExp(e,"i")}),p=[o,bh,Sh,M5,k5,Ah,Th,P5,F5,L5,U5,$5,D5,Nh,Du,V5,G5,h,Ch,Yi].concat(tL(f),[Oh,wh,c,H5,W5,x5,fn,zi,$u,hn,j5,u,s]);return{ArgSeparator:l,NumberLiteral:c,OffsetProcedureName:h,ArrayRowSeparator:u,ArrayColSeparator:s,WhiteSpace:o,allTokens:p,errorMapping:n,functionMapping:a,decimalSeparator:t.decimalSeparator,maxColumns:t.maxColumns,maxRows:t.maxRows}};function lL(r,t){return pL(r)||hL(r,t)||cL(r,t)||fL()}function fL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cL(r,t){if(!!r){if(typeof r=="string")return z5(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z5(r,t)}}function z5(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function hL(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function pL(r){if(Array.isArray(r))return r}var Y5=new RegExp("^(".concat(cn,")?(\\").concat(gt,"?)([A-Za-z]+)(\\").concat(gt,"?)([0-9]+)$")),dL=new RegExp("^(".concat(cn,")?(\\").concat(gt,"?)([A-Za-z]+)$")),vL=new RegExp("^(".concat(cn,")?(\\").concat(gt,"?)([0-9]+)$")),yL=new RegExp("^".concat(B5,"$")),Aa=function(t,e,n){var a=Y5.exec(e),i=Mh(a[6]),o=Bu(a,t);if(o!==void 0){o===null&&(o=void 0);var u=Number(a[8])-1;return a[5]===gt&&a[7]===gt?Ut.absolute(i,u,o):a[5]===gt?Ut.absoluteCol(i,u-n.row,o):a[7]===gt?Ut.absoluteRow(i-n.col,u,o):Ut.relative(u-n.row,i-n.col,o)}},Lu=function(t,e,n){var a=dL.exec(e),i=Bu(a,t);if(i!==void 0){i===null&&(i=void 0);var o=Mh(a[6]);return a[5]===gt?Dn.absolute(o,i):Dn.relative(o-n.col,i)}},Uu=function(t,e,n){var a=vL.exec(e),i=Bu(a,t);if(i!==void 0){i===null&&(i=void 0);var o=Number(a[6])-1;return a[5]===gt?on.absolute(o,i):on.relative(o-n.row,i)}},Ih=function(t,e,n){var a=Y5.exec(e),i=Mh(a[6]),o=Bu(a,t);if(o!==void 0){o===null&&(o=n);var u=Number(a[8])-1;return P(o,i,u)}},mL=function(t,e,n){var a=e.split(Wi);if(a.length===2){var i=lL(a,2),o=i[0],u=i[1],s=Ih(t,o,n);if(s!==void 0){var l=Ih(t,u,s.sheet);if(l!==void 0&&s.sheet===l.sheet)return jh(s,l)}}},xu=function(t,e,n){var a=kh(e.col),i=K5(e.sheet,t);if(i!==void 0)return n!==e.sheet?"".concat(i,"!").concat(a).concat(e.row+1):"".concat(a).concat(e.row+1)},gL=function(t,e,n){var a=xu(t,e.start,n),i=xu(t,e.end,e.start.sheet);if(!(a===void 0||i===void 0))return"".concat(a).concat(Wi).concat(i)};function Mh(r){return r.length===1?r.toUpperCase().charCodeAt(0)-65:r.split("").reduce(function(t,e){return t*26+(e.toUpperCase().charCodeAt(0)-64)},0)-1}function kh(r){for(var t="";r>=0;)t=String.fromCharCode(r%26+97)+t,r=Math.floor(r/26)-1;return t.toUpperCase()}function K5(r,t){var e=t(r);if(e!==void 0)return yL.test(e)?e:(e=e.replace(/'/g,"''"),"'".concat(e,"'"))}function Bu(r,t){var e,n=(e=r[3])!==null&&e!==void 0?e:r[2];return n?(n=n.replace(/''/g,"'"),t(n)):null}var EL=z,RL=Q,bL=Za,SL=ar,AL=eu,TL=RL([].join),OL=bL!=Object,wL=AL("join",",");EL({target:"Array",proto:!0,forced:OL||!wL},{join:function(t){return TL(SL(this),t===void 0?",":t)}});var X5=function(t,e){return{type:t,message:e}},je;(function(r){r.LexingError="LexingError",r.ParserError="ParsingError",r.StaticOffsetError="StaticOffsetError",r.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",r.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(je||(je={}));var b;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.MINUS_UNARY_OP="MINUS_UNARY_OP",r.PLUS_UNARY_OP="PLUS_UNARY_OP",r.PERCENT_OP="PERCENT_OP",r.CONCATENATE_OP="CONCATENATE_OP",r.EQUALS_OP="EQUALS_OP",r.NOT_EQUAL_OP="NOT_EQUAL_OP",r.GREATER_THAN_OP="GREATER_THAN_OP",r.LESS_THAN_OP="LESS_THAN_OP",r.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",r.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",r.PLUS_OP="PLUS_OP",r.MINUS_OP="MINUS_OP",r.TIMES_OP="TIMES_OP",r.DIV_OP="DIV_OP",r.POWER_OP="POWER_OP",r.FUNCTION_CALL="FUNCTION_CALL",r.NAMED_EXPRESSION="NAMED_EXPRESSION",r.PARENTHESIS="PARENTHESES",r.CELL_REFERENCE="CELL_REFERENCE",r.CELL_RANGE="CELL_RANGE",r.COLUMN_RANGE="COLUMN_RANGE",r.ROW_RANGE="ROW_RANGE",r.ERROR="ERROR",r.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",r.ARRAY="ARRAY"})(b||(b={}));var Qt;(function(r){r[r.RELATIVE=0]="RELATIVE",r[r.START_ABSOLUTE=1]="START_ABSOLUTE",r[r.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(Qt||(Qt={}));var NL=function(t){return{type:b.EMPTY,leadingWhitespace:t==null?void 0:t.image}},CL=function(t,e){return{type:b.NUMBER,value:t,leadingWhitespace:e==null?void 0:e.image}},_L=function(t){var e;return{type:b.STRING,value:t.image.slice(1,-1),leadingWhitespace:(e=t.leadingWhitespace)===null||e===void 0?void 0:e.image}},q5=function(t,e){return{type:b.CELL_REFERENCE,reference:t,leadingWhitespace:e==null?void 0:e.image}},Q5=function(t,e,n,a){return Ph(t,e,n),{type:b.CELL_RANGE,start:t,end:e,sheetReferenceType:n,leadingWhitespace:a}},IL=function(t,e,n,a){return Ph(t,e,n),{type:b.COLUMN_RANGE,start:t,end:e,sheetReferenceType:n,leadingWhitespace:a==null?void 0:a.image}},ML=function(t,e,n,a){return Ph(t,e,n),{type:b.ROW_RANGE,start:t,end:e,sheetReferenceType:n,leadingWhitespace:a==null?void 0:a.image}},kL=function(t,e,n){return{type:b.CONCATENATE_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},FL=function(t,e,n){return{type:b.EQUALS_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},PL=function(t,e,n){return{type:b.NOT_EQUAL_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},$L=function(t,e,n){return{type:b.GREATER_THAN_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},DL=function(t,e,n){return{type:b.LESS_THAN_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},LL=function(t,e,n){return{type:b.GREATER_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},UL=function(t,e,n){return{type:b.LESS_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},xL=function(t,e,n){return{type:b.PLUS_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},BL=function(t,e,n){return{type:b.MINUS_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},VL=function(t,e,n){return{type:b.TIMES_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},GL=function(t,e,n){return{type:b.DIV_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},jL=function(t,e,n){return{type:b.POWER_OP,left:t,right:e,leadingWhitespace:n==null?void 0:n.image}},HL=function(t,e){return{type:b.MINUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},WL=function(t,e){return{type:b.PLUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},zL=function(t,e){return{type:b.PERCENT_OP,value:t,leadingWhitespace:e==null?void 0:e.image}},YL=function(t,e,n,a){return{type:b.FUNCTION_CALL,procedureName:t,args:e,leadingWhitespace:n==null?void 0:n.image,internalWhitespace:a==null?void 0:a.image}},Z5=function(t,e,n){return{type:b.ARRAY,args:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:n==null?void 0:n.image}},KL=function(t,e){return{type:b.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:e==null?void 0:e.image}},XL=function(t,e,n){return{type:b.PARENTHESIS,expression:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:n==null?void 0:n.image}},Rr=function(t,e){return{type:b.ERROR,error:t,leadingWhitespace:e==null?void 0:e.image}},Ta=function(t,e,n){return{type:b.ERROR_WITH_RAW_INPUT,error:e,rawInput:t,leadingWhitespace:n==null?void 0:n.image}},Fh=function(){return{type:b.ERROR,error:m.parsingError()}};function Ph(r,t,e){if(r.sheet!==void 0&&t.sheet===void 0||r.sheet===void 0&&t.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(r.sheet===void 0&&e!==Qt.RELATIVE||r.sheet!==void 0&&e===Qt.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function fe(r,t){return(t!=null?t:"")+r}var It;function Zt(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var J5=(It={},Zt(It,b.PLUS_OP,"+"),Zt(It,b.MINUS_OP,"-"),Zt(It,b.TIMES_OP,"*"),Zt(It,b.DIV_OP,"/"),Zt(It,b.CONCATENATE_OP,"&"),Zt(It,b.POWER_OP,"^"),Zt(It,b.EQUALS_OP,"="),Zt(It,b.NOT_EQUAL_OP,"<>"),Zt(It,b.GREATER_THAN_OP,">"),Zt(It,b.GREATER_THAN_OR_EQUAL_OP,">="),Zt(It,b.LESS_THAN_OP,"<"),Zt(It,b.LESS_THAN_OR_EQUAL_OP,"<="),It);function qL(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function eg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function QL(r,t,e){return t&&eg(r.prototype,t),e&&eg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var ZL=function(t,e,n,a){return{ast:t,relativeDependencies:e,hasVolatileFunction:n,hasStructuralChangeFunction:a}},JL=function(){function r(t){qL(this,r),this.functionRegistry=t,this.cache=new Map}return QL(r,[{key:"set",value:function(e,n){var a=xh(n,this.functionRegistry),i=ZL(n,a,tg(n,this.functionRegistry.isFunctionVolatile),tg(n,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}},{key:"get",value:function(e){return this.cache.get(e)}},{key:"maybeSetAndThenGet",value:function(e,n){var a=this.cache.get(e);return a!==void 0?a.ast:(this.set(e,n),n)}}]),r}(),tg=function r(t,e){switch(t.type){case b.EMPTY:case b.NUMBER:case b.STRING:case b.ERROR:case b.ERROR_WITH_RAW_INPUT:case b.CELL_REFERENCE:case b.CELL_RANGE:case b.COLUMN_RANGE:case b.ROW_RANGE:case b.NAMED_EXPRESSION:return!1;case b.PERCENT_OP:case b.PLUS_UNARY_OP:case b.MINUS_UNARY_OP:return r(t.value,e);case b.CONCATENATE_OP:case b.EQUALS_OP:case b.NOT_EQUAL_OP:case b.LESS_THAN_OP:case b.GREATER_THAN_OP:case b.LESS_THAN_OR_EQUAL_OP:case b.GREATER_THAN_OR_EQUAL_OP:case b.MINUS_OP:case b.PLUS_OP:case b.TIMES_OP:case b.DIV_OP:case b.POWER_OP:return r(t.left,e)||r(t.right,e);case b.PARENTHESIS:return r(t.expression,e);case b.FUNCTION_CALL:return e(t.procedureName)?!0:t.args.some(function(n){return r(n,e)});case b.ARRAY:return t.args.some(function(n){return n.some(function(a){return r(a,e)})})}},rg=mf,eU=Math.floor,$h=function(r,t){var e=r.length,n=eU(e/2);return e<8?tU(r,t):rU(r,$h(rg(r,0,n),t),$h(rg(r,n),t),t)},tU=function(r,t){for(var e=r.length,n=1,a,i;n<e;){for(i=n,a=r[n];i&&t(r[i-1],a)>0;)r[i]=r[--i];i!==n++&&(r[i]=a)}return r},rU=function(r,t,e,n){for(var a=t.length,i=e.length,o=0,u=0;o<a||u<i;)r[o+u]=o<a&&u<i?n(t[o],e[u])<=0?t[o++]:e[u++]:o<a?t[o++]:e[u++];return r},nU=$h,aU=Ja,ng=aU.match(/firefox\/(\d+)/i),iU=!!ng&&+ng[1],oU=Ja,uU=/MSIE|Trident/.test(oU),sU=Ja,ag=sU.match(/AppleWebKit\/(\d+)\./),lU=!!ag&&+ag[1],fU=z,ig=Q,cU=ea,hU=At,pU=or,og=ft,Dh=re,dU=nU,vU=eu,ug=iU,yU=uU,sg=ei,lg=lU,pn=[],fg=ig(pn.sort),mU=ig(pn.push),gU=Dh(function(){pn.sort(void 0)}),EU=Dh(function(){pn.sort(null)}),RU=vU("sort"),cg=!Dh(function(){if(sg)return sg<70;if(!(ug&&ug>3)){if(yU)return!0;if(lg)return lg<603;var r="",t,e,n,a;for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)pn.push({k:e+a,v:n})}for(pn.sort(function(i,o){return o.v-i.v}),a=0;a<pn.length;a++)e=pn[a].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return r!=="DGBEFHACIJK"}}),bU=gU||!EU||!RU||!cg,SU=function(r){return function(t,e){return e===void 0?-1:t===void 0?1:r!==void 0?+r(t,e)||0:og(t)>og(e)?1:-1}};fU({target:"Array",proto:!0,forced:bU},{sort:function(t){t!==void 0&&cU(t);var e=hU(this);if(cg)return t===void 0?fg(e):fg(e,t);var n=[],a=pU(e),i,o;for(o=0;o<a;o++)o in e&&mU(n,e[o]);for(dU(n,SU(t)),i=n.length,o=0;o<i;)e[o]=n[o++];for(;o<a;)delete e[o++];return e}});var AU=ze,TU=Math.floor,OU=Number.isInteger||function(t){return!AU(t)&&isFinite(t)&&TU(t)===t},wU=z,NU=OU;wU({target:"Number",stat:!0},{isInteger:NU});var hg=Be,CU=function(r){return r!==void 0&&(hg(r,"value")||hg(r,"writable"))},_U=z,IU=rt,MU=ze,kU=Qe,FU=CU,PU=Ir,$U=Io;function pg(r,t){var e=arguments.length<3?r:arguments[2],n,a;if(kU(r)===e)return r[t];if(n=PU.f(r,t),n)return FU(n)?n.value:n.get===void 0?void 0:IU(n.get,e);if(MU(a=$U(r)))return pg(a,t,e)}_U({target:"Reflect",stat:!0},{get:pg});var DU=z,LU=re,UU=ar,dg=Ir.f,vg=tt,xU=LU(function(){dg(1)}),BU=!vg||xU;DU({target:"Object",stat:!0,forced:BU,sham:!vg},{getOwnPropertyDescriptor:function(t,e){return dg(UU(t),e)}});function yg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function VU(r,t,e){return t&&yg(r.prototype,t),e&&yg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function GU(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var S=VU(function r(){GU(this,r)});S.DistinctSigns="Distinct signs.";S.WrongArgNumber="Wrong number of arguments.";S.EmptyArg="Empty function argument.";S.EmptyArray="Empty array not allowed.";S.ArrayDimensions="Array dimensions are not compatible.";S.NoSpaceForArrayResult="No space for array result.";S.ValueSmall="Value too small.";S.ValueLarge="Value too large.";S.BadCriterion="Incorrect criterion.";S.RangeManySheets="Range spans more than one sheet.";S.CellRangeExpected="Cell range expected.";S.WrongDimension="Wrong range dimension.";S.ScalarExpected="Cell range not allowed.";S.NumberCoercion="Value cannot be coerced to number.";S.NumberExpected="Number argument expected.";S.IntegerExpected="Value needs to be an integer.";S.BadMode="Mode not recognized.";S.DateBounds="Date outside of bounds.";S.OutOfSheet="Resulting reference is out of the sheet.";S.WrongType="Wrong type of argument.";S.NaN="NaN or infinite value encountered.";S.EqualLength="Ranges need to be of equal length.";S.Negative="Value cannot be negative.";S.NotBinary="String does not represent a binary number.";S.NotOctal="String does not represent an octal number.";S.NotHex="String does not represent a hexadecimal number.";S.EndStartPeriod="End period needs to be at least start period.";S.CellRefExpected="Cell reference expected.";S.EmptyRange="Empty range not allowed.";S.BadRef="Address is not correct.";S.NumberRange="Number-only range expected.";S.ValueNotFound="Value not found.";S.ValueBaseLarge="Value in base too large.";S.ValueBaseSmall="Value in base too small.";S.ValueBaseLong="Value in base too long.";S.NegativeLength="Length cannot be negative.";S.PatternNotFound="Pattern not found.";S.OneValue="Needs at least one value.";S.TwoValues="Range needs to contain at least two elements.";S.ThreeValues="Range needs to contain at least three elements.";S.IndexBounds="Index out of bounds.";S.IndexLarge="Index too large.";S.Formula="Expected formula.";S.NegativeCount="Count cannot be negative.";S.ParseError="Parsing error.";S.SheetRef="Sheet does not exist.";S.PeriodLong="Period number cannot exceed life length.";S.InvalidDate="Invalid date.";S.BitshiftLong="Result of bitshift is too long.";S.EmptyString="Empty-string argument not allowed.";S.LengthBounds="Length out of bounds.";S.NegativeTime="Time cannot be negative.";S.NoDefault="No default option.";S.Selector="Selector cannot exceed the number of arguments.";S.StartEndDate="Start date needs to be earlier than end date.";S.IncorrectDateTime="String does not represent correct DateTime.";S.CharacterCodeBounds="Character code out of bounds.";S.NonZero="Argument cannot be 0.";S.LessThanOne="Argument cannot be less than 1.";S.WeekendString="Incorrect weekend bitmask string.";S.InvalidRoman="Invalid roman numeral.";S.WrongOrder="Wrong order of values.";S.ComplexNumberExpected="Complex number expected.";S.ShouldBeIorJ="Should be 'i' or 'j'.";S.SizeMismatch="Array dimensions mismatched.";S.FunctionName=function(r){return"Function name ".concat(r," not recognized.")};S.NamedExpressionName=function(r){return"Named expression ".concat(r," not recognized.")};S.LicenseKey=function(r){return"License key is ".concat(r,".")};function Lh(r){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(r)}function Ur(r,t){return zU(r)||WU(r,t)||HU(r,t)||jU()}function jU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HU(r,t){if(!!r){if(typeof r=="string")return mg(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mg(r,t)}}function mg(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function WU(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function zU(r){if(Array.isArray(r))return r}function gg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Eg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Rg(r,t,e){return t&&Eg(r.prototype,t),e&&Eg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Vu(){return typeof Reflect!="undefined"&&Reflect.get?Vu=Reflect.get:Vu=function(t,e,n){var a=YU(t,e);if(!!a){var i=Object.getOwnPropertyDescriptor(a,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vu.apply(this,arguments)}function YU(r,t){for(;!Object.prototype.hasOwnProperty.call(r,t)&&(r=Oa(r),r!==null););return r}function KU(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Uh(r,t)}function Uh(r,t){return Uh=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Uh(r,t)}function XU(r){var t=ZU();return function(){var n=Oa(r),a;if(t){var i=Oa(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return qU(this,a)}}function qU(r,t){if(t&&(Lh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QU(r)}function QU(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ZU(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oa(r){return Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Oa(r)}var JU=function(r){KU(e,r);var t=XU(e);function e(n,a){var i;return gg(this,e),i=t.call(this,n.allTokens,{outputCst:!1,maxLookahead:7}),i.booleanExpressionOrEmpty=i.RULE("booleanExpressionOrEmpty",function(){return i.OR([{ALT:function(){return i.SUBRULE(i.booleanExpression)}},{ALT:JD(NL())}])}),i.procedureExpression=i.RULE("procedureExpression",function(){var o,u=i.CONSUME(Ch),s=u.image.toUpperCase().slice(0,-1),l=(o=i.lexerConfig.functionMapping[s])!==null&&o!==void 0?o:s,f=[],c=i.SUBRULE(i.booleanExpressionOrEmpty);i.MANY(function(){var p,y=i.CONSUME(i.lexerConfig.ArgSeparator);c.type===b.EMPTY&&(c.leadingWhitespace=(p=y.leadingWhitespace)===null||p===void 0?void 0:p.image),f.push(c),c=i.SUBRULE2(i.booleanExpressionOrEmpty)}),f.push(c),f.length===1&&f[0].type===b.EMPTY&&(f.length=0);var h=i.CONSUME(Du);return YL(l,f,u.leadingWhitespace,h.leadingWhitespace)}),i.namedExpressionExpression=i.RULE("namedExpressionExpression",function(){var o=i.CONSUME(j5);return KL(o.image,o.leadingWhitespace)}),i.offsetProcedureExpression=i.RULE("offsetProcedureExpression",function(){var o=[];return i.CONSUME(i.lexerConfig.OffsetProcedureName),i.CONSUME(Nh),i.MANY_SEP({SEP:i.lexerConfig.ArgSeparator,DEF:function(){o.push(i.SUBRULE(i.booleanExpression))}}),i.CONSUME(Du),i.handleOffsetHeuristic(o)}),i.columnRangeExpression=i.RULE("columnRangeExpression",function(){var o=i.CONSUME(Oh),u=o.image.split(":"),s=Ur(u,2),l=s[0],f=s[1],c=i.ACTION(function(){return Lu(i.sheetMapping,l,i.formulaAddress)}),h=i.ACTION(function(){return Lu(i.sheetMapping,f,i.formulaAddress)});if(c===void 0||h===void 0)return Rr(new m(E.REF));if(c.exceedsSheetSizeLimits(i.lexerConfig.maxColumns)||h.exceedsSheetSizeLimits(i.lexerConfig.maxColumns))return Ta(o.image,new m(E.NAME),o.leadingWhitespace);if(c.sheet===void 0&&h.sheet!==void 0)return i.parsingError(je.ParserError,"Malformed range expression");var p=e.fixSheetIdsForRangeEnds(c,h),y=p.firstEnd,v=p.secondEnd,R=p.sheetRefType,g=i.orderColumnRangeEnds(y,v),A=g.start,T=g.end;return IL(A,T,R,o.leadingWhitespace)}),i.rowRangeExpression=i.RULE("rowRangeExpression",function(){var o=i.CONSUME(wh),u=o.image.split(":"),s=Ur(u,2),l=s[0],f=s[1],c=i.ACTION(function(){return Uu(i.sheetMapping,l,i.formulaAddress)}),h=i.ACTION(function(){return Uu(i.sheetMapping,f,i.formulaAddress)});if(c===void 0||h===void 0)return Rr(new m(E.REF));if(c.exceedsSheetSizeLimits(i.lexerConfig.maxRows)||h.exceedsSheetSizeLimits(i.lexerConfig.maxRows))return Ta(o.image,new m(E.NAME),o.leadingWhitespace);if(c.sheet===void 0&&h.sheet!==void 0)return i.parsingError(je.ParserError,"Malformed range expression");var p=e.fixSheetIdsForRangeEnds(c,h),y=p.firstEnd,v=p.secondEnd,R=p.sheetRefType,g=i.orderRowRangeEnds(y,v),A=g.start,T=g.end;return ML(A,T,R,o.leadingWhitespace)}),i.cellReference=i.RULE("cellReference",function(){var o=i.CONSUME(hn),u=i.ACTION(function(){return Aa(i.sheetMapping,o.image,i.formulaAddress)});return u===void 0?Ta(o.image,new m(E.REF),o.leadingWhitespace):u.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?Ta(o.image,new m(E.NAME),o.leadingWhitespace):q5(u,o.leadingWhitespace)}),i.endRangeReference=i.RULE("endRangeReference",function(o){var u,s=i.CONSUME(hn),l=i.ACTION(function(){return Aa(i.sheetMapping,o.image,i.formulaAddress)}),f=i.ACTION(function(){return Aa(i.sheetMapping,s.image,i.formulaAddress)});return l===void 0||f===void 0?i.ACTION(function(){return Ta("".concat(o.image,":").concat(s.image),new m(E.REF),o.leadingWhitespace)}):l.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)||f.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?i.ACTION(function(){return Ta("".concat(o.image,":").concat(s.image),new m(E.NAME),o.leadingWhitespace)}):i.buildCellRange(l,f,(u=o.leadingWhitespace)===null||u===void 0?void 0:u.image)}),i.endOfRangeExpression=i.RULE("endOfRangeExpression",function(o){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeReference,{ARGS:[o]})}},{ALT:function(){var s,l=i.SUBRULE(i.offsetProcedureExpression),f=i.ACTION(function(){return Aa(i.sheetMapping,o.image,i.formulaAddress)});return f===void 0?Rr(new m(E.REF)):l.type===b.CELL_REFERENCE?i.buildCellRange(f,l.reference,(s=o.leadingWhitespace)===null||s===void 0?void 0:s.image):i.parsingError(je.RangeOffsetNotAllowed,"Range offset not allowed here")}}])}),i.cellRangeExpression=i.RULE("cellRangeExpression",function(){var o=i.CONSUME(hn);return i.CONSUME2(Yi),i.SUBRULE(i.endOfRangeExpression,{ARGS:[o]})}),i.endRangeWithOffsetStartReference=i.RULE("endRangeWithOffsetStartReference",function(o){var u=i.CONSUME(hn),s=i.ACTION(function(){return Aa(i.sheetMapping,u.image,i.formulaAddress)});return s===void 0?i.ACTION(function(){return Rr(new m(E.REF))}):i.buildCellRange(o.reference,s,o.leadingWhitespace)}),i.endOfRangeWithOffsetStartExpression=i.RULE("endOfRangeWithOffsetStartExpression",function(o){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeWithOffsetStartReference,{ARGS:[o]})}},{ALT:function(){var s=i.SUBRULE(i.offsetProcedureExpression);return s.type===b.CELL_REFERENCE?i.buildCellRange(o.reference,s.reference,o.leadingWhitespace):i.parsingError(je.RangeOffsetNotAllowed,"Range offset not allowed here")}}])}),i.offsetExpression=i.RULE("offsetExpression",function(){var o=i.SUBRULE(i.offsetProcedureExpression),u;return i.OPTION(function(){i.CONSUME(Yi),o.type===b.CELL_RANGE?u=i.parsingError(je.RangeOffsetNotAllowed,"Range offset not allowed here"):u=i.SUBRULE(i.endOfRangeWithOffsetStartExpression,{ARGS:[o]})}),u!==void 0?u:o}),i.insideArrayExpression=i.RULE("insideArrayExpression",function(){var o=[[]];return o[o.length-1].push(i.SUBRULE(i.booleanExpression)),i.MANY(function(){i.OR([{ALT:function(){i.CONSUME(i.lexerConfig.ArrayColSeparator),o[o.length-1].push(i.SUBRULE2(i.booleanExpression))}},{ALT:function(){i.CONSUME(i.lexerConfig.ArrayRowSeparator),o.push([]),o[o.length-1].push(i.SUBRULE3(i.booleanExpression))}}])}),Z5(o)}),i.parenthesisExpression=i.RULE("parenthesisExpression",function(){var o=i.CONSUME(Nh),u=i.SUBRULE(i.booleanExpression),s=i.CONSUME(Du);return XL(u,o.leadingWhitespace,s.leadingWhitespace)}),i.arrayExpression=i.RULE("arrayExpression",function(){return i.OR([{ALT:function(){var u=i.CONSUME(V5),s=i.SUBRULE(i.insideArrayExpression),l=i.CONSUME(G5);return Z5(s.args,u.leadingWhitespace,l.leadingWhitespace)}},{ALT:function(){return i.SUBRULE(i.parenthesisExpression)}}])}),i.numericStringToNumber=function(o){var u=o.replace(i.lexerConfig.decimalSeparator,".");return Number(u)},i.positiveAtomicExpression=i.RULE("positiveAtomicExpression",function(){var o;return i.OR((o=i.atomicExpCache)!==null&&o!==void 0?o:i.atomicExpCache=[{ALT:function(){return i.SUBRULE(i.arrayExpression)}},{ALT:function(){return i.SUBRULE(i.cellRangeExpression)}},{ALT:function(){return i.SUBRULE(i.columnRangeExpression)}},{ALT:function(){return i.SUBRULE(i.rowRangeExpression)}},{ALT:function(){return i.SUBRULE(i.offsetExpression)}},{ALT:function(){return i.SUBRULE(i.cellReference)}},{ALT:function(){return i.SUBRULE(i.procedureExpression)}},{ALT:function(){return i.SUBRULE(i.namedExpressionExpression)}},{ALT:function(){var s=i.CONSUME(i.lexerConfig.NumberLiteral);return CL(i.numericStringToNumber(s.image),s.leadingWhitespace)}},{ALT:function(){var s=i.CONSUME(H5);return _L(s)}},{ALT:function(){var s=i.CONSUME(W5),l=s.image.toUpperCase(),f=i.lexerConfig.errorMapping[l];return f?Rr(new m(f),s.leadingWhitespace):i.parsingError(je.ParserError,"Unknown error literal")}}])}),i.rightUnaryOpAtomicExpression=i.RULE("rightUnaryOpAtomicExpression",function(){var o=i.SUBRULE(i.positiveAtomicExpression),u=i.OPTION(function(){return i.CONSUME(F5)});return u?zL(o,u.leadingWhitespace):o}),i.atomicExpression=i.RULE("atomicExpression",function(){return i.OR([{ALT:function(){var u=i.CONSUME(zi),s=i.SUBRULE(i.atomicExpression);return Se(u,bh)?WL(s,u.leadingWhitespace):Se(u,Sh)?HL(s,u.leadingWhitespace):(i.customParsingError=X5(je.ParserError,"Mismatched token type"),i.customParsingError)}},{ALT:function(){return i.SUBRULE2(i.rightUnaryOpAtomicExpression)}}])}),i.powerExpression=i.RULE("powerExpression",function(){var o=i.SUBRULE(i.atomicExpression);return i.MANY(function(){var u=i.CONSUME(Ah),s=i.SUBRULE2(i.atomicExpression);Se(u,Ah)?o=jL(o,s,u.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),o}),i.multiplicationExpression=i.RULE("multiplicationExpression",function(){var o=i.SUBRULE(i.powerExpression);return i.MANY(function(){var u=i.CONSUME($u),s=i.SUBRULE2(i.powerExpression);Se(u,M5)?o=VL(o,s,u.leadingWhitespace):Se(u,k5)?o=GL(o,s,u.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),o}),i.additionExpression=i.RULE("additionExpression",function(){var o=i.SUBRULE(i.multiplicationExpression);return i.MANY(function(){var u=i.CONSUME(zi),s=i.SUBRULE2(i.multiplicationExpression);Se(u,bh)?o=xL(o,s,u.leadingWhitespace):Se(u,Sh)?o=BL(o,s,u.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),o}),i.concatenateExpression=i.RULE("concatenateExpression",function(){var o=i.SUBRULE(i.additionExpression);return i.MANY(function(){var u=i.CONSUME(x5),s=i.SUBRULE2(i.additionExpression);o=kL(o,s,u.leadingWhitespace)}),o}),i.booleanExpression=i.RULE("booleanExpression",function(){var o=i.SUBRULE(i.concatenateExpression);return i.MANY(function(){var u=i.CONSUME(fn),s=i.SUBRULE2(i.concatenateExpression);Se(u,Th)?o=FL(o,s,u.leadingWhitespace):Se(u,P5)?o=PL(o,s,u.leadingWhitespace):Se(u,$5)?o=$L(o,s,u.leadingWhitespace):Se(u,D5)?o=DL(o,s,u.leadingWhitespace):Se(u,L5)?o=LL(o,s,u.leadingWhitespace):Se(u,U5)?o=UL(o,s,u.leadingWhitespace):i.ACTION(function(){throw Error("Operator not supported")})}),o}),i.formula=i.RULE("formula",function(){return i.CONSUME(Th),i.SUBRULE(i.booleanExpression)}),i.lexerConfig=n,i.sheetMapping=a,i.formulaAddress=P(0,0,0),i.performSelfAnalysis(),i}return Rg(e,[{key:"parseFromTokens",value:function(a,i){this.input=a;var o=this.formulaWithContext(i),u=[];return this.customParsingError&&u.push(this.customParsingError),u=u.concat(this.errors.map(function(s){return{type:je.ParserError,message:s.message}})),u.length>0&&(o=Fh()),{ast:o,errors:u}}},{key:"reset",value:function(){Vu(Oa(e.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"formulaWithContext",value:function(a){return this.formulaAddress=a,this.formula()}},{key:"buildCellRange",value:function(a,i,o){if(a.sheet===void 0&&i.sheet!==void 0)return this.parsingError(je.ParserError,"Malformed range expression");var u=e.fixSheetIdsForRangeEnds(a,i),s=u.firstEnd,l=u.secondEnd,f=u.sheetRefType,c=this.orderCellRangeEnds(s,l),h=c.start,p=c.end;return Q5(h,p,f,o)}},{key:"orderCellRangeEnds",value:function(a,i){var o=[a,i],u=o.map(function(T){return T.toColumnAddress()}).sort(Dn.compareByAbsoluteAddress(this.formulaAddress)),s=Ur(u,2),l=s[0],f=s[1],c=o.map(function(T){return T.toRowAddress()}).sort(on.compareByAbsoluteAddress(this.formulaAddress)),h=Ur(c,2),p=h[0],y=h[1],v=o.map(function(T){return T.sheet}).sort(e.compareSheetIds.bind(this)),R=Ur(v,2),g=R[0],A=R[1];return{start:Ut.fromColAndRow(l,p,g),end:Ut.fromColAndRow(f,y,A)}}},{key:"orderColumnRangeEnds",value:function(a,i){var o=[a,i],u=o.sort(Dn.compareByAbsoluteAddress(this.formulaAddress)),s=Ur(u,2),l=s[0],f=s[1],c=o.map(function(v){return v.sheet}).sort(e.compareSheetIds.bind(this)),h=Ur(c,2),p=h[0],y=h[1];return{start:new Dn(l.type,l.col,p),end:new Dn(f.type,f.col,y)}}},{key:"orderRowRangeEnds",value:function(a,i){var o=[a,i],u=o.sort(on.compareByAbsoluteAddress(this.formulaAddress)),s=Ur(u,2),l=s[0],f=s[1],c=o.map(function(v){return v.sheet}).sort(e.compareSheetIds.bind(this)),h=Ur(c,2),p=h[0],y=h[1];return{start:new on(l.type,l.row,p),end:new on(f.type,f.row,y)}}},{key:"handleOffsetHeuristic",value:function(a){var i=a[0];if(i.type!==b.CELL_REFERENCE)return this.parsingError(je.StaticOffsetError,"First argument to OFFSET is not a reference");var o=a[1],u;if(o.type===b.NUMBER&&Number.isInteger(o.value))u=o.value;else if(o.type===b.PLUS_UNARY_OP&&o.value.type===b.NUMBER&&Number.isInteger(o.value.value))u=o.value.value;else if(o.type===b.MINUS_UNARY_OP&&o.value.type===b.NUMBER&&Number.isInteger(o.value.value))u=-o.value.value;else return this.parsingError(je.StaticOffsetError,"Second argument to OFFSET is not a static number");var s=a[2],l;if(s.type===b.NUMBER&&Number.isInteger(s.value))l=s.value;else if(s.type===b.PLUS_UNARY_OP&&s.value.type===b.NUMBER&&Number.isInteger(s.value.value))l=s.value.value;else if(s.type===b.MINUS_UNARY_OP&&s.value.type===b.NUMBER&&Number.isInteger(s.value.value))l=-s.value.value;else return this.parsingError(je.StaticOffsetError,"Third argument to OFFSET is not a static number");var f=a[3],c;if(f===void 0)c=1;else if(f.type===b.NUMBER){if(c=f.value,c<1)return this.parsingError(je.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(je.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(je.StaticOffsetError,"Fourth argument to OFFSET is not a static number");var h=a[4],p;if(h===void 0)p=1;else if(h.type===b.NUMBER){if(p=h.value,p<1)return this.parsingError(je.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(p))return this.parsingError(je.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(je.StaticOffsetError,"Fifth argument to OFFSET is not a static number");var y=new Ut(i.reference.col+l,i.reference.row+u,i.reference.type),v=y.col,R=y.row;if((i.reference.type===be.CELL_REFERENCE_RELATIVE||i.reference.type===be.CELL_REFERENCE_ABSOLUTE_COL)&&(R=R+this.formulaAddress.row),(i.reference.type===be.CELL_REFERENCE_RELATIVE||i.reference.type===be.CELL_REFERENCE_ABSOLUTE_ROW)&&(v=v+this.formulaAddress.col),v<0||R<0)return Rr(new m(E.REF,S.OutOfSheet));if(p===1&&c===1)return q5(y);var g=new Ut(y.col+p-1,y.row+c-1,y.type);return Q5(y,g,Qt.RELATIVE)}},{key:"parsingError",value:function(a,i){return this.customParsingError=X5(a,i),Fh()}}],[{key:"fixSheetIdsForRangeEnds",value:function(a,i){var o=e.rangeSheetReferenceType(a.sheet,i.sheet),u=a.sheet!==void 0&&i.sheet===void 0?i.withSheet(a.sheet):i;return{firstEnd:a,secondEnd:u,sheetRefType:o}}},{key:"compareSheetIds",value:function(a,i){return a=a!=null?a:1/0,i=i!=null?i:1/0,a-i}},{key:"rangeSheetReferenceType",value:function(a,i){return a===void 0?Qt.RELATIVE:i===void 0?Qt.START_ABSOLUTE:Qt.BOTH_ABSOLUTE}}]),e}(eL),ex=function(){function r(t){gg(this,r),this.lexerConfig=t,this.lexer=new Nt(t.allTokens,{ensureOptimizations:!0})}return Rg(r,[{key:"tokenizeFormula",value:function(e){var n=this.lexer.tokenize(e),a=n.tokens;return a=this.trimTrailingWhitespaces(a),a=this.skipWhitespacesInsideRanges(a),a=this.skipWhitespacesBeforeArgSeparators(a),n.tokens=a,n}},{key:"skipWhitespacesInsideRanges",value:function(e){var n=this;return r.filterTokensByNeighbors(e,function(a,i,o){return(Se(a,hn)||Se(a,Yi))&&Se(i,n.lexerConfig.WhiteSpace)&&(Se(o,hn)||Se(o,Yi))})}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var n=this;return r.filterTokensByNeighbors(e,function(a,i,o){return!Se(a,n.lexerConfig.ArgSeparator)&&Se(i,n.lexerConfig.WhiteSpace)&&Se(o,n.lexerConfig.ArgSeparator)})}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&Se(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}],[{key:"filterTokensByNeighbors",value:function(e,n){if(e.length<3)return e;for(var a=0,i=[e[a++]];a<e.length-1;)n(e[a-1],e[a],e[a+1])||i.push(e[a]),++a;return i.push(e[a]),i}}]),r}();function tx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function rx(r,t,e){return t&&bg(r.prototype,t),e&&bg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Sg=function(){function r(t,e,n,a){tx(this,r),this.config=t,this.lexerConfig=e,this.sheetMappingFn=n,this.namedExpressions=a}return rx(r,[{key:"unparse",value:function(e,n){return"="+this.unparseAst(e,n)}},{key:"unparseAst",value:function(e,n){var a=this,i,o;switch(e.type){case b.EMPTY:return fe("",e.leadingWhitespace);case b.NUMBER:return fe(Ag(e.value,this.config.decimalSeparator),e.leadingWhitespace);case b.STRING:return fe('"'+e.value+'"',e.leadingWhitespace);case b.FUNCTION_CALL:{var u=e.args.map(function(N){return N!==void 0?a.unparseAst(N,n):""}).join(this.config.functionArgSeparator),s=this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName,l=s+"("+u+fe(")",e.internalWhitespace);return fe(l,e.leadingWhitespace)}case b.NAMED_EXPRESSION:{var f=(i=this.namedExpressions.nearestNamedExpression(e.expressionName,n.sheet))===null||i===void 0?void 0:i.displayName;return fe(f||e.expressionName,e.leadingWhitespace)}case b.CELL_REFERENCE:{var c;return e.reference.sheet!==void 0?c=this.unparseSheetName(e.reference.sheet)+"!":c="",c+=(o=e.reference.unparse(n))!==null&&o!==void 0?o:this.config.translationPackage.getErrorTranslation(E.REF),fe(c,e.leadingWhitespace)}case b.COLUMN_RANGE:case b.ROW_RANGE:case b.CELL_RANGE:return fe(this.formatRange(e,n),e.leadingWhitespace);case b.PLUS_UNARY_OP:{var h=this.unparseAst(e.value,n);return fe("+",e.leadingWhitespace)+h}case b.MINUS_UNARY_OP:{var p=this.unparseAst(e.value,n);return fe("-",e.leadingWhitespace)+p}case b.PERCENT_OP:return this.unparseAst(e.value,n)+fe("%",e.leadingWhitespace);case b.ERROR:{var y=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:E.ERROR);return fe(y,e.leadingWhitespace)}case b.ERROR_WITH_RAW_INPUT:return fe(e.rawInput,e.leadingWhitespace);case b.PARENTHESIS:{var v=this.unparseAst(e.expression,n),R="("+v+fe(")",e.internalWhitespace);return fe(R,e.leadingWhitespace)}case b.ARRAY:{var g="{"+e.args.map(function(N){return N.map(function(M){return a.unparseAst(M,n)}).join(a.config.arrayColumnSeparator)}).join(this.config.arrayRowSeparator)+fe("}",e.internalWhitespace);return fe(g,e.leadingWhitespace)}default:{var A=this.unparseAst(e.left,n),T=this.unparseAst(e.right,n);return A+fe(J5[e.type],e.leadingWhitespace)+T}}}},{key:"unparseSheetName",value:function(e){var n=K5(e,this.sheetMappingFn);if(n===void 0)throw new Me(e);return n}},{key:"formatRange",value:function(e,n){var a="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==Qt.RELATIVE&&(a=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===Qt.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");var o=e.start.unparse(n),u=e.end.unparse(n);return o===void 0||u===void 0?this.config.translationPackage.getErrorTranslation(E.REF):"".concat(a).concat(o,":").concat(i).concat(u)}}]),r}();function Ag(r,t){var e=r.toString();return e.replace(".",t)}function Tg(r,t){return ox(r)||ix(r,t)||ax(r,t)||nx()}function nx(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ax(r,t){if(!!r){if(typeof r=="string")return Og(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Og(r,t)}}function Og(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function ix(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function ox(r){if(Array.isArray(r))return r}function ux(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function wg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function sx(r,t,e){return t&&wg(r.prototype,t),e&&wg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var lx=function(){function r(t,e,n){ux(this,r),this.config=t,this.functionRegistry=e,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=_h(t),this.lexer=new ex(this.lexerConfig),this.formulaParser=new JU(this.lexerConfig,this.sheetMapping),this.cache=new JL(this.functionRegistry)}return sx(r,[{key:"parse",value:function(e,n){var a=this.tokenizeFormula(e);if(a.errors.length>0){var i=a.errors.map(function(v){return{type:je.LexingError,message:v.message}});return{ast:Fh(),errors:i,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var o=this.computeHashFromTokens(a.tokens,n),u=this.cache.get(o);if(u!==void 0)++this.statsCacheUsed;else{var s=this.bindWhitespacesToTokens(a.tokens),l=this.formulaParser.parseFromTokens(s,n);if(l.errors.length>0)return Object.assign(Object.assign({},l),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});u=this.cache.set(o,l.ast)}var f=u,c=f.ast,h=f.hasVolatileFunction,p=f.hasStructuralChangeFunction,y=f.relativeDependencies;return{ast:c,errors:[],hasVolatileFunction:h,hasStructuralChangeFunction:p,dependencies:y}}},{key:"fetchCachedResultForAst",value:function(e){var n=this.computeHashFromAst(e);return this.fetchCachedResult(n)}},{key:"fetchCachedResult",value:function(e){var n=this.cache.get(e);if(n===void 0)throw new Error("There is no AST with such key in the cache");var a=n.ast,i=n.hasVolatileFunction,o=n.hasStructuralChangeFunction,u=n.relativeDependencies;return{ast:a,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:u}}},{key:"computeHashFromTokens",value:function(e,n){for(var a,i="",o=0;o<e.length;){var u=e[o];if(Se(u,hn)){var s=Aa(this.sheetMapping,u.image,n);s===void 0?i=i.concat(u.image):i=i.concat(s.hash(!0))}else if(Se(u,Ch)){var l=u.image.toUpperCase().slice(0,-1),f=(a=this.lexerConfig.functionMapping[l])!==null&&a!==void 0?a:l;i=i.concat(f,"(")}else if(Se(u,Oh)){var c=u.image.split(":"),h=Tg(c,2),p=h[0],y=h[1],v=Lu(this.sheetMapping,p,n),R=Lu(this.sheetMapping,y,n);v===void 0||R===void 0?i=i.concat("!REF"):i=i.concat(v.hash(!0),":",R.hash(!0))}else if(Se(u,wh)){var g=u.image.split(":"),A=Tg(g,2),T=A[0],N=A[1],M=Uu(this.sheetMapping,T,n),_=Uu(this.sheetMapping,N,n);M===void 0||_===void 0?i=i.concat("!REF"):i=i.concat(M.hash(!0),":",_.hash(!0))}else i=i.concat(u.image);o++}return i}},{key:"rememberNewAst",value:function(e){var n=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(n,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"computeHashOfAstNode",value:function(e){var n=this;switch(e.type){case b.EMPTY:return e.leadingWhitespace||"";case b.NUMBER:return fe(Ag(e.value,this.config.decimalSeparator),e.leadingWhitespace);case b.STRING:return fe('"'+e.value+'"',e.leadingWhitespace);case b.NAMED_EXPRESSION:return fe(e.expressionName,e.leadingWhitespace);case b.FUNCTION_CALL:{var a=e.args.map(function(h){return n.computeHashOfAstNode(h)}).join(this.config.functionArgSeparator),i=e.procedureName+"("+a+fe(")",e.internalWhitespace);return fe(i,e.leadingWhitespace)}case b.CELL_REFERENCE:return fe(e.reference.hash(!0),e.leadingWhitespace);case b.COLUMN_RANGE:case b.ROW_RANGE:case b.CELL_RANGE:{var o=e.start.hash(e.sheetReferenceType!==Qt.RELATIVE),u=e.end.hash(e.sheetReferenceType===Qt.BOTH_ABSOLUTE);return fe(o+":"+u,e.leadingWhitespace)}case b.MINUS_UNARY_OP:return fe("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case b.PLUS_UNARY_OP:return fe("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case b.PERCENT_OP:return this.computeHashOfAstNode(e.value)+fe("%",e.leadingWhitespace);case b.ERROR:{var s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:E.ERROR);return fe(s,e.leadingWhitespace)}case b.ERROR_WITH_RAW_INPUT:return fe(e.rawInput,e.leadingWhitespace);case b.ARRAY:{var l=e.args.map(function(h){return h.map(function(p){return n.computeHashOfAstNode(p)}).join(",")}).join(";");return fe("{"+l+fe("}",e.internalWhitespace),e.leadingWhitespace)}case b.PARENTHESIS:{var f=this.computeHashOfAstNode(e.expression),c="("+f+fe(")",e.internalWhitespace);return fe(c,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+fe(J5[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}},{key:"bindWhitespacesToTokens",value:function(e){var n=[],a=e[0];Se(a,this.lexerConfig.WhiteSpace)||n.push(a);for(var i=1;i<e.length;++i){var o=e[i];if(!Se(o,this.lexerConfig.WhiteSpace)){var u=e[i-1];Se(u,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=u),n.push(o)}}return n}},{key:"tokenizeFormula",value:function(e){return this.lexer.tokenizeFormula(e)}}]),r}(),fx=function r(t,e,n,a){switch(t.type){case b.EMPTY:case b.NUMBER:case b.STRING:case b.ERROR:return;case b.NAMED_EXPRESSION:{a&&n.push(new dn(t.expressionName));return}case b.CELL_REFERENCE:{a&&n.push(new Cg(t.reference));return}case b.CELL_RANGE:{a&&t.start.sheet===t.end.sheet&&n.push(new cx(t.start,t.end));return}case b.COLUMN_RANGE:{a&&t.start.sheet===t.end.sheet&&n.push(new hx(t.start,t.end));return}case b.ROW_RANGE:{a&&t.start.sheet===t.end.sheet&&n.push(new px(t.start,t.end));return}case b.PERCENT_OP:case b.PLUS_UNARY_OP:case b.MINUS_UNARY_OP:{r(t.value,e,n,!0);return}case b.CONCATENATE_OP:case b.EQUALS_OP:case b.NOT_EQUAL_OP:case b.LESS_THAN_OP:case b.GREATER_THAN_OP:case b.LESS_THAN_OR_EQUAL_OP:case b.GREATER_THAN_OR_EQUAL_OP:case b.MINUS_OP:case b.PLUS_OP:case b.TIMES_OP:case b.DIV_OP:case b.POWER_OP:r(t.left,e,n,!0),r(t.right,e,n,!0);return;case b.PARENTHESIS:r(t.expression,e,n,a);return;case b.FUNCTION_CALL:{var i=!e.doesFunctionNeedArgumentToBeComputed(t.procedureName);t.args.forEach(function(o){return r(o,e,n,i)});return}}},xh=function(t,e){var n=new Array;return fx(t,e,n,!0),n};function Ki(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Ng(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Xi(r,t,e){return t&&Ng(r.prototype,t),e&&Ng(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Cg=function(){function r(t){Ki(this,r),this.dependency=t}return Xi(r,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),r}(),cx=function(){function r(t,e){Ki(this,r),this.start=t,this.end=e}return Xi(r,[{key:"absolutize",value:function(e){return new Y(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),r}(),hx=function(){function r(t,e){Ki(this,r),this.start=t,this.end=e}return Xi(r,[{key:"absolutize",value:function(e){var n=this.start.toSimpleColumnAddress(e),a=this.end.toSimpleColumnAddress(e);return new Hu(n.sheet,n.col,a.col)}}]),r}(),px=function(){function r(t,e){Ki(this,r),this.start=t,this.end=e}return Xi(r,[{key:"absolutize",value:function(e){var n=this.start.toSimpleRowAddress(e),a=this.end.toSimpleRowAddress(e);return new Wu(n.sheet,n.row,a.row)}}]),r}(),dn=function(){function r(t){Ki(this,r),this.name=t}return Xi(r,[{key:"absolutize",value:function(e){return this}}]),r}();function _g(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Ig(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Mg(r,t,e){return t&&Ig(r.prototype,t),e&&Ig(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var xr=function(){function r(t,e,n){if(_g(this,r),this.sheet=t,this.rowStart=e,this.rowEnd=n,e<0)throw Error("Starting row cant be less than 0");if(n<e)throw Error("Row span cant end before start")}return Mg(r,[{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}},{key:"rows",value:regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=this.rowStart;case 1:if(!(e<=this.rowEnd)){a.next=7;break}return a.next=4,e;case 4:++e,a.next=1;break;case 7:case"end":return a.stop()}},t,this)})},{key:"intersect",value:function(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.rowStart,e.rowStart),a=Math.min(this.rowEnd,e.rowEnd);return n>a?null:new r(this.sheet,n,a)}},{key:"firstRow",value:function(){return new r(this.sheet,this.rowStart,this.rowStart)}}],[{key:"fromNumberOfRows",value:function(e,n,a){return new r(e,n,n+a-1)}},{key:"fromRowStartAndEnd",value:function(e,n,a){return new r(e,n,a)}}]),r}(),vn=function(){function r(t,e,n){if(_g(this,r),this.sheet=t,this.columnStart=e,this.columnEnd=n,e<0)throw Error("Starting column cant be less than 0");if(n<e)throw Error("Column span cant end before start")}return Mg(r,[{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}},{key:"columns",value:regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=this.columnStart;case 1:if(!(e<=this.columnEnd)){a.next=7;break}return a.next=4,e;case 4:++e,a.next=1;break;case 7:case"end":return a.stop()}},t,this)})},{key:"intersect",value:function(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.columnStart,e.columnStart),a=Math.min(this.columnEnd,e.columnEnd);return n>a?null:new r(this.sheet,n,a)}},{key:"firstColumn",value:function(){return new r(this.sheet,this.columnStart,this.columnStart)}}],[{key:"fromNumberOfColumns",value:function(e,n,a){return new r(e,n,n+a-1)}},{key:"fromColumnStartAndEnd",value:function(e,n,a){return new r(e,n,a)}}]),r}();function kg(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Bh(r,t)}function Bh(r,t){return Bh=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Bh(r,t)}function Fg(r){var t=yx();return function(){var n=Gu(r),a;if(t){var i=Gu(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return dx(this,a)}}function dx(r,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vx(r)}function vx(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function yx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(r){return Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gu(r)}function Vh(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Pg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Gh(r,t,e){return t&&Pg(r.prototype,t),e&&Pg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ju(r){return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(r)}var mx="AbsoluteCellRange: Wrong range size";function Gt(r){return r&&(ju(r)==="object"||typeof r=="function")?"start"in r&&He(r.start)&&"end"in r&&He(r.end):!1}var jh=function(t,e){return{start:t,end:e}},Y=function(){function r(t,e){if(Vh(this,r),t.sheet!==e.sheet)throw new uu(t.sheet,e.sheet);this.start=P(t.sheet,t.col,t.row),this.end=P(e.sheet,e.col,e.row)}return Gh(r,[{key:"sheet",get:function(){return this.start.sheet}},{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}},{key:"addressInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"columnInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}},{key:"rowInRange",value:function(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(e){if(this.sheet===e.start.sheet){var n=Math.max(this.start.row,e.start.row),a=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(n>a||i>o))return new r(P(this.sheet,i,n),P(this.sheet,o,a))}}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(e,n){return r.spanFrom(P(this.sheet,this.start.col+e,this.start.row+n),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof xr?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(e,n){return r.spanFrom(P(this.sheet,this.start.col,e),this.width(),n)}},{key:"rangeWithSameHeight",value:function(e,n){return r.spanFrom(P(this.sheet,e,this.start.row),n,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],n=0;n<this.height();++n){e[n]=[];for(var a=0;a<this.width();++a){var i=P(this.sheet,this.start.col+a,this.start.row+n);e[n].push(i)}}return e}},{key:"withStart",value:function(e){return new r(e,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"sameAs",value:function(e){return ro(this.start,e.start)&&ro(this.end,e.end)}},{key:"addressesArrayMap",value:function(e,n){for(var a=[],i=this.start.row;i<=this.effectiveEndRow(e);){for(var o=this.start.col,u=[];o<=this.effectiveEndColumn(e);)u.push(n(P(this.start.sheet,o,i))),o++;a.push(u),i++}return a}},{key:"addresses",value:function(e){for(var n=[],a=this.start.row,i=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);a<=i;){for(var u=this.start.col;u<=o;)n.push(P(this.start.sheet,u,a)),u++;a++}return n}},{key:"addressesWithDirection",value:regeneratorRuntime.mark(function t(e,n,a){var i,o,u,s,l,f,c,h;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(e>0)){y.next=30;break}if(!(n>0)){y.next=16;break}i=this.effectiveEndRow(a);case 3:if(!(i>=this.start.row)){y.next=14;break}o=this.effectiveEndColumn(a);case 5:if(!(o>=this.start.col)){y.next=11;break}return y.next=8,P(this.start.sheet,o,i);case 8:o-=1,y.next=5;break;case 11:i-=1,y.next=3;break;case 14:y.next=28;break;case 16:u=this.start.row;case 17:if(!(u<=this.effectiveEndRow(a))){y.next=28;break}s=this.effectiveEndColumn(a);case 19:if(!(s>=this.start.col)){y.next=25;break}return y.next=22,P(this.start.sheet,s,u);case 22:s-=1,y.next=19;break;case 25:u+=1,y.next=17;break;case 28:y.next=57;break;case 30:if(!(n>0)){y.next=45;break}l=this.effectiveEndRow(a);case 32:if(!(l>=this.start.row)){y.next=43;break}f=this.start.col;case 34:if(!(f<=this.effectiveEndColumn(a))){y.next=40;break}return y.next=37,P(this.start.sheet,f,l);case 37:f+=1,y.next=34;break;case 40:l-=1,y.next=32;break;case 43:y.next=57;break;case 45:c=this.start.row;case 46:if(!(c<=this.effectiveEndRow(a))){y.next=57;break}h=this.start.col;case 48:if(!(h<=this.effectiveEndColumn(a))){y.next=54;break}return y.next=51,P(this.start.sheet,h,c);case 51:h+=1,y.next=48;break;case 54:c+=1,y.next=46;break;case 57:case"end":return y.stop()}},t,this)})},{key:"getAddress",value:function(e,n){if(e<0||n<0||n>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return P(this.start.sheet,this.start.col+e,this.start.row+n)}},{key:"exceedsSheetSizeLimits",value:function(e,n){return this.end.col>=e||this.end.row>=n}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}},{key:"effectiveWidth",value:function(e){return this.width()}},{key:"effectiveHeight",value:function(e){return this.height()}},{key:"removeRows",value:function(e,n){if(!(e>this.end.row)){if(n<this.start.row){var a=n-e+1;return this.shiftByRows(-a)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(n,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,n){if(!(e>this.end.col)){if(n<this.start.col){var a=n-e+1;return this.shiftByColumns(-a)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(n,this.end.col)-e+1}}}],[{key:"fromAst",value:function(e,n){return e.type===b.CELL_RANGE?r.fromCellRange(e,n):e.type===b.COLUMN_RANGE?Hu.fromColumnRange(e,n):Wu.fromRowRangeAst(e,n)}},{key:"fromAstOrUndef",value:function(e,n){try{return r.fromAst(e,n)}catch{return}}},{key:"fromCellRange",value:function(e,n){return new r(e.start.toSimpleCellAddress(n),e.end.toSimpleCellAddress(n))}},{key:"spanFrom",value:function(e,n,a){var i=r.spanFromOrUndef(e,n,a);if(i===void 0)throw new Error(mx);return i}},{key:"spanFromOrUndef",value:function(e,n,a){if(!Number.isFinite(n)&&Number.isFinite(a))return e.col!==0?void 0:new Wu(e.sheet,e.row,e.row+a-1);if(!Number.isFinite(a)&&Number.isFinite(n))return e.row!==0?void 0:new Hu(e.sheet,e.col,e.col+n-1);if(Number.isFinite(a)&&Number.isFinite(n))return new r(e,P(e.sheet,e.col+n-1,e.row+a-1))}},{key:"fromCoordinates",value:function(e,n,a,i,o){return new r(P(e,n,a),P(e,i,o))}}]),r}(),Hu=function(r){kg(e,r);var t=Fg(e);function e(n,a,i){return Vh(this,e),t.call(this,P(n,a,0),P(n,i,Number.POSITIVE_INFINITY))}return Gh(e,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(a){}},{key:"expandByRows",value:function(a){}},{key:"shifted",value:function(a,i){return new e(this.sheet,this.start.col+a,this.end.col+a)}},{key:"rangeWithSameHeight",value:function(a,i){return new e(this.sheet,a,a+i-1)}},{key:"exceedsSheetSizeLimits",value:function(a,i){return this.end.col>=a}},{key:"effectiveEndRow",value:function(a){return this.effectiveHeight(a)-1}},{key:"effectiveHeight",value:function(a){return a.getSheetHeight(this.sheet)}},{key:"removeRows",value:function(a,i){}}],[{key:"fromColumnRange",value:function(a,i){var o=a.start.toSimpleColumnAddress(i),u=a.end.toSimpleColumnAddress(i);if(o.sheet!==u.sheet)throw new uu(o.sheet,u.sheet);return new e(o.sheet,o.col,u.col)}}]),e}(Y),Wu=function(r){kg(e,r);var t=Fg(e);function e(n,a,i){return Vh(this,e),t.call(this,P(n,0,a),P(n,Number.POSITIVE_INFINITY,i))}return Gh(e,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(a){}},{key:"expandByColumns",value:function(a){}},{key:"shifted",value:function(a,i){return new e(this.sheet,this.start.row+i,this.end.row+i)}},{key:"rangeWithSameWidth",value:function(a,i){return new e(this.sheet,a,a+i-1)}},{key:"exceedsSheetSizeLimits",value:function(a,i){return this.end.row>=i}},{key:"effectiveEndColumn",value:function(a){return this.effectiveWidth(a)-1}},{key:"effectiveWidth",value:function(a){return a.getSheetWidth(this.sheet)}},{key:"removeColumns",value:function(a,i){}}],[{key:"fromRowRangeAst",value:function(a,i){var o=a.start.toSimpleRowAddress(i),u=a.end.toSimpleRowAddress(i);if(o.sheet!==u.sheet)throw new uu(o.sheet,u.sheet);return new e(o.sheet,o.row,u.row)}}]),e}(Y),br=function(t,e){return t.map(function(n){return n.absolutize(e)})},gx=function(t){return t.filter(function(e){return e instanceof dn?!0:e instanceof Y?!(Ft(e.start)||Ft(e.end)):!Ft(e)})};function $g(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Ex(r,t,e){return t&&$g(r.prototype,t),e&&$g(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Rx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var Sr=Ex(function r(t,e,n){Rx(this,r),this.formulaAddress=t,this.arraysFlag=e,this.formulaVertex=n}),bx=oi.PROPER,Sx=re,Dg=hy,Lg="\u200B\x85\u180E",Ax=function(r){return Sx(function(){return!!Dg[r]()||Lg[r]()!==Lg||bx&&Dg[r].name!==r})},Tx=z,Ox=dy.trim,wx=Ax;Tx({target:"String",proto:!0,forced:wx("trim")},{trim:function(){return Ox(this)}});var Nx=z,Cx=bv.includes,_x=re,Ix=Si,Mx=_x(function(){return!Array(1).includes()});Nx({target:"Array",proto:!0,forced:Mx},{includes:function(t){return Cx(this,t,arguments.length>1?arguments[1]:void 0)}});Ix("includes");var Ug={exports:{}};(function(r){(function(t){for(var e=[null,0,{}],n=10,a=44032,i=4352,o=4449,u=4519,s=19,l=21,f=28,c=l*f,h=s*c,p=function(w,O){this.codepoint=w,this.feature=O},y={},v=[],R=0;R<=255;++R)v[R]=0;function g(w,O,C){var k=y[O];return k||(k=w(O,C),!!k.feature&&++v[O>>8&255]>n&&(y[O]=k)),k}function A(w,O,C){var k=O&65280,B=p.udata[k]||{},ae=B[O];return ae?new p(O,ae):new p(O,e)}function T(w,O,C){return C?w(O,C):new p(O,null)}function N(w,O,C){var k;if(O<i||i+s<=O&&O<a||a+h<O)return w(O,C);if(i<=O&&O<i+s){var B={},ae=(O-i)*l;for(k=0;k<l;++k)B[o+k]=a+f*(k+ae);return new p(O,[,,B])}var J=O-a,Ae=J%f,Ce=[];if(Ae!==0)Ce[0]=[a+J-Ae,u+Ae];else for(Ce[0]=[i+Math.floor(J/c),o+Math.floor(J%c/f)],Ce[2]={},k=1;k<f;++k)Ce[2][u+k]=O+k;return new p(O,Ce)}function M(w,O,C){return O<60||13311<O&&O<42607?new p(O,e):w(O,C)}var _=[M,g,T,N,A];p.fromCharCode=_.reduceRight(function(w,O){return function(C,k){return O(w,C,k)}},null),p.isHighSurrogate=function(w){return w>=55296&&w<=56319},p.isLowSurrogate=function(w){return w>=56320&&w<=57343},p.prototype.prepFeature=function(){this.feature||(this.feature=p.fromCharCode(this.codepoint,!0).feature)},p.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var w=this.codepoint-65536;return String.fromCharCode(Math.floor(w/1024)+55296,w%1024+56320)},p.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},p.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<8},p.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<9},p.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},p.prototype.getComposite=function(w){if(this.prepFeature(),!this.feature[2])return null;var O=this.feature[2][w.codepoint];return O?p.fromCharCode(O):null};var $=function(w){this.str=w,this.cursor=0};$.prototype.next=function(){if(!!this.str&&this.cursor<this.str.length){var w=this.str.charCodeAt(this.cursor++),O;return p.isHighSurrogate(w)&&this.cursor<this.str.length&&p.isLowSurrogate(O=this.str.charCodeAt(this.cursor))&&(w=(w-55296)*1024+(O-56320)+65536,++this.cursor),p.fromCharCode(w)}else return this.str=null,null};var x=function(w,O){this.it=w,this.canonical=O,this.resBuf=[]};x.prototype.next=function(){function w(C,k){var B=k.getDecomp();if(!!B&&!(C&&k.isCompatibility())){for(var ae=[],J=0;J<B.length;++J){var Ae=w(C,p.fromCharCode(B[J]));ae=ae.concat(Ae)}return ae}else return[k]}if(this.resBuf.length===0){var O=this.it.next();if(!O)return null;this.resBuf=w(this.canonical,O)}return this.resBuf.shift()};var D=function(w){this.it=w,this.resBuf=[]};D.prototype.next=function(){var w;if(this.resBuf.length===0)do{var O=this.it.next();if(!O)break;w=O.getCanonicalClass();var C=this.resBuf.length;if(w!==0)for(;C>0;--C){var k=this.resBuf[C-1],B=k.getCanonicalClass();if(B<=w)break}this.resBuf.splice(C,0,O)}while(w!==0);return this.resBuf.shift()};var K=function(w){this.it=w,this.procBuf=[],this.resBuf=[],this.lastClass=null};K.prototype.next=function(){for(;this.resBuf.length===0;){var w=this.it.next();if(!w){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=w.getCanonicalClass(),this.procBuf.push(w);else{var O=this.procBuf[0],C=O.getComposite(w),k=w.getCanonicalClass();!!C&&(this.lastClass<k||this.lastClass===0)?this.procBuf[0]=C:(k===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=k,this.procBuf.push(w))}}return this.resBuf.shift()};var Z=function(w,O){switch(w){case"NFD":return new D(new x(new $(O),!0));case"NFKD":return new D(new x(new $(O),!1));case"NFC":return new K(new D(new x(new $(O),!0)));case"NFKC":return new K(new D(new x(new $(O),!1)))}throw w+" is invalid"},ie=function(w,O){for(var C=Z(w,O),k="",B;B=C.next();)k+=B.toString();return k};function q(w){return ie("NFD",w)}function le(w){return ie("NFKD",w)}function pe(w){return ie("NFC",w)}function Re(w){return ie("NFKC",w)}p.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var we={nfc:pe,nfd:q,nfkc:Re,nfkd:le};r.exports=we,we.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var O=""+this,C=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(C==="NFC")return we.nfc(O);if(C==="NFD")return we.nfd(O);if(C==="NFKC")return we.nfkc(O);if(C==="NFKD")return we.nfkd(O);throw new RangeError("Invalid normalization form: "+C)}}),we.shimApplied=!0)})()})(Ug);var kx=Ug.exports;/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function Fx(r){var t=r.caseSensitive?r.accentSensitive?"variant":"case":r.accentSensitive?"accent":"base",e=r.caseFirst,n=r.ignorePunctuation;return new Intl.Collator(r.localeLang,{sensitivity:t,caseFirst:e,ignorePunctuation:n})}function Hh(r){return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(r)}function qi(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Wh(r,t)}function Wh(r,t){return Wh=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Wh(r,t)}function Qi(r){var t=Dx();return function(){var n=zu(r),a;if(t){var i=zu(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Px(this,a)}}function Px(r,t){if(t&&(Hh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $x(r)}function $x(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Dx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zu(r){return zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zu(r)}function wa(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function xg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Na(r,t,e){return t&&xg(r.prototype,t),e&&xg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var ne=Symbol("Empty value");function F(r){return r instanceof Ar?r.val:r}var Ar=function(){function r(t,e){wa(this,r),this.val=t,this.format=e}return Na(r,[{key:"fromNumber",value:function(e){return new this.constructor(e)}}]),r}();function zh(r,t){if(typeof r=="number")return t;var e=r.fromNumber(t);return e.format=r.format,e}var Yh=function(r){qi(e,r);var t=Qi(e);function e(){return wa(this,e),t.apply(this,arguments)}return Na(e,[{key:"getDetailedType",value:function(){return U.NUMBER_DATE}}]),e}(Ar),Bg=function(r){qi(e,r);var t=Qi(e);function e(){return wa(this,e),t.apply(this,arguments)}return Na(e,[{key:"getDetailedType",value:function(){return U.NUMBER_CURRENCY}}]),e}(Ar),Kh=function(r){qi(e,r);var t=Qi(e);function e(){return wa(this,e),t.apply(this,arguments)}return Na(e,[{key:"getDetailedType",value:function(){return U.NUMBER_TIME}}]),e}(Ar),Xh=function(r){qi(e,r);var t=Qi(e);function e(){return wa(this,e),t.apply(this,arguments)}return Na(e,[{key:"getDetailedType",value:function(){return U.NUMBER_DATETIME}}]),e}(Ar),qh=function(r){qi(e,r);var t=Qi(e);function e(){return wa(this,e),t.apply(this,arguments)}return Na(e,[{key:"getDetailedType",value:function(){return U.NUMBER_PERCENT}}]),e}(Ar);function de(r){return typeof r=="number"||r instanceof Ar}var U;(function(r){r.NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"})(U||(U={}));function Lx(r){return r instanceof Ar?r.getDetailedType():U.NUMBER_RAW}function Ux(r){if(r instanceof Ar)return r.format}function Yu(r){return r instanceof Ar?{type:r.getDetailedType(),format:r.format}:{type:U.NUMBER_RAW}}function xx(r,t){return Gx(r)||Vx(r,t)||Qh(r,t)||Bx()}function Bx(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vx(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function Gx(r){if(Array.isArray(r))return r}function Vg(r){return Wx(r)||Hx(r)||Qh(r)||jx()}function jx(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hx(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Wx(r){if(Array.isArray(r))return Zh(r)}function Ca(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Qh(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Qh(r,t){if(!!r){if(typeof r=="string")return Zh(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Zh(r,t)}}function Zh(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function zx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Gg(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Yx(r,t,e){return t&&Gg(r.prototype,t),e&&Gg(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Kx="i",Xx=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/,qx=function(){function r(t,e,n){var a=this;zx(this,r),this.config=t,this.dateTimeHelper=e,this.numberLiteralsHelper=n,this.lt=function(i,o){return a.compare(i,o)<0},this.leq=function(i,o){return a.compare(i,o)<=0},this.gt=function(i,o){return a.compare(i,o)>0},this.geq=function(i,o){return a.compare(i,o)>=0},this.eq=function(i,o){return a.compare(i,o)===0},this.neq=function(i,o){return a.compare(i,o)!==0},this.pow=function(i,o){return Math.pow(F(i),F(o))},this.addWithEpsilonRaw=function(i,o){var u=i+o;return Math.abs(u)<a.actualEps*Math.abs(i)?0:u},this.addWithEpsilon=function(i,o){var u=Xg(i,o);return a.ExtendedNumberFactory(a.addWithEpsilonRaw(F(i),F(o)),u)},this.unaryMinus=function(i){return zh(i,-F(i))},this.unaryPlus=function(i){return i},this.unaryPercent=function(i){return new qh(F(i)/100)},this.concat=function(i,o){return i.concat(o)},this.nonstrictadd=function(i,o){return i instanceof m?i:o instanceof m?o:typeof i=="number"?typeof o=="number"?a.addWithEpsilonRaw(i,o):i:typeof o=="number"?o:0},this.subtract=function(i,o){var u=Xg(i,o),s=F(i),l=F(o),f=s-l;return Math.abs(f)<a.actualEps*Math.abs(s)&&(f=0),a.ExtendedNumberFactory(f,u)},this.divide=function(i,o){var u=F(i),s=F(o);if(s===0)return new m(E.DIV_BY_ZERO);var l=qg(i,o);return a.ExtendedNumberFactory(u/s,l)},this.multiply=function(i,o){var u=qg(i,o);return a.ExtendedNumberFactory(F(i)*F(o),u)},this.manyToExactComplex=function(i){var o=[],u=Ca(i),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof m)return l;if(de(l)||typeof l=="string"){var f=a.coerceScalarToComplex(l);f instanceof m||o.push(f)}}}catch(c){u.e(c)}finally{u.f()}return o},this.coerceNumbersExactRanges=function(i){return a.manyToNumbers(i,a.manyToExactNumbers)},this.coerceNumbersCoerceRangesDropNulls=function(i){return a.manyToNumbers(i,a.manyToCoercedNumbersDropNulls)},this.manyToExactNumbers=function(i){var o=[],u=Ca(i),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof m)return l;de(l)&&o.push(F(l))}}catch(f){u.e(f)}finally{u.f()}return o},this.manyToOnlyNumbersDropNulls=function(i){var o=[],u=Ca(i),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof m)return l;if(de(l))o.push(F(l));else if(l!==ne)return new m(E.VALUE,S.NumberExpected)}}catch(f){u.e(f)}finally{u.f()}return o},this.manyToCoercedNumbersDropNulls=function(i){var o=[],u=Ca(i),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof m)return l;if(l!==ne){var f=a.coerceScalarToNumberOrError(l);de(f)&&o.push(F(f))}}}catch(c){u.e(c)}finally{u.f()}return o},this.collator=Fx(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}return Yx(r,[{key:"eqMatcherFunction",value:function(e){var n=this,a=this.buildRegex(e);return function(i){return typeof i=="string"&&a.test(n.normalizeString(i))}}},{key:"neqMatcherFunction",value:function(e){var n=this,a=this.buildRegex(e);return function(i){return typeof i!="string"||!a.test(n.normalizeString(i))}}},{key:"searchString",value:function(e,n){var a,i=this.buildRegex(e,!1),o=i.exec(n);return(a=o==null?void 0:o.index)!==null&&a!==void 0?a:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var n=0;n<e.length;n++){var a=e.charAt(n);if(Zi(a)||this.config.useRegularExpressions&&Ji(a))return!0}return!1}},{key:"floatCmp",value:function(e,n){var a=F(e),i=F(n),o=1+this.actualEps;return i>=0&&a*o>=i&&a<=i*o||i<=0&&a*o<=i&&a>=i*o?0:a>i?1:-1}},{key:"coerceScalarToNumberOrError",value:function(e){var n;return e instanceof m?e:(n=this.coerceToMaybeNumber(e))!==null&&n!==void 0?n:new m(E.VALUE,S.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var n;return(n=this.coerceNonDateScalarToMaybeNumber(e))!==null&&n!==void 0?n:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){return e===ne?0:typeof e=="string"?e===""?0:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):de(e)?e:typeof e=="boolean"?Number(e):void 0}},{key:"coerceComplexExactRanges",value:function(e){var n=[],a=Ca(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o instanceof V)n.push(o);else if(o!==ne){var u=this.coerceScalarToComplex(o);if(u instanceof m)return u;n.push(u)}}}catch(p){a.e(p)}finally{a.f()}for(var s=[],l=0,f=n;l<f.length;l++){var c=f[l];if(c instanceof V){var h=this.manyToExactComplex(c.valuesFromTopLeftCorner());if(h instanceof m)return h;s.push.apply(s,Vg(h))}else s.push(c)}return s}},{key:"coerceScalarToComplex",value:function(e){return e instanceof m?e:e===ne?[0,0]:de(e)?[F(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new m(E.NUM,S.ComplexNumberExpected)}},{key:"ExtendedNumberFactory",value:function(e,n){var a=n.type,i=n.format;switch(a){case U.NUMBER_RAW:return e;case U.NUMBER_CURRENCY:return new Bg(e,i!=null?i:this.config.currencySymbol[0]);case U.NUMBER_DATE:return new Yh(e,i);case U.NUMBER_DATETIME:return new Xh(e,i);case U.NUMBER_TIME:return new Kh(e,i);case U.NUMBER_PERCENT:return new qh(e,i)}}},{key:"buildRegex",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e=this.normalizeString(e);var a,i=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,i=!1}return o?a=eB(e,this.config.caseSensitive):i?a=Zx(e,this.config.caseSensitive):a=Jx(e,this.config.caseSensitive),this.config.matchWholeCell&&n?RegExp("^("+a+")$"):RegExp(a)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Qg(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,n){if(typeof e=="string"||typeof n=="string"){var a=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof n=="string"?this.dateTimeHelper.dateStringToDateNumber(n):n;if(de(a)&&de(i))return this.floatCmp(a,i)}return e===ne?e=Hg(n):n===ne&&(n=Hg(e)),typeof e=="string"&&typeof n=="string"?this.stringCmp(e,n):typeof e=="boolean"&&typeof n=="boolean"?zg(Jh(e),Jh(n)):de(e)&&de(n)?this.floatCmp(e,n):e===ne&&n===ne?0:zg(n4(ts(e)),n4(ts(n)))}},{key:"stringCmp",value:function(e,n){return this.collator.compare(e,n)}},{key:"manyToNumbers",value:function(e,n){var a=[],i=Ca(e),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;if(u instanceof V)a.push(u);else{var s=F(this.coerceScalarToNumberOrError(u));if(s instanceof m)return s;a.push(s)}}}catch(y){i.e(y)}finally{i.f()}for(var l=[],f=0,c=a;f<c.length;f++){var h=c[f];if(h instanceof V){var p=n(h.valuesFromTopLeftCorner());if(p instanceof m)return p;l.push.apply(l,Vg(p))}else l.push(h)}return l}},{key:"coerceStringToComplex",value:function(e){var n=Xx.exec(e);if(n===null)return new m(E.NUM,S.ComplexNumberExpected);var a;if(n[6]!==void 0?a=n[1]==="-"?[0,-1]:[0,1]:a=this.parseComplexToken(n[1]+n[3],n[5]),a instanceof m||n[8]===void 0)return a;var i;return n[14]!==void 0?i=n[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(n[9]+n[11],n[13]),i instanceof m?i:n[5]!==""||n[13]===""?new m(E.NUM,S.ComplexNumberExpected):n[8]==="+"?[a[0]+i[0],a[1]+i[1]]:[a[0]-i[0],a[1]-i[1]]}},{key:"parseComplexToken",value:function(e,n){var a=F(this.coerceNonDateScalarToMaybeNumber(e));return a===void 0?new m(E.NUM,S.ComplexNumberExpected):n===""?[a,0]:[0,a]}}]),r}();function De(r,t){var e=xx(r,2),n=e[0],a=e[1];if(!isFinite(n)||!isFinite(a))return new m(E.NUM,S.NaN);if(t=t!=null?t:Kx,a===0)return"".concat(n);var i="".concat(a===-1||a===1?"":Math.abs(a)).concat(t);return n===0?"".concat(a<0?"-":"").concat(i):"".concat(n).concat(a<0?"-":"+").concat(i)}function jg(r){return r instanceof V?r:V.fromScalar(r)}function Jh(r){return Number(r)}function Hg(r){return typeof r=="string"?"":de(r)?0:typeof r=="boolean"?!1:ne}function Wg(r){if(r instanceof m||typeof r=="boolean")return r;if(r===ne)return!1;if(de(r))return F(r)!==0;var t=r.toUpperCase();return t==="TRUE"?!0:t==="FALSE"||t===""?!1:void 0}function e1(r){return r instanceof m||typeof r=="string"?r:r===ne?"":de(r)?F(r).toString():r?"TRUE":"FALSE"}function t1(r){return r===ne?0:r}function zg(r,t){var e=F(r),n=F(t);return e>n?1:e<n?-1:0}function Yg(r){return isNaN(r)||r===1/0||r===-1/0}function Kg(r){return r===0?0:r}function Zi(r){return["*","?"].includes(r)}var Qx=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Ji(r){return Qx.includes(r)}function Zx(r,t){for(var e="",n=0;n<r.length;n++){var a=r.charAt(n);if(a==="~"){if(n==r.length-1){e+="~";continue}var i=r.charAt(n+1);Zi(i)||Ji(i)?(e+="\\"+i,n++):(e+=i,n++)}else Zi(a)?e+="."+a:Ji(a)?e+="\\"+a:t?e+=a:e+=a.toLowerCase()}return e}function Jx(r,t){for(var e="",n=0;n<r.length;n++){var a=r.charAt(n);Zi(a)||Ji(a)?e+="\\"+a:t?e+=a:e+=a.toLowerCase()}return e}function eB(r,t){for(var e="",n=0;n<r.length;n++){var a=r.charAt(n);Zi(a)||Ji(a)||t?e+=a:e+=a.toLowerCase()}return e}function Xg(r,t){var e=Yu(r),n=e.type,a=e.format,i=Yu(t),o=i.type,u=i.format;if(n===U.NUMBER_RAW)return{type:o,format:u};if(o===U.NUMBER_RAW)return{type:n,format:a};if((n===U.NUMBER_DATETIME||n===U.NUMBER_DATE)&&(o===U.NUMBER_DATETIME||o===U.NUMBER_DATE))return{type:U.NUMBER_RAW};if(n===U.NUMBER_TIME){if(o===U.NUMBER_DATE)return{type:U.NUMBER_DATETIME,format:u+" "+a};if(o===U.NUMBER_DATETIME)return{type:U.NUMBER_DATETIME,format:u}}if(o===U.NUMBER_TIME){if(n===U.NUMBER_DATE)return{type:U.NUMBER_DATETIME,format:a+" "+u};if(n===U.NUMBER_DATETIME)return{type:U.NUMBER_DATETIME,format:a}}return{type:n,format:a}}function qg(r,t){var e=Yu(r),n=e.type,a=e.format,i=Yu(t),o=i.type,u=i.format;return n===U.NUMBER_PERCENT&&(n=U.NUMBER_RAW,a=void 0),o===U.NUMBER_PERCENT&&(o=U.NUMBER_RAW,u=void 0),n===U.NUMBER_RAW?{type:o,format:u}:o===U.NUMBER_RAW?{type:n,format:a}:{type:U.NUMBER_RAW}}function yn(r){return Qg(r.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Ku(r,t){var e;if(r.isAdHoc())return(e=r.data[0])===null||e===void 0?void 0:e[0];var n=r.range;if(t.formulaAddress.sheet===n.sheet){if(n.width()===1){var a=t.formulaAddress.row-n.start.row;if(a>=0&&a<n.height())return r.data[a][0]}else if(n.height()===1){var i=t.formulaAddress.col-n.start.col;if(i>=0&&i<n.width())return r.data[0][i]}}}function Qg(r,t){return typeof r.normalize=="function"?r.normalize(t.toUpperCase()):kx[t](r)}function Zg(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=r1(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Jg(r,t){return nB(r)||rB(r,t)||r1(r,t)||tB()}function tB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rB(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function nB(r){if(Array.isArray(r))return r}function e7(r){return oB(r)||iB(r)||r1(r)||aB()}function aB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r1(r,t){if(!!r){if(typeof r=="string")return n1(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return n1(r,t)}}function iB(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function oB(r){if(Array.isArray(r))return n1(r)}function n1(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function uB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function t7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function sB(r,t,e){return t&&t7(r.prototype,t),e&&t7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var d;(function(r){r.STRING="STRING",r.NUMBER="NUMBER",r.BOOLEAN="BOOLEAN",r.SCALAR="SCALAR",r.NOERROR="NOERROR",r.RANGE="RANGE",r.INTEGER="INTEGER",r.COMPLEX="COMPLEX",r.ANY="ANY"})(d||(d={}));var ee=function(){function r(t){var e=this;uB(this,r),this.coerceScalarToNumberOrError=function(n){return e.arithmeticHelper.coerceScalarToNumberOrError(n)},this.runFunction=function(n,a,i,o){var u,s,l,f,c,h=i.parameters,p;if(i.expandRanges?p=e.listOfScalarValues(n,a):p=n.map(function(O){return[e.evaluateAst(O,a),!1]}),i.repeatLastArgs===void 0&&h.length<p.length)return new m(E.NA,S.WrongArgNumber);if(i.repeatLastArgs!==void 0&&h.length<p.length&&(p.length-h.length)%i.repeatLastArgs!=0)return new m(E.NA,S.WrongArgNumber);for(h=e7(h);h.length<p.length;){var y;(y=h).push.apply(y,e7(h.slice(h.length-i.repeatLastArgs)))}var v=1,R=1;if(!i.vectorizationForbidden&&a.arraysFlag)for(var g=0;g<p.length;g++){var A=Jg(p[g],1),T=A[0];T instanceof V&&h[g].argumentType!==d.RANGE&&h[g].argumentType!==d.ANY&&(R=Math.max(R,T.height()),v=Math.max(v,T.width()))}for(var N=p.length;N<h.length;N++)if(((u=h[N])===null||u===void 0?void 0:u.defaultValue)===void 0&&!((s=h[N])===null||s===void 0?void 0:s.optionalArg))return new m(E.NA,S.WrongArgNumber);for(var M=[],_=0;_<R;_++){for(var $=[],x=0;x<v;x++){for(var D=void 0,K=[],Z=0;Z<h.length;Z++){var ie=(l=p[Z])!==null&&l!==void 0?l:[void 0,void 0],q=Jg(ie,2),le=q[0],pe=q[1];le instanceof V&&h[Z].argumentType!==d.RANGE&&h[Z].argumentType!==d.ANY&&!i.vectorizationForbidden&&a.arraysFlag&&(le=(f=le.data[le.height()!==1?_:0])===null||f===void 0?void 0:f[le.width()!==1?x:0]);var Re=le!=null?le:(c=h[Z])===null||c===void 0?void 0:c.defaultValue;if(Re===void 0)K.push(void 0);else{var we=le!==void 0?e.coerceToType(Re,h[Z],a):Re;we!==void 0?(we instanceof m&&h[Z].argumentType!==d.SCALAR&&(D=D!=null?D:we),K.push(we)):pe||(D=D!=null?D:new m(E.VALUE,S.WrongType))}}var w=D!=null?D:e.returnNumberWrapper(o.apply(void 0,K),i.returnNumberType);if(R===1&&v===1)return w;if(w instanceof V)throw"Function returning array cannot be vectorized.";$.push(w)}M.push($)}return V.onlyValues(M)},this.runFunctionWithReferenceArgument=function(n,a,i,o,u){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:function(){return new m(E.NA,S.CellRefExpected)};if(n.length===0)return e.returnNumberWrapper(o(),i.returnNumberType);if(n.length>1)return new m(E.NA,S.WrongArgNumber);for(var l=n[0];l.type===b.PARENTHESIS;)l=l.expression;var f;if(l.type===b.CELL_REFERENCE)f=l.reference.toSimpleCellAddress(a.formulaAddress);else if(l.type===b.CELL_RANGE||l.type===b.COLUMN_RANGE||l.type===b.ROW_RANGE)try{f=Y.fromAst(l,a.formulaAddress).start}catch{return new m(E.REF,S.CellRefExpected)}return f!==void 0?e.returnNumberWrapper(u(f),i.returnNumberType):e.runFunction(n,a,i,s)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization,this.arraySizePredictor=t.arraySizePredictor,this.dateTimeHelper=t.dateTimeHelper,this.arithmeticHelper=t.arithmeticHelper}return sB(r,[{key:"evaluateAst",value:function(e,n){return this.interpreter.evaluateAst(e,n)}},{key:"arraySizeForAst",value:function(e,n){return this.arraySizePredictor.checkArraySizeForAst(e,n)}},{key:"listOfScalarValues",value:function(e,n){var a=[],i=Zg(e),o;try{for(i.s();!(o=i.n()).done;){var u=o.value,s=this.evaluateAst(u,n);if(s instanceof V){var l=Zg(s.valuesFromTopLeftCorner()),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;a.push([c,!0])}}catch(h){l.e(h)}finally{l.f()}}else a.push([s,!1])}}catch(h){i.e(h)}finally{i.f()}return a}},{key:"coerceToType",value:function(e,n,a){var i;if(e instanceof V)switch(n.argumentType){case d.RANGE:case d.ANY:i=e;break;default:{var o=Ku(e,a);if(o===void 0)return;e=o}}if(!(e instanceof V))switch(n.argumentType){case d.INTEGER:case d.NUMBER:var u=this.coerceScalarToNumberOrError(e);if(!de(u)){i=u;break}var s=F(u);if(n.maxValue!==void 0&&s>n.maxValue)return new m(E.NUM,S.ValueLarge);if(n.minValue!==void 0&&s<n.minValue)return new m(E.NUM,S.ValueSmall);if(n.lessThan!==void 0&&s>=n.lessThan)return new m(E.NUM,S.ValueLarge);if(n.greaterThan!==void 0&&s<=n.greaterThan)return new m(E.NUM,S.ValueSmall);if(n.argumentType===d.INTEGER&&!Number.isInteger(s))return new m(E.NUM,S.IntegerExpected);i=u;break;case d.STRING:i=e1(e);break;case d.BOOLEAN:i=Wg(e);break;case d.SCALAR:case d.NOERROR:case d.ANY:i=e;break;case d.RANGE:if(e instanceof m)return e;i=jg(e);break;case d.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(F(e))}return n.passSubtype||i===void 0?i:F(i)}},{key:"metadata",value:function(e){var n=this.constructor.implementedFunctions[e];if(n!==void 0)return n;throw new Error("No metadata for function ".concat(e,"."))}},{key:"returnNumberWrapper",value:function(e,n,a){return n!==void 0&&de(e)?this.arithmeticHelper.ExtendedNumberFactory(F(e),{type:n,format:a}):e}}]),r}();function a1(r){return cB(r)||fB(r)||r7(r)||lB()}function lB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fB(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function cB(r){if(Array.isArray(r))return i1(r)}function hB(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=r7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function r7(r,t){if(!!r){if(typeof r=="string")return i1(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return i1(r,t)}}function i1(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function n7(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function a7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function i7(r,t,e){return t&&a7(r.prototype,t),e&&a7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var ue=function(){function r(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n7(this,r),this.width=t,this.height=e,this.isRef=n,t<=0||e<=0)throw Error("Incorrect array size")}return i7(r,[{key:"isScalar",value:function(){return this.width<=1&&this.height<=1||this.isRef}}],[{key:"fromArray",value:function(e){return new r(e.length>0?e[0].length:0,e.length)}},{key:"error",value:function(){return new r(1,1,!0)}},{key:"scalar",value:function(){return new r(1,1,!1)}}]),r}();function pB(r,t){return new ue(Math.max(r.width,t.width),Math.max(r.height,t.height))}function dB(r){return new ue(r.width,r.height)}var vB=function(){function r(t,e){n7(this,r),this.config=t,this.functionRegistry=e}return i7(r,[{key:"checkArraySize",value:function(e,n){return this.checkArraySizeForAst(e,{formulaAddress:n,arraysFlag:this.config.useArrayArithmetic})}},{key:"checkArraySizeForAst",value:function(e,n){var a=this;switch(e.type){case b.FUNCTION_CALL:return this.checkArraySizeForFunction(e,n);case b.COLUMN_RANGE:case b.ROW_RANGE:case b.CELL_RANGE:{var i=Y.fromAstOrUndef(e,n.formulaAddress);return i===void 0?ue.error():new ue(i.width(),i.height(),!0)}case b.ARRAY:{var o=[],u=[],s=hB(e.args),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,c=f.map(function(T){return a.checkArraySizeForAst(T,n)}),h=Math.min.apply(Math,a1(c.map(function(T){return T.height}))),p=c.reduce(function(T,N){return T+N.width},0);o.push(h),u.push(p)}}catch(T){s.e(T)}finally{s.f()}var y=o.reduce(function(T,N){return T+N},0),v=Math.min.apply(Math,u);return new ue(v,y)}case b.STRING:case b.NUMBER:return ue.scalar();case b.CELL_REFERENCE:return new ue(1,1,!0);case b.DIV_OP:case b.CONCATENATE_OP:case b.EQUALS_OP:case b.GREATER_THAN_OP:case b.GREATER_THAN_OR_EQUAL_OP:case b.LESS_THAN_OP:case b.LESS_THAN_OR_EQUAL_OP:case b.MINUS_OP:case b.NOT_EQUAL_OP:case b.PLUS_OP:case b.POWER_OP:case b.TIMES_OP:{var R=this.checkArraySizeForAst(e.left,n),g=this.checkArraySizeForAst(e.right,n);return!n.arraysFlag&&(R.height>1||R.width>1||g.height>1||g.width>1)?ue.error():pB(R,g)}case b.MINUS_UNARY_OP:case b.PLUS_UNARY_OP:case b.PERCENT_OP:{var A=this.checkArraySizeForAst(e.value,n);return!n.arraysFlag&&(A.height>1||A.width>1)?ue.error():dB(A)}case b.PARENTHESIS:return this.checkArraySizeForAst(e.expression,n);case b.EMPTY:return ue.error();default:return ue.error()}}},{key:"checkArraySizeForFunction",value:function(e,n){var a=this,i=this.functionRegistry.getMetadata(e.procedureName),o=this.functionRegistry.getArraySizeFunction(e.procedureName);if(o!==void 0)return o(e,n);var u=e.args.map(function(h){var p;return a.checkArraySizeForAst(h,new Sr(n.formulaAddress,n.arraysFlag||((p=i==null?void 0:i.arrayFunction)!==null&&p!==void 0?p:!1)))});if(i===void 0||i.expandRanges||!n.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new ue(1,1);var s=a1(i.parameters);if(i.repeatLastArgs===void 0&&s.length<u.length||i.repeatLastArgs!==void 0&&s.length<u.length&&(u.length-s.length)%i.repeatLastArgs!=0)return ue.error();for(;s.length<u.length;)s.push.apply(s,a1(s.slice(s.length-i.repeatLastArgs)));for(var l=1,f=1,c=0;c<u.length;c++)s[c].argumentType!==d.RANGE&&s[c].argumentType!==d.ANY&&(f=Math.max(f,u[c].height),l=Math.max(l,u[c].width));return new ue(l,f)}}]),r}();function o7(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=yB(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function yB(r,t){if(!!r){if(typeof r=="string")return u7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return u7(r,t)}}function u7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function mB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function s7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function gB(r,t,e){return t&&s7(r.prototype,t),e&&s7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var V=function(){function r(t,e,n,a){mB(this,r),this._data=t,this.range=e,this.dependencyGraph=n,this._hasOnlyNumbers=a,t===void 0?this.size=new ue(e.effectiveWidth(n),e.effectiveHeight(n)):this.size=new ue(t[0].length,t.length)}return gB(r,[{key:"data",get:function(){return this.ensureThatComputed(),this._data}},{key:"isAdHoc",value:function(){return this.range===void 0}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],n=0;n<this._data.length;n++)for(var a=0;a<this._data[0].length;a++)e.push(this._data[n][a]);return e}},{key:"effectiveAddressesFromData",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<this.data.length)){u.next=13;break}a=this.data[n],i=0;case 4:if(!(i<a.length)){u.next=10;break}return u.next=7,P(e.sheet,e.col+i,e.row+n);case 7:++i,u.next=4;break;case 10:++n,u.next=1;break;case 13:case"end":return u.stop()}},t,this)})},{key:"entriesFromTopLeftCorner",value:regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this.ensureThatComputed(),n=0;case 2:if(!(n<this.size.height)){o.next=13;break}a=0;case 4:if(!(a<this.size.width)){o.next=10;break}return o.next=7,[this._data[n][a],P(e.sheet,e.col+a,e.row+n)];case 7:++a,o.next=4;break;case 10:++n,o.next=2;break;case 13:case"end":return o.stop()}},t,this)})},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(this.valuesFromTopLeftCorner(),"t0",1);case 1:case"end":return n.stop()}},t,this)})},{key:"numberOfElements",value:function(){return this.size.width*this.size.height}},{key:"hasOnlyNumbers",value:function(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;var e=o7(this.data),n;try{for(e.s();!(n=e.n()).done;){var a=n.value,i=o7(a),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;if(typeof u!="number")return this._hasOnlyNumbers=!1,!1}}catch(s){i.e(s)}finally{i.f()}}}catch(s){e.e(s)}finally{e.f()}}return this._hasOnlyNumbers}},{key:"rawNumbers",value:function(){return this._data}},{key:"rawData",value:function(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"ensureThatComputed",value:function(){var e=this;this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,function(n){var a=e.dependencyGraph.getCellValue(n);return a instanceof r?(e._hasOnlyNumbers=!1,new m(E.VALUE,S.ScalarExpected)):(de(a)||(e._hasOnlyNumbers=!1),a)}))}}],[{key:"fromRange",value:function(e,n,a){return new r(e,n,a,!0)}},{key:"onlyNumbers",value:function(e){return new r(e,void 0,void 0,!0)}},{key:"onlyValues",value:function(e){return new r(e,void 0,void 0,void 0)}},{key:"onlyRange",value:function(e,n){return new r(void 0,e,n,void 0)}},{key:"fromScalar",value:function(e){return new r([[e]],void 0,void 0,void 0)}}]),r}();function l7(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=EB(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function EB(r,t){if(!!r){if(typeof r=="string")return f7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return f7(r,t)}}function f7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function RB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function c7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function bB(r,t,e){return t&&c7(r.prototype,t),e&&c7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var _a=function(){function r(){RB(this,r),this.changes=new Map}return bB(r,[{key:"addAll",value:function(e){var n=l7(e.changes.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.add(i.address,i)}}catch(o){n.e(o)}finally{n.f()}return this}},{key:"addChange",value:function(e,n,a){this.addInterpreterValue(e,n,a)}},{key:"exportChanges",value:function(e){var n=[];return this.changes.forEach(function(a){var i=e.exportChange(a);Array.isArray(i)?n=n.concat(i):n.push(i)}),n}},{key:"getChanges",value:function(){return Array.from(this.changes.values())}},{key:"isEmpty",value:function(){return this.changes.size===0}},{key:"add",value:function(e,n){var a=n.value;if(a instanceof V){var i=l7(a.effectiveAddressesFromData(e)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;this.changes.delete("".concat(u.sheet,",").concat(u.col,",").concat(u.row))}}catch(s){i.e(s)}finally{i.f()}}this.changes.set(rs(e),n)}},{key:"addInterpreterValue",value:function(e,n,a){this.add(n,{address:n,value:e,oldValue:a})}}],[{key:"empty",value:function(){return new r}}]),r}();/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var X;(function(r){r.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(X||(X={}));function SB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function h7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function AB(r,t,e){return t&&h7(r.prototype,t),e&&h7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var p7=function(){function r(){SB(this,r),this.stats=new Map([[X.CRITERION_FUNCTION_FULL_CACHE_USED,0],[X.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}return AB(r,[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e,n=((e=this.stats.get(X.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(X.CRITERION_FUNCTION_FULL_CACHE_USED,n)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e,n=((e=this.stats.get(X.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(X.CRITERION_FUNCTION_PARTIAL_CACHE_USED,n)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(X.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(X.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var n,a=Date.now(),i=this.startTimes.get(e);if(i){var o=(n=this.stats.get(e))!==null&&n!==void 0?n:0;o+=a-i,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error("Statistics ".concat(e," not started"))}},{key:"measure",value:function(e,n){this.start(e);var a=n();return this.end(e),a}},{key:"snapshot",value:function(){return new Map(this.stats)}}]),r}();function o1(r){return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(r)}function TB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function d7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function OB(r,t,e){return t&&d7(r.prototype,t),e&&d7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function wB(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&u1(r,t)}function u1(r,t){return u1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},u1(r,t)}function NB(r){var t=IB();return function(){var n=Xu(r),a;if(t){var i=Xu(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return CB(this,a)}}function CB(r,t){if(t&&(o1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _B(r)}function _B(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function IB(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xu(r){return Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xu(r)}var MB=function(r){wB(e,r);var t=NB(e);function e(){return TB(this,e),t.apply(this,arguments)}return OB(e,[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(a){}},{key:"end",value:function(a){}}]),e}(p7),kB=At,v7=na,FB=or,PB=function(t){for(var e=kB(this),n=FB(e),a=arguments.length,i=v7(a>1?arguments[1]:void 0,n),o=a>2?arguments[2]:void 0,u=o===void 0?n:v7(o,n);u>i;)e[i++]=t;return e},$B=z,DB=PB,LB=Si;$B({target:"Array",proto:!0},{fill:DB});LB("fill");function UB(r,t){return VB(r)||BB(r,t)||y7(r,t)||xB()}function xB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BB(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function VB(r){if(Array.isArray(r))return r}function GB(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=y7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function y7(r,t){if(!!r){if(typeof r=="string")return m7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m7(r,t)}}function m7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function jB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function g7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function HB(r,t,e){return t&&g7(r.prototype,t),e&&g7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var WB=function(){function r(t){jB(this,r),this.policy=t,this.mapping=new Map}return HB(r,[{key:"getCell",value:function(e){var n=this.mapping.get(e.sheet);if(n===void 0)throw new Me(e.sheet);return n.getCell(e)}},{key:"fetchCell",value:function(e){var n=this.mapping.get(e.sheet);if(n===void 0)throw new Me(e.sheet);var a=n.getCell(e);if(!a)throw Error("Vertex for address missing in AddressMapping");return a}},{key:"strategyFor",value:function(e){var n=this.mapping.get(e);if(n===void 0)throw new Me(e);return n}},{key:"addSheet",value:function(e,n){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,n)}},{key:"autoAddSheet",value:function(e,n,a){var i=a.height,o=a.width,u=a.fill,s=this.policy.call(u);this.addSheet(e,new s(o,i))}},{key:"getCellValue",value:function(e){var n=this.getCell(e);return n===void 0?ne:n instanceof Fe?n.getArrayCellValue(e):n.getCellValue()}},{key:"getRawValue",value:function(e){var n=this.getCell(e);return n instanceof mn?n.getValues().rawValue:n instanceof Fe?n.getArrayCellRawValue(e):null}},{key:"setCell",value:function(e,n){var a=this.mapping.get(e.sheet);if(!a)throw Error("Sheet not initialized");a.setCell(e,n)}},{key:"moveCell",value:function(e,n){var a=this.mapping.get(e.sheet);if(!a)throw Error("Sheet not initialized.");if(e.sheet!==n.sheet)throw Error("Cannot move cells between sheets.");if(a.has(n))throw new Error("Cannot move cell. Destination already occupied.");var i=a.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(n,i),this.removeCell(e)}},{key:"removeCell",value:function(e){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.removeCell(e)}},{key:"has",value:function(e){var n=this.mapping.get(e.sheet);return n===void 0?!1:n.has(e)}},{key:"getHeight",value:function(e){var n=this.mapping.get(e);if(n===void 0)throw new Me(e);return n.getHeight()}},{key:"getWidth",value:function(e){var n=this.mapping.get(e);if(!n)throw new Me(e);return n.getWidth()}},{key:"addRows",value:function(e,n,a){var i=this.mapping.get(e);if(i===void 0)throw new Me(e);i.addRows(n,a)}},{key:"removeRows",value:function(e){var n=this.mapping.get(e.sheet);if(n===void 0)throw new Me(e.sheet);n.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,n,a){var i=this.mapping.get(e);if(i===void 0)throw new Me(e);i.addColumns(n,a)}},{key:"removeColumns",value:function(e){var n=this.mapping.get(e.sheet);if(n===void 0)throw new Me(e.sheet);n.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.mapping.get(e.sheet).verticesFromRowsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.mapping.get(e.sheet).verticesFromColumnsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.mapping.get(e.sheet).entriesFromRowsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.mapping.get(e.sheet).entriesFromColumnsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"entries",value:regeneratorRuntime.mark(function t(){var e,n,a,i,o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=GB(this.mapping.entries()),s.prev=1,e.s();case 3:if((n=e.n()).done){s.next=8;break}return a=UB(n.value,2),i=a[0],o=a[1],s.delegateYield(o.getEntries(i),"t0",6);case 6:s.next=3;break;case 8:s.next=13;break;case 10:s.prev=10,s.t1=s.catch(1),e.e(s.t1);case 13:return s.prev=13,e.f(),s.finish(13);case 16:case"end":return s.stop()}},t,this,[[1,10,13,16]])})},{key:"sheetEntries",value:regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=this.mapping.get(e),n===void 0){i.next=5;break}return i.delegateYield(n.getEntries(e),"t0",3);case 3:i.next=6;break;case 5:throw new Me(e);case 6:case"end":return i.stop()}},t,this)})}]),r}();function qu(r,t){return KB(r)||YB(r,t)||E7(r,t)||zB()}function zB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YB(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function KB(r){if(Array.isArray(r))return r}function Br(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=E7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function E7(r,t){if(!!r){if(typeof r=="string")return R7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return R7(r,t)}}function R7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function XB(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function qB(r,t,e){return t&&b7(r.prototype,t),e&&b7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var QB=function(){function r(){XB(this,r),this.arrayMapping=new Map}return qB(r,[{key:"getArray",value:function(e){var n=this.getArrayByCorner(e.start);if(n==null?void 0:n.getRange().sameAs(e))return n}},{key:"getArrayByCorner",value:function(e){return this.arrayMapping.get(rs(e))}},{key:"setArray",value:function(e,n){this.arrayMapping.set(rs(e.start),n)}},{key:"removeArray",value:function(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(rs(e.start))}},{key:"count",value:function(){return this.arrayMapping.size}},{key:"arraysInRows",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=Br(this.arrayMapping.entries()),l.prev=1,n.s();case 3:if((a=n.n()).done){l.next=10;break}if(i=qu(a.value,2),o=i[0],u=i[1],!u.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)){l.next=8;break}return l.next=8,[o,u];case 8:l.next=3;break;case 10:l.next=15;break;case 12:l.prev=12,l.t0=l.catch(1),n.e(l.t0);case 15:return l.prev=15,n.f(),l.finish(15);case 18:case"end":return l.stop()}},t,this,[[1,12,15,18]])})},{key:"arraysInCols",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=Br(this.arrayMapping.entries()),l.prev=1,n.s();case 3:if((a=n.n()).done){l.next=10;break}if(i=qu(a.value,2),o=i[0],u=i[1],!u.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)){l.next=8;break}return l.next=8,[o,u];case 8:l.next=3;break;case 10:l.next=15;break;case 12:l.prev=12,l.t0=l.catch(1),n.e(l.t0);case 15:return l.prev=15,n.f(),l.finish(15);case 18:case"end":return l.stop()}},t,this,[[1,12,15,18]])})},{key:"isFormulaArrayInRow",value:function(e,n){var a=Br(this.arrayMapping.values()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o.spansThroughSheetRows(e,n))return!0}}catch(u){a.e(u)}finally{a.f()}return!1}},{key:"isFormulaArrayInAllRows",value:function(e){var n=!0,a=Br(e.rows()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this.isFormulaArrayInRow(e.sheet,o)||(n=!1)}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"isFormulaArrayInColumn",value:function(e,n){var a=Br(this.arrayMapping.values()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o.spansThroughSheetColumn(e,n))return!0}}catch(u){a.e(u)}finally{a.f()}return!1}},{key:"isFormulaArrayInAllColumns",value:function(e){var n=!0,a=Br(e.columns()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this.isFormulaArrayInColumn(e.sheet,o)||(n=!1)}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"isFormulaArrayInRange",value:function(e){var n=Br(this.arrayMapping.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.getRange().doesOverlap(e))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"isFormulaArrayAtAddress",value:function(e){var n=Br(this.arrayMapping.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.getRange().addressInRange(e))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"moveArrayVerticesAfterRowByRows",value:function(e,n,a){this.updateArrayVerticesInSheet(e,function(i,o){var u=o.getRange();return n<=u.start.row?[u.shifted(0,a),o]:void 0})}},{key:"moveArrayVerticesAfterColumnByColumns",value:function(e,n,a){this.updateArrayVerticesInSheet(e,function(i,o){var u=o.getRange();return n<=u.start.col?[u.shifted(a,0),o]:void 0})}},{key:"updateArrayVerticesInSheet",value:function(e,n){var a=this,i=Array(),o=Br(this.arrayMapping.entries()),u;try{for(o.s();!(u=o.n()).done;){var s=qu(u.value,2),l=s[0],f=s[1];if(f.sheet===e){var c=n(l,f);c!==void 0&&(this.removeArray(l),i.push(c))}}}catch(h){o.e(h)}finally{o.f()}i.forEach(function(h){var p=qu(h,2),y=p[0],v=p[1];a.setArray(y,v)})}}]),r}(),ZB=z,JB=H,eV=na,tV=Cn,rV=or,nV=At,aV=Xf,iV=li,oV=pi,uV=oV("splice"),sV=JB.TypeError,lV=Math.max,fV=Math.min,cV=9007199254740991,hV="Maximum allowed length exceeded";ZB({target:"Array",proto:!0,forced:!uV},{splice:function(t,e){var n=nV(this),a=rV(n),i=eV(t,a),o=arguments.length,u,s,l,f,c,h;if(o===0?u=s=0:o===1?(u=0,s=a-i):(u=o-2,s=fV(lV(tV(e),0),a-i)),a+u-s>cV)throw sV(hV);for(l=aV(n,s),f=0;f<s;f++)c=i+f,c in n&&iV(l,f,n[c]);if(l.length=s,u<s){for(f=i;f<a-s;f++)c=f+s,h=f+u,c in n?n[h]=n[c]:delete n[h];for(f=a;f>a-s+u;f--)delete n[f-1]}else if(u>s)for(f=a-s;f>i;f--)c=f+s-1,h=f+u-1,c in n?n[h]=n[c]:delete n[h];for(f=0;f<u;f++)n[f+i]=arguments[f+2];return n.length=a-s+u,l}});function pV(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=A7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function S7(r){return yV(r)||vV(r)||A7(r)||dV()}function dV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A7(r,t){if(!!r){if(typeof r=="string")return s1(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return s1(r,t)}}function vV(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function yV(r){if(Array.isArray(r))return s1(r)}function s1(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function l1(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function T7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function f1(r,t,e){return t&&T7(r.prototype,t),e&&T7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var eo=function(){function r(t){l1(this,r),this.size=t}return f1(r,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,n){throw Error("Array not computed yet.")}},{key:"simpleRangeValue",value:function(){throw Error("Array not computed yet.")}}]),r}(),c1=function(){function r(t){l1(this,r),this.size=new ue(t.length>0?t[0].length:0,t.length),this.array=t}return f1(r,[{key:"simpleRangeValue",value:function(){return V.onlyValues(this.array)}},{key:"addRows",value:function(e,n){var a;(a=this.array).splice.apply(a,[e,0].concat(S7(this.nullArrays(n,this.width())))),this.size.height+=n}},{key:"addColumns",value:function(e,n){for(var a=0;a<this.height();a++){var i;(i=this.array[a]).splice.apply(i,[e,0].concat(S7(new Array(n).fill(ne))))}this.size.width+=n}},{key:"removeRows",value:function(e,n){if(this.outOfBound(0,e)||this.outOfBound(0,n))throw Error("Array index out of bound");var a=n-e+1;this.array.splice(e,a),this.size.height-=a}},{key:"removeColumns",value:function(e,n){if(this.outOfBound(e,0)||this.outOfBound(n,0))throw Error("Array index out of bound");var a=n-e+1,i=pV(this.array),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;u.splice(e,a)}}catch(s){i.e(s)}finally{i.f()}this.size.width-=a}},{key:"nullArrays",value:function(e,n){for(var a=[],i=0;i<e;++i)a.push(new Array(n).fill(ne));return a}},{key:"get",value:function(e,n){if(this.outOfBound(e,n))throw Error("Array index out of bound");return this.array[n][e]}},{key:"set",value:function(e,n,a){if(this.outOfBound(e,n))throw Error("Array index out of bound");this.array[n][e]=a}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.array}},{key:"resize",value:function(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw"Resizing to smaller array"}},{key:"outOfBound",value:function(e,n){return e<0||n<0||n>this.size.height-1||e>this.size.width-1}}],[{key:"fromInterpreterValue",value:function(e){return e instanceof V?new r(e.data):new r([[e]])}}]),r}(),h1=function(){function r(t,e){l1(this,r),this.error=t,this.size=e}return f1(r,[{key:"get",value:function(e,n){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"simpleRangeValue",value:function(){return this.error}}]),r}();function p1(r){return p1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p1(r)}function O7(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&d1(r,t)}function d1(r,t){return d1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},d1(r,t)}function w7(r){var t=EV();return function(){var n=Qu(r),a;if(t){var i=Qu(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return mV(this,a)}}function mV(r,t){if(t&&(p1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gV(r)}function gV(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function EV(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(r){return Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qu(r)}function RV(r,t){return TV(r)||AV(r,t)||SV(r,t)||bV()}function bV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SV(r,t){if(!!r){if(typeof r=="string")return N7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N7(r,t)}}function N7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function AV(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function TV(r){if(Array.isArray(r))return r}function v1(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function C7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function y1(r,t,e){return t&&C7(r.prototype,t),e&&C7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var jt=function(){function r(t,e,n){v1(this,r),this.formula=t,this.cellAddress=e,this.version=n}return y1(r,[{key:"width",get:function(){return 1}},{key:"height",get:function(){return 1}},{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var n=e.applyTransformations(this.formula,this.cellAddress,this.version),a=RV(n,3),i=a[0],o=a[1],u=a[2];this.formula=i,this.cellAddress=o,this.version=u}}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}}],[{key:"fromAst",value:function(e,n,a,i){return a.isScalar()?new Vr(e,n,i):new Fe(e,n,a,i)}}]),r}(),Fe=function(r){O7(e,r);var t=w7(e);function e(n,a,i){var o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return v1(this,e),o=t.call(this,n,a,u),i.isRef?o.array=new h1(new m(E.REF,S.NoSpaceForArrayResult),ue.error()):o.array=new eo(i),o}return y1(e,[{key:"width",get:function(){return this.array.width()}},{key:"height",get:function(){return this.array.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}},{key:"leftCorner",get:function(){return this.cellAddress}},{key:"setCellValue",value:function(a){if(a instanceof m)return this.setErrorValue(a),a;var i=c1.fromInterpreterValue(a);return i.resize(this.array.size),this.array=i,a}},{key:"getCellValue",value:function(){if(this.array instanceof eo)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}},{key:"valueOrUndef",value:function(){if(!(this.array instanceof eo))return this.array.simpleRangeValue()}},{key:"getArrayCellValue",value:function(a){var i=a.col-this.cellAddress.col,o=a.row-this.cellAddress.row;try{return this.array.get(i,o)}catch{return new m(E.REF)}}},{key:"getArrayCellRawValue",value:function(a){var i=this.getArrayCellValue(a);if(!(i instanceof m||i===ne))return F(i)}},{key:"setArrayCellValue",value:function(a,i){var o=a.col-this.cellAddress.col,u=a.row-this.cellAddress.row;this.array instanceof c1&&this.array.set(o,u,i)}},{key:"setNoSpace",value:function(){return this.array=new h1(new m(E.SPILL,S.NoSpaceForArrayResult),ue.error()),this.getCellValue()}},{key:"getRange",value:function(){return Y.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getRangeOrUndef",value:function(){return Y.spanFromOrUndef(this.cellAddress,this.width,this.height)}},{key:"setAddress",value:function(a){this.cellAddress=a}},{key:"setFormula",value:function(a){this.formula=a}},{key:"spansThroughSheetRows",value:function(a,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i;return this.cellAddress.sheet===a&&this.cellAddress.row<=o&&i<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(a,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i;return this.cellAddress.sheet===a&&this.cellAddress.col<=o&&i<this.cellAddress.col+this.width}},{key:"isComputed",value:function(){return!(this.array instanceof eo)}},{key:"columnsFromArray",value:function(){return vn.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromArray",value:function(){return xr.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"ensureRecentData",value:function(a){}},{key:"isLeftCorner",value:function(a){return ro(this.cellAddress,a)}},{key:"setErrorValue",value:function(a){this.array=new h1(a,this.array.size)}}]),e}(jt),Vr=function(r){O7(e,r);var t=w7(e);function e(n,a,i){return v1(this,e),t.call(this,n,a,i)}return y1(e,[{key:"valueOrUndef",value:function(){return this.cachedCellValue}},{key:"setCellValue",value:function(a){return this.cachedCellValue=a,this.cachedCellValue}},{key:"getCellValue",value:function(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"isComputed",value:function(){return this.cachedCellValue!==void 0}}]),e}(jt);function OV(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function wV(r,t,e){return t&&_7(r.prototype,t),e&&_7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var Et=function(){function r(t){OV(this,r),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}return wV(r,[{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}},{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)}},{key:"setFunctionValue",value:function(e,n){this.functionCache.set(e,n)}},{key:"getCriterionFunctionValue",value:function(e,n){var a;return(a=this.getCriterionFunctionValues(e).get(n))===null||a===void 0?void 0:a[0]}},{key:"getCriterionFunctionValues",value:function(e){var n;return(n=this.criterionFunctionCache.get(e))!==null&&n!==void 0?n:new Map}},{key:"setCriterionFunctionValues",value:function(e,n){this.criterionFunctionCache.set(e,n)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(function(e){return e.criterionFunctionCache.clear()}),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}]),r}(),NV=function(t,e,n,a,i){if(e instanceof Et){var o=e.range.intersectionWith(n);return o!==void 0?Array.from(o.addresses(i)):[]}var u,s;if(e instanceof jt)u=e.getFormula(a),s=e.getAddress(a);else return[];return xh(u,t).filter(function(l){return l instanceof Cg}).map(function(l){return l.dependency.toSimpleCellAddress(s)}).filter(function(l){return n.addressInRange(l)})},CV=z,_V=Q,IV=hi,MV=_V([].reverse),I7=[1,2];CV({target:"Array",proto:!0,forced:String(I7)===String(I7.reverse())},{reverse:function(){return IV(this)&&(this.length=this.length),MV(this)}});function M7(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=kV(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function kV(r,t){if(!!r){if(typeof r=="string")return k7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return k7(r,t)}}function k7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function FV(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function F7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function PV(r,t,e){return t&&F7(r.prototype,t),e&&F7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var Gr;(function(r){r[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED"})(Gr||(Gr={}));var $V=function(){function r(t){FV(this,r),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}return PV(r,[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,n){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(n))throw new Error("Unknown node ".concat(n));this.edges.get(e).add(n)}},{key:"removeEdge",value:function(e,n){if(this.existsEdge(e,n))this.edges.get(e).delete(n);else throw new Error("Edge does not exist")}},{key:"softRemoveEdge",value:function(e,n){var a;(a=this.edges.get(e))===null||a===void 0||a.delete(n)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach(function(n){n.delete(e)})}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach(function(n){return e+=n.size}),e}},{key:"removeNode",value:function(e){var n=M7(this.adjacentNodes(e).values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.markNodeAsSpecialRecentlyChanged(i)}}catch(o){n.e(o)}finally{n.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,n){var a,i;return(i=(a=this.edges.get(e))===null||a===void 0?void 0:a.has(n))!==null&&i!==void 0?i:!1}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),function(){return!0},function(){})}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,n,a){var i=this,o=new Map,u=new Map,s=new Map,l=new Set,f=new Map,c=[],h=0,p=new Set;e.reverse(),e.forEach(function(g){if(f.get(g)===void 0){var A=[g],T=[];f.set(g,Gr.ON_STACK);for(var N=function(){var _=A[A.length-1];switch(f.get(_)){case Gr.ON_STACK:{o.set(_,h),u.set(_,h),T.push(_),h++,i.adjacentNodes(_).forEach(function(D){o.get(D)===void 0&&(A.push(D),s.set(D,_),f.set(D,Gr.ON_STACK))}),f.set(_,Gr.PROCESSED);break}case Gr.PROCESSED:{var $;if($=o.get(_),i.adjacentNodes(_).forEach(function(D){l.has(D)||(s.get(D)===_?$=Math.min($,u.get(D)):$=Math.min($,o.get(D)))}),u.set(_,$),$===o.get(_)){var x=[];do x.push(T[T.length-1]),T.pop();while(x[x.length-1]!==_);x.forEach(function(D){l.add(D)}),c.push.apply(c,x),x.length>1&&x.forEach(function(D){p.add(D)})}A.pop(),f.set(_,Gr.POPPED);break}case Gr.POPPED:{A.pop();break}}};A.length>0;)N()}});var y=new Set(e),v=[],R=[];return c.reverse(),c.forEach(function(g){p.has(g)||i.adjacentNodes(g).has(g)?(R.push(g),a(g),i.adjacentNodes(g).forEach(function(A){return y.add(A)})):(v.push(g),y.has(g)&&n(g)&&i.adjacentNodes(g).forEach(function(A){return y.add(A)}))}),{sorted:v,cycled:R}}},{key:"getDependencies",value:function(e){var n=[];return this.edges.forEach(function(a,i){a.has(e)&&n.push(i)}),n}},{key:"removeDependencies",value:function(e){var n=this.dependencyQuery(e),a=M7(n),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this.softRemoveEdge(o,e)}}catch(u){a.e(u)}finally{a.f()}return n}}]),r}();function m1(r,t){return UV(r)||LV(r,t)||P7(r,t)||DV()}function DV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LV(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function UV(r){if(Array.isArray(r))return r}function g1(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=P7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function P7(r,t){if(!!r){if(typeof r=="string")return $7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $7(r,t)}}function $7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function xV(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function D7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function BV(r,t,e){return t&&D7(r.prototype,t),e&&D7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var VV=function(){function r(){xV(this,r),this.rangeMapping=new Map}return BV(r,[{key:"getMappingSize",value:function(e){var n,a;return(a=(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.size)!==null&&a!==void 0?a:0}},{key:"setRange",value:function(e){var n=this.rangeMapping.get(e.getStart().sheet);n===void 0&&(n=new Map,this.rangeMapping.set(e.getStart().sheet,n));var a=Zu(e.getStart(),e.getEnd());n.set(a,e)}},{key:"removeRange",value:function(e){var n=e.getStart().sheet,a=this.rangeMapping.get(n);if(a!==void 0){var i=Zu(e.getStart(),e.getEnd());a.delete(i),a.size===0&&this.rangeMapping.delete(n)}}},{key:"getRange",value:function(e,n){var a=this.rangeMapping.get(e.sheet),i=Zu(e,n);return a==null?void 0:a.get(i)}},{key:"fetchRange",value:function(e,n){var a=this.getRange(e,n);if(!a)throw Error("Range does not exist");return a}},{key:"truncateRanges",value:function(e,n){var a=Array(),i=Array(),o=Array(),u=e.sheet,s=g1(this.entriesFromSheet(e.sheet)),l;try{for(s.s();!(l=s.n()).done;){var f=m1(l.value,2),c=f[0],h=f[1],p=h.range;e.start<=n(h.range.end)&&(p.removeSpan(e),p.shouldBeRemoved()?(this.removeByKey(u,c),a.push(h)):i.push([c,h]),o.push(h))}}catch(_){s.e(_)}finally{s.f()}var y=[];i.sort(function(_,$){return jV(_[1],$[1],n)});for(var v=0,R=i;v<R.length;v++){var g=m1(R[v],2),A=g[0],T=g[1],N=GV(T.range);if(N!==A){var M=this.getByKey(u,N);this.removeByKey(u,A),M!==void 0&&T!=M?y.push([M,T]):this.setRange(T)}}return{verticesToRemove:a,verticesToMerge:y,verticesWithChangedSize:o}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,n,a){return this.updateVerticesFromSheet(e,function(i,o){return n<=o.start.row?(o.range.shiftByRows(a),{changedSize:!1,vertex:o}):n>o.start.row&&n<=o.end.row?(o.range.expandByRows(a),{changedSize:!0,vertex:o}):void 0})}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,n,a){return this.updateVerticesFromSheet(e,function(i,o){return n<=o.start.col?(o.range.shiftByColumns(a),{changedSize:!1,vertex:o}):n>o.start.col&&n<=o.end.col?(o.range.expandByColumns(a),{changedSize:!0,vertex:o}):void 0})}},{key:"moveRangesInsideSourceRange",value:function(e,n,a,i){this.updateVerticesFromSheet(e.sheet,function(o,u){if(e.containsRange(u.range))return u.range.shiftByColumns(n),u.range.shiftByRows(a),u.range.moveToSheet(i),{changedSize:!1,vertex:u}})}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var n=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),n}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=this.rangeMapping.get(e),n){i.next=3;break}return i.abrupt("return");case 3:return i.delegateYield(n.values(),"t0",4);case 4:case"end":return i.stop()}},t,this)})},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=g1(this.rangesInSheet(e.sheet)),u.prev=1,n.s();case 3:if((a=n.n()).done){u.next=10;break}if(i=a.value,!e.containsRange(i.range)){u.next=8;break}return u.next=8,i;case 8:u.next=3;break;case 10:u.next=15;break;case 12:u.prev=12,u.t0=u.catch(1),n.e(u.t0);case 15:return u.prev=15,n.f(),u.finish(15);case 18:case"end":return u.stop()}},t,this,[[1,12,15,18]])})},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var n=P(e.end.sheet,e.end.col,e.end.row-1),a=this.getRange(e.start,n);if(a!==void 0){var i=new Y(P(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:a,restRange:i}}}return{restRange:e}}},{key:"entriesFromSheet",value:regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=this.rangeMapping.get(e),n){i.next=3;break}return i.abrupt("return");case 3:return i.delegateYield(n.entries(),"t0",4);case 4:case"end":return i.stop()}},t,this)})},{key:"removeByKey",value:function(e,n){this.rangeMapping.get(e).delete(n)}},{key:"getByKey",value:function(e,n){var a;return(a=this.rangeMapping.get(e))===null||a===void 0?void 0:a.get(n)}},{key:"updateVerticesFromSheet",value:function(e,n){var a=this,i=Array(),o=g1(this.entriesFromSheet(e)),u;try{for(o.s();!(u=o.n()).done;){var s=m1(u.value,2),l=s[0],f=s[1],c=n(l,f);c!==void 0&&(this.removeByKey(e,l),i.push(c))}}catch(h){o.e(h)}finally{o.f()}return i.forEach(function(h){a.setRange(h.vertex)}),{verticesWithChangedSize:i.filter(function(h){return h.changedSize}).map(function(h){return h.vertex})}}}]),r}();function Zu(r,t){return"".concat(r.col,",").concat(r.row,",").concat(t.col,",").concat(t.row)}function GV(r){return Zu(r.start,r.end)}var jV=function(t,e,n){var a=n(t.range.start),i=n(t.range.start);if(a===i){var o=n(t.range.end),u=n(e.range.end);return o-u}else return a-i},HV=z,WV=At,L7=ci,zV=re,YV=zV(function(){L7(1)});HV({target:"Object",stat:!0,forced:YV},{keys:function(t){return L7(WV(t))}});var KV=tt,U7=Q,XV=ci,qV=ar,QV=qa.f,ZV=U7(QV),JV=U7([].push),x7=function(r){return function(t){for(var e=qV(t),n=XV(e),a=n.length,i=0,o=[],u;a>i;)u=n[i++],(!KV||ZV(e,u))&&JV(o,r?[u,e[u]]:e[u]);return o}},B7={entries:x7(!0),values:x7(!1)},eG=z,tG=B7.values;eG({target:"Object",stat:!0},{values:function(t){return tG(t)}});function V7(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=rG(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function rG(r,t){if(!!r){if(typeof r=="string")return G7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return G7(r,t)}}function G7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function nG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function j7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function aG(r,t,e){return t&&j7(r.prototype,t),e&&j7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var iG=function(){function r(t,e,n){nG(this,r),this.functions=t,this.errors=e,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}return aG(r,[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce(function(n,a){return n[e.functions[a]]=a,n},{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce(function(n,a){return n[e.errors[a]]=a,n},{})}},{key:"isFunctionTranslated",value:function(e){return this.functions[e]!==void 0}},{key:"getFunctionTranslations",value:function(e){var n=[],a=V7(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this.isFunctionTranslated(o)&&n.push(this.functions[o])}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"getFunctionTranslation",value:function(e){var n=this.functions[e];if(n===void 0)throw new ha("functions.".concat(e));return n}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===E.LIC)return"#".concat(E.LIC,"!");var n=this.errors[e];if(n===void 0)throw new ha("errors.".concat(e));return n}},{key:"getUITranslation",value:function(e){var n=this.ui[e];if(n===void 0)throw new ha("ui.".concat(e));return n}},{key:"checkUI",value:function(){for(var e=0,n=Object.values(to);e<n.length;e++){var a=n[e];if(!(a in this.ui))throw new ha("ui.".concat(a))}}},{key:"checkErrors",value:function(){for(var e=0,n=Object.values(E);e<n.length;e++){var a=n[e];if(!(a in this.errors)&&a!==E.LIC)throw new ha("errors.".concat(a))}}},{key:"checkFunctionTranslations",value:function(e){var n=new Set(Object.getOwnPropertyNames(e)),a=V7(Object.getOwnPropertyNames(this._protectedTranslations)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;if(n.has(o))throw new Yy(o)}}catch(u){a.e(u)}finally{a.f()}}}]),r}();function oG(r){return new iG(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var to;(function(r){r.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(to||(to={}));function uG(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=sG(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function sG(r,t){if(!!r){if(typeof r=="string")return H7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return H7(r,t)}}function H7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function W7(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function z7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Y7(r,t,e){return t&&z7(r.prototype,t),e&&z7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ia(r){return r.toLowerCase()}var lG=function(){function r(t,e){W7(this,r),this.id=t,this.displayName=e}return Y7(r,[{key:"canonicalName",get:function(){return Ia(this.displayName)}}]),r}(),fG=function(){function r(t){var e=this;W7(this,r),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(n){var a=e.mappingFromCanonicalName.get(Ia(n));if(a===void 0)throw new $y(n);return a.id},this.get=function(n){var a;return(a=e.mappingFromCanonicalName.get(Ia(n)))===null||a===void 0?void 0:a.id},this.fetchDisplayName=function(n){return e.fetchSheetById(n).displayName},this.sheetNamePrefix=t.getUITranslation(to.NEW_SHEET_PREFIX)}return Y7(r,[{key:"addSheet",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),n=Ia(e);if(this.mappingFromCanonicalName.has(n))throw new _i(e);this.lastSheetId++;var a=new lG(this.lastSheetId,e);return this.store(a),a.id}},{key:"removeSheet",value:function(e){var n=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(n.canonicalName),this.mappingFromId.delete(n.id)}},{key:"getDisplayName",value:function(e){var n;return(n=this.mappingFromId.get(e))===null||n===void 0?void 0:n.displayName}},{key:"displayNames",value:regeneratorRuntime.mark(function t(){var e,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=uG(this.mappingFromCanonicalName.values()),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=9;break}return a=n.value,o.next=7,a.displayName;case 7:o.next=3;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),e.e(o.t0);case 14:return o.prev=14,e.f(),o.finish(14);case 17:case"end":return o.stop()}},t,this,[[1,11,14,17]])})},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(Ia(e))}},{key:"renameSheet",value:function(e,n){var a=this.fetchSheetById(e),i=a.displayName;if(i!==n){var o=this.mappingFromCanonicalName.get(Ia(n));if(o!==void 0&&o.id!==a.id)throw new _i(n);var u=a.canonicalName;return this.mappingFromCanonicalName.delete(u),a.displayName=n,this.store(a),i}}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map(function(e){return e.displayName})}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var n=this.mappingFromId.get(e);if(n===void 0)throw new Me(e);return n}}]),r}();function Ju(r,t,e){return cG()?Ju=Reflect.construct:Ju=function(a,i,o){var u=[null];u.push.apply(u,i);var s=Function.bind.apply(a,u),l=new s;return o&&E1(l,o.prototype),l},Ju.apply(null,arguments)}function cG(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function E1(r,t){return E1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},E1(r,t)}function R1(r){return dG(r)||pG(r)||b1(r)||hG()}function hG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pG(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function dG(r){if(Array.isArray(r))return S1(r)}function W(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=b1(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function bt(r,t){return mG(r)||yG(r,t)||b1(r,t)||vG()}function vG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b1(r,t){if(!!r){if(typeof r=="string")return S1(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return S1(r,t)}}function S1(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function yG(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function mG(r){if(Array.isArray(r))return r}function gG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function EG(r,t,e){return t&&K7(r.prototype,t),e&&K7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var RG=function(){function r(t,e,n,a,i,o,u,s){var l=this;gG(this,r),this.addressMapping=t,this.rangeMapping=e,this.sheetMapping=n,this.arrayMapping=a,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=u,this.namedExpressions=s,this.changes=_a.empty(),this.dependencyQueryAddresses=function(f){if(f instanceof Et)return l.rangeDependencyQuery(f).map(function(v){var R=bt(v,2),g=R[0];return R[1],g});var c=l.formulaDependencyQuery(f);if(c!==void 0){var h=bt(c,2),p=h[0],y=h[1];return y.map(function(v){return v instanceof dn?l.namedExpressions.namedExpressionOrPlaceholder(v.name,p.sheet).address:He(v)?v:jh(v.start,v.end)})}else return[]},this.dependencyQueryVertices=function(f){if(f instanceof Et)return l.rangeDependencyQuery(f).map(function(v){var R=bt(v,2);R[0];var g=R[1];return g});var c=l.formulaDependencyQuery(f);if(c!==void 0){var h=bt(c,2),p=h[0],y=h[1];return y.map(function(v){if(v instanceof Y)return l.rangeMapping.fetchRange(v.start,v.end);if(v instanceof dn){var R=l.namedExpressions.namedExpressionOrPlaceholder(v.name,p.sheet);return l.addressMapping.fetchCell(R.address)}else return l.addressMapping.fetchCell(v)})}else return[]},this.rangeDependencyQuery=function(f){var c=[],h=l.rangeMapping.findSmallerRange(f.range),p=h.smallerRangeVertex,y=h.restRange,v;p!==void 0&&l.graph.adjacentNodes(p).has(f)?(v=y,c.push([new Y(p.start,p.end),p])):v=f.range;var R=W(v.addresses(l)),g;try{for(R.s();!(g=R.n()).done;){var A=g.value,T=l.addressMapping.getCell(A);T instanceof jr&&(T.address=A),T!==void 0&&c.push([A,T])}}catch(N){R.e(N)}finally{R.f()}return c},this.formulaDependencyQuery=function(f){var c,h;if(f instanceof jt)h=f.getAddress(l.lazilyTransformingAstService),c=f.getFormula(l.lazilyTransformingAstService);else return;var p=xh(c,l.functionRegistry);return[h,br(p,h)]},this.graph=new $V(this.dependencyQueryVertices)}return EG(r,[{key:"setFormulaToCell",value:function(e,n,a,i,o,u){var s=jt.fromAst(n,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(a,s),this.graph.markNodeAsSpecialRecentlyChanged(s),o&&this.markAsVolatile(s),u&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setParsingErrorToCell",value:function(e,n){var a=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(a,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsSpecialRecentlyChanged(n),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setValueToCell",value:function(e,n){var a=this.shrinkPossibleArrayAndGetCell(e);if(a instanceof Fe&&this.arrayMapping.removeArray(a.getRange()),a instanceof mn){var i=a.getValues();i.rawValue!==n.rawValue&&(a.setValues(n),this.graph.markNodeAsSpecialRecentlyChanged(a))}else{var o=new mn(n.parsedValue,n.rawValue);this.exchangeOrAddGraphNode(a,o),this.addressMapping.setCell(e,o),this.graph.markNodeAsSpecialRecentlyChanged(o)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}},{key:"setCellEmpty",value:function(e){var n=this.shrinkPossibleArrayAndGetCell(e);if(n===void 0)return _a.empty();if(this.graph.adjacentNodes(n).size>0){var a=new jr(e);this.exchangeGraphNode(n,a),this.graph.adjacentNodesCount(a)===0?(this.removeVertex(a),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(a),this.addressMapping.setCell(e,a))}else this.removeVertex(n),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}},{key:"ensureThatVertexIsNonArrayCellVertex",value:function(e){if(e instanceof Fe)throw new Error("Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(R1(this.graph.specialNodesRecentlyChanged),R1(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,n){var a=this;e.forEach(function(i){if(i instanceof Y){var o=i,u=a.getRange(o.start,o.end);u===void 0&&(u=new Et(o),a.rangeMapping.setRange(u)),a.graph.addNode(u),o.isFinite()||a.graph.markNodeAsInfiniteRange(u);var s=a.rangeMapping.findSmallerRange(o),l=s.smallerRangeVertex,f=s.restRange;if(l!==void 0){if(a.graph.addEdge(l,u),u.bruteForce){u.bruteForce=!1;var c=W(o.addresses(a)),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;a.graph.removeEdge(a.fetchCell(p),u)}}catch(N){c.e(N)}finally{c.f()}}}else u.bruteForce=!0;var y=a.arrayMapping.getArray(f);if(y!==void 0)a.graph.addEdge(y,u);else{var v=W(f.addresses(a)),R;try{for(v.s();!(R=v.n()).done;){var g=R.value;a.graph.addEdge(a.fetchCellOrCreateEmpty(g),u)}}catch(N){v.e(N)}finally{v.f()}}a.graph.addEdge(u,n),o.isFinite()&&a.correctInfiniteRangesDependenciesByRangeVertex(u)}else if(i instanceof dn){var A=n.getAddress(a.lazilyTransformingAstService).sheet,T=a.fetchNamedExpressionVertex(i.name,A);a.graph.addEdge(T,n)}else a.graph.addEdge(a.fetchCellOrCreateEmpty(i),n)})}},{key:"fetchNamedExpressionVertex",value:function(e,n){var a=this.namedExpressions.namedExpressionOrPlaceholder(e,n);return this.fetchCellOrCreateEmpty(a.address)}},{key:"exchangeNode",value:function(e,n){var a=this.fetchCellOrCreateEmpty(e),i=this.fetchCellOrCreateEmpty(n);this.addressMapping.removeCell(e),this.exchangeGraphNode(a,i)}},{key:"correctInfiniteRangesDependency",value:function(e){var n=void 0,a=W(this.graph.infiniteRanges),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o;u.range.addressInRange(e)&&(n=n!=null?n:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(n,u))}}catch(s){a.e(s)}finally{a.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var n=this.addressMapping.getCell(e);return n===void 0&&(n=new jr(e),this.graph.addNode(n),this.addressMapping.setCell(e,n)),n}},{key:"removeRows",value:function(e){var n=this;this.stats.measure(X.ADJUSTING_GRAPH,function(){var i=W(n.addressMapping.entriesFromRowsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=bt(o.value,2),s=u[0],l=u[1],f=W(n.graph.adjacentNodes(l)),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;n.graph.markNodeAsSpecialRecentlyChanged(h)}}catch(p){f.e(p)}finally{f.f()}if(l instanceof Fe)if(l.isLeftCorner(s))n.shrinkArrayToCorner(l),n.arrayMapping.removeArray(l.getRange());else continue;n.removeVertex(l)}}catch(p){i.e(p)}finally{i.f()}}),this.stats.measure(X.ADJUSTING_ADDRESS_MAPPING,function(){n.addressMapping.removeRows(e)});var a=this.stats.measure(X.ADJUSTING_RANGES,function(){var i=n.truncateRanges(e,function(o){return o.row});return n.getArrayVerticesRelatedToRanges(i)});return this.stats.measure(X.ADJUSTING_ARRAY_MAPPING,function(){n.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:a,contentChanges:this.getAndClearContentChanges()}}},{key:"removeSheet",value:function(e){var n=this,a=new Set,i=W(this.addressMapping.sheetEntries(e)),o;try{for(i.s();!(o=i.n()).done;){var u=bt(o.value,2),s=u[0],l=u[1];if(l instanceof Fe){if(a.has(l))continue;a.add(l)}var f=W(this.graph.adjacentNodes(l)),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;this.graph.markNodeAsSpecialRecentlyChanged(h)}}catch(p){f.e(p)}finally{f.f()}this.removeVertex(l),this.addressMapping.removeCell(s)}}catch(p){i.e(p)}finally{i.f()}this.stats.measure(X.ADJUSTING_ARRAY_MAPPING,function(){var p=W(a.values()),y;try{for(p.s();!(y=p.n()).done;){var v=y.value;n.arrayMapping.removeArray(v.getRange())}}catch(R){p.e(R)}finally{p.f()}}),this.stats.measure(X.ADJUSTING_RANGES,function(){var p=n.rangeMapping.removeRangesInSheet(e),y=W(p),v;try{for(y.s();!(v=y.n()).done;){var R=v.value;n.removeVertex(R)}}catch(g){y.e(g)}finally{y.f()}n.stats.measure(X.ADJUSTING_ADDRESS_MAPPING,function(){n.addressMapping.removeSheet(e)})}),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var n=new Set,a=W(this.addressMapping.sheetEntries(e)),i;try{for(a.s();!(i=a.n()).done;){var o=bt(i.value,2),u=o[0],s=o[1];s instanceof Fe?n.add(s):this.setCellEmpty(u)}}catch(h){a.e(h)}finally{a.f()}var l=W(n.values()),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;this.setArrayEmpty(c)}}catch(h){l.e(h)}finally{l.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var n=this;this.stats.measure(X.ADJUSTING_GRAPH,function(){var i=W(n.addressMapping.entriesFromColumnsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=bt(o.value,2),s=u[0],l=u[1],f=W(n.graph.adjacentNodes(l)),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;n.graph.markNodeAsSpecialRecentlyChanged(h)}}catch(p){f.e(p)}finally{f.f()}if(l instanceof Fe)if(l.isLeftCorner(s))n.shrinkArrayToCorner(l),n.arrayMapping.removeArray(l.getRange());else continue;n.removeVertex(l)}}catch(p){i.e(p)}finally{i.f()}}),this.stats.measure(X.ADJUSTING_ADDRESS_MAPPING,function(){n.addressMapping.removeColumns(e)});var a=this.stats.measure(X.ADJUSTING_RANGES,function(){var i=n.truncateRanges(e,function(o){return o.col});return n.getArrayVerticesRelatedToRanges(i)});return this.stats.measure(X.ADJUSTING_ARRAY_MAPPING,function(){return n.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)}),this.addStructuralNodesToChangeSet(),{affectedArrays:a,contentChanges:this.getAndClearContentChanges()}}},{key:"addRows",value:function(e){var n=this;this.stats.measure(X.ADJUSTING_ADDRESS_MAPPING,function(){n.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});var a=this.stats.measure(X.ADJUSTING_RANGES,function(){var s=n.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return n.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),n.getArrayVerticesRelatedToRanges(s.verticesWithChangedSize)});this.stats.measure(X.ADJUSTING_ARRAY_MAPPING,function(){n.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});var i=W(this.addressMapping.verticesFromRowsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;this.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(s){i.e(s)}finally{i.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:a}}},{key:"addColumns",value:function(e){var n=this;this.stats.measure(X.ADJUSTING_ADDRESS_MAPPING,function(){n.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});var a=this.stats.measure(X.ADJUSTING_RANGES,function(){var s=n.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return n.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),n.getArrayVerticesRelatedToRanges(s.verticesWithChangedSize)});this.stats.measure(X.ADJUSTING_ARRAY_MAPPING,function(){return n.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)});var i=W(this.addressMapping.verticesFromColumnsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;this.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(s){i.e(s)}finally{i.f()}return this.addStructuralNodesToChangeSet(),{affectedArrays:a,contentChanges:this.getAndClearContentChanges()}}},{key:"ensureNoArrayInRange",value:function(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}},{key:"isThereSpaceForArray",value:function(e){var n=e.getRangeOrUndef();if(n===void 0)return!1;var a=W(n.addresses(this)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.addressMapping.getCell(o);if(u!==void 0&&!(u instanceof jr)&&u!==e)return!1}}catch(s){a.e(s)}finally{a.f()}return!0}},{key:"moveCells",value:function(e,n,a,i){var o=W(e.addressesWithDirection(n,a,this)),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=P(i,s.col+n,s.row+a),f=this.addressMapping.getCell(s),c=this.addressMapping.getCell(l);if(this.addressMapping.removeCell(s),f!==void 0){this.graph.markNodeAsSpecialRecentlyChanged(f),this.addressMapping.setCell(l,f);var h=void 0,p=W(this.graph.adjacentNodes(f)),y;try{for(p.s();!(y=p.n()).done;){var v=y.value;v instanceof Et&&!e.containsRange(v.range)&&(h=h!=null?h:this.fetchCellOrCreateEmpty(s),this.graph.addEdge(h,v),this.graph.removeEdge(f,v))}}catch(q){p.e(q)}finally{p.f()}h&&(this.graph.markNodeAsSpecialRecentlyChanged(h),this.addressMapping.setCell(s,h))}if(c!==void 0){f===void 0&&this.addressMapping.removeCell(l);var R=W(this.graph.adjacentNodes(c)),g;try{for(R.s();!(g=R.n()).done;){var A=g.value;f=f!=null?f:this.fetchCellOrCreateEmpty(l),this.graph.addEdge(f,A),this.graph.markNodeAsSpecialRecentlyChanged(f)}}catch(q){R.e(q)}finally{R.f()}this.removeVertex(c)}}}catch(q){o.e(q)}finally{o.f()}var T=W(this.rangeMapping.rangeVerticesContainedInRange(e)),N;try{for(T.s();!(N=T.n()).done;){var M=N.value,_=W(this.graph.adjacentNodes(M)),$;try{for(_.s();!($=_.n()).done;){var x=$.value;if(x instanceof Et&&!e.containsRange(x.range)){this.graph.removeEdge(M,x);var D=W(M.range.addresses(this)),K;try{for(D.s();!(K=D.n()).done;){var Z=K.value,ie=this.fetchCellOrCreateEmpty(Z);this.graph.addEdge(ie,x),this.addressMapping.setCell(Z,ie),this.graph.markNodeAsSpecialRecentlyChanged(ie)}}catch(q){D.e(q)}finally{D.f()}}}}catch(q){_.e(q)}finally{_.f()}}}catch(q){T.e(q)}finally{T.f()}this.rangeMapping.moveRangesInsideSourceRange(e,n,a,i)}},{key:"setArrayEmpty",value:function(e){var n=Y.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),a=this.graph.adjacentNodes(e),i=W(n.addresses(this)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;this.addressMapping.removeCell(u)}}catch(R){i.e(R)}finally{i.f()}var s=W(a.values()),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,c=NV(this.functionRegistry,f,e.getRange(),this.lazilyTransformingAstService,this),h=W(c),p;try{for(h.s();!(p=h.n()).done;){var y=p.value,v=this.fetchCellOrCreateEmpty(y);this.graph.addEdge(v,f)}}catch(R){h.e(R)}finally{h.f()}c.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(f)}}catch(R){s.e(R)}finally{s.f()}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}},{key:"addVertex",value:function(e,n){this.graph.addNode(n),this.addressMapping.setCell(e,n)}},{key:"addArrayVertex",value:function(e,n){this.graph.addNode(n),this.setAddressMappingForArrayVertex(n,e)}},{key:"arrayFormulaNodes",value:regeneratorRuntime.mark(function t(){var e,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=W(this.graph.nodes),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=10;break}if(a=n.value,!(a instanceof Fe)){o.next=8;break}return o.next=8,a;case 8:o.next=3;break;case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(1),e.e(o.t0);case 15:return o.prev=15,e.f(),o.finish(15);case 18:case"end":return o.stop()}},t,this,[[1,12,15,18]])})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.addressMapping.entriesFromRowsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this.addressMapping.entriesFromColumnsSpan(e),"t0",1);case 1:case"end":return a.stop()}},t,this)})},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getRawValue",value:function(e){return this.addressMapping.getRawValue(e)}},{key:"getScalarValue",value:function(e){var n=this.addressMapping.getCellValue(e);return n instanceof V?new m(E.VALUE,S.ScalarExpected):n}},{key:"existsEdge",value:function(e,n){return this.graph.existsEdge(e,n)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getArray",value:function(e){return this.arrayMapping.getArray(e)}},{key:"setArray",value:function(e,n){this.arrayMapping.setArray(e,n)}},{key:"getRange",value:function(e,n){return this.rangeMapping.getRange(e,n)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e=W(this.graph.nodes.values()),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;a instanceof Vr&&a.ensureRecentData(this.lazilyTransformingAstService)}}catch(i){e.e(i)}finally{e.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"getArrayVerticesRelatedToRanges",value:function(e){var n=this,a=e.map(function(i){return n.graph.hasNode(i)?Array.from(n.graph.adjacentNodes(i)).filter(function(o){return o instanceof Fe}):[]});return Ju(Set,R1(a))}},{key:"rawValuesFromRange",value:regeneratorRuntime.mark(function t(e){var n,a,i,o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n=W(e.addresses(this)),s.prev=1,n.s();case 3:if((a=n.n()).done){s.next=11;break}if(i=a.value,o=this.getScalarValue(i),o===ne){s.next=9;break}return s.next=9,[F(o),i];case 9:s.next=3;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),n.e(s.t0);case 16:return s.prev=16,n.f(),s.finish(16);case 19:case"end":return s.stop()}},t,this,[[1,13,16,19]])})},{key:"entriesFromRange",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=W(e.addresses(this)),u.prev=1,n.s();case 3:if((a=n.n()).done){u.next=9;break}return i=a.value,u.next=7,[i,this.getCell(i)];case 7:u.next=3;break;case 9:u.next=14;break;case 11:u.prev=11,u.t0=u.catch(1),n.e(u.t0);case 14:return u.prev=14,n.f(),u.finish(14);case 17:case"end":return u.stop()}},t,this,[[1,11,14,17]])})},{key:"exchangeGraphNode",value:function(e,n){var a=this;this.graph.addNode(n);var i=this.graph.adjacentNodes(e);this.removeVertex(e),i.forEach(function(o){a.graph.hasNode(o)&&a.graph.addEdge(n,o)})}},{key:"exchangeOrAddGraphNode",value:function(e,n){e?this.exchangeGraphNode(e,n):this.graph.addNode(n)}},{key:"computeListOfValuesInRange",value:function(e){var n=[],a=W(e.addresses(this)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.getScalarValue(o);n.push(u)}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"shrinkArrayToCorner",value:function(e){this.cleanAddressMappingUnderArray(e);var n=W(this.adjacentArrayVertices(e)),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=void 0;i instanceof jt?o=this.formulaDirectDependenciesToArray(i,e):o=this.rangeDirectDependenciesToArray(i,e);var u=!1,s=W(o),l;try{for(s.s();!(l=s.n()).done;){var f=bt(l.value,2),c=f[0],h=f[1];e.isLeftCorner(c)&&(u=!0),this.graph.addEdge(h,i),this.graph.markNodeAsSpecialRecentlyChanged(h)}}catch(p){s.e(p)}finally{s.f()}u||this.graph.removeEdge(e,i)}}catch(p){n.e(p)}finally{n.f()}this.graph.markNodeAsSpecialRecentlyChanged(e)}},{key:"isArrayInternalCell",value:function(e){var n=this.getCell(e);return n instanceof Fe&&!n.isLeftCorner(e)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=_a.empty(),e}},{key:"getAdjacentNodesAddresses",value:function(e){var n=this,a=this.graph.adjacentNodes(e),i=[];return a.forEach(function(o){var u=o;u instanceof Et?i.push(jh(u.start,u.end)):i.push(u.getAddress(n.lazilyTransformingAstService))}),i}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var n=W(this.graph.infiniteRanges),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i,u=e.range.intersectionWith(o.range);if(u!==void 0){var s=W(u.addresses(this)),l;try{for(s.s();!(l=s.n()).done;){var f=l.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(f),i)}}catch(c){s.e(c)}finally{s.f()}}}}catch(c){n.e(c)}finally{n.f()}}},{key:"cleanAddressMappingUnderArray",value:function(e){var n=e.getRange(),a=W(n.addresses(this)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=e.getArrayCellValue(o);this.getCell(o)===e?e.isLeftCorner(o)?this.changes.addChange(new m(E.REF),o,u):(this.addressMapping.removeCell(o),this.changes.addChange(ne,o,u)):this.changes.addChange(ne,o,u)}}catch(s){a.e(s)}finally{a.f()}}},{key:"formulaDirectDependenciesToArray",value:regeneratorRuntime.mark(function t(e,n){var a,i,o,u,s,l,f,c;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(i=(a=this.formulaDependencyQuery(e))!==null&&a!==void 0?a:[],o=bt(i,2),u=o[1],u!==void 0){p.next=3;break}return p.abrupt("return");case 3:s=W(u),p.prev=4,s.s();case 6:if((l=s.n()).done){p.next=16;break}if(f=l.value,!(f instanceof dn||f instanceof Y)){p.next=10;break}return p.abrupt("continue",14);case 10:if(!n.getRange().addressInRange(f)){p.next=14;break}return c=this.fetchCellOrCreateEmpty(f),p.next=14,[f,c];case 14:p.next=6;break;case 16:p.next=21;break;case 18:p.prev=18,p.t0=p.catch(4),s.e(p.t0);case 21:return p.prev=21,s.f(),p.finish(21);case 24:case"end":return p.stop()}},t,this,[[4,18,21,24]])})},{key:"rangeDirectDependenciesToArray",value:regeneratorRuntime.mark(function t(e,n){var a,i,o,u,s,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=this.rangeMapping.findSmallerRange(e.range),i=a.restRange,o=W(i.addresses(this)),c.prev=2,o.s();case 4:if((u=o.n()).done){c.next=12;break}if(s=u.value,!n.getRange().addressInRange(s)){c.next=10;break}return l=this.fetchCellOrCreateEmpty(s),c.next=10,[s,l];case 10:c.next=4;break;case 12:c.next=17;break;case 14:c.prev=14,c.t0=c.catch(2),o.e(c.t0);case 17:return c.prev=17,o.f(),c.finish(17);case 20:case"end":return c.stop()}},t,this,[[2,14,17,20]])})},{key:"adjacentArrayVertices",value:regeneratorRuntime.mark(function t(e){var n,a,i,o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n=this.graph.adjacentNodes(e),a=W(n),s.prev=2,a.s();case 4:if((i=a.n()).done){s.next=11;break}if(o=i.value,!(o instanceof jt||o instanceof Et)){s.next=9;break}return s.next=9,o;case 9:s.next=4;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(2),a.e(s.t0);case 16:return s.prev=16,a.f(),s.finish(16);case 19:case"end":return s.stop()}},t,this,[[2,13,16,19]])})},{key:"addStructuralNodesToChangeSet",value:function(){var e=W(this.graph.specialNodesStructuralChanges),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;this.graph.markNodeAsSpecialRecentlyChanged(a)}}catch(i){e.e(i)}finally{e.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,n,a){for(var i=Array.from(this.rangeMapping.rangesInSheet(e)),o=0,u=i;o<u.length;o++){var s=u[o];if(s.range.includesRow(n+a))if(s.bruteForce){var l=s.range.rangeWithSameWidth(n,a),f=W(l.addresses(this)),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(h),s)}}catch(g){f.e(g)}finally{f.f()}}else{var p=s,y=this.rangeMapping.findSmallerRange(p.range);if(y.smallerRangeVertex!==void 0)continue;for(;y.smallerRangeVertex===void 0;){var v=new Et(Y.spanFrom(p.range.start,p.range.width(),p.range.height()-1));this.rangeMapping.setRange(v),this.graph.addNode(v);var R=new Y(P(p.range.start.sheet,p.range.start.col,p.range.end.row),p.range.end);this.addAllFromRange(R,p),this.graph.addEdge(v,p),p=v,y=this.rangeMapping.findSmallerRange(p.range)}this.graph.addEdge(y.smallerRangeVertex,p),this.addAllFromRange(y.restRange,p),this.graph.removeEdge(y.smallerRangeVertex,s)}}}},{key:"addAllFromRange",value:function(e,n){var a=W(e.addresses(this)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(o),n)}}catch(u){a.e(u)}finally{a.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,n,a){var i=W(this.rangeMapping.rangesInSheet(e)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;if(u.range.includesColumn(n+a)){var s=void 0;u.bruteForce?s=u.range.rangeWithSameHeight(n,a):s=Y.spanFrom(P(e,n,u.range.end.row),a,1);var l=W(s.addresses(this)),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(c),u)}}catch(h){l.e(h)}finally{l.f()}}}}catch(h){i.e(h)}finally{i.f()}}},{key:"exchangeOrAddFormulaVertex",value:function(e){var n=e.getAddress(this.lazilyTransformingAstService),a=Y.spanFrom(n,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(n);if(e instanceof Fe&&this.setArray(a,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(n,e),e instanceof Fe){if(!this.isThereSpaceForArray(e))return;var o=W(a.addresses(this)),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;if(!e.isLeftCorner(s)){var l=this.getCell(s);this.exchangeOrAddGraphNode(l,e)}}}catch(p){o.e(p)}finally{o.f()}}var f=W(a.addresses(this)),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;this.addressMapping.setCell(h,e)}}catch(p){f.e(p)}finally{f.f()}}},{key:"setAddressMappingForArrayVertex",value:function(e,n){if(this.addressMapping.setCell(n,e),e instanceof Fe){var a=Y.spanFromOrUndef(n,e.width,e.height);if(a!==void 0&&(this.setArray(a,e),!!this.isThereSpaceForArray(e))){var i=W(a.addresses(this)),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;this.addressMapping.setCell(u,e)}}catch(s){i.e(s)}finally{i.f()}}}}},{key:"truncateRanges",value:function(e,n){var a=this.rangeMapping.truncateRanges(e,n),i=a.verticesToRemove,o=a.verticesToMerge,u=a.verticesWithChangedSize,s=W(o),l;try{for(s.s();!(l=s.n()).done;){var f=bt(l.value,2),c=f[0],h=f[1];this.mergeRangeVertices(c,h)}}catch(R){s.e(R)}finally{s.f()}var p=W(i),y;try{for(p.s();!(y=p.n()).done;){var v=y.value;this.removeVertexAndCleanupDependencies(v)}}catch(R){p.e(R)}finally{p.f()}return u}},{key:"fixArraysAfterAddingRow",value:function(e,n,a){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,n,a),!(n<=0)){var i=W(this.arrayMapping.arraysInRows(xr.fromRowStartAndEnd(e,n-1,n-1))),o;try{for(i.s();!(o=i.n()).done;)for(var u=bt(o.value,2),s=u[1],l=s.getRange(),f=l.start.col;f<=l.end.col;++f)for(var c=n;c<=l.end.row;++c){var h=P(e,f,c),p=P(e,f,c+a),y=s.getArrayCellValue(h);this.addressMapping.moveCell(p,h),this.changes.addChange(ne,p,y)}}catch(v){i.e(v)}finally{i.f()}}}},{key:"fixArraysAfterRemovingRows",value:function(e,n,a){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,n,-a),!(n<=0)){var i=W(this.arrayMapping.arraysInRows(xr.fromRowStartAndEnd(e,n-1,n-1))),o;try{for(i.s();!(o=i.n()).done;){var u=bt(o.value,2),s=u[1];if(this.isThereSpaceForArray(s)){var l=W(s.getRange().addresses(this)),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;this.addressMapping.setCell(c,s)}}catch(h){l.e(h)}finally{l.f()}}else this.setNoSpaceIfArray(s)}}catch(h){i.e(h)}finally{i.f()}}}},{key:"fixArraysAfterAddingColumn",value:function(e,n,a){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,n,a),!(n<=0)){var i=W(this.arrayMapping.arraysInCols(vn.fromColumnStartAndEnd(e,n-1,n-1))),o;try{for(i.s();!(o=i.n()).done;)for(var u=bt(o.value,2),s=u[1],l=s.getRange(),f=l.start.row;f<=l.end.row;++f)for(var c=n;c<=l.end.col;++c){var h=P(e,c,f),p=P(e,c+a,f),y=s.getArrayCellValue(h);this.addressMapping.moveCell(p,h),this.changes.addChange(ne,p,y)}}catch(v){i.e(v)}finally{i.f()}}}},{key:"fixArraysAfterRemovingColumns",value:function(e,n,a){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,n,-a),!(n<=0)){var i=W(this.arrayMapping.arraysInCols(vn.fromColumnStartAndEnd(e,n-1,n-1))),o;try{for(i.s();!(o=i.n()).done;){var u=bt(o.value,2),s=u[1];if(this.isThereSpaceForArray(s)){var l=W(s.getRange().addresses(this)),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;this.addressMapping.setCell(c,s)}}catch(h){l.e(h)}finally{l.f()}}else this.setNoSpaceIfArray(s)}}catch(h){i.e(h)}finally{i.f()}}}},{key:"shrinkPossibleArrayAndGetCell",value:function(e){var n=this.getCell(e);return n instanceof Fe?(this.setNoSpaceIfArray(n),this.getCell(e)):n}},{key:"setNoSpaceIfArray",value:function(e){e instanceof Fe&&(this.shrinkArrayToCorner(e),e.setNoSpace())}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof Et&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,n){var a=this,i=this.graph.adjacentNodes(n);this.removeVertexAndCleanupDependencies(n),this.graph.softRemoveEdge(e,n),i.forEach(function(o){a.graph.hasNode(o)&&a.graph.addEdge(e,o)})}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var n=new Set(this.graph.removeNode(e));n.size>0;){var a=n.values().next().value;n.delete(a),this.graph.hasNode(a)&&this.graph.adjacentNodesCount(a)===0&&((a instanceof Et||a instanceof jr)&&this.graph.removeNode(a).forEach(function(i){return n.add(i)}),a instanceof Et?this.rangeMapping.removeRange(a):a instanceof jr&&this.addressMapping.removeCell(a.address))}}}],[{key:"buildEmpty",value:function(e,n,a,i,o){return new r(new WB(n.chooseAddressMappingPolicy),new VV,new fG(n.translationPackage),new QB,o,e,a,i)}}]),r}();function bG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function X7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function SG(r,t,e){return t&&X7(r.prototype,t),e&&X7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var jr=function(){function r(t){bG(this,r),this.address=t}return SG(r,[{key:"getCellValue",value:function(){return ne}}]),r}();function AG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function TG(r,t,e){return t&&q7(r.prototype,t),e&&q7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var mn=function(){function r(t,e){AG(this,r),this.parsedValue=t,this.rawValue=e}return TG(r,[{key:"getValues",value:function(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}},{key:"setValues",value:function(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}},{key:"getCellValue",value:function(){return this.parsedValue}},{key:"setCellValue",value:function(e){throw"SetCellValue is deprecated for ValueCellVertex"}}]),r}();function OG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function wG(r,t,e){return t&&Q7(r.prototype,t),e&&Q7(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Ma=function(){function r(t,e){OG(this,r),this.errors=t,this.rawInput=e}return wG(r,[{key:"getCellValue",value:function(){return m.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}]),r}();function gn(r,t){return _G(r)||CG(r,t)||Z7(r,t)||NG()}function NG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CG(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function _G(r){if(Array.isArray(r))return r}function Mt(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Z7(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Z7(r,t){if(!!r){if(typeof r=="string")return J7(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return J7(r,t)}}function J7(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function IG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function e4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function MG(r,t,e){return t&&e4(r.prototype,t),e&&e4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var kG=function(){function r(t,e){IG(this,r),this.width=t,this.height=e,this.mapping=new Map}return MG(r,[{key:"getCell",value:function(e){var n;return(n=this.mapping.get(e.col))===null||n===void 0?void 0:n.get(e.row)}},{key:"setCell",value:function(e,n){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var a=this.mapping.get(e.col);a||(a=new Map,this.mapping.set(e.col,a)),a.set(e.row,n)}},{key:"has",value:function(e){var n;return!!((n=this.mapping.get(e.col))===null||n===void 0?void 0:n.get(e.row))}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var n;(n=this.mapping.get(e.col))===null||n===void 0||n.delete(e.row)}},{key:"addRows",value:function(e,n){this.mapping.forEach(function(a){var i=new Map;a.forEach(function(o,u){u>=e&&(i.set(u+n,o),a.delete(u))}),i.forEach(function(o,u){a.set(u,o)})}),this.height+=n}},{key:"addColumns",value:function(e,n){var a=this,i=new Map;this.mapping.forEach(function(o,u){u>=e&&(i.set(u+n,o),a.mapping.delete(u))}),i.forEach(function(o,u){a.mapping.set(u,o)}),this.width+=n}},{key:"removeRows",value:function(e){this.mapping.forEach(function(i){var o=new Map;i.forEach(function(u,s){s>=e.rowStart&&(i.delete(s),s>e.rowEnd&&o.set(s-e.numberOfRows,u))}),o.forEach(function(u,s){i.set(s,u)})});var n=Math.min(this.height-1,e.rowEnd),a=Math.max(0,n-e.rowStart+1);this.height=Math.max(0,this.height-a)}},{key:"removeColumns",value:function(e){var n=this,a=new Map;this.mapping.forEach(function(u,s){s>=e.columnStart&&(n.mapping.delete(s),s>e.columnEnd&&a.set(s-e.numberOfColumns,u))}),a.forEach(function(u,s){n.mapping.set(s,u)});var i=Math.min(this.width-1,e.columnEnd),o=Math.max(0,i-e.columnStart+1);this.width=Math.max(0,this.width-o)}},{key:"getEntries",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u,s,l,f,c,h;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:n=Mt(this.mapping),y.prev=1,n.s();case 3:if((a=n.n()).done){y.next=24;break}i=gn(a.value,2),o=i[0],u=i[1],s=Mt(u),y.prev=6,s.s();case 8:if((l=s.n()).done){y.next=14;break}return f=gn(l.value,2),c=f[0],h=f[1],y.next=12,[P(e,o,c),h];case 12:y.next=8;break;case 14:y.next=19;break;case 16:y.prev=16,y.t0=y.catch(6),s.e(y.t0);case 19:return y.prev=19,s.f(),y.finish(19);case 22:y.next=3;break;case 24:y.next=29;break;case 26:y.prev=26,y.t1=y.catch(1),n.e(y.t1);case 29:return y.prev=29,n.f(),y.finish(29);case 32:case"end":return y.stop()}},t,this,[[1,26,29,32],[6,16,19,22]])})},{key:"verticesFromColumn",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(n=this.mapping.get(e),n!==void 0){l.next=3;break}return l.abrupt("return");case 3:a=Mt(n),l.prev=4,a.s();case 6:if((i=a.n()).done){l.next=12;break}return o=gn(i.value,2),u=o[1],l.next=10,u;case 10:l.next=6;break;case 12:l.next=17;break;case 14:l.prev=14,l.t0=l.catch(4),a.e(l.t0);case 17:return l.prev=17,a.f(),l.finish(17);case 20:case"end":return l.stop()}},t,this,[[4,14,17,20]])})},{key:"verticesFromRow",value:regeneratorRuntime.mark(function t(e){var n,a,i,o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n=Mt(this.mapping.values()),s.prev=1,n.s();case 3:if((a=n.n()).done){s.next=11;break}if(i=a.value,o=i.get(e),o===void 0){s.next=9;break}return s.next=9,o;case 9:s.next=3;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),n.e(s.t0);case 16:return s.prev=16,n.f(),s.finish(16);case 19:case"end":return s.stop()}},t,this,[[1,13,16,19]])})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u,s,l,f;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:n=Mt(e.columns()),h.prev=1,n.s();case 3:if((a=n.n()).done){h.next=27;break}if(i=a.value,o=this.mapping.get(i),o!==void 0){h.next=8;break}return h.abrupt("continue",25);case 8:u=Mt(o),h.prev=9,u.s();case 11:if((s=u.n()).done){h.next=17;break}return l=gn(s.value,2),f=l[1],h.next=15,f;case 15:h.next=11;break;case 17:h.next=22;break;case 19:h.prev=19,h.t0=h.catch(9),u.e(h.t0);case 22:return h.prev=22,u.f(),h.finish(22);case 25:h.next=3;break;case 27:h.next=32;break;case 29:h.prev=29,h.t1=h.catch(1),n.e(h.t1);case 32:return h.prev=32,n.f(),h.finish(32);case 35:case"end":return h.stop()}},t,this,[[1,29,32,35],[9,19,22,25]])})},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u,s,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:n=Mt(this.mapping.values()),c.prev=1,n.s();case 3:if((a=n.n()).done){c.next=26;break}i=a.value,o=Mt(e.rows()),c.prev=6,o.s();case 8:if((u=o.n()).done){c.next=16;break}if(s=u.value,l=i.get(s),l===void 0){c.next=14;break}return c.next=14,l;case 14:c.next=8;break;case 16:c.next=21;break;case 18:c.prev=18,c.t0=c.catch(6),o.e(c.t0);case 21:return c.prev=21,o.f(),c.finish(21);case 24:c.next=3;break;case 26:c.next=31;break;case 28:c.prev=28,c.t1=c.catch(1),n.e(c.t1);case 31:return c.prev=31,n.f(),c.finish(31);case 34:case"end":return c.stop()}},t,this,[[1,28,31,34],[6,18,21,24]])})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u,s,l,f,c;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:n=Mt(this.mapping.entries()),p.prev=1,n.s();case 3:if((a=n.n()).done){p.next=26;break}i=gn(a.value,2),o=i[0],u=i[1],s=Mt(e.rows()),p.prev=6,s.s();case 8:if((l=s.n()).done){p.next=16;break}if(f=l.value,c=u.get(f),c===void 0){p.next=14;break}return p.next=14,[P(e.sheet,o,f),c];case 14:p.next=8;break;case 16:p.next=21;break;case 18:p.prev=18,p.t0=p.catch(6),s.e(p.t0);case 21:return p.prev=21,s.f(),p.finish(21);case 24:p.next=3;break;case 26:p.next=31;break;case 28:p.prev=28,p.t1=p.catch(1),n.e(p.t1);case 31:return p.prev=31,n.f(),p.finish(31);case 34:case"end":return p.stop()}},t,this,[[1,28,31,34],[6,18,21,24]])})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i,o,u,s,l,f,c;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:n=Mt(e.columns()),p.prev=1,n.s();case 3:if((a=n.n()).done){p.next=26;break}if(i=a.value,o=this.mapping.get(i),o===void 0){p.next=24;break}u=Mt(o.entries()),p.prev=8,u.s();case 10:if((s=u.n()).done){p.next=16;break}return l=gn(s.value,2),f=l[0],c=l[1],p.next=14,[P(e.sheet,i,f),c];case 14:p.next=10;break;case 16:p.next=21;break;case 18:p.prev=18,p.t0=p.catch(8),u.e(p.t0);case 21:return p.prev=21,u.f(),p.finish(21);case 24:p.next=3;break;case 26:p.next=31;break;case 28:p.prev=28,p.t1=p.catch(1),n.e(p.t1);case 31:return p.prev=31,n.f(),p.finish(31);case 34:case"end":return p.stop()}},t,this,[[1,28,31,34],[8,18,21,24]])})},{key:"vertices",value:regeneratorRuntime.mark(function t(){var e,n,a,i,o,u,s,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=Mt(this.mapping),c.prev=1,e.s();case 3:if((n=e.n()).done){c.next=25;break}a=gn(n.value,2),i=a[1],o=Mt(i),c.prev=6,o.s();case 8:if((u=o.n()).done){c.next=15;break}if(s=gn(u.value,2),l=s[1],l===void 0){c.next=13;break}return c.next=13,l;case 13:c.next=8;break;case 15:c.next=20;break;case 17:c.prev=17,c.t0=c.catch(6),o.e(c.t0);case 20:return c.prev=20,o.f(),c.finish(20);case 23:c.next=3;break;case 25:c.next=30;break;case 27:c.prev=27,c.t1=c.catch(1),e.e(c.t1);case 30:return c.prev=30,e.f(),c.finish(30);case 33:case"end":return c.stop()}},t,this,[[1,27,30,33],[6,17,20,23]])})}]),r}();function FG(r){return LG(r)||DG(r)||$G(r)||PG()}function PG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $G(r,t){if(!!r){if(typeof r=="string")return A1(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return A1(r,t)}}function DG(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function LG(r){if(Array.isArray(r))return A1(r)}function A1(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function UG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function t4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function xG(r,t,e){return t&&t4(r.prototype,t),e&&t4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var BG=function(){function r(t,e){UG(this,r),this.width=t,this.height=e,this.mapping=new Array(e);for(var n=0;n<e;n++)this.mapping[n]=new Array(t)}return xG(r,[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,n){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var a=this.mapping[e.row];a||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=n}},{key:"has",value:function(e){var n=this.mapping[e.row];return n?!!n[e.col]:!1}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,n){for(var a,i=[],o=0;o<n;o++)i.push(new Array(this.width));(a=this.mapping).splice.apply(a,[e,0].concat(i)),this.height+=n}},{key:"addColumns",value:function(e,n){for(var a=0;a<this.height;a++){var i;(i=this.mapping[a]).splice.apply(i,[e,0].concat(FG(new Array(n))))}this.width+=n}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var n=Math.min(this.height-1,e.rowEnd),a=Math.max(0,n-e.rowStart+1);this.height=Math.max(0,this.height-a)}},{key:"removeColumns",value:function(e){for(var n=0;n<this.height;n++)this.mapping[n].splice(e.columnStart,e.numberOfColumns);var a=Math.min(this.width-1,e.columnEnd),i=Math.max(0,a-e.columnStart+1);this.width=Math.max(0,this.width-i)}},{key:"getEntries",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<this.height)){u.next=14;break}a=0;case 3:if(!(a<this.width)){u.next=11;break}if(i=this.getCellVertex(a,n),!i){u.next=8;break}return u.next=8,[P(e,a,n),i];case 8:++a,u.next=3;break;case 11:++n,u.next=1;break;case 14:case"end":return u.stop()}},t,this)})},{key:"verticesFromColumn",value:regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=0;case 1:if(!(n<this.height)){o.next=9;break}if(a=this.getCellVertex(e,n),!a){o.next=6;break}return o.next=6,a;case 6:++n,o.next=1;break;case 9:case"end":return o.stop()}},t,this)})},{key:"verticesFromRow",value:regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=0;case 1:if(!(n<this.width)){o.next=9;break}if(a=this.getCellVertex(n,e),!a){o.next=6;break}return o.next=6,a;case 6:++n,o.next=1;break;case 9:case"end":return o.stop()}},t,this)})},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=e.columnStart;case 1:if(!(n<=e.columnEnd)){u.next=14;break}a=0;case 3:if(!(a<this.height)){u.next=11;break}if(i=this.getCellVertex(n,a),!i){u.next=8;break}return u.next=8,i;case 8:++a,u.next=3;break;case 11:++n,u.next=1;break;case 14:case"end":return u.stop()}},t,this)})},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<this.width)){u.next=14;break}a=e.rowStart;case 3:if(!(a<=e.rowEnd)){u.next=11;break}if(i=this.getCellVertex(n,a),!i){u.next=8;break}return u.next=8,i;case 8:++a,u.next=3;break;case 11:++n,u.next=1;break;case 14:case"end":return u.stop()}},t,this)})},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<this.width)){u.next=14;break}a=e.rowStart;case 3:if(!(a<=e.rowEnd)){u.next=11;break}if(i=this.getCellVertex(n,a),!i){u.next=8;break}return u.next=8,[P(e.sheet,n,a),i];case 8:++a,u.next=3;break;case 11:++n,u.next=1;break;case 14:case"end":return u.stop()}},t,this)})},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<this.height)){u.next=14;break}a=e.columnStart;case 3:if(!(a<=e.columnEnd)){u.next=11;break}if(i=this.getCellVertex(a,n),!i){u.next=8;break}return u.next=8,[P(e.sheet,a,n),i];case 8:++a,u.next=3;break;case 11:++n,u.next=1;break;case 14:case"end":return u.stop()}},t,this)})},{key:"vertices",value:regeneratorRuntime.mark(function t(){var e,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=0;case 1:if(!(e<this.height)){o.next=14;break}n=0;case 3:if(!(n<this.width)){o.next=11;break}if(a=this.getCellVertex(n,e),!a){o.next=8;break}return o.next=8,a;case 8:++n,o.next=3;break;case 11:++e,o.next=1;break;case 14:case"end":return o.stop()}},t,this)})},{key:"getCellVertex",value:function(e,n){var a;return(a=this.mapping[n])===null||a===void 0?void 0:a[e]}}]),r}();function T1(r){return T1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T1(r)}function VG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function r4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function GG(r,t,e){return t&&r4(r.prototype,t),e&&r4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var E;(function(r){r.DIV_BY_ZERO="DIV_BY_ZERO",r.NAME="NAME",r.VALUE="VALUE",r.NUM="NUM",r.NA="NA",r.CYCLE="CYCLE",r.REF="REF",r.SPILL="SPILL",r.LIC="LIC",r.ERROR="ERROR"})(E||(E={}));var kt;(function(r){r.FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA"})(kt||(kt={}));var jG=function(t,e){return t instanceof Fe?t.isLeftCorner(e)?kt.ARRAYFORMULA:kt.ARRAY:t instanceof Vr||t instanceof Ma?kt.FORMULA:t instanceof mn?kt.VALUE:kt.EMPTY},es;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.ERROR="ERROR"})(es||(es={}));var O1;(function(r){r.NUMBER="NUMBER"})(O1||(O1={}));var cr=Object.assign(Object.assign({},es),O1),HG=Object.assign(Object.assign({},es),U),n4=function(t){switch(t){case cr.EMPTY:return 0;case cr.NUMBER:return 1;case cr.STRING:return 2;case cr.BOOLEAN:return 3;case cr.ERROR:return 4}throw new Error("Cell value not computed")},ts=function(t){if(t===ne)return cr.EMPTY;if(t instanceof m||t instanceof V)return cr.ERROR;if(typeof t=="string")return cr.STRING;if(de(t))return cr.NUMBER;if(typeof t=="boolean")return cr.BOOLEAN;throw new Error("Cell value not computed")},WG=function(t){return de(t)?Lx(t):ts(t)},zG=function(t){if(de(t))return Ux(t)},m=function(){function r(t,e,n){VG(this,r),this.type=t,this.message=e,this.root=n}return GG(r,[{key:"attachRootVertex",value:function(e){return this.root===void 0?new r(this.type,this.message,e):this}}],[{key:"parsingError",value:function(){return new r(E.ERROR,S.ParseError)}}]),r}(),a4=function(t,e){return{sheet:t,row:e}},YG=function(t){return t.row<0},i4=function(t,e){return{sheet:t,col:e}},KG=function(t){return t.col<0},P=function(t,e,n){return{sheet:t,col:e,row:n}},Ft=function(t){return t.col<0||t.row<0},XG=function(t,e,n,a){return P(e,t.col+n,t.row+a)},rs=function(t){return"".concat(t.sheet,",").concat(t.row,",").concat(t.col)};function He(r){return r&&(T1(r)==="object"||typeof r=="function")?"col"in r&&typeof r.col=="number"&&"row"in r&&typeof r.row=="number"&&"sheet"in r&&typeof r.sheet=="number":!1}var hr=function(t,e){var n;return(n=t.sheet)!==null&&n!==void 0?n:e.sheet},ro=function(t,e){return t.sheet===e.sheet&&t.col===e.col&&t.row===e.row};function qG(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function o4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function QG(r,t,e){return t&&o4(r.prototype,t),e&&o4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var u4=function(){function r(t,e,n){qG(this,r);var a;this.value=e,this.address=n,this.type=t.type,this.message=(a=t.message)!==null&&a!==void 0?a:""}return QG(r,[{key:"toString",value:function(){return this.value}},{key:"valueOf",value:function(){return this.value}}]),r}(),ZG=Q,s4=Cc,ns=Ti.exports.getWeakData,JG=Qe,w1=ze,ej=Ac,tj=Sc,l4=In,f4=Be,c4=Mr,rj=c4.set,nj=c4.getterFor,aj=l4.find,ij=l4.findIndex,oj=ZG([].splice),uj=0,as=function(r){return r.frozen||(r.frozen=new h4)},h4=function(){this.entries=[]},N1=function(r,t){return aj(r.entries,function(e){return e[0]===t})};h4.prototype={get:function(r){var t=N1(this,r);if(t)return t[1]},has:function(r){return!!N1(this,r)},set:function(r,t){var e=N1(this,r);e?e[1]=t:this.entries.push([r,t])},delete:function(r){var t=ij(this.entries,function(e){return e[0]===r});return~t&&oj(this.entries,t,1),!!~t}};var sj={getConstructor:function(r,t,e,n){var a=r(function(s,l){ej(s,i),rj(s,{type:t,id:uj++,frozen:void 0}),l!=null&&tj(l,s[n],{that:s,AS_ENTRIES:e})}),i=a.prototype,o=nj(t),u=function(s,l,f){var c=o(s),h=ns(JG(l),!0);return h===!0?as(c).set(l,f):h[c.id]=f,s};return s4(i,{delete:function(s){var l=o(this);if(!w1(s))return!1;var f=ns(s);return f===!0?as(l).delete(s):f&&f4(f,l.id)&&delete f[l.id]},has:function(l){var f=o(this);if(!w1(l))return!1;var c=ns(l);return c===!0?as(f).has(l):c&&f4(c,f.id)}}),s4(i,e?{get:function(l){var f=o(this);if(w1(l)){var c=ns(l);return c===!0?as(f).get(l):c?c[f.id]:void 0}},set:function(l,f){return u(this,l,f)}}:{add:function(l){return u(this,l,!0)}}),a}},p4=H,is=Q,lj=Cc,fj=Ti.exports,cj=Nc,d4=sj,os=ze,us=Y0,ss=Mr.enforce,hj=cv,pj=!p4.ActiveXObject&&"ActiveXObject"in p4,no,v4=function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},dj=cj("WeakMap",v4,d4);if(hj&&pj){no=d4.getConstructor(v4,"WeakMap",!0),fj.enable();var ao=dj.prototype,y4=is(ao.delete),ls=is(ao.has),m4=is(ao.get),g4=is(ao.set);lj(ao,{delete:function(r){if(os(r)&&!us(r)){var t=ss(this);return t.frozen||(t.frozen=new no),y4(this,r)||t.frozen.delete(r)}return y4(this,r)},has:function(t){if(os(t)&&!us(t)){var e=ss(this);return e.frozen||(e.frozen=new no),ls(this,t)||e.frozen.has(t)}return ls(this,t)},get:function(t){if(os(t)&&!us(t)){var e=ss(this);return e.frozen||(e.frozen=new no),ls(this,t)?m4(this,t):e.frozen.get(t)}return m4(this,t)},set:function(t,e){if(os(t)&&!us(t)){var n=ss(this);n.frozen||(n.frozen=new no),ls(this,t)?g4(this,t,e):n.frozen.set(t,e)}else g4(this,t,e);return this}})}var vj=z,yj=Q,mj=Rf,gj=nr,E4=ft,Ej=bf,Rj=yj("".indexOf);vj({target:"String",proto:!0,forced:!Ej("includes")},{includes:function(t){return!!~Rj(E4(gj(this)),E4(mj(t)),arguments.length>1?arguments[1]:void 0)}});function bj(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Sj(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Sj(r,t){if(!!r){if(typeof r=="string")return R4(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return R4(r,t)}}function R4(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function fs(r){return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(r)}function Ee(r,t,e){if(typeof r=="undefined")return zr.defaultConfig[e];if(typeof t=="string"){if(fs(r)===t)return r;throw new he(t,e)}else{if(t.includes(r))return r;throw new Wy(t.map(function(n){return"'".concat(n,"'")}).join(" "),e)}}function ka(r,t,e){if(r<e)throw new jy(t,e)}function Aj(r,t,e){if(r>e)throw new Hy(t,e)}function cs(r,t,e,n){if(t(r))return r;if(typeof r=="undefined")return zr.defaultConfig[n];throw new he(e,n)}function b4(){for(var r=new Map,t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(l){var f=r.get(l.value)||[];f.push(l.name),r.set(l.value,f)});var a=[],i=bj(r.values()),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;u.length>1&&a.push(u)}}catch(l){i.e(l)}finally{i.f()}if(a.length>0){a.forEach(function(l){return l.sort()});var s=a.map(function(l){return"[".concat(l,"]")}).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(s))}}function I(r,t,e){if(fs(r)!==t)throw new he(t,e)}var Tj=z,S4=Q,Oj=Ir.f,wj=aa,A4=ft,Nj=Rf,Cj=nr,_j=bf,T4=S4("".endsWith),Ij=S4("".slice),Mj=Math.min,O4=_j("endsWith"),kj=!O4&&!!function(){var r=Oj(String.prototype,"endsWith");return r&&!r.writable}();Tj({target:"String",proto:!0,forced:!kj&&!O4},{endsWith:function(t){var e=A4(Cj(this));Nj(t);var n=arguments.length>1?arguments[1]:void 0,a=e.length,i=n===void 0?a:Mj(wj(n),a),o=A4(t);return T4?T4(e,o,i):Ij(e,i-o.length,i)===o}});/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function Fj(r,t,e){r=r.replace(/\s\s+/g," ").trim().toLowerCase();var n=r.substring(r.length-2);n==="am"||n==="pm"?r=r.substring(0,r.length-2).trim():(n=r.substring(r.length-1),n==="a"||n==="p"?r=r.substring(0,r.length-1).trim():n=void 0);var a=r.split(/[ /.-]/g);a.length>=2&&a[a.length-2].includes(":")&&(a[a.length-2]=a[a.length-2]+"."+a[a.length-1],a.pop());var i=a[a.length-1].split(":");if(n!==void 0&&i.push(n),a.length===1)return w4(i,e);if(i.length===1)return N4(a,t);var o=N4(a.slice(0,a.length-1),t),u=w4(i,e);if(o!==void 0)return u===void 0?void 0:Object.assign(Object.assign({},o),u)}var C1=/^ss\.(s+|0+)$/;function w4(r,t){if(t!==void 0){t=t.toLowerCase(),t.endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var e=t.split(":"),n=void 0;r[r.length-1]==="am"||r[r.length-1]==="a"?(n=!1,r.pop()):(r[r.length-1]==="pm"||r[r.length-1]==="p")&&(n=!0,r.pop());var a=0;if(e.length>=1&&C1.test(e[e.length-1])&&(a=e[e.length-1].length-3,e[e.length-1]="ss"),r.length===e.length){var i=e.indexOf("hh"),o=e.indexOf("mm"),u=e.indexOf("ss"),s=i!==-1?r[i]:"0";if(!!/^\d+$/.test(s)){var l=Number(s);if(n!==void 0){if(l<0||l>12)return;l=l%12,n&&(l=l+12)}var f=o!==-1?r[o]:"0";if(!!/^\d+$/.test(f)){var c=Number(f),h=u!==-1?r[u]:"0";if(!!/^\d+(\.\d+)?$/.test(h)){var p=Number(h);return p=Math.round(p*Math.pow(10,a))/Math.pow(10,a),{hours:l,minutes:c,seconds:p}}}}}}}function N4(r,t){if(t!==void 0){var e=t.toLowerCase().split(/[ /.-]/g);if(r.length===e.length){var n=e.indexOf("mm"),a=e.indexOf("dd"),i=e.indexOf("yyyy"),o=e.indexOf("yy");if(!(!(n in r)||!(a in r)||!(i in r)&&!(o in r))&&!(i in r&&o in r)){var u;if(i in r){var s=r[i];if(/^\d+$/.test(s)){if(u=Number(s),u<1e3||u>9999)return}else return}else{var l=r[o];if(/^\d+$/.test(l)){if(u=Number(l),u<0||u>99)return}else return}var f=r[n];if(!!/^\d+$/.test(f)){var c=Number(f),h=r[a];if(!!/^\d+$/.test(h)){var p=Number(h);return{year:u,month:c,day:p}}}}}}}function C4(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Pj(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Pj(r,t){if(!!r){if(typeof r=="string")return _4(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _4(r,t)}}function _4(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function $j(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function I4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Dj(r,t,e){return t&&I4(r.prototype,t),e&&I4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function hs(r){return hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs(r)}var _1=[31,28,31,30,31,30,31,31,30,31,30,31],Fa=[0,31,59,90,120,151,181,212,243,273,304,334];function io(r){return r&&(hs(r)==="object"||typeof r=="function")?"year"in r&&typeof r.year=="number"&&"month"in r&&typeof r.month=="number"&&"day"in r&&typeof r.day=="number":!1}function M4(r){return r&&(hs(r)==="object"||typeof r=="function")?"hours"in r&&typeof r.hours=="number"&&"minutes"in r&&typeof r.minutes=="number"&&"seconds"in r&&typeof r.seconds=="number":!1}var Lj={year:9999,month:12,day:31},Uj=function(){function r(t){$j(this,r),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(Lj),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}return Dj(r,[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var n=this.parseDateTimeFromConfigFormats(e),a=n.dateTime,i=n.dateFormat,o=i===void 0?"":i,u=n.timeFormat,s=u===void 0?"":u;if(a!==void 0)return M4(a)?io(a)?new Xh($a(a)+this.dateToNumber(a),o+" "+s):new Kh($a(a),s):io(a)?new Yh(this.dateToNumber(a),o):0}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=_1[e.month-1]}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var n=Math.floor(e)+this.minDateAboluteValue,a=Math.floor(n/365.2425);this.dateToNumberFromZero({year:a+1,month:1,day:1})<=n?a++:this.dateToNumberFromZero({year:a-1,month:1,day:1})>n&&a--;var i=n-this.dateToNumberFromZero({year:a,month:1,day:1}),o=xj(i-(this.isLeapYear(a)&&i>=59?1:0)),u=i-Fa[o]-(this.isLeapYear(a)&&o>1?1:0);return{year:a,month:o+1,day:u+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),Pa(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"daysInMonth",value:function(e,n){return this.isLeapYear(e)&&n===2?29:_1[n-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,n){return e.day===31&&(e.day=30),e.day===30&&n.day===31&&(n.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,n.month===2&&n.day===this.daysInMonth(n.year,n.month)&&(n.day=30)),[e,n]}},{key:"yearLengthForBasis",value:function(e,n){return e.year!==n.year?e.year+1!==n.year||e.month<n.month||e.month===n.month&&e.day<n.day?(this.leapYearsCount(n.year)-this.leapYearsCount(e.year-1))/(n.year-e.year+1)+365:this.countLeapDays(n)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}},{key:"parseSingleFormat",value:function(e,n,a){var i=this.parseDateTime(e,n,a);if(!(io(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}},{key:"parseDateTimeFromFormats",value:function(e,n,a){var i=n.length===0?[void 0]:n,o=a.length===0?[void 0]:a,u=C4(i),s;try{for(u.s();!(s=u.n()).done;){var l=s.value,f=C4(o),c;try{for(f.s();!(c=f.n()).done;){var h=c.value,p=this.parseSingleFormat(e,l,h);if(p!==void 0)return{dateTime:p,timeFormat:h,dateFormat:l}}}catch(y){f.e(y)}finally{f.f()}}}catch(y){u.e(y)}finally{u.f()}return{}}},{key:"countLeapDays",value:function(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+Fa[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}]),r}();function xj(r){var t=0;return Fa[t+6]<=r&&(t+=6),Fa[t+3]<=r&&(t+=3),Fa[t+2]<=r?t+=2:Fa[t+1]<=r&&(t+=1),t}function k4(r,t){var e=12*r.year+r.month-1+t;return{year:Math.floor(e/12),month:e%12+1,day:r.day}}function Bj(r){return{year:r.year,month:r.month,day:Math.min(r.day,_1[r.month-1])}}function I1(r){return Math.round(r*3600*24)/(3600*24)}function Pa(r){r=Math.round(r*24*60*60*1e5)/(24*60*60*1e5),r*=24;var t=Math.floor(r);r-=t,r*=60;var e=Math.floor(r);r-=e,r*=60;var n=Math.round(r*1e5)/1e5;return{hours:t,minutes:e,seconds:n}}function $a(r){return((r.seconds/60+r.minutes)/60+r.hours)/24}function F4(r){return{year:r.year,month:r.month,day:Math.min(30,r.day)}}function Vj(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function P4(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Gj(r,t,e){return t&&P4(r.prototype,t),e&&P4(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var jj=function(){function r(){Vj(this,r)}return Gj(r,[{key:"call",value:function(){return BG}}]),r}(),Hj=H,Wj=Cn,zj=ft,Yj=nr,Kj=Hj.RangeError,M1=function(t){var e=zj(Yj(this)),n="",a=Wj(t);if(a<0||a==1/0)throw Kj("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))a&1&&(n+=e);return n},Xj=z,$4=H,k1=Q,qj=Cn,Qj=cy,Zj=M1,D4=re,Jj=$4.RangeError,L4=$4.String,U4=Math.floor,F1=k1(Zj),x4=k1("".slice),oo=k1(1 .toFixed),Da=function(r,t,e){return t===0?e:t%2==1?Da(r,t-1,e*r):Da(r*r,t/2,e)},eH=function(r){for(var t=0,e=r;e>=4096;)t+=12,e/=4096;for(;e>=2;)t+=1,e/=2;return t},La=function(r,t,e){for(var n=-1,a=e;++n<6;)a+=t*r[n],r[n]=a%1e7,a=U4(a/1e7)},P1=function(r,t){for(var e=6,n=0;--e>=0;)n+=r[e],r[e]=U4(n/t),n=n%t*1e7},B4=function(r){for(var t=6,e="";--t>=0;)if(e!==""||t===0||r[t]!==0){var n=L4(r[t]);e=e===""?n:e+F1("0",7-n.length)+n}return e},tH=D4(function(){return oo(8e-5,3)!=="0.000"||oo(.9,0)!=="1"||oo(1.255,2)!=="1.25"||oo(1000000000000000100,0)!=="1000000000000000128"})||!D4(function(){oo({})});Xj({target:"Number",proto:!0,forced:tH},{toFixed:function(t){var e=Qj(this),n=qj(t),a=[0,0,0,0,0,0],i="",o="0",u,s,l,f;if(n<0||n>20)throw Jj("Incorrect fraction digits");if(e!=e)return"NaN";if(e<=-1e21||e>=1e21)return L4(e);if(e<0&&(i="-",e=-e),e>1e-21)if(u=eH(e*Da(2,69,1))-69,s=u<0?e*Da(2,-u,1):e/Da(2,u,1),s*=4503599627370496,u=52-u,u>0){for(La(a,0,s),l=n;l>=7;)La(a,1e7,0),l-=7;for(La(a,Da(10,l,1),0),l=u-1;l>=23;)P1(a,1<<23),l-=23;P1(a,1<<l),La(a,1,1),P1(a,2),o=B4(a)}else La(a,0,s),La(a,1<<-u,0),o=B4(a)+F1("0",n);return n>0?(f=o.length,o=i+(f<=n?"0."+F1("0",n-f)+o:x4(o,0,f-n)+"."+x4(o,f-n))):o=i+o,o}});/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var V4=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,G4=/(\\.|[#0]+(\.[#0]*)?)/g,Tr;(function(r){r.FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT"})(Tr||(Tr={}));function ps(r,t){return{type:r,value:t}}var ds;(function(r){r.DATE="DATE",r.NUMBER="NUMBER",r.STRING="STRING"})(ds||(ds={}));function rH(r){V4.lastIndex=0;var t=[],e;do e=V4.exec(r),e!==null&&t.push(e);while(e);return t}function nH(r){G4.lastIndex=0;var t=G4.exec(r);return t!==null?[t]:[]}function j4(r,t){for(var e=[],n=0,a=0;a<r.length;++a){var i=r[a];if(i.index!==n){var o=t.substr(n,i.index-n);e.push(ps(Tr.FREE_TEXT,o))}i[0].startsWith("\\")?e.push(ps(Tr.FREE_TEXT,i[0])):e.push(ps(Tr.FORMAT,i[0])),n=i.index+i[0].length}var u=r[r.length-1];if(u.index+u[0].length<t.length){var s=t.substr(u.index+u[0].length,t.length);e.push(ps(Tr.FREE_TEXT,s))}return e}function H4(r){var t=rH(r);if(!t.every(function(e){return W4(e)}))return{type:ds.DATE,tokens:j4(t,r)}}function aH(r){var t=nH(r);if(!t.every(function(e){return W4(e)}))return{type:ds.NUMBER,tokens:j4(t,r)}}function W4(r){return r[0].startsWith("\\")}function iH(r,t){return sH(r)||uH(r,t)||z4(r,t)||oH()}function oH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uH(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function sH(r){if(Array.isArray(r))return r}function lH(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=z4(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function z4(r,t){if(!!r){if(typeof r=="string")return Y4(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Y4(r,t)}}function Y4(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function fH(r,t,e,n){var a=e.stringifyDateTime(n.numberToSimpleDateTime(r),t);if(a!==void 0)return a;var i=e.stringifyDuration(Pa(r),t);if(i!==void 0)return i;var o=aH(t);return o!==void 0?hH(o.tokens,r):t}function Pt(r,t){for(var e=r+"";e.length<t;)e="0"+e;return e}function cH(r,t){for(var e=r+"";e.length<t;)e=e+"0";return e}function K4(r,t){return r.split(t).length-1}function hH(r,t){for(var e="",n=0;n<r.length;++n){var a=r[n];if(a.type===Tr.FREE_TEXT){e+=a.value;continue}var i=a.value.split("."),o=i[0],u=i[1]||"",s=i[1]?".":"",l=Number(t.toFixed(u.length)).toString().split("."),f=l[0]||"",c=l[1]||"";if(o.length>f.length){var h=K4(o.substr(0,o.length-f.length),"0");f=Pt(f,h+f.length)}var p=K4(u.substr(c.length,u.length-c.length),"0");c=cH(c,p+c.length),e+=f+s+c}return e}function pH(r,t){var e=H4(t);if(e!==void 0){var n=e.tokens,a="",i=lH(n),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;if(u.type===Tr.FREE_TEXT){a+=u.value;continue}if(C1.test(u.value)){var s=u.value.length-3;a+=(r.seconds<10?"0":"")+Math.round(r.seconds*Math.pow(10,s))/Math.pow(10,s);continue}switch(u.value.toLowerCase()){case"h":case"hh":{a+=Pt(r.hours,u.value.length),r.hours=0;break}case"[hh]":{a+=Pt(r.hours,u.value.length-2),r.hours=0;break}case"m":case"mm":{a+=Pt(r.minutes,u.value.length),r.minutes=0;break}case"[mm]":{a+=Pt(r.minutes+60*r.hours,u.value.length-2),r.minutes=0,r.hours=0;break}case"s":case"ss":{a+=Pt(r.seconds,u.value.length);break}default:return}}}catch(l){i.e(l)}finally{i.f()}return a}}function dH(r,t){var e=H4(t);if(e!==void 0){for(var n=e.tokens,a="",i=!1,o=n.some(function(y){return y.type===Tr.FORMAT&&(y.value==="a/p"||y.value==="A/P"||y.value==="am/pm"||y.value==="AM/PM")}),u=0;u<n.length;u++){var s=n[u];if(s.type===Tr.FREE_TEXT){a+=s.value;continue}if(C1.test(s.value)){var l=s.value.length-3;a+=(r.seconds<10?"0":"")+Math.round(r.seconds*Math.pow(10,l))/Math.pow(10,l);continue}switch(s.value.toLowerCase()){case"h":case"hh":{i=!0,a+=Pt(o?(r.hours+11)%12+1:r.hours,s.value.length);break}case"d":case"dd":{a+=Pt(r.day,s.value.length);break}case"s":case"ss":{a+=Pt(Math.round(r.seconds),s.value.length);break}case"m":case"mm":{u+1<n.length&&n[u+1].value.startsWith(":")&&(i=!0),i?a+=Pt(r.minutes,s.value.length):a+=Pt(r.month,s.value.length),i=!0;break}case"yy":{a+=Pt(r.year%100,s.value.length);break}case"yyyy":{a+=r.year;break}case"am/pm":case"a/p":{var f=s.value.split("/"),c=iH(f,2),h=c[0],p=c[1];a+=r.hours<12?h:p;break}default:return}}return a}}var vH=z,yH=Pf.codeAt;vH({target:"String",proto:!0},{codePointAt:function(t){return yH(this,t)}});var X4=Q,mH=aa,q4=ft,gH=M1,EH=nr,RH=X4(gH),bH=X4("".slice),SH=Math.ceil,Q4=function(r){return function(t,e,n){var a=q4(EH(t)),i=mH(e),o=a.length,u=n===void 0?" ":q4(n),s,l;return i<=o||u==""?a:(s=i-o,l=RH(u,SH(s/u.length)),l.length>s&&(l=bH(l,0,s)),r?a+l:l+a)}},AH={start:Q4(!1),end:Q4(!0)},TH=Ja,OH=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(TH),wH=z,NH=AH.start,CH=OH;wH({target:"String",proto:!0,forced:CH},{padStart:function(t){return NH(this,t,arguments.length>1?arguments[1]:void 0)}});function _H(r,t){return FH(r)||kH(r,t)||MH(r,t)||IH()}function IH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MH(r,t){if(!!r){if(typeof r=="string")return Z4(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Z4(r,t)}}function Z4(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function kH(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function FH(r){if(Array.isArray(r))return r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var $1="length",uo=function(t){return parseInt(t,16)},J4=function(t){return parseInt(t,10)},D1=function(t){return(t+"").replace(/\-/g,"")},vs=function(t,e,n){return t.substr(e,n)},pr=function(t){return t.codePointAt(0)-65};function PH(r){return D1(r)[$1]===50>>1?uo(vs(D1(r),uo("12"),pr("F")))/(uo(vs(D1(r),pr("C"),pr("Y")>>4))||(~~![][$1]<<3)+1):0}function $H(r){if(r=(r+"").replace(/\-/g,""),r[$1]!==pr("Z"))return!1;var t=0;return[[0,pr("G")+1],[pr("H"),pr("H")-1],[pr("G")+pr("H"),pr("G")]].reduce(function(e,n,a){var i=_H(n,2),o=i[0],u=i[1];return e|=(J4("".concat(J4(uo(vs.apply(void 0,[r].concat([t+o-(a===3>>2?0:2),u+(a?2:0)])))+(uo(vs.apply(void 0,[r].concat([t+o+u,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,e},pr("A"))===[]+1>>1}function DH(r,t){return BH(r)||xH(r,t)||UH(r,t)||LH()}function LH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UH(r,t){if(!!r){if(typeof r=="string")return e8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return e8(r,t)}}function e8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function xH(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function BH(r){if(Array.isArray(r))return r}var VH={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(t){var e=t.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(e,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},t8=!1;function GH(r){var t={template:"missing",vars:{}};if(r==="gpl-v3"||r==="internal-use-in-handsontable")t.template="valid";else if(typeof r=="string"&&$H(r)){var e="14/04/2022".split("/"),n=DH(e,3),a=n[0],i=n[1],o=n[2],u=Math.floor(new Date("".concat(i,"/").concat(a,"/").concat(o)).getTime()/864e5),s=PH(r);t.vars.keyValidityDate=jH(new Date((s+1)*864e5)),u>s?t.template="expired":t.template="valid"}else r!==""&&(t.template="invalid");return!t8&&t.template!=="valid"&&(console.warn(VH[t.template](t.vars)),t8=!0),t.template}function jH(r){var t=["January","February","March","April","May","June","July","August","September","October","November","December"],e=t[r.getMonth()],n=r.getDate(),a=r.getFullYear();return"".concat(e," ").concat(n,", ").concat(a)}function HH(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=r8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function WH(r,t){return KH(r)||YH(r,t)||r8(r,t)||zH()}function zH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r8(r,t){if(!!r){if(typeof r=="string")return n8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return n8(r,t)}}function n8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function YH(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function KH(r){if(Array.isArray(r))return r}function a8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function jn(r,t,e){return t&&a8(r.prototype,t),e&&a8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Hn(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var _e;(function(r){var t=jn(function u(s){Hn(this,u),this.value=s,this.value=zh(this.value,Kg(F(this.value)))});r.Number=t;var e=jn(function u(s){Hn(this,u),this.value=s});r.String=e;var n=jn(function u(s){Hn(this,u),this.value=s});r.Boolean=n;var a=function(){function u(){Hn(this,u)}return jn(u,null,[{key:"getSingletonInstance",value:function(){return u.instance||(u.instance=new u),u.instance}}]),u}();r.Empty=a;var i=jn(function u(s){Hn(this,u),this.formula=s});r.Formula=i;var o=jn(function u(s,l){Hn(this,u),this.value=new m(s,l)});r.Error=o})(_e||(_e={}));function XH(r){return r.startsWith("=")}function qH(r){var t=r.toLowerCase();return t==="true"||t==="false"}function QH(r,t){var e=r.toUpperCase(),n=/#[A-Za-z0-9\/]+[?!]?/;return n.test(e)&&Object.prototype.hasOwnProperty.call(t,e)}var ZH=function(){function r(t,e,n){Hn(this,r),this.config=t,this.dateHelper=e,this.numberLiteralsHelper=n}return jn(r,[{key:"parse",value:function(e){if(e==null)return _e.Empty.getSingletonInstance();if(typeof e=="number")return Yg(e)?new _e.Error(E.NUM,S.ValueLarge):new _e.Number(e);if(typeof e=="boolean")return new _e.Boolean(e);if(e instanceof Date){var n=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),a=$a({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=n+a;return i<0?new _e.Error(E.NUM,S.DateBounds):i%1==0?new _e.Number(new Yh(i,"Date()")):i<1?new _e.Number(new Kh(i,"Date()")):new _e.Number(new Xh(i,"Date()"))}else if(typeof e=="string"){if(qH(e))return new _e.Boolean(e.toLowerCase()==="true");if(XH(e))return new _e.Formula(e);if(QH(e,this.config.errorMapping))return new _e.Error(this.config.errorMapping[e.toUpperCase()]);var o=e.trim(),u=0,s;if(o.endsWith("%"))u=1,o=o.slice(0,o.length-1);else{var l=this.currencyMatcher(o);if(l!==void 0){u=2;var f=WH(l,2);s=f[0],o=f[1]}}var c=this.numberLiteralsHelper.numericStringToMaybeNumber(o);if(c!==void 0){var h;return u===1?h=new qh(c/100):u===2?h=new Bg(c,s):h=c,new _e.Number(h)}var p=this.dateHelper.dateStringToDateNumber(o);return p!==void 0?new _e.Number(p):new _e.String(e.startsWith("'")?e.slice(1):e)}else throw new Gy(e)}},{key:"currencyMatcher",value:function(e){var n=HH(this.config.currencySymbol),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(e.startsWith(i))return[i,e.slice(i.length)];if(e.endsWith(i))return[i,e.slice(0,e.length-i.length)]}}catch(o){n.e(o)}finally{n.f()}}}]),r}();function i8(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function o8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function u8(r,t,e){return t&&o8(r.prototype,t),e&&o8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Wn;(function(r){r[r.COPY=0]="COPY",r[r.CUT=1]="CUT"})(Wn||(Wn={}));var dt;(function(r){r[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR"})(dt||(dt={}));var s8=function(){function r(t,e,n,a,i){i8(this,r),this.sourceLeftCorner=t,this.width=e,this.height=n,this.type=a,this.content=i}return u8(r,[{key:"getContent",value:regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.content!==void 0){o.next=4;break}return o.abrupt("return");case 4:n=0;case 5:if(!(n<this.height)){o.next=16;break}a=0;case 7:if(!(a<this.width)){o.next=13;break}return o.next=10,[P(e.sheet,e.col+a,e.row+n),this.content[n][a]];case 10:++a,o.next=7;break;case 13:++n,o.next=5;break;case 16:case"end":return o.stop()}},t,this)})}]),r}(),JH=function(){function r(t,e,n){i8(this,r),this.dependencyGraph=e,this.operations=n,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}return u8(r,[{key:"cut",value:function(e,n,a){this.clipboard=new s8(e,n,a,Wn.CUT)}},{key:"copy",value:function(e,n,a){for(var i=[],o=0;o<a;++o){i[o]=[];for(var u=0;u<n;++u){var s=this.operations.getClipboardCell(P(e.sheet,e.col+u,e.row+o));i[o].push(s)}}this.clipboard=new s8(e,n,a,Wn.COPY,i)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===Wn.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(this.clipboard!==void 0){if(Ft(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Ye("a valid target address.");var n=Y.spanFrom(e,this.clipboard.width,this.clipboard.height);if(n.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new $n;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(n))throw new Error("It is not possible to paste onto an array")}}},{key:"isCutClipboard",value:function(){return this.clipboard!==void 0&&this.clipboard.type===Wn.CUT}},{key:"isCopyClipboard",value:function(){return this.clipboard!==void 0&&this.clipboard.type===Wn.COPY}}]),r}();function ys(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function l8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function ms(r,t,e){return t&&l8(r.prototype,t),e&&l8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var f8=function(){function r(t,e,n,a){ys(this,r),this.displayName=t,this.address=e,this.added=n,this.options=a}return ms(r,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new r(this.displayName,this.address,this.added,this.options)}}]),r}(),eW=function(){function r(){ys(this,r),this.mapping=new Map}return ms(r,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var n=this.normalizeExpressionName(e),a=this.mapping.get(n);return!(a&&a.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var n=this.mapping.get(this.normalizeExpressionName(e));if(n&&n.added)return n}},{key:"remove",value:function(e){var n=this.normalizeExpressionName(e),a=this.mapping.get(n);a&&(a.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter(function(e){return e.added})}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),r}(),c8=function(){function r(){ys(this,r),this.mapping=new Map}return ms(r,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter(function(e){return e.added})}},{key:"isNameAvailable",value:function(e){var n=this.normalizeExpressionName(e);return!this.mapping.has(n)}},{key:"remove",value:function(e){var n=this.normalizeExpressionName(e),a=this.mapping.get(n);a&&this.mapping.delete(n)}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),r}(),gs=function(){function r(){ys(this,r),this.nextNamedExpressionRow=0,this.workbookStore=new eW,this.worksheetStores=new Map,this.addressCache=new Map}return ms(r,[{key:"isNameAvailable",value:function(e,n){var a,i;return n===void 0?this.workbookStore.isNameAvailable(e):(i=(a=this.worksheetStore(n))===null||a===void 0?void 0:a.isNameAvailable(e))!==null&&i!==void 0?i:!0}},{key:"namedExpressionInAddress",value:function(e){var n=this.addressCache.get(e);if(n&&n.added)return n}},{key:"namedExpressionForScope",value:function(e,n){var a;return n===void 0?this.workbookStore.getExisting(e):(a=this.worksheetStore(n))===null||a===void 0?void 0:a.get(e)}},{key:"nearestNamedExpression",value:function(e,n){var a,i;return(i=(a=this.worksheetStore(n))===null||a===void 0?void 0:a.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,n){var a,i;return(i=(a=this.worksheetStore(n))===null||a===void 0?void 0:a.has(e))!==null&&i!==void 0?i:!1}},{key:"isNameValid",value:function(e){return/^[A-Za-z]+[0-9]+$/.test(e)?!1:/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,n,a){var i=n===void 0?this.workbookStore:this.worksheetStoreOrCreate(n),o=i.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=a):(o=new f8(e,this.nextAddress(),!0,a),i.add(o)),this.addressCache.set(o.address.row,o),o}},{key:"restoreNamedExpression",value:function(e,n){var a=n===void 0?this.workbookStore:this.worksheetStoreOrCreate(n);return e.added=!0,a.add(e),this.addressCache.set(e.address.row,e),e}},{key:"namedExpressionOrPlaceholder",value:function(e,n){var a;return(a=this.worksheetStoreOrCreate(n).get(e))!==null&&a!==void 0?a:this.workbookNamedExpressionOrPlaceholder(e)}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var n=this.workbookStore.get(e);return n===void 0&&(n=new f8(e,this.nextAddress(),!1),this.workbookStore.add(n)),n}},{key:"remove",value:function(e,n){var a;n===void 0?a=this.workbookStore:a=this.worksheetStore(n);var i=a==null?void 0:a.get(e);if(a===void 0||i===void 0||!i.added)throw"Named expression does not exist";a.remove(e),a instanceof c8&&a.mapping.size===0&&this.worksheetStores.delete(n),this.addressCache.delete(i.address.row)}},{key:"getAllNamedExpressionsNamesInScope",value:function(e){return this.getAllNamedExpressions().filter(function(n){var a=n.scope;return a===e}).map(function(n){return n.expression.displayName})}},{key:"getAllNamedExpressionsNames",value:function(){return this.getAllNamedExpressions().map(function(e){return e.expression.displayName})}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach(function(n){e.push({expression:n,scope:void 0})}),this.worksheetStores.forEach(function(n,a){n.getAllNamedExpressions().forEach(function(i){e.push({expression:i,scope:a})})}),e}},{key:"getAllNamedExpressionsForScope",value:function(e){var n,a;return e===void 0?this.workbookStore.getAllNamedExpressions():(a=(n=this.worksheetStores.get(e))===null||n===void 0?void 0:n.getAllNamedExpressions())!==null&&a!==void 0?a:[]}},{key:"worksheetStoreOrCreate",value:function(e){var n=this.worksheetStores.get(e);return n||(n=new c8,this.worksheetStores.set(e,n)),n}},{key:"worksheetStore",value:function(e){return this.worksheetStores.get(e)}},{key:"nextAddress",value:function(){return P(r.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}]),r}();gs.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;var h8=function r(t){switch(t.type){case b.EMPTY:case b.NUMBER:case b.STRING:case b.ERROR:case b.ERROR_WITH_RAW_INPUT:return!1;case b.CELL_REFERENCE:return!t.reference.isAbsolute();case b.CELL_RANGE:case b.COLUMN_RANGE:case b.ROW_RANGE:return!t.start.isAbsolute();case b.NAMED_EXPRESSION:return!1;case b.PERCENT_OP:case b.PLUS_UNARY_OP:case b.MINUS_UNARY_OP:return r(t.value);case b.CONCATENATE_OP:case b.EQUALS_OP:case b.NOT_EQUAL_OP:case b.LESS_THAN_OP:case b.GREATER_THAN_OP:case b.LESS_THAN_OR_EQUAL_OP:case b.GREATER_THAN_OR_EQUAL_OP:case b.MINUS_OP:case b.PLUS_OP:case b.TIMES_OP:case b.DIV_OP:case b.POWER_OP:return r(t.left)||r(t.right);case b.PARENTHESIS:return r(t.expression);case b.FUNCTION_CALL:return t.args.some(function(e){return r(e)});case b.ARRAY:return t.args.some(function(e){return e.some(function(n){return r(n)})})}};function tW(r,t){return aW(r)||nW(r,t)||p8(r,t)||rW()}function rW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nW(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function aW(r){if(Array.isArray(r))return r}function iW(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=p8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function p8(r,t){if(!!r){if(typeof r=="string")return d8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return d8(r,t)}}function d8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function oW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function v8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function uW(r,t,e){return t&&v8(r.prototype,t),e&&v8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var En=function(){function r(){oW(this,r)}return uW(r,[{key:"performEagerTransformations",value:function(e,n){var a=iW(e.arrayFormulaNodes()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.transformSingleAst(o.getFormula(e.lazilyTransformingAstService),o.getAddress(e.lazilyTransformingAstService)),s=tW(u,2),l=s[0],f=s[1],c=n.rememberNewAst(l);o.setFormula(c),o.setAddress(f)}}catch(h){a.e(h)}finally{a.f()}}},{key:"transformSingleAst",value:function(e,n){var a=this.transformAst(e,n),i=this.fixNodeAddress(n);return[a,i]}},{key:"transformAst",value:function(e,n){var a=this;switch(e.type){case b.CELL_REFERENCE:return this.transformCellReferenceAst(e,n);case b.CELL_RANGE:return this.transformCellRangeAst(e,n);case b.COLUMN_RANGE:return this.transformColumnRangeAst(e,n);case b.ROW_RANGE:return this.transformRowRangeAst(e,n);case b.EMPTY:case b.ERROR:case b.NUMBER:case b.NAMED_EXPRESSION:case b.ERROR_WITH_RAW_INPUT:case b.STRING:return e;case b.PERCENT_OP:case b.MINUS_UNARY_OP:case b.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,n)});case b.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(function(i){return a.transformAst(i,n)})});case b.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,n)});case b.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(function(i){return i.map(function(o){return a.transformAst(o,n)})})});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,n),right:this.transformAst(e.right,n)})}}},{key:"transformCellReferenceAst",value:function(e,n){var a=this.transformCellAddress(e.reference,n);return a instanceof Ut?Object.assign(Object.assign({},e),{reference:a}):a===E.REF?Rr(new m(E.REF)):e}},{key:"transformCellRangeAst",value:function(e,n){var a=this.transformCellRange(e.start,e.end,n);return Array.isArray(a)?Object.assign(Object.assign({},e),{start:a[0],end:a[1]}):a===E.REF?Rr(new m(E.REF)):e}},{key:"transformColumnRangeAst",value:function(e,n){var a=this.transformColumnRange(e.start,e.end,n);return Array.isArray(a)?Object.assign(Object.assign({},e),{start:a[0],end:a[1]}):a===E.REF?Rr(new m(E.REF)):e}},{key:"transformRowRangeAst",value:function(e,n){var a=this.transformRowRange(e.start,e.end,n);return Array.isArray(a)?Object.assign(Object.assign({},e),{start:a[0],end:a[1]}):a===E.REF?Rr(new m(E.REF)):e}}]),r}();function L1(r){return L1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L1(r)}function sW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function y8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function lW(r,t,e){return t&&y8(r.prototype,t),e&&y8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function fW(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&U1(r,t)}function U1(r,t){return U1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},U1(r,t)}function cW(r){var t=dW();return function(){var n=Es(r),a;if(t){var i=Es(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return hW(this,a)}}function hW(r,t){if(t&&(L1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pW(r)}function pW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function dW(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Es(r){return Es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Es(r)}var vW=function(r){fW(e,r);var t=cW(e);function e(n){var a;return sW(this,e),a=t.call(this),a.columnsSpan=n,a}return lW(e,[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(a,i){return a}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformCellAddress",value:function(a,i){var o=hr(a,i);if(o!==this.columnsSpan.sheet&&i.sheet!==this.columnsSpan.sheet)return!1;var u=a.toSimpleColumnAddress(i);if(o===this.columnsSpan.sheet&&i.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=u.col?a.shiftedByColumns(this.columnsSpan.numberOfColumns):!1;if(i.sheet===this.columnsSpan.sheet&&o!==this.columnsSpan.sheet)return a.isColumnAbsolute()||i.col<this.columnsSpan.columnStart?!1:a.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(a.isColumnAbsolute())return a.col<this.columnsSpan.columnStart?!1:a.shiftedByColumns(this.columnsSpan.numberOfColumns);var s=a.toSimpleColumnAddress(i);return s.col<this.columnsSpan.columnStart?i.col<this.columnsSpan.columnStart?!1:a.shiftedByColumns(-this.columnsSpan.numberOfColumns):i.col<this.columnsSpan.columnStart?a.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}},{key:"fixNodeAddress",value:function(a){return this.columnsSpan.sheet===a.sheet&&this.columnsSpan.columnStart<=a.col?Object.assign(Object.assign({},a),{col:a.col+this.columnsSpan.numberOfColumns}):a}},{key:"transformRange",value:function(a,i,o){var u=this.transformCellAddress(a,o),s=this.transformCellAddress(i,o);return u===E.REF||s===E.REF?E.REF:u||s?[u||a,s||i]:!1}}]),e}(En);function x1(r){return x1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x1(r)}function yW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function m8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function mW(r,t,e){return t&&m8(r.prototype,t),e&&m8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function gW(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&B1(r,t)}function B1(r,t){return B1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},B1(r,t)}function EW(r){var t=SW();return function(){var n=Rs(r),a;if(t){var i=Rs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return RW(this,a)}}function RW(r,t){if(t&&(x1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bW(r)}function bW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function SW(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rs(r){return Rs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rs(r)}var V1=function(r){gW(e,r);var t=EW(e);function e(n){var a;return yW(this,e),a=t.call(this),a.rowsSpan=n,a}return mW(e,[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(a,i){return a}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformColumnRange",value:function(a,i,o){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(a,i){var o=hr(a,i);if(o!==this.rowsSpan.sheet&&i.sheet!==this.rowsSpan.sheet)return!1;var u=a.toSimpleRowAddress(i);return o===this.rowsSpan.sheet&&i.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=u.row?a.shiftedByRows(this.rowsSpan.numberOfRows):!1:i.sheet===this.rowsSpan.sheet&&o!==this.rowsSpan.sheet?a.isRowAbsolute()||i.row<this.rowsSpan.rowStart?!1:a.shiftedByRows(-this.rowsSpan.numberOfRows):a.isRowAbsolute()?a.row<this.rowsSpan.rowStart?!1:a.shiftedByRows(this.rowsSpan.numberOfRows):u.row<this.rowsSpan.rowStart?i.row<this.rowsSpan.rowStart?!1:a.shiftedByRows(-this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?a.shiftedByRows(this.rowsSpan.numberOfRows):!1}},{key:"fixNodeAddress",value:function(a){return this.rowsSpan.sheet===a.sheet&&this.rowsSpan.rowStart<=a.row?Object.assign(Object.assign({},a),{row:a.row+this.rowsSpan.numberOfRows}):a}},{key:"transformRange",value:function(a,i,o){var u=this.transformCellAddress(a,o),s=this.transformCellAddress(i,o);return u===E.REF||s===E.REF?E.REF:u||s?[u||a,s||i]:!1}}]),e}(En);function G1(r){return G1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G1(r)}function AW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function g8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function TW(r,t,e){return t&&g8(r.prototype,t),e&&g8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function OW(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&j1(r,t)}function j1(r,t){return j1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},j1(r,t)}function wW(r){var t=_W();return function(){var n=bs(r),a;if(t){var i=bs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return NW(this,a)}}function NW(r,t){if(t&&(G1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CW(r)}function CW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _W(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bs(r){return bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bs(r)}var IW=function(r){OW(e,r);var t=wW(e);function e(n){var a;return AW(this,e),a=t.call(this),a.sheet=n,a}return TW(e,[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(a){return a}},{key:"transformCellAddress",value:function(a,i){return a.isInvalid(i)?E.REF:!1}},{key:"transformCellRange",value:function(a,i,o){return a.isInvalid(o)||i.isInvalid(o)?E.REF:!1}},{key:"transformColumnRange",value:function(a,i,o){return a.isInvalid(o)||i.isInvalid(o)?E.REF:!1}},{key:"transformRowRange",value:function(a,i,o){return a.isInvalid(o)||i.isInvalid(o)?E.REF:!1}}]),e}(En);function H1(r){return H1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H1(r)}function E8(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function R8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function b8(r,t,e){return t&&R8(r.prototype,t),e&&R8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function S8(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&W1(r,t)}function W1(r,t){return W1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},W1(r,t)}function A8(r){var t=FW();return function(){var n=Ss(r),a;if(t){var i=Ss(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return MW(this,a)}}function MW(r,t){if(t&&(H1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kW(r)}function kW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function FW(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ss(r){return Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ss(r)}var PW=function(r){S8(e,r);var t=A8(e);function e(n,a,i,o){var u;return E8(this,e),u=t.call(this),u.sourceRange=n,u.toRight=a,u.toBottom=i,u.toSheet=o,u.dependentFormulaTransformer=new $W(n,a,i,o),u}return b8(e,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformSingleAst",value:function(a,i){if(this.sourceRange.addressInRange(i)){var o=this.transformAst(a,i);return[o,this.fixNodeAddress(i)]}else return this.dependentFormulaTransformer.transformSingleAst(a,i)}},{key:"fixNodeAddress",value:function(a){return P(this.toSheet,a.col+this.toRight,a.row+this.toBottom)}},{key:"transformCellAddress",value:function(a,i){return this.transformAddress(a,i)}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformColumnRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformAddress",value:function(a,i){var o=this.sourceRange;if(a instanceof Ut){var u=a.toSimpleCellAddress(i);if(o.addressInRange(u))return a.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return a.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(a,i,o){var u=this.sourceRange;if(a instanceof Ut&&i instanceof Ut){var s=a.toSimpleCellAddress(o),l=i.toSimpleCellAddress(o);if(u.addressInRange(s)&&u.addressInRange(l))return[a.shiftAbsoluteDimensions(this.toRight,this.toBottom),i.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[a.shiftRelativeDimensions(-this.toRight,-this.toBottom),i.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}]),e}(En),$W=function(r){S8(e,r);var t=A8(e);function e(n,a,i,o){var u;return E8(this,e),u=t.call(this),u.sourceRange=n,u.toRight=a,u.toBottom=i,u.toSheet=o,u}return b8(e,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(a){return a}},{key:"transformCellAddress",value:function(a,i){return this.shouldMove(a,i)?a.moved(this.toSheet,this.toRight,this.toBottom):!1}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformColumnRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"shouldMove",value:function(a,i){return a instanceof Ut?this.sourceRange.addressInRange(a.toSimpleCellAddress(i)):a instanceof on?this.sourceRange.rowInRange(a.toSimpleRowAddress(i))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(a.toSimpleColumnAddress(i))&&!this.sourceRange.isFinite()}},{key:"transformRange",value:function(a,i,o){var u=this.transformCellAddress(a,o),s=this.transformCellAddress(i,o);return u&&s?[u,s]:!1}}]),e}(En);function z1(r){return z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z1(r)}function DW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function T8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function LW(r,t,e){return t&&T8(r.prototype,t),e&&T8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function UW(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Y1(r,t)}function Y1(r,t){return Y1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Y1(r,t)}function xW(r){var t=GW();return function(){var n=As(r),a;if(t){var i=As(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return BW(this,a)}}function BW(r,t){if(t&&(z1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VW(r)}function VW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function GW(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function As(r){return As=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},As(r)}var jW=function(r){UW(e,r);var t=xW(e);function e(n){var a;return DW(this,e),a=t.call(this),a.columnsSpan=n,a}return LW(e,[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformRowRangeAst",value:function(a,i){return a}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformCellAddress",value:function(a,i){var o=hr(a,i);if(this.columnsSpan.sheet!==i.sheet&&this.columnsSpan.sheet!==o)return!1;if(this.columnsSpan.sheet!==i.sheet&&this.columnsSpan.sheet===o){var u=a.toSimpleColumnAddress(i);if(u.col<this.columnsSpan.columnStart)return!1;if(u.col>this.columnsSpan.columnEnd)return a.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===i.sheet&&this.columnsSpan.sheet!==o){if(a.isColumnAbsolute())return!1;if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return a.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===i.sheet&&this.columnsSpan.sheet===o)if(a.isColumnAbsolute()){if(a.col<this.columnsSpan.columnStart)return!1;if(a.col>this.columnsSpan.columnEnd)return a.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var s=a.toSimpleColumnAddress(i);if(s.col<this.columnsSpan.columnStart){if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return a.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(s.col>this.columnsSpan.columnEnd){if(i.col<this.columnsSpan.columnStart)return a.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(i.col>this.columnsSpan.columnEnd)return!1}}return E.REF}},{key:"fixNodeAddress",value:function(a){return this.columnsSpan.sheet===a.sheet&&this.columnsSpan.columnStart<=a.col?Object.assign(Object.assign({},a),{col:a.col-this.columnsSpan.numberOfColumns}):a}},{key:"transformRange",value:function(a,i,o){var u=hr(a,o),s=a,l=i;if(this.columnsSpan.sheet===u){var f=a.toSimpleColumnAddress(o),c=i.toSimpleColumnAddress(o);if(this.columnsSpan.columnStart<=f.col&&this.columnsSpan.columnEnd>=c.col)return E.REF;f.col>=this.columnsSpan.columnStart&&f.col<=this.columnsSpan.columnEnd&&(s=a.shiftedByColumns(this.columnsSpan.columnEnd-f.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(l=i.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}var h=this.transformCellAddress(s,o),p=this.transformCellAddress(l,o);if(h===!1&&p===!1)return[s,l];if(h===E.REF||p===E.REF)throw Error("Cannot happen");return[h||s,p||l]}}]),e}(En);function K1(r){return K1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K1(r)}function HW(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function O8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function WW(r,t,e){return t&&O8(r.prototype,t),e&&O8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function zW(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&X1(r,t)}function X1(r,t){return X1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},X1(r,t)}function YW(r){var t=qW();return function(){var n=Ts(r),a;if(t){var i=Ts(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return KW(this,a)}}function KW(r,t){if(t&&(K1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XW(r)}function XW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function qW(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ts(r){return Ts=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ts(r)}var q1=function(r){zW(e,r);var t=YW(e);function e(n){var a;return HW(this,e),a=t.call(this),a.rowsSpan=n,a}return WW(e,[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(a,i){return a}},{key:"transformCellAddress",value:function(a,i){var o=hr(a,i);if(this.rowsSpan.sheet!==i.sheet&&this.rowsSpan.sheet!==o)return!1;if(this.rowsSpan.sheet!==i.sheet&&this.rowsSpan.sheet===o){var u=a.toSimpleRowAddress(i);if(u.row<this.rowsSpan.rowStart)return!1;if(u.row>this.rowsSpan.rowEnd)return a.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===i.sheet&&this.rowsSpan.sheet!==o){if(a.isRowAbsolute())return!1;if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return a.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===i.sheet&&this.rowsSpan.sheet===o)if(a.isRowAbsolute()){if(a.row<this.rowsSpan.rowStart)return!1;if(a.row>this.rowsSpan.rowEnd)return a.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var s=a.toSimpleRowAddress(i);if(s.row<this.rowsSpan.rowStart){if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return a.shiftedByRows(this.rowsSpan.numberOfRows)}else if(s.row>this.rowsSpan.rowEnd){if(i.row<this.rowsSpan.rowStart)return a.shiftedByRows(-this.rowsSpan.numberOfRows);if(i.row>this.rowsSpan.rowEnd)return!1}}return E.REF}},{key:"transformCellRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformRowRange",value:function(a,i,o){return this.transformRange(a,i,o)}},{key:"transformColumnRange",value:function(a,i,o){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(a){return this.rowsSpan.sheet===a.sheet&&this.rowsSpan.rowStart<=a.row?Object.assign(Object.assign({},a),{row:a.row-this.rowsSpan.numberOfRows}):a}},{key:"transformRange",value:function(a,i,o){var u=hr(a,o),s=a,l=i;if(this.rowsSpan.sheet===u){var f=a.toSimpleRowAddress(o),c=i.toSimpleRowAddress(o);if(this.rowsSpan.rowStart<=f.row&&this.rowsSpan.rowEnd>=c.row)return E.REF;f.row>=this.rowsSpan.rowStart&&f.row<=this.rowsSpan.rowEnd&&(s=a.shiftedByRows(this.rowsSpan.rowEnd-f.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(l=i.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}var h=this.transformCellAddress(s,o),p=this.transformCellAddress(l,o);return h===!1&&p===!1?[s,l]:h===E.REF||p===E.REF?E.REF:[h||s,p||l]}}]),e}(En);function Q1(r){return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(r)}function QW(r,t){return ez(r)||JW(r,t)||w8(r,t)||ZW()}function ZW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JW(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function ez(r){if(Array.isArray(r))return r}function tz(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=w8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function w8(r,t){if(!!r){if(typeof r=="string")return N8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N8(r,t)}}function N8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function rz(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function C8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function nz(r,t,e){return t&&C8(r.prototype,t),e&&C8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function az(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Z1(r,t)}function Z1(r,t){return Z1=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Z1(r,t)}function iz(r){var t=sz();return function(){var n=Os(r),a;if(t){var i=Os(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return oz(this,a)}}function oz(r,t){if(t&&(Q1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uz(r)}function uz(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function sz(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Os(r){return Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Os(r)}var lz=function(r){az(e,r);var t=iz(e);function e(n){var a;return rz(this,e),a=t.call(this),a.sheet=n,a}return nz(e,[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(a,i){var o=tz(a.arrayFormulaNodes()),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=this.transformSingleAst(s.getFormula(a.lazilyTransformingAstService),s.getAddress(a.lazilyTransformingAstService)),f=QW(l,1),c=f[0];s.setFormula(c)}}catch(h){o.e(h)}finally{o.f()}}},{key:"fixNodeAddress",value:function(a){return a}},{key:"transformCellAddress",value:function(a,i){return this.transformAddress(a)}},{key:"transformCellRange",value:function(a,i,o){return this.transformAddress(a)}},{key:"transformColumnRange",value:function(a,i,o){return this.transformAddress(a)}},{key:"transformRowRange",value:function(a,i,o){return this.transformAddress(a)}},{key:"transformAddress",value:function(a){return a.sheet===this.sheet?E.REF:!1}}]),e}(En);/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function _8(r){if(!Array.isArray(r))throw new Ye("an array of arrays.");for(var t=0;t<r.length;t++)if(!Array.isArray(r[t]))throw new Ye("an array of arrays.")}function ws(r){for(var t=0,e=0,n=0,a=0;a<r.length;a++){for(var i=0,o=0;o<r[a].length;o++){var u=r[a][o];u!=null&&(i=o+1,++n)}t=Math.max(t,i),i>0&&(e=a+1)}var s=t*e;return{height:e,width:t,fill:s===0?0:n/s}}function Ns(r){return hz(r)||cz(r)||J1(r)||fz()}function fz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cz(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function hz(r){if(Array.isArray(r))return e2(r)}function $t(r,t){return vz(r)||dz(r,t)||J1(r,t)||pz()}function pz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dz(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function vz(r){if(Array.isArray(r))return r}function St(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=J1(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function J1(r,t){if(!!r){if(typeof r=="string")return e2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return e2(r,t)}}function e2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function so(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function I8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function lo(r,t,e){return t&&I8(r.prototype,t),e&&I8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var M8=function(){function r(t,e){so(this,r),this.sheet=t,this.indexes=e}return lo(r,[{key:"normalizedIndexes",value:function(){return Cs(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(n){return xr.fromNumberOfRows(e.sheet,n[0],n[1])})}}]),r}(),k8=function(){function r(t,e){so(this,r),this.sheet=t,this.indexes=e}return lo(r,[{key:"normalizedIndexes",value:function(){return _s(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(n){return xr.fromNumberOfRows(e.sheet,n[0],n[1])})}}]),r}(),F8=function(){function r(t,e){so(this,r),this.sheet=t,this.indexes=e}return lo(r,[{key:"normalizedIndexes",value:function(){return _s(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(n){return vn.fromNumberOfColumns(e.sheet,n[0],n[1])})}}]),r}(),P8=function(){function r(t,e){so(this,r),this.sheet=t,this.indexes=e}return lo(r,[{key:"normalizedIndexes",value:function(){return Cs(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map(function(n){return vn.fromNumberOfColumns(e.sheet,n[0],n[1])})}}]),r}(),yz=function(){function r(t,e,n,a,i,o,u,s,l){so(this,r),this.dependencyGraph=e,this.columnSearch=n,this.cellContentParser=a,this.parser=i,this.stats=o,this.lazilyTransformingAstService=u,this.namedExpressions=s,this.arraySizePredictor=l,this.changes=_a.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=t.maxColumns,this.maxRows=t.maxRows}return lo(r,[{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"removeRows",value:function(e){var n=[],a=St(e.rowsSpans()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.doRemoveRows(o);u&&n.push(u)}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"addRows",value:function(e){var n=St(e.rowsSpans()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.doAddRows(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"addColumns",value:function(e){var n=St(e.columnsSpans()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.doAddColumns(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"removeColumns",value:function(e){var n=[],a=St(e.columnsSpans()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.doRemoveColumns(o);u&&n.push(u)}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"removeSheet",value:function(e){var n=this;this.dependencyGraph.removeSheet(e);var a;this.stats.measure(X.TRANSFORM_ASTS,function(){var o=new lz(e);o.performEagerTransformations(n.dependencyGraph,n.parser),a=n.lazilyTransformingAstService.addTransformation(o)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);var i=this.namedExpressions.getAllNamedExpressionsForScope(e).map(function(o){return n.removeNamedExpression(o.normalizeExpressionName(),e)});return{version:a,scopedNamedExpressions:i}}},{key:"removeSheetByName",value:function(e){var n=this.sheetMapping.fetch(e);return this.removeSheet(n)}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var n=this.sheetMapping.addSheet(e),a=[];return this.dependencyGraph.addressMapping.autoAddSheet(n,a,ws(a)),this.sheetMapping.fetchDisplayName(n)}},{key:"renameSheet",value:function(e,n){return this.sheetMapping.renameSheet(e,n)}},{key:"moveRows",value:function(e,n,a,i){var o=xr.fromNumberOfRows(e,i,a);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),i<n&&(n+=a);var u=P(e,0,n),s=P(e,0,i);this.moveCells(u,Number.POSITIVE_INFINITY,a,s);var l=xr.fromNumberOfRows(e,n,a);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,n,a,i){var o=vn.fromNumberOfColumns(e,i,a);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),i<n&&(n+=a);var u=P(e,n,0),s=P(e,i,0);this.moveCells(u,a,Number.POSITIVE_INFINITY,s);var l=vn.fromNumberOfColumns(e,n,a);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,n,a,i){var o=this;this.ensureItIsPossibleToMoveCells(e,n,a,i);var u=Y.spanFrom(e,n,a),s=Y.spanFrom(i,n,a),l=i.col-e.col,f=i.row-e.row,c=i.sheet,h=this.getRangeClipboardCells(s),p=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.removeValues(p);var y=this.dependencyGraph.rawValuesFromRange(u);this.columnSearch.moveValues(y,l,f,c);var v;this.stats.measure(X.TRANSFORM_ASTS,function(){var g=new PW(u,l,f,c);g.performEagerTransformations(o.dependencyGraph,o.parser),v=o.lazilyTransformingAstService.addTransformation(g)}),this.dependencyGraph.moveCells(u,l,f,c);var R=this.updateNamedExpressionsForMovedCells(e,n,a,i);return{version:v,overwrittenCellsData:h,addedGlobalNamedExpressions:R}}},{key:"setRowOrder",value:function(e,n){var a=this,i=[],o=[],u=St(n),s;try{var l=function(){var c=$t(s.value,2),h=c[0],p=c[1];if(h!==p){var y=Y.spanFrom({sheet:e,col:0,row:h},1/0,1),v=a.getRangeClipboardCells(y);o=o.concat(v),i.push(v.map(function(R){var g=$t(R,2),A=g[0],T=A.sheet,N=A.col,M=g[1];return[{sheet:T,col:N,row:p},M]}))}};for(u.s();!(s=u.n()).done;)l()}catch(f){u.e(f)}finally{u.f()}return i.forEach(function(f){return a.restoreClipboardCells(e,f.values())}),o}},{key:"setColumnOrder",value:function(e,n){var a=this,i=[],o=[],u=St(n),s;try{var l=function(){var c=$t(s.value,2),h=c[0],p=c[1];if(h!==p){var y=Y.spanFrom({sheet:e,col:h,row:0},1,1/0),v=a.getRangeClipboardCells(y);o=o.concat(v),i.push(v.map(function(R){var g=$t(R,2),A=g[0],T=A.sheet,N=A.col,M=A.row,_=g[1];return[{sheet:T,col:p,row:M},_]}))}};for(u.s();!(s=u.n()).done;)l()}catch(f){u.e(f)}finally{u.f()}return i.forEach(function(f){return a.restoreClipboardCells(e,f.values())}),o}},{key:"addNamedExpression",value:function(e,n,a,i){var o=this.namedExpressions.addNamedExpression(e,a,i);this.storeNamedExpressionInCell(o.address,n),this.adjustNamedExpressionEdges(o,e,a)}},{key:"restoreNamedExpression",value:function(e,n,a){var i=e.displayName;this.restoreCell(e.address,n);var o=this.namedExpressions.restoreNamedExpression(e,a);this.adjustNamedExpressionEdges(o,i,a)}},{key:"changeNamedExpressionExpression",value:function(e,n,a,i){var o=this.namedExpressions.namedExpressionForScope(e,a);if(!o)throw new Ii(e);var u=o.copy();o.options=i;var s=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,n),[u,s]}},{key:"removeNamedExpression",value:function(e,n){var a=this.namedExpressions.namedExpressionForScope(e,n);if(!a)throw new Ii(e);this.namedExpressions.remove(a.displayName,n);var i=this.getClipboardCell(a.address);if(n!==void 0){var o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(a.address,o.address)}else this.dependencyGraph.setCellEmpty(a.address);return[a,i]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,n,a,i){if(Ft(e)||!(Is(n)&&Is(a)||mz(e,n,a))||Ft(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Ye("a valid range of cells to move.");var o=Y.spanFrom(e,n,a),u=Y.spanFrom(i,n,a);if(u.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new $n;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new pa;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new su}},{key:"restoreClipboardCells",value:function(e,n){var a=[],i=St(n),o;try{for(i.s();!(o=i.n()).done;){var u=$t(o.value,2),s=u[0],l=u[1];if(this.restoreCell(s,l),l.type===dt.FORMULA){var f=this.parser.fetchCachedResult(l.hash),c=f.dependencies;a.push.apply(a,Ns(this.updateNamedExpressionsForTargetAddress(e,s,c)))}}}catch(h){i.e(h)}finally{i.f()}return a}},{key:"restoreCell",value:function(e,n){switch(n.type){case dt.VALUE:{this.setValueToCell(n,e);break}case dt.FORMULA:{this.setFormulaToCellFromCache(n.hash,e);break}case dt.EMPTY:{this.setCellEmpty(e);break}case dt.PARSING_ERROR:{this.setParsingErrorToCell(n.rawInput,n.errors,e);break}}}},{key:"getOldContent",value:function(e){var n=this.dependencyGraph.getCell(e);if(n===void 0||n instanceof jr)return[e,{type:dt.EMPTY}];if(n instanceof mn)return[e,Object.assign({type:dt.VALUE},n.getValues())];if(n instanceof jt)return[n.getAddress(this.lazilyTransformingAstService),{type:dt.FORMULA,hash:this.parser.computeHashFromAst(n.getFormula(this.lazilyTransformingAstService))}];if(n instanceof Ma)return[e,{type:dt.PARSING_ERROR,rawInput:n.rawInput,errors:n.errors}];throw Error("Trying to copy unsupported type")}},{key:"getClipboardCell",value:function(e){var n=this.dependencyGraph.getCell(e);if(n===void 0||n instanceof jr)return{type:dt.EMPTY};if(n instanceof mn)return Object.assign({type:dt.VALUE},n.getValues());if(n instanceof Fe){var a=n.getArrayCellValue(e);return a===ne?{type:dt.EMPTY}:{type:dt.VALUE,parsedValue:a,rawValue:n.getArrayCellRawValue(e)}}else{if(n instanceof Vr)return{type:dt.FORMULA,hash:this.parser.computeHashFromAst(n.getFormula(this.lazilyTransformingAstService))};if(n instanceof Ma)return{type:dt.PARSING_ERROR,rawInput:n.rawInput,errors:n.errors}}throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var n=this.dependencyGraph.getSheetHeight(e),a=this.dependencyGraph.getSheetWidth(e),i=new Array(n),o=0;o<n;o++){i[o]=new Array(a);for(var u=0;u<a;u++){var s=P(e,u,o);i[o][u]=this.getClipboardCell(s)}}return i}},{key:"getRangeClipboardCells",value:function(e){var n=[],a=St(e.addresses(this.dependencyGraph)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.push([o,this.getClipboardCell(o)])}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"setCellContent",value:function(e,n){var a=this.cellContentParser.parse(n),i=this.getOldContent(e);if(a instanceof _e.Formula){var o=this.parser.parse(a.formula,e),u=o.ast,s=o.errors;if(s.length>0)this.setParsingErrorToCell(a.formula,s,e);else{var l=this.arraySizePredictor.checkArraySize(u,e);this.setFormulaToCell(e,l,o)}}else a instanceof _e.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:a.value,rawValue:n},e);return i}},{key:"setSheetContent",value:function(e,n){this.clearSheet(e);for(var a=0;a<n.length;a++)for(var i=0;i<n[a].length;i++){var o=P(e,i,a);this.setCellContent(o,n[a][i])}}},{key:"setParsingErrorToCell",value:function(e,n,a){var i=this.dependencyGraph.getCellValue(a),o=new Ma(n,e),u=this.dependencyGraph.setParsingErrorToCell(a,o);this.columnSearch.remove(F(i),a),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u),this.changes.addChange(o.getCellValue(),a)}},{key:"setFormulaToCell",value:function(e,n,a){var i=a.ast,o=a.hasVolatileFunction,u=a.hasStructuralChangeFunction,s=a.dependencies,l=this.dependencyGraph.getCellValue(e),f=this.dependencyGraph.setFormulaToCell(e,i,br(s,e),n,o,u);this.columnSearch.remove(F(l),e),this.columnSearch.applyChanges(f.getChanges()),this.changes.addAll(f)}},{key:"setValueToCell",value:function(e,n){var a=this.dependencyGraph.getCellValue(n),i=this.dependencyGraph.setValueToCell(n,e);this.columnSearch.change(F(a),F(e.parsedValue),n),this.columnSearch.applyChanges(i.getChanges().filter(function(o){return!ro(o.address,n)})),this.changes.addAll(i),this.changes.addChange(e.parsedValue,n)}},{key:"setCellEmpty",value:function(e){if(!this.dependencyGraph.isArrayInternalCell(e)){var n=this.dependencyGraph.getCellValue(e),a=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(F(n),e),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(ne,e)}}},{key:"setFormulaToCellFromCache",value:function(e,n){var a=this.parser.fetchCachedResult(e),i=a.ast,o=a.hasVolatileFunction,u=a.hasStructuralChangeFunction,s=a.dependencies,l=br(s,n),f=new IW(n.sheet).transformSingleAst(i,n),c=$t(f,1),h=c[0];this.parser.rememberNewAst(h);var p=gx(l),y=this.arraySizePredictor.checkArraySize(i,n);this.dependencyGraph.setFormulaToCell(n,h,p,y,o,u)}},{key:"rowEffectivelyNotInSheet",value:function(e,n){var a=this.dependencyGraph.addressMapping.getHeight(n);return e>=a}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=_a.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"doRemoveRows",value:function(e){var n=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var a=[],i=St(this.dependencyGraph.entriesFromRowsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=$t(o.value,1),s=u[0];a.push({address:s,cellType:this.getClipboardCell(s)})}}catch(p){i.e(p)}finally{i.f()}var l=this.dependencyGraph.removeRows(e),f=l.affectedArrays,c=l.contentChanges;this.columnSearch.applyChanges(c.getChanges());var h;return this.stats.measure(X.TRANSFORM_ASTS,function(){var p=new q1(e);p.performEagerTransformations(n.dependencyGraph,n.parser),h=n.lazilyTransformingAstService.addTransformation(p)}),this.rewriteAffectedArrays(f),{version:h,removedCells:a,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var n=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var a=[],i=St(this.dependencyGraph.entriesFromColumnsSpan(e)),o;try{for(i.s();!(o=i.n()).done;){var u=$t(o.value,1),s=u[0];a.push({address:s,cellType:this.getClipboardCell(s)})}}catch(p){i.e(p)}finally{i.f()}var l=this.dependencyGraph.removeColumns(e),f=l.affectedArrays,c=l.contentChanges;this.columnSearch.applyChanges(c.getChanges()),this.columnSearch.removeColumns(e);var h;return this.stats.measure(X.TRANSFORM_ASTS,function(){var p=new jW(e);p.performEagerTransformations(n.dependencyGraph,n.parser),h=n.lazilyTransformingAstService.addTransformation(p)}),this.rewriteAffectedArrays(f),{version:h,removedCells:a,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var n=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var a=this.dependencyGraph.addRows(e),i=a.affectedArrays;this.stats.measure(X.TRANSFORM_ASTS,function(){var o=new V1(e);o.performEagerTransformations(n.dependencyGraph,n.parser),n.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(i)}}},{key:"rewriteAffectedArrays",value:function(e){var n=St(e.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(!i.array.size.isRef){var o=i.getFormula(this.lazilyTransformingAstService),u=i.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(o);this.setFormulaToCellFromCache(s,u)}}}catch(l){n.e(l)}finally{n.f()}}},{key:"doAddColumns",value:function(e){var n=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var a=this.dependencyGraph.addColumns(e),i=a.affectedArrays,o=a.contentChanges;this.columnSearch.addColumns(e),this.columnSearch.applyChanges(o.getChanges()),this.stats.measure(X.TRANSFORM_ASTS,function(){var u=new vW(e);u.performEagerTransformations(n.dependencyGraph,n.parser),n.lazilyTransformingAstService.addTransformation(u)}),this.rewriteAffectedArrays(i)}}},{key:"columnEffectivelyNotInSheet",value:function(e,n){var a=this.dependencyGraph.addressMapping.getWidth(n);return e>=a}},{key:"adjustNamedExpressionEdges",value:function(e,n,a){if(a!==void 0){var i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(n),u=this.dependencyGraph.fetchCellOrCreateEmpty(o.address),s=St(this.dependencyGraph.graph.adjacentNodes(u)),l;try{for(s.s();!(l=s.n()).done;){var f=l.value;if(f instanceof Vr&&f.getAddress(this.lazilyTransformingAstService).sheet===a){var c=f.getFormula(this.lazilyTransformingAstService),h=f.getAddress(this.lazilyTransformingAstService),p=this.parser.fetchCachedResultForAst(c),y=p.dependencies,v=St(br(y,h)),R;try{for(v.s();!(R=v.n()).done;){var g=R.value;g instanceof dn&&g.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(u,f),this.dependencyGraph.graph.addEdge(i,f))}}catch(A){v.e(A)}finally{v.f()}}}}catch(A){s.e(A)}finally{s.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,n){var a=this.cellContentParser.parse(n);if(a instanceof _e.Formula){var i=this.parser.parse(a.formula,P(-1,0,0));if(h8(i.ast))throw new Hc;var o=i.ast,u=i.hasVolatileFunction,s=i.hasStructuralChangeFunction,l=i.dependencies;this.dependencyGraph.setFormulaToCell(e,o,br(l,e),ue.scalar(),u,s)}else a instanceof _e.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:a.value,rawValue:n},e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,n,a,i){if(e.sheet===i.sheet)return[];var o=[],u=Y.spanFrom(i,n,a),s=St(u.addresses(this.dependencyGraph)),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,c=this.addressMapping.fetchCell(f);if(c instanceof Vr&&f.sheet!==e.sheet){var h=c.getFormula(this.lazilyTransformingAstService),p=this.parser.fetchCachedResultForAst(h),y=p.dependencies;o.push.apply(o,Ns(this.updateNamedExpressionsForTargetAddress(e.sheet,f,y)))}}}catch(v){s.e(v)}finally{s.f()}return o}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,n,a){if(e===n.sheet)return[];var i=[],o=this.addressMapping.fetchCell(n),u=St(br(a,n)),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof dn){var f=l.name,c=this.dependencyGraph.fetchNamedExpressionVertex(f,e),h=this.namedExpressions.isExpressionInScope(f,n.sheet),p=h?this.dependencyGraph.fetchNamedExpressionVertex(f,n.sheet):this.copyOrFetchGlobalNamedExpressionVertex(f,c,i);p!==c&&(this.dependencyGraph.graph.softRemoveEdge(c,o),this.dependencyGraph.graph.addEdge(p,o))}}}catch(y){u.e(y)}finally{u.f()}return i}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new kG(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,n,a){var i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),a.push(i.normalizeExpressionName()),n instanceof Vr){var o=this.parser.fetchCachedResultForAst(n.getFormula(this.lazilyTransformingAstService)),u=o.ast,s=o.hasVolatileFunction,l=o.hasStructuralChangeFunction,f=o.dependencies;this.dependencyGraph.setFormulaToCell(i.address,u,br(f,i.address),ue.scalar(),s,l)}else n instanceof jr?this.setCellEmpty(i.address):n instanceof mn&&this.setValueToCell(n.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address)}}]),r}();function Cs(r){if(r.length<=1)return r;for(var t=Ns(r).sort(function(i,o){var u=$t(i,1),s=u[0],l=$t(o,1),f=l[0];return s-f}),e=t.reduce(function(i,o){var u=$t(o,2),s=u[0],l=u[1],f=i[i.length-1],c=f[0]+f[1];return s<=c?f[1]+=Math.max(0,l-(c-s)):i.push([s,l]),i},[t[0]]),n=0,a=0;a<e.length;++a)e[a][0]-=n,n+=e[a][1];return e}function _s(r){if(r.length<=1)return r;for(var t=Ns(r).sort(function(i,o){var u=$t(i,1),s=u[0],l=$t(o,1),f=l[0];return s-f}),e=t.reduce(function(i,o){var u=$t(o,2),s=u[0],l=u[1],f=i[i.length-1];return s===f[0]?f[1]=Math.max(f[1],l):i.push([s,l]),i},[t[0]]),n=0,a=0;a<e.length;++a)e[a][0]+=n,n+=e[a][1];return e}function Is(r){return Number.isInteger(r)&&r>0}function mz(r,t,e){return r.row===0&&Is(t)&&e===Number.POSITIVE_INFINITY||r.col===0&&Is(e)&&t===Number.POSITIVE_INFINITY}function t2(r){return t2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t2(r)}function Ms(r,t){return Rz(r)||Ez(r,t)||$8(r,t)||gz()}function gz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ez(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function Rz(r){if(Array.isArray(r))return r}function dr(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=$8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function $8(r,t){if(!!r){if(typeof r=="string")return D8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return D8(r,t)}}function D8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function Ke(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&r2(r,t)}function r2(r,t){return r2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},r2(r,t)}function Xe(r){var t=Az();return function(){var n=ks(r),a;if(t){var i=ks(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return bz(this,a)}}function bz(r,t){if(t&&(t2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sz(r)}function Sz(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Az(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ks(r){return ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ks(r)}function L8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Le(r,t,e){return t&&L8(r.prototype,t),e&&L8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ue(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var qe=Le(function r(){Ue(this,r)}),Tz=function(r){Ke(e,r);var t=Xe(e);function e(n,a){var i;return Ue(this,e),i=t.call(this),i.command=n,i.rowsRemovals=a,i}return Le(e,[{key:"doUndo",value:function(a){a.undoRemoveRows(this)}},{key:"doRedo",value:function(a){a.redoRemoveRows(this)}}]),e}(qe),Oz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o,u,s,l){var f;return Ue(this,e),f=t.call(this),f.sourceLeftCorner=n,f.width=a,f.height=i,f.destinationLeftCorner=o,f.overwrittenCellsData=u,f.addedGlobalNamedExpressions=s,f.version=l,f}return Le(e,[{key:"doUndo",value:function(a){a.undoMoveCells(this)}},{key:"doRedo",value:function(a){a.redoMoveCells(this)}}]),e}(qe),wz=function(r){Ke(e,r);var t=Xe(e);function e(n){var a;return Ue(this,e),a=t.call(this),a.command=n,a}return Le(e,[{key:"doUndo",value:function(a){a.undoAddRows(this)}},{key:"doRedo",value:function(a){a.redoAddRows(this)}}]),e}(qe),Nz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i){var o;return Ue(this,e),o=t.call(this),o.sheetId=n,o.rowMapping=a,o.oldContent=i,o}return Le(e,[{key:"doUndo",value:function(a){a.undoSetRowOrder(this)}},{key:"doRedo",value:function(a){a.redoSetRowOrder(this)}}]),e}(qe),Cz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i){var o;return Ue(this,e),o=t.call(this),o.sheetId=n,o.columnMapping=a,o.oldContent=i,o}return Le(e,[{key:"doUndo",value:function(a){a.undoSetColumnOrder(this)}},{key:"doRedo",value:function(a){a.redoSetColumnOrder(this)}}]),e}(qe),_z=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i){var o;return Ue(this,e),o=t.call(this),o.sheetId=n,o.oldSheetContent=a,o.newSheetContent=i,o}return Le(e,[{key:"doUndo",value:function(a){a.undoSetSheetContent(this)}},{key:"doRedo",value:function(a){a.redoSetSheetContent(this)}}]),e}(qe),Iz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o,u){var s;return Ue(this,e),s=t.call(this),s.sheet=n,s.startRow=a,s.numberOfRows=i,s.targetRow=o,s.version=u,s.undoStart=s.startRow<s.targetRow?s.targetRow-s.numberOfRows:s.targetRow,s.undoEnd=s.startRow>s.targetRow?s.startRow+s.numberOfRows:s.startRow,s}return Le(e,[{key:"doUndo",value:function(a){a.undoMoveRows(this)}},{key:"doRedo",value:function(a){a.redoMoveRows(this)}}]),e}(qe),Mz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o,u){var s;return Ue(this,e),s=t.call(this),s.sheet=n,s.startColumn=a,s.numberOfColumns=i,s.targetColumn=o,s.version=u,s.undoStart=s.startColumn<s.targetColumn?s.targetColumn-s.numberOfColumns:s.targetColumn,s.undoEnd=s.startColumn>s.targetColumn?s.startColumn+s.numberOfColumns:s.startColumn,s}return Le(e,[{key:"doUndo",value:function(a){a.undoMoveColumns(this)}},{key:"doRedo",value:function(a){a.redoMoveColumns(this)}}]),e}(qe),kz=function(r){Ke(e,r);var t=Xe(e);function e(n){var a;return Ue(this,e),a=t.call(this),a.command=n,a}return Le(e,[{key:"doUndo",value:function(a){a.undoAddColumns(this)}},{key:"doRedo",value:function(a){a.redoAddColumns(this)}}]),e}(qe),Fz=function(r){Ke(e,r);var t=Xe(e);function e(n,a){var i;return Ue(this,e),i=t.call(this),i.command=n,i.columnsRemovals=a,i}return Le(e,[{key:"doUndo",value:function(a){a.undoRemoveColumns(this)}},{key:"doRedo",value:function(a){a.redoRemoveColumns(this)}}]),e}(qe),Pz=function(r){Ke(e,r);var t=Xe(e);function e(n){var a;return Ue(this,e),a=t.call(this),a.sheetName=n,a}return Le(e,[{key:"doUndo",value:function(a){a.undoAddSheet(this)}},{key:"doRedo",value:function(a){a.redoAddSheet(this)}}]),e}(qe),$z=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o,u){var s;return Ue(this,e),s=t.call(this),s.sheetName=n,s.sheetId=a,s.oldSheetContent=i,s.scopedNamedExpressions=o,s.version=u,s}return Le(e,[{key:"doUndo",value:function(a){a.undoRemoveSheet(this)}},{key:"doRedo",value:function(a){a.redoRemoveSheet(this)}}]),e}(qe),Dz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i){var o;return Ue(this,e),o=t.call(this),o.sheetId=n,o.oldName=a,o.newName=i,o}return Le(e,[{key:"doUndo",value:function(a){a.undoRenameSheet(this)}},{key:"doRedo",value:function(a){a.redoRenameSheet(this)}}]),e}(qe),Lz=function(r){Ke(e,r);var t=Xe(e);function e(n,a){var i;return Ue(this,e),i=t.call(this),i.sheetId=n,i.oldSheetContent=a,i}return Le(e,[{key:"doUndo",value:function(a){a.undoClearSheet(this)}},{key:"doRedo",value:function(a){a.redoClearSheet(this)}}]),e}(qe),Uz=function(r){Ke(e,r);var t=Xe(e);function e(n){var a;return Ue(this,e),a=t.call(this),a.cellContents=n,a}return Le(e,[{key:"doUndo",value:function(a){a.undoSetCellContents(this)}},{key:"doRedo",value:function(a){a.redoSetCellContents(this)}}]),e}(qe),xz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o){var u;return Ue(this,e),u=t.call(this),u.targetLeftCorner=n,u.oldContent=a,u.newContent=i,u.addedGlobalNamedExpressions=o,u}return Le(e,[{key:"doUndo",value:function(a){a.undoPaste(this)}},{key:"doRedo",value:function(a){a.redoPaste(this)}}]),e}(qe),Bz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o){var u;return Ue(this,e),u=t.call(this),u.name=n,u.newContent=a,u.scope=i,u.options=o,u}return Le(e,[{key:"doUndo",value:function(a){a.undoAddNamedExpression(this)}},{key:"doRedo",value:function(a){a.redoAddNamedExpression(this)}}]),e}(qe),Vz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i){var o;return Ue(this,e),o=t.call(this),o.namedExpression=n,o.content=a,o.scope=i,o}return Le(e,[{key:"doUndo",value:function(a){a.undoRemoveNamedExpression(this)}},{key:"doRedo",value:function(a){a.redoRemoveNamedExpression(this)}}]),e}(qe),Gz=function(r){Ke(e,r);var t=Xe(e);function e(n,a,i,o,u){var s;return Ue(this,e),s=t.call(this),s.namedExpression=n,s.newContent=a,s.oldContent=i,s.scope=o,s.options=u,s}return Le(e,[{key:"doUndo",value:function(a){a.undoChangeNamedExpression(this)}},{key:"doRedo",value:function(a){a.redoChangeNamedExpression(this)}}]),e}(qe),jz=function(r){Ke(e,r);var t=Xe(e);function e(){var n;return Ue(this,e),n=t.apply(this,arguments),n.operations=[],n}return Le(e,[{key:"add",value:function(a){this.operations.push(a)}},{key:"reversedOperations",value:regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:a=this.operations.length-1;case 1:if(!(a>=0)){o.next=7;break}return o.next=4,this.operations[a];case 4:a--,o.next=1;break;case 7:case"end":return o.stop()}},n,this)})},{key:"doUndo",value:function(a){a.undoBatch(this)}},{key:"doRedo",value:function(a){a.redoBatch(this)}}]),e}(qe),Hz=function(){function r(t,e){Ue(this,r),this.operations=e,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=t.undoLimit}return Le(r,[{key:"saveOperation",value:function(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new jz}},{key:"commitBatchMode",value:function(){if(this.batchUndoEntry===void 0)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,n,a){this.oldData.has(e)||this.oldData.set(e,[]);var i=this.oldData.get(e);i.push([n,a])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return this.undoStack.length===0}},{key:"isRedoStackEmpty",value:function(){return this.redoStack.length===0}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoBatch",value:function(e){var n=dr(e.reversedOperations()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.undoEntry(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var n=e.command.sheet,a=e.rowsRemovals,i=a.length-1;i>=0;--i){var o=a[i];this.operations.addRows(new k8(n,[[o.rowFrom,o.rowCount]]));var u=dr(o.removedCells),s;try{for(u.s();!(s=u.n()).done;){var l=s.value,f=l.address,c=l.cellType;this.operations.restoreCell(f,c)}}catch(h){u.e(h)}finally{u.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var n=e.command.sheet,a=e.columnsRemovals,i=a.length-1;i>=0;--i){var o=a[i];this.operations.addColumns(new F8(n,[[o.columnFrom,o.columnCount]]));var u=dr(o.removedCells),s;try{for(u.s();!(s=u.n()).done;){var l=s.value,f=l.address,c=l.cellType;this.operations.restoreCell(f,c)}}catch(h){u.e(h)}finally{u.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoAddRows",value:function(e){for(var n=e.command.rowsSpans(),a=n.length-1;a>=0;--a){var i=n[a];this.operations.removeRows(new M8(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var n=e.command.columnsSpans(),a=n.length-1;a>=0;--a){var i=n[a];this.operations.removeColumns(new P8(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var n=dr(e.cellContents),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i.address,u=Ms(i.oldContent,2),s=u[0],l=u[1];ro(o,s)||this.operations.setCellEmpty(o),this.operations.restoreCell(s,l)}}catch(f){n.e(f)}finally{n.f()}}},{key:"undoPaste",value:function(e){this.restoreOperationOldContent(e.oldContent);var n=dr(e.addedGlobalNamedExpressions),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.operations.removeNamedExpression(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"undoMoveRows",value:function(e){var n=e.sheet;this.operations.moveRows(n,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var n=e.sheet;this.operations.moveColumns(n,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);var n=dr(e.addedGlobalNamedExpressions),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.operations.removeNamedExpression(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"undoAddSheet",value:function(e){var n=e.sheetName;this.operations.removeSheetByName(n)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var n=e.oldSheetContent,a=e.sheetId;this.operations.addSheet(e.sheetName);for(var i=0;i<n.length;i++)for(var o=n[i],u=0;u<o.length;u++){var s=o[u],l=P(a,u,i);this.operations.restoreCell(l,s)}var f=dr(e.scopedNamedExpressions),c;try{for(f.s();!(c=f.n()).done;){var h=Ms(c.value,2),p=h[0],y=h[1];this.operations.restoreNamedExpression(p,y,a)}}catch(v){f.e(v)}finally{f.f()}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var n=e.oldSheetContent,a=e.sheetId,i=0;i<n.length;i++)for(var o=n[i],u=0;u<o.length;u++){var s=o[u],l=P(a,u,i);this.operations.restoreCell(l,s)}}},{key:"undoSetSheetContent",value:function(e){var n=e.oldSheetContent,a=e.sheetId;this.operations.clearSheet(a);for(var i=0;i<n.length;i++)for(var o=n[i],u=0;u<o.length;u++){var s=o[u],l=P(a,u,i);this.operations.restoreCell(l,s)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"undoSetRowOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"undoSetColumnOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoBatch",value:function(e){var n=dr(e.operations),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.redoEntry(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var n=e.targetLeftCorner,a=e.newContent,i=a.length,o=a[0].length,u=0;u<i;++u)for(var s=0;s<o;++s){var l=P(n.sheet,n.col+s,n.row+u);this.operations.restoreCell(l,a[u][s])}}},{key:"redoSetCellContents",value:function(e){var n=dr(e.cellContents),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.operations.setCellContent(i.address,i.newContent)}}catch(o){n.e(o)}finally{n.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheetByName(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var n=e.sheetId,a=e.newSheetContent;this.operations.setSheetContent(n,a)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"redoSetRowOrder",value:function(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}},{key:"redoSetColumnOrder",value:function(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"undoEntry",value:function(e){e.doUndo(this)}},{key:"restoreOperationOldContent",value:function(e){var n=dr(e),a;try{for(n.s();!(a=n.n()).done;){var i=Ms(a.value,2),o=i[0],u=i[1];this.operations.restoreCell(o,u)}}catch(s){n.e(s)}finally{n.f()}}},{key:"redoEntry",value:function(e){e.doRedo(this)}},{key:"restoreOldDataFromVersion",value:function(e){var n=this.oldData.get(e)||[],a=dr(n),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=Ms(o,2),s=u[0],l=u[1];this.operations.setFormulaToCellFromCache(l,s)}}catch(f){a.e(f)}finally{a.f()}}}]),r}();function Or(r,t){return Yz(r)||zz(r,t)||U8(r,t)||Wz()}function Wz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zz(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function Yz(r){if(Array.isArray(r))return r}function n2(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=U8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function U8(r,t){if(!!r){if(typeof r=="string")return x8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return x8(r,t)}}function x8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function Kz(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function B8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Xz(r,t,e){return t&&B8(r.prototype,t),e&&B8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var qz=function(){function r(t,e,n,a,i,o,u,s,l,f){Kz(this,r),this.operations=e,this.undoRedo=n,this.clipboardOperations=a,this.dependencyGraph=i,this.columnSearch=o,this.parser=u,this.cellContentParser=s,this.lazilyTransformingAstService=l,this.namedExpressions=f,this.maxRows=t.maxRows,this.maxColumns=t.maxColumns}return Xz(r,[{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addRows",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=new k8(e,a);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(a)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(o),this.undoRedo.saveOperation(new wz(o))}},{key:"removeRows",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=new M8(e,a);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(a)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var u=this.operations.removeRows(o);this.undoRedo.saveOperation(new Tz(o,u))}},{key:"addColumns",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=new F8(e,a);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(a)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(o),this.undoRedo.saveOperation(new kz(o))}},{key:"removeColumns",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=new P8(e,a);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(a)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var u=this.operations.removeColumns(o);this.undoRedo.saveOperation(new Fz(o,u))}},{key:"moveCells",value:function(e,n,a,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveCells(e,n,a,i),u=o.version,s=o.overwrittenCellsData,l=o.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new Oz(e,n,a,i,s,l,u))}},{key:"moveRows",value:function(e,n,a,i){this.ensureItIsPossibleToMoveRows(e,n,a,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveRows(e,n,a,i);this.undoRedo.saveOperation(new Iz(e,n,a,i,o))}},{key:"moveColumns",value:function(e,n,a,i){this.ensureItIsPossibleToMoveColumns(e,n,a,i),this.undoRedo.clearRedoStack();var o=this.operations.moveColumns(e,n,a,i);this.undoRedo.saveOperation(new Mz(e,n,a,i,o))}},{key:"cut",value:function(e,n,a){this.clipboardOperations.cut(e,n,a)}},{key:"ensureItIsPossibleToCopy",value:function(e,n,a){if(!Ua(n))throw new Ye("width to be positive integer.");if(!Ua(a))throw new Ye("height to be positive integer.")}},{key:"copy",value:function(e,n,a){this.ensureItIsPossibleToCopy(e,n,a),this.clipboardOperations.copy(e,n,a)}},{key:"paste",value:function(e){var n=this.clipboardOperations.clipboard;if(n===void 0)throw new Vy;if(this.clipboardOperations.isCutClipboard())this.moveCells(n.sourceLeftCorner,n.width,n.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var a=Y.spanFrom(e,n.width,n.height),i=this.operations.getRangeClipboardCells(a);this.undoRedo.clearRedoStack();var o=this.operations.restoreClipboardCells(n.sourceLeftCorner.sheet,n.getContent(e));this.undoRedo.saveOperation(new xz(e,i,n.content,o))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return this.clipboardOperations.clipboard===void 0}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var n=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Pz(n)),n}},{key:"removeSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.sheetMapping.fetchDisplayName(e),a=this.operations.getSheetClipboardCells(e),i=this.operations.removeSheet(e),o=i.version,u=i.scopedNamedExpressions;this.undoRedo.saveOperation(new $z(n,e,a,u,o))}},{key:"renameSheet",value:function(e,n){this.ensureItIsPossibleToRenameSheet(e,n);var a=this.operations.renameSheet(e,n);return a!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Dz(e,a,n))),a}},{key:"clearSheet",value:function(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Lz(e,n))}},{key:"setCellContents",value:function(e,n){if(!(n instanceof Array))n=[[n]];else for(var a=0;a<n.length;a++)if(!(n[a]instanceof Array))throw new Ye("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,n),this.undoRedo.clearRedoStack();for(var i=[],o=0;o<n.length;o++)for(var u=0;u<n[o].length;u++){var s={sheet:e.sheet,row:e.row+o,col:e.col+u},l=n[o][u];this.clipboardOperations.abortCut();var f=this.operations.setCellContent(s,l);i.push({address:s,newContent:l,oldContent:f})}this.undoRedo.saveOperation(new Uz(i))}},{key:"setSheetContent",value:function(e,n){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,n),_8(n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,n),this.undoRedo.saveOperation(new _z(e,a,n))}},{key:"setRowOrder",value:function(e,n){this.validateSwapRowIndexes(e,n),this.testRowOrderForArrays(e,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.setRowOrder(e,n);this.undoRedo.saveOperation(new Nz(e,n,a))}},{key:"validateSwapRowIndexes",value:function(e,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);this.validateRowOrColumnMapping(e,n,"row")}},{key:"testColumnOrderForArrays",value:function(e,n){var a=n2(n),i;try{for(a.s();!(i=a.n()).done;){var o=Or(i.value,2),u=o[0],s=o[1];if(u!==s){var l=Y.spanFrom({sheet:e,col:u,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new pa}}}catch(f){a.e(f)}finally{a.f()}}},{key:"setColumnOrder",value:function(e,n){this.validateSwapColumnIndexes(e,n),this.testColumnOrderForArrays(e,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.setColumnOrder(e,n);this.undoRedo.saveOperation(new Cz(e,n,a))}},{key:"validateSwapColumnIndexes",value:function(e,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);this.validateRowOrColumnMapping(e,n,"column")}},{key:"testRowOrderForArrays",value:function(e,n){var a=n2(n),i;try{for(a.s();!(i=a.n()).done;){var o=Or(i.value,2),u=o[0],s=o[1];if(u!==s){var l=Y.spanFrom({sheet:e,col:0,row:u},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new pa}}}catch(f){a.e(f)}finally{a.f()}}},{key:"mappingFromOrder",value:function(e,n,a){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);var i=a==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(n.length!==i)throw new Ye("number of ".concat(a,"s provided to be sheet ").concat(a==="row"?"height":"width","."));for(var o=[],u=0;u<i;u++)n[u]!==u&&o.push([u,n[u]]);return o}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new xy;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new By;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,n,a,i){this.ensureItIsPossibleToAddNamedExpression(e,n,a),this.operations.addNamedExpression(e,n,a,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Bz(e,n,a,i))}},{key:"changeNamedExpressionExpression",value:function(e,n,a,i){this.ensureItIsPossibleToChangeNamedExpression(e,a,n);var o=this.operations.changeNamedExpressionExpression(e,a,n,i),u=Or(o,2),s=u[0],l=u[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Gz(s,a,l,n,i))}},{key:"removeNamedExpression",value:function(e,n){this.ensureScopeIdIsValid(n);var a=this.operations.removeNamedExpression(e,n),i=Or(a,2),o=i[0],u=i[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Vz(o,u,n)),o}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,n,a){this.ensureScopeIdIsValid(a),this.ensureNamedExpressionNameIsValid(e,a),this.ensureNamedExpressionIsValid(n)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,n,a){if(this.ensureScopeIdIsValid(a),this.namedExpressions.namedExpressionForScope(e,a)===void 0)throw new Ii(e);this.ensureNamedExpressionIsValid(n)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Ii(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);for(var n=this.dependencyGraph.getSheetHeight(e),a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];var u=i.map(function(p){return p[1]}).reduce(function(p,y){return p+y},0);if(n+u>this.maxRows)throw new $n;for(var s=0,l=i;s<l.length;s++){var f=Or(l[s],2),c=f[0],h=f[1];if(!zn(c)||!Ua(h))throw new Ye("row number to be nonnegative and number of rows to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];for(var o=0,u=a;o<u.length;o++){var s=Or(u[o],2),l=s[0],f=s[1],c=l+f-1;if(!zn(l)||!zn(c))throw new Ye("starting and ending row to be nonnegative.");if(c<l)throw new Ye("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e)}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);for(var n=this.dependencyGraph.getSheetWidth(e),a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];var u=i.map(function(p){return p[1]}).reduce(function(p,y){return p+y},0);if(n+u>this.maxColumns)throw new $n;for(var s=0,l=i;s<l.length;s++){var f=Or(l[s],2),c=f[0],h=f[1];if(!zn(c)||!Ua(h))throw new Ye("column number to be nonnegative and number of columns to add to be positive.")}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];for(var o=0,u=a;o<u.length;o++){var s=Or(u[o],2),l=s[0],f=s[1],c=l+f-1;if(!zn(l)||!zn(c))throw new Ye("starting and ending column to be nonnegative.");if(c<l)throw new Ye("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e)}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,n,a,i){this.ensureItIsPossibleToAddRows(e,[i,a]);var o=P(e,0,n),u=P(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Ft(o)||Ft(u)||!Ua(a)||i<=n+a&&i>=n)throw new Ye("a valid range of rows to move.");var s=this.dependencyGraph.getSheetWidth(e),l=Y.spanFrom(o,s,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new pa;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(xr.fromNumberOfRows(e,i-1,2)))throw new su}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,n,a,i){this.ensureItIsPossibleToAddColumns(e,[i,a]);var o=P(e,n,0),u=P(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Ft(o)||Ft(u)||!Ua(a)||i<=n+a&&i>=n)throw new Ye("a valid range of columns to move.");var s=this.dependencyGraph.getSheetHeight(e),l=Y.spanFrom(o,a,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new pa;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(vn.fromNumberOfColumns(e,i-1,2)))throw new su}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new _i(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Me(e);var a=this.sheetMapping.get(n);if(a!==void 0&&a!==e)throw new _i(n)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if(Ft(e))throw new Dy(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Me(e.sheet)}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,n){var a=ws(n),i=Y.spanFrom(e,a.width,a.height);this.ensureRangeInSizeLimits(i);var o=n2(i.addresses(this.dependencyGraph)),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;this.ensureItIsPossibleToChangeContent(s)}}catch(l){o.e(l)}finally{o.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,n){var a=ws(n),i=Y.spanFrom(P(e,0,0),a.width,a.height);this.ensureRangeInSizeLimits(i)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new $n}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureScopeIdIsValid",value:function(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new Me(e)}},{key:"validateRowOrColumnMapping",value:function(e,n,a){for(var i=a==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=n.map(function(l){var f=Or(l,2),c=f[0];return f[1],c}).sort(function(l,f){return l-f}),u=n.map(function(l){var f=Or(l,2);f[0];var c=f[1];return c}).sort(function(l,f){return l-f}),s=0;s<o.length;s++){if(!zn(o[s])||o[s]>=i)throw new Ye("".concat(a," numbers to be nonnegative integers and less than sheet ").concat(a==="row"?"height":"width","."));if(o[s]===o[s+1])throw new Ye("source ".concat(a," numbers to be unique."));if(o[s]!==u[s])throw new Ye("target ".concat(a," numbers to be permutation of source ").concat(a," numbers."))}}},{key:"ensureNamedExpressionNameIsValid",value:function(e,n){if(!this.namedExpressions.isNameValid(e))throw new Uy(e);if(!this.namedExpressions.isNameAvailable(e,n))throw new Ly(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var n=this.cellContentParser.parse(e);if(n instanceof _e.Formula){var a=this.parser.parse(n.formula,P(-1,0,0));if(h8(a.ast))throw new Hc}}}]),r}();function Ua(r){return Number.isInteger(r)&&r>0}function zn(r){return Number.isInteger(r)&&r>=0}function Qz(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Zz(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Zz(r,t){if(!!r){if(typeof r=="string")return V8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return V8(r,t)}}function V8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function Jz(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function G8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function eY(r,t,e){return t&&G8(r.prototype,t),e&&G8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var tY=function(){function r(t,e,n,a,i,o){Jz(this,r),this.config=t,this.stats=e,this.interpreter=n,this.lazilyTransformingAstService=a,this.dependencyGraph=i,this.columnSearch=o}return eY(r,[{key:"run",value:function(){var e=this;this.stats.start(X.TOP_SORT);var n=this.dependencyGraph.topSortWithScc(),a=n.sorted,i=n.cycled;this.stats.end(X.TOP_SORT),this.stats.measure(X.EVALUATION,function(){e.recomputeFormulas(i,a)})}},{key:"partialRun",value:function(e){var n=this,a=_a.empty();return this.stats.measure(X.EVALUATION,function(){n.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,function(i){if(i instanceof jt){var o=i.isComputed()?i.getCellValue():void 0,u=n.recomputeFormulaVertexValue(i);if(u!==o){var s=i.getAddress(n.lazilyTransformingAstService);return a.addChange(u,s),n.columnSearch.change(F(o),F(u),s),!0}return!1}else return i instanceof Et&&i.clearCache(),!0},function(i){if(i instanceof Et)i.clearCache();else if(i instanceof jt){var o=i.getAddress(n.lazilyTransformingAstService);n.columnSearch.remove(F(i.valueOrUndef()),o);var u=new m(E.CYCLE,void 0,i);i.setCellValue(u),a.addChange(u,o)}})}),a}},{key:"runAndForget",value:function(e,n,a){var i=this,o=[],u=Qz(br(a,n)),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l instanceof Y){var f=l;if(this.dependencyGraph.getRange(f.start,f.end)===void 0){var c=new Et(f);this.dependencyGraph.rangeMapping.setRange(c),o.push(c)}}}}catch(p){u.e(p)}finally{u.f()}var h=this.evaluateAstToCellValue(e,new Sr(n,this.config.useArrayArithmetic));return o.forEach(function(p){i.dependencyGraph.rangeMapping.removeRange(p)}),h}},{key:"recomputeFormulas",value:function(e,n){var a=this;e.forEach(function(i){i instanceof jt&&i.setCellValue(new m(E.CYCLE,void 0,i))}),n.forEach(function(i){if(i instanceof jt){var o=a.recomputeFormulaVertexValue(i),u=i.getAddress(a.lazilyTransformingAstService);a.columnSearch.add(F(o),u)}else i instanceof Et&&i.clearCache()})}},{key:"recomputeFormulaVertexValue",value:function(e){var n=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Fe&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();var a=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(a,new Sr(n,this.config.useArrayArithmetic,e));return e.setCellValue(i)}},{key:"evaluateAstToCellValue",value:function(e,n){var a=this.interpreter.evaluateAst(e,n);return a instanceof V?a:a===ne&&this.config.evaluateNullToZero?0:a}}]),r}(),rY=Math.log,nY=Math.LOG10E,aY=Math.log10||function(t){return rY(t)*nY},iY=z,oY=aY;iY({target:"Math",stat:!0},{log10:oY});function uY(r,t){return fY(r)||lY(r,t)||j8(r,t)||sY()}function sY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lY(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function fY(r){if(Array.isArray(r))return r}function cY(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=j8(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function j8(r,t){if(!!r){if(typeof r=="string")return H8(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return H8(r,t)}}function H8(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function a2(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function W8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function i2(r,t,e){return t&&W8(r.prototype,t),e&&W8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var o2=function(){function r(t,e){a2(this,r),this.address=t,this.newValue=e}return i2(r,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),r}(),z8=i2(function r(t,e){a2(this,r),this.name=t,this.newValue=e}),hY=function(){function r(t,e,n,a){a2(this,r),this.config=t,this.namedExpressions=e,this.sheetIndexMapping=n,this.lazilyTransformingService=a}return i2(r,[{key:"exportChange",value:function(e){var n=e.value,a=e.address;if(a.sheet===gs.SHEET_FOR_WORKBOOK_EXPRESSIONS){var i=this.namedExpressions.namedExpressionInAddress(a.row);if(!i)throw new Error("Missing named expression");return new z8(i.displayName,this.exportScalarOrRange(n))}else if(n instanceof V){var o=[],u=cY(n.entriesFromTopLeftCorner(a)),s;try{for(u.s();!(s=u.n()).done;){var l=uY(s.value,2),f=l[0],c=l[1];o.push(new o2(c,this.exportValue(f)))}}catch(h){u.e(h)}finally{u.f()}return o}else return new o2(a,this.exportValue(n))}},{key:"exportValue",value:function(e){return e instanceof V?this.detailedError(new m(E.VALUE,S.ScalarExpected)):this.config.smartRounding&&de(e)?this.cellValueRounding(F(e)):e instanceof m?this.detailedError(e):e===ne?null:F(e)}},{key:"exportScalarOrRange",value:function(e){var n=this;return e instanceof V?e.rawData().map(function(a){return a.map(function(i){return n.exportValue(i)})}):this.exportValue(e)}},{key:"detailedError",value:function(e){var n,a,i=void 0,o=(n=e.root)===null||n===void 0?void 0:n.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===gs.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(a=this.namedExpressions.namedExpressionInAddress(o.row))===null||a===void 0?void 0:a.displayName:i=xu(this.sheetIndexMapping,o,-1)),new u4(e,this.config.translationPackage.getErrorTranslation(e.type),i)}},{key:"cellValueRounding",value:function(e){if(e===0)return e;var n=Math.floor(Math.log10(Math.abs(e))),a=Math.pow(10,this.config.precisionRounding-n);return e<0?-Math.round(-e*a)/a:Math.round(e*a)/a}}]),r}();function Y8(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function K8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function X8(r,t,e){return t&&K8(r.prototype,t),e&&K8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var pY=function(){function r(t,e,n,a,i,o){Y8(this,r),this.dependencyGraph=t,this.columnSearch=e,this.parser=n,this.cellContentParser=a,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new dY(t,e,n,i,a,o)}return X8(r,[{key:"buildGraph",value:function(e,n){var a=this,i=n.measure(X.COLLECT_DEPENDENCIES,function(){return a.buildStrategy.run(e)});this.dependencyGraph.getAndClearContentChanges(),n.measure(X.PROCESS_DEPENDENCIES,function(){return a.processDependencies(i)})}},{key:"processDependencies",value:function(e){var n=this;e.forEach(function(a,i){n.dependencyGraph.processCellDependencies(a,i)})}}]),r}(),dY=function(){function r(t,e,n,a,i,o){Y8(this,r),this.dependencyGraph=t,this.columnIndex=e,this.parser=n,this.stats=a,this.cellContentParser=i,this.arraySizePredictor=o}return X8(r,[{key:"run",value:function(e){var n=this,a=new Map;for(var i in e)for(var o=this.dependencyGraph.getSheetId(i),u=e[i],s=0;s<u.length;++s)for(var l=u[s],f=function(p){var y=l[p],v=P(o,p,s),R=n.cellContentParser.parse(y);if(R instanceof _e.Formula){var g=n.stats.measure(X.PARSER,function(){return n.parser.parse(R.formula,v)});if(g.errors.length>0){n.shrinkArrayIfNeeded(v);var A=new Ma(g.errors,R.formula);n.dependencyGraph.addVertex(v,A)}else{n.shrinkArrayIfNeeded(v);var T=n.arraySizePredictor.checkArraySize(g.ast,v);if(T.isScalar()){var N=new Vr(g.ast,v,0);a.set(N,br(g.dependencies,v)),n.dependencyGraph.addVertex(v,N),g.hasVolatileFunction&&n.dependencyGraph.markAsVolatile(N),g.hasStructuralChangeFunction&&n.dependencyGraph.markAsDependentOnStructureChange(N)}else{var M=new Fe(g.ast,v,new ue(T.width,T.height));a.set(M,br(g.dependencies,v)),n.dependencyGraph.addArrayVertex(v,M)}}}else if(!(R instanceof _e.Empty)){n.shrinkArrayIfNeeded(v);var _=new mn(R.value,y);n.columnIndex.add(F(R.value),v),n.dependencyGraph.addVertex(v,_)}},c=0;c<l.length;++c)f(c);return a}},{key:"shrinkArrayIfNeeded",value:function(e){var n=this.dependencyGraph.getCell(e);n instanceof Fe&&this.dependencyGraph.shrinkArrayToCorner(n)}}]),r}(),vY=z,yY=In.find,mY=Si,u2="find",q8=!0;u2 in[]&&Array(1)[u2](function(){q8=!1});vY({target:"Array",proto:!0,forced:q8},{find:function(t){return yY(this,t,arguments.length>1?arguments[1]:void 0)}});mY(u2);function s2(r){return s2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s2(r)}function gY(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Q8(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function EY(r,t,e){return t&&Q8(r.prototype,t),e&&Q8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function RY(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&l2(r,t)}function l2(r,t){return l2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},l2(r,t)}function bY(r){var t=TY();return function(){var n=Fs(r),a;if(t){var i=Fs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return SY(this,a)}}function SY(r,t){if(t&&(s2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AY(r)}function AY(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function TY(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(r){return Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fs(r)}var Ps=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]),Z8=function(r){RY(e,r);var t=bY(e);function e(){return gY(this,e),t.apply(this,arguments)}return EY(e,[{key:"version",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("VERSION"),function(){var u=o.config,s=u.licenseKeyValidityState,l=u.licenseKey,f;return Ps.has(l)?f=Ps.get(l):Ps.has(s)?f=Ps.get(s):s==="valid"&&(f=l.slice(-5)),"HyperFormula v".concat(Dt.version,", ").concat(f)})}}]),e}(ee);Z8.implementedFunctions={VERSION:{method:"version",parameters:[]}};function J8(r){return NY(r)||wY(r)||f2(r)||OY()}function OY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wY(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function NY(r){if(Array.isArray(r))return c2(r)}function Hr(r,t){return IY(r)||_Y(r,t)||f2(r,t)||CY()}function CY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Y(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function IY(r){if(Array.isArray(r))return r}function Wr(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=f2(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function f2(r,t){if(!!r){if(typeof r=="string")return c2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c2(r,t)}}function c2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function MY(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function e3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function kY(r,t,e){return t&&e3(r.prototype,t),e&&e3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function h2(r,t){var e,n=t.implementedFunctions[r],a=(e=t.aliases)===null||e===void 0?void 0:e[r];if(a!==void 0){if(n!==void 0)throw new dF(r,t.name);n=t.implementedFunctions[a]}if(n===void 0)throw Gc.functionNotDeclaredInPlugin(r,t.name);return n}var Jt=function(){function r(t){var e=this;if(MY(this,r),this.config=t,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=function(R){return e.functionsWhichDoesNotNeedArgumentsToBeComputed.has(R)},this.isFunctionVolatile=function(R){return e.volatileFunctions.has(R)},this.isArrayFunction=function(R){return e.arrayFunctions.has(R)},this.isFunctionDependentOnSheetStructureChange=function(R){return e.structuralChangeFunctions.has(R)},t.functionPlugins.length>0){this.instancePlugins=new Map;var n=Wr(t.functionPlugins),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.loadPluginFunctions(i,this.instancePlugins)}}catch(R){n.e(R)}finally{n.f()}}else this.instancePlugins=new Map(r.plugins);var o=Wr(r.protectedFunctions()),u;try{for(o.s();!(u=o.n()).done;){var s=Hr(u.value,2),l=s[0],f=s[1];r.loadFunctionUnprotected(f,l,this.instancePlugins)}}catch(R){o.e(R)}finally{o.f()}var c=Wr(this.instancePlugins.entries()),h;try{for(c.s();!(h=c.n()).done;){var p=Hr(h.value,2),y=p[0],v=p[1];this.categorizeFunction(y,h2(y,v))}}catch(R){c.e(R)}finally{c.f()}}return kY(r,[{key:"initializePlugins",value:function(e){var n=this,a=[],i=Wr(this.instancePlugins.entries()),o;try{var u=function(){var l=Hr(o.value,2),f=l[0],c=l[1],h=a.find(function(R){return R instanceof c});h===void 0&&(h=new c(e),a.push(h));var p=h2(f,c),y=p.method;n.functions.set(f,[y,h]);var v=p.arraySizeMethod;v!==void 0&&n.arraySizeFunctions.set(f,[v,h])};for(i.s();!(o=i.n()).done;)u()}catch(s){i.e(s)}finally{i.f()}}},{key:"getFunctionPlugin",value:function(e){if(!r.functionIsProtected(e))return this.instancePlugins.get(e)}},{key:"getFunction",value:function(e){var n=this.functions.get(e);if(n!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){var a=Hr(n,2),i=a[0],o=a[1];return function(u,s){return o[i](u,s)}}else return}},{key:"getArraySizeFunction",value:function(e){var n=this.arraySizeFunctions.get(e);if(n!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){var a=Hr(n,2),i=a[0],o=a[1];return function(u,s){return o[i](u,s)}}else return}},{key:"getMetadata",value:function(e){return this.functionsMetadata.get(e)}},{key:"getPlugins",value:function(){var e=new Set,n=Wr(this.instancePlugins),a;try{for(n.s();!(a=n.n()).done;){var i=Hr(a.value,2),o=i[0],u=i[1];r.functionIsProtected(o)||e.add(u)}}catch(s){n.e(s)}finally{n.f()}return Array.from(e)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,n){n.isVolatile&&this.volatileFunctions.add(e),n.arrayFunction&&this.arrayFunctions.add(e),n.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),n.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,n)}}],[{key:"registerFunctionPlugin",value:function(e,n){this.loadPluginFunctions(e,this.plugins),n!==void 0&&this.loadTranslations(n)}},{key:"registerFunction",value:function(e,n,a){this.loadPluginFunction(n,e,this.plugins),a!==void 0&&this.loadTranslations(a)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw jc.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var n=Wr(this.protectedPlugins()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i===e)throw jc.cannotUnregisterProtectedPlugin()}}catch(c){n.e(c)}finally{n.f()}var o=Wr(this.plugins.entries()),u;try{for(o.s();!(u=o.n()).done;){var s=Hr(u.value,2),l=s[0],f=s[1];f===e&&this.plugins.delete(l)}}catch(c){o.e(c)}finally{o.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(J8(Array.from(this.plugins.keys())),J8(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"loadTranslations",value:function(e){var n=new Set(Dt.getRegisteredLanguagesCodes());Object.keys(e).forEach(function(a){n.has(a)&&Dt.getLanguage(a).extendFunctions(e[a])})}},{key:"loadPluginFunctions",value:function(e,n){var a=this;Object.keys(e.implementedFunctions).forEach(function(i){a.loadPluginFunction(e,i,n)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(function(i){a.loadPluginFunction(e,i,n)})}},{key:"loadPluginFunction",value:function(e,n,a){if(this.functionIsProtected(n))throw jc.cannotRegisterFunctionWithId(n);this.loadFunctionUnprotected(e,n,a)}},{key:"loadFunctionUnprotected",value:function(e,n,a){var i=h2(n,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))a.set(n,e);else throw Gc.functionMethodNotFound(i,e.name)}},{key:"protectedFunctions",value:regeneratorRuntime.mark(function t(){var e,n,a,i,o;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=Wr(this._protectedPlugins),s.prev=1,e.s();case 3:if((n=e.n()).done){s.next=10;break}if(a=Hr(n.value,2),i=a[0],o=a[1],o===void 0){s.next=8;break}return s.next=8,[i,o];case 8:s.next=3;break;case 10:s.next=15;break;case 12:s.prev=12,s.t0=s.catch(1),e.e(s.t0);case 15:return s.prev=15,e.f(),s.finish(15);case 18:case"end":return s.stop()}},t,this,[[1,12,15,18]])})},{key:"protectedPlugins",value:regeneratorRuntime.mark(function t(){var e,n,a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:e=Wr(this._protectedPlugins),u.prev=1,e.s();case 3:if((n=e.n()).done){u.next=10;break}if(a=Hr(n.value,2),i=a[1],i===void 0){u.next=8;break}return u.next=8,i;case 8:u.next=3;break;case 10:u.next=15;break;case 12:u.prev=12,u.t0=u.catch(1),e.e(u.t0);case 15:return u.prev=15,e.f(),u.finish(15);case 18:case"end":return u.stop()}},t,this,[[1,12,15,18]])})}]),r}();Jt.plugins=new Map;Jt._protectedPlugins=new Map([["VERSION",Z8],["OFFSET",void 0]]);function FY(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function t3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function PY(r,t,e){return t&&t3(r.prototype,t),e&&t3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var ot;(function(r){r.GREATER_THAN="GREATER_THAN",r.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",r.LESS_THAN="LESS_THAN",r.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",r.NOT_EQUAL="NOT_EQUAL",r.EQUAL="EQUAL"})(ot||(ot={}));var $s=function(t,e){return{operator:t,value:e}},$Y=function(){function r(t){FY(this,r);var e,n,a,i;this.trueString=(n=(e=t.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||e===void 0?void 0:e.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(i=(a=t.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||a===void 0?void 0:a.toLowerCase())!==null&&i!==void 0?i:"false"}return PY(r,[{key:"fromCellValue",value:function(e,n){if(!(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")){var a=this.parseCriterion(e,n);if(a!==void 0)return{raw:e,lambda:UY(a,n)}}}},{key:"parseCriterion",value:function(e,n){if(typeof e=="number"||typeof e=="boolean")return $s(ot.EQUAL,e);if(typeof e=="string"){var a=DY.exec(e),i,o;a?(o=LY(a[1]),i=a[2]):(o=ot.EQUAL,i=e);var u=n.coerceToMaybeNumber(i),s=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(i==="")return $s(o,null);if(u===void 0){if(o===ot.EQUAL||o===ot.NOT_EQUAL)return $s(o,s!=null?s:i)}else return $s(o,F(u))}}}]),r}(),DY=/([<>=]+)(.*)/;function LY(r){switch(r){case">":return ot.GREATER_THAN;case">=":return ot.GREATER_THAN_OR_EQUAL;case"<":return ot.LESS_THAN;case"<=":return ot.LESS_THAN_OR_EQUAL;case"<>":return ot.NOT_EQUAL;case"=":return ot.EQUAL;default:return}}var UY=function(t,e){switch(t.operator){case ot.GREATER_THAN:return typeof t.value=="number"?function(n){return typeof n=="number"&&e.floatCmp(n,t.value)>0}:function(n){return!1};case ot.GREATER_THAN_OR_EQUAL:return typeof t.value=="number"?function(n){return typeof n=="number"&&e.floatCmp(n,t.value)>=0}:function(n){return!1};case ot.LESS_THAN:return typeof t.value=="number"?function(n){return typeof n=="number"&&e.floatCmp(n,t.value)<0}:function(n){return!1};case ot.LESS_THAN_OR_EQUAL:return typeof t.value=="number"?function(n){return typeof n=="number"&&e.floatCmp(n,t.value)<=0}:function(n){return!1};case ot.EQUAL:return typeof t.value=="number"?function(n){if(typeof n=="number")return e.floatCmp(n,t.value)===0;if(typeof n=="string"){if(n==="")return!1;var a=e.coerceToMaybeNumber(n);return a===void 0?!1:e.floatCmp(a,t.value)===0}else return!1}:typeof t.value=="string"?e.eqMatcherFunction(t.value):typeof t.value=="boolean"?function(n){return typeof n=="boolean"&&n===t.value}:function(n){return n===ne};case ot.NOT_EQUAL:return typeof t.value=="number"?function(n){if(typeof n=="number")return e.floatCmp(n,t.value)!==0;if(typeof n=="string"){if(n==="")return!0;var a=e.coerceToMaybeNumber(n);return a===void 0?!0:e.floatCmp(a,t.value)!==0}else return!0}:typeof t.value=="string"?e.neqMatcherFunction(t.value):typeof t.value=="boolean"?function(n){return typeof n!="boolean"||n!==t.value}:function(n){return n!==ne}}};function r3(r){return VY(r)||BY(r)||p2(r)||xY()}function xY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BY(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function VY(r){if(Array.isArray(r))return d2(r)}function n3(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=p2(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function a3(r,t){return HY(r)||jY(r,t)||p2(r,t)||GY()}function GY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p2(r,t){if(!!r){if(typeof r=="string")return d2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return d2(r,t)}}function d2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function jY(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function HY(r){if(Array.isArray(r))return r}function WY(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function i3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function zY(r,t,e){return t&&i3(r.prototype,t),e&&i3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var YY=function(){function r(t,e,n,a,i,o,u,s,l,f){var c=this;WY(this,r),this.config=t,this.dependencyGraph=e,this.columnSearch=n,this.stats=a,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=u,this.serialization=s,this.arraySizePredictor=l,this.dateTimeHelper=f,this.equalOp=function(h,p){return er(c.arithmeticHelper.eq,h,p)},this.notEqualOp=function(h,p){return er(c.arithmeticHelper.neq,h,p)},this.greaterThanOp=function(h,p){return er(c.arithmeticHelper.gt,h,p)},this.lessThanOp=function(h,p){return er(c.arithmeticHelper.lt,h,p)},this.greaterThanOrEqualOp=function(h,p){return er(c.arithmeticHelper.geq,h,p)},this.lessThanOrEqualOp=function(h,p){return er(c.arithmeticHelper.leq,h,p)},this.concatOp=function(h,p){return er(c.arithmeticHelper.concat,e1(h),e1(p))},this.plusOp=function(h,p){return er(c.arithmeticHelper.addWithEpsilon,c.arithmeticHelper.coerceScalarToNumberOrError(h),c.arithmeticHelper.coerceScalarToNumberOrError(p))},this.minusOp=function(h,p){return er(c.arithmeticHelper.subtract,c.arithmeticHelper.coerceScalarToNumberOrError(h),c.arithmeticHelper.coerceScalarToNumberOrError(p))},this.timesOp=function(h,p){return er(c.arithmeticHelper.multiply,c.arithmeticHelper.coerceScalarToNumberOrError(h),c.arithmeticHelper.coerceScalarToNumberOrError(p))},this.powerOp=function(h,p){return er(c.arithmeticHelper.pow,c.arithmeticHelper.coerceScalarToNumberOrError(h),c.arithmeticHelper.coerceScalarToNumberOrError(p))},this.divOp=function(h,p){return er(c.arithmeticHelper.divide,c.arithmeticHelper.coerceScalarToNumberOrError(h),c.arithmeticHelper.coerceScalarToNumberOrError(p))},this.unaryMinusOp=function(h){return o3(c.arithmeticHelper.unaryMinus,c.arithmeticHelper.coerceScalarToNumberOrError(h))},this.percentOp=function(h){return o3(c.arithmeticHelper.unaryPercent,c.arithmeticHelper.coerceScalarToNumberOrError(h))},this.unaryPlusOp=function(h){return c.arithmeticHelper.unaryPlus(h)},this.functionRegistry.initializePlugins(this),this.criterionBuilder=new $Y(t)}return zY(r,[{key:"evaluateAst",value:function(e,n){var a=this.evaluateAstWithoutPostprocessing(e,n);if(de(a)){if(Yg(F(a)))return new m(E.NUM,S.NaN);a=zh(a,Kg(F(a)))}if(a instanceof V&&a.height()===1&&a.width()===1){var i=a3(a.data,1),o=a3(i[0],1);a=o[0]}return KY(a,n.formulaVertex)}},{key:"evaluateAstWithoutPostprocessing",value:function(e,n){switch(e.type){case b.EMPTY:return ne;case b.CELL_REFERENCE:{var a=e.reference.toSimpleCellAddress(n.formulaAddress);return Ft(a)?new m(E.REF,S.BadRef):this.dependencyGraph.getCellValue(a)}case b.NUMBER:case b.STRING:return e.value;case b.CONCATENATE_OP:{var i=this.evaluateAst(e.left,n),o=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.concatOp,i,o,n)}case b.EQUALS_OP:{var u=this.evaluateAst(e.left,n),s=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.equalOp,u,s,n)}case b.NOT_EQUAL_OP:{var l=this.evaluateAst(e.left,n),f=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.notEqualOp,l,f,n)}case b.GREATER_THAN_OP:{var c=this.evaluateAst(e.left,n),h=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.greaterThanOp,c,h,n)}case b.LESS_THAN_OP:{var p=this.evaluateAst(e.left,n),y=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.lessThanOp,p,y,n)}case b.GREATER_THAN_OR_EQUAL_OP:{var v=this.evaluateAst(e.left,n),R=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,v,R,n)}case b.LESS_THAN_OR_EQUAL_OP:{var g=this.evaluateAst(e.left,n),A=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.lessThanOrEqualOp,g,A,n)}case b.PLUS_OP:{var T=this.evaluateAst(e.left,n),N=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.plusOp,T,N,n)}case b.MINUS_OP:{var M=this.evaluateAst(e.left,n),_=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.minusOp,M,_,n)}case b.TIMES_OP:{var $=this.evaluateAst(e.left,n),x=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.timesOp,$,x,n)}case b.POWER_OP:{var D=this.evaluateAst(e.left,n),K=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.powerOp,D,K,n)}case b.DIV_OP:{var Z=this.evaluateAst(e.left,n),ie=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.divOp,Z,ie,n)}case b.PLUS_UNARY_OP:{var q=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.unaryPlusOp,q,n)}case b.MINUS_UNARY_OP:{var le=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.unaryMinusOp,le,n)}case b.PERCENT_OP:{var pe=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.percentOp,pe,n)}case b.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!Jt.functionIsProtected(e.procedureName))return new m(E.LIC,S.LicenseKey(this.config.licenseKeyValidityState));var Re=this.functionRegistry.getFunction(e.procedureName);return Re!==void 0?Re(e,new Sr(n.formulaAddress,n.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),n.formulaVertex)):new m(E.NAME,S.FunctionName(e.procedureName))}case b.NAMED_EXPRESSION:{var we=this.namedExpressions.nearestNamedExpression(e.expressionName,n.formulaAddress.sheet);return we?this.dependencyGraph.getCellValue(we.address):new m(E.NAME,S.NamedExpressionName(e.expressionName))}case b.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new m(E.REF,S.RangeManySheets);var w=Y.fromCellRange(e,n.formulaAddress),O=this.dependencyGraph.getArray(w);if(O){var C=O.array;if(C instanceof eo)throw new Error("Array should be already computed");if(C instanceof m)return C;if(C instanceof c1)return V.fromRange(C.raw(),w,this.dependencyGraph);throw new Error("Unknown array")}else return V.onlyRange(w,this.dependencyGraph)}case b.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new m(E.REF,S.RangeManySheets);var k=Hu.fromColumnRange(e,n.formulaAddress);return V.onlyRange(k,this.dependencyGraph)}case b.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new m(E.REF,S.RangeManySheets);var B=Wu.fromRowRangeAst(e,n.formulaAddress);return V.onlyRange(B,this.dependencyGraph)}case b.PARENTHESIS:return this.evaluateAst(e.expression,n);case b.ARRAY:{var ae=void 0,J=[],Ae=n3(e.args),Ce;try{for(Ae.s();!(Ce=Ae.n()).done;){var Je=Ce.value,vt=void 0,et=[],yt=n3(Je),qn;try{for(yt.s();!(qn=yt.n()).done;){var Qn=qn.value,Sn=jg(this.evaluateAst(Qn,n)),An=Sn.height();if(vt===void 0)vt=An,et.push.apply(et,r3(Sn.data));else if(vt===An)for(var qr=0;qr<An;qr++){var za;(za=et[qr]).push.apply(za,r3(Sn.data[qr]))}else return new m(E.REF,S.SizeMismatch)}}catch(_r){yt.e(_r)}finally{yt.f()}var Ya=et[0].length;if(ae===void 0)ae=Ya,J.push.apply(J,et);else if(ae===Ya)J.push.apply(J,et);else return new m(E.REF,S.SizeMismatch)}}catch(_r){Ae.e(_r)}finally{Ae.f()}return V.onlyValues(J)}case b.ERROR_WITH_RAW_INPUT:case b.ERROR:return e.error}}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}},{key:"unaryRangeWrapper",value:function(e,n,a){var i;if(n instanceof V&&!a.arraysFlag&&(n=(i=Ku(n,a))!==null&&i!==void 0?i:new m(E.VALUE,S.ScalarExpected)),n instanceof m)return n;if(n instanceof V){var o=n.data.map(function(u){return u.map(e)});return V.onlyValues(o)}return e(n)}},{key:"binaryRangeWrapper",value:function(e,n,a,i){var o,u;if(n instanceof V&&!i.arraysFlag&&(n=(o=Ku(n,i))!==null&&o!==void 0?o:new m(E.VALUE,S.ScalarExpected)),n instanceof m)return n;if(a instanceof V&&!i.arraysFlag&&(a=(u=Ku(a,i))!==null&&u!==void 0?u:new m(E.VALUE,S.ScalarExpected)),a instanceof m)return a;if(n instanceof V||a instanceof V){if(!(n instanceof V))if(a.isAdHoc()){for(var s=a.data,l=0;l<s.length;l++)for(var f=0;f<s[0].length;f++)s[l][f]=e(n,s[l][f]);return V.onlyValues(s)}else n=V.fromScalar(n);if(!(a instanceof V))if(n.isAdHoc()){for(var c=n.data,h=0;h<c.length;h++)for(var p=0;p<c[0].length;p++)c[h][p]=e(c[h][p],a);return V.onlyValues(c)}else a=V.fromScalar(a);if(n.width()===a.width()&&n.height()===a.height()){if(n.isAdHoc()){for(var y=n.data,v=a.data,R=0;R<y.length;R++)for(var g=0;g<y[0].length;g++)y[R][g]=e(y[R][g],v[R][g]);return V.onlyValues(y)}if(a.isAdHoc()){for(var A=n.data,T=a.data,N=0;N<A.length;N++)for(var M=0;M<A[0].length;M++)T[N][M]=e(A[N][M],T[N][M]);return V.onlyValues(T)}}for(var _=Math.max(n.width(),a.width()),$=Math.max(n.height(),a.height()),x=Array($),D=0;D<$;D++)x[D]=Array(_);for(var K=0;K<$;K++)for(var Z=n.height()!==1?K:0,ie=a.height()!==1?K:0,q=0;q<_;q++){var le=n.width()!==1?q:0,pe=a.width()!==1?q:0;Z<n.height()&&ie<a.height()&&le<n.width()&&pe<a.width()?x[K][q]=e(n.data[Z][le],a.data[ie][pe]):x[K][q]=new m(E.NA)}return V.onlyValues(x)}return e(n,a)}}]),r}();function o3(r,t){return t instanceof m?t:r(t)}function er(r,t,e){return t instanceof m?t:e instanceof m?e:r(t,e)}function KY(r,t){return r instanceof m&&t!==void 0?r.attachRootVertex(t):r}function XY(r,t){return JY(r)||ZY(r,t)||QY(r,t)||qY()}function qY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QY(r,t){if(!!r){if(typeof r=="string")return u3(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return u3(r,t)}}function u3(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function ZY(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function JY(r){if(Array.isArray(r))return r}function eK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function s3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function tK(r,t,e){return t&&s3(r.prototype,t),e&&s3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var rK=function(){function r(t){eK(this,r),this.sheet=t,this.transformations=[]}return tK(r,[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,n){this.transformations.forEach(function(a){return a.performEagerTransformations(e,n)})}},{key:"transformSingleAst",value:function(e,n){var a=e,i=n;return this.transformations.forEach(function(o){var u=o.transformSingleAst(a,i),s=XY(u,2);a=s[0],i=s[1]}),[a,i]}},{key:"isIrreversible",value:function(){return!0}}]),r}();function nK(r,t){return uK(r)||oK(r,t)||iK(r,t)||aK()}function aK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iK(r,t){if(!!r){if(typeof r=="string")return l3(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return l3(r,t)}}function l3(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function oK(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function uK(r){if(Array.isArray(r))return r}function sK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function f3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function lK(r,t,e){return t&&f3(r.prototype,t),e&&f3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var fK=function(){function r(t){sK(this,r),this.stats=t,this.transformations=[]}return lK(r,[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new rK(e)}},{key:"commitCombinedMode",value:function(){if(this.combinedTransformer===void 0)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,n,a){this.stats.start(X.TRANSFORM_ASTS_POSTPONED);for(var i=a;i<this.transformations.length;i++){var o=this.transformations[i];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,n,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var u=o.transformSingleAst(e,n),s=nK(u,2),l=s[0],f=s[1];e=l,n=f}var c=this.parser.rememberNewAst(e);return this.stats.end(X.TRANSFORM_ASTS_POSTPONED),[c,n,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark(function t(e,n){var a,i;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:a=e;case 1:if(!(a<this.transformations.length)){u.next=9;break}if(i=this.transformations[a],!(!n||n(i))){u.next=6;break}return u.next=6,i;case 6:a++,u.next=1;break;case 9:case"end":return u.stop()}},t,this)})}]),r}(),cK=z,hK=In.findIndex,pK=Si,v2="findIndex",c3=!0;v2 in[]&&Array(1)[v2](function(){c3=!1});cK({target:"Array",proto:!0,forced:c3},{findIndex:function(t){return hK(this,t,arguments.length>1?arguments[1]:void 0)}});pK(v2);function xa(r){return xa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xa(r)}function h3(r,t,e,n){var a;n==="col"?a=r.effectiveEndColumn(e):a=r.effectiveEndRow(e);var i=r.start[n],o;n==="row"?o=function(l){return F(e.getCellValue(P(r.sheet,r.start.col,l)))}:o=function(l){return F(e.getCellValue(P(r.sheet,l,r.start.row)))};var u=dK(o,t,i,a);return xa(o(u))!==xa(t)?-1:u-i}function dK(r,t,e,n){for(;e<=n;){var a=Math.floor((e+n)/2),i=vK(t,r(a));if(i>0)e=a+1;else if(i<0)n=a-1;else if(e!=a)n=a;else return a}return n}function vK(r,t){return xa(r)===xa(t)?r===ne?0:r<t?-1:r>t?1:0:r===ne?-1:t===ne?1:t instanceof m||typeof r=="number"&&typeof t=="string"||typeof r=="number"&&typeof t=="boolean"?-1:typeof r=="string"&&typeof t=="number"?1:typeof r=="string"&&typeof t=="boolean"?-1:1}function yK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function p3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function mK(r,t,e){return t&&p3(r.prototype,t),e&&p3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var d3=function(){function r(t){yK(this,r),this.dependencyGraph=t}return mK(r,[{key:"advancedFind",value:function(e,n){var a,i=n.range;i===void 0?a=n.valuesFromTopLeftCorner():a=this.dependencyGraph.computeListOfValuesInRange(i);for(var o=0;o<a.length;o++)if(e(F(a[o])))return o;return-1}}]),r}();function y2(r){return y2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y2(r)}function gK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function v3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function EK(r,t,e){return t&&v3(r.prototype,t),e&&v3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function RK(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&m2(r,t)}function m2(r,t){return m2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},m2(r,t)}function bK(r){var t=TK();return function(){var n=Ds(r),a;if(t){var i=Ds(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return SK(this,a)}}function SK(r,t){if(t&&(y2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AK(r)}function AK(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function TK(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(r){return Ds=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ds(r)}var y3=function(r){RK(e,r);var t=bK(e);function e(n,a){var i;return gK(this,e),i=t.call(this,n),i.dependencyGraph=n,i.config=a,i}return EK(e,[{key:"add",value:function(a,i){}},{key:"remove",value:function(a,i){}},{key:"change",value:function(a,i,o){}},{key:"applyChanges",value:function(a){}},{key:"addColumns",value:function(a){}},{key:"removeColumns",value:function(a){}},{key:"removeSheet",value:function(a){}},{key:"moveValues",value:function(a,i,o,u){}},{key:"removeValues",value:function(a){}},{key:"find",value:function(a,i,o){typeof a=="string"&&(a=yn(a));var u=i.range;return u===void 0?i.valuesFromTopLeftCorner().map(F).map(function(s){return typeof s=="string"?yn(s):s}).indexOf(a):o?h3(u,a,this.dependencyGraph,"row"):this.dependencyGraph.computeListOfValuesInRange(u).findIndex(function(s){return s=F(s),s=typeof s=="string"?yn(s):s,s===a})}}]),e}(d3);function OK(r){return CK(r)||NK(r)||g2(r)||wK()}function wK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NK(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function CK(r){if(Array.isArray(r))return E2(r)}function Ls(r,t){return MK(r)||IK(r,t)||g2(r,t)||_K()}function _K(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IK(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function MK(r){if(Array.isArray(r))return r}function Ba(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=g2(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function g2(r,t){if(!!r){if(typeof r=="string")return E2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return E2(r,t)}}function E2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function kK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function m3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function FK(r,t,e){return t&&m3(r.prototype,t),e&&m3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var PK=function(){function r(t,e,n){kK(this,r),this.dependencyGraph=t,this.config=e,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new y3(t,e)}return FK(r,[{key:"add",value:function(e,n){if(!(e===ne||e instanceof m))if(e instanceof V){var a=Ba(e.entriesFromTopLeftCorner(n)),i;try{for(a.s();!(i=a.n()).done;){var o=Ls(i.value,2),u=o[0],s=o[1];this.addSingleCellValue(F(u),s)}}catch(l){a.e(l)}finally{a.f()}}else this.addSingleCellValue(e,n)}},{key:"remove",value:function(e,n){if(e!==void 0)if(e instanceof V){var a=Ba(e.entriesFromTopLeftCorner(n)),i;try{for(a.s();!(i=a.n()).done;){var o=Ls(i.value,2),u=o[0],s=o[1];this.removeSingleValue(F(u),s)}}catch(l){a.e(l)}finally{a.f()}}else this.removeSingleValue(e,n)}},{key:"change",value:function(e,n,a){e!==n&&(this.remove(e,a),this.add(n,a))}},{key:"applyChanges",value:function(e){var n=Ba(e),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.oldValue!==void 0&&this.change(F(i.oldValue),F(i.value),i.address)}}catch(o){n.e(o)}finally{n.f()}}},{key:"moveValues",value:function(e,n,a,i){var o=Ba(e),u;try{for(o.s();!(u=o.n()).done;){var s=Ls(u.value,2),l=s[0],f=s[1],c=XG(f,i,n,a);this.remove(l,f),this.add(l,c)}}catch(h){o.e(h)}finally{o.f()}}},{key:"removeValues",value:function(e){var n=Ba(e),a;try{for(n.s();!(a=n.n()).done;){var i=Ls(a.value,2),o=i[0],u=i[1];this.remove(o,u)}}catch(s){n.e(s)}finally{n.f()}}},{key:"find",value:function(e,n,a){var i=n.range;if(i===void 0)return this.binarySearchStrategy.find(e,n,a);this.ensureRecentData(i.sheet,i.start.col,e);var o=this.getColumnMap(i.sheet,i.start.col);if(!o)return-1;typeof e=="string"&&(e=yn(e));var u=o.get(e);if(!u)return this.binarySearchStrategy.find(e,n,a);var s=Us(u.index,i.start.row),l=u.index[s];return l<=i.end.row?l-i.start.row:this.binarySearchStrategy.find(e,n,a)}},{key:"advancedFind",value:function(e,n){return this.binarySearchStrategy.advancedFind(e,n)}},{key:"addColumns",value:function(e){var n=this.index.get(e.sheet);!n||n.splice.apply(n,[e.columnStart,0].concat(OK(Array(e.numberOfColumns))))}},{key:"removeColumns",value:function(e){var n=this.index.get(e.sheet);!n||n.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,n){this.index.has(e)||this.index.set(e,[]);var a=this.index.get(e),i=a[n];return i||(i=new Map,a[n]=i),i}},{key:"getValueIndex",value:function(e,n,a){var i=this.getColumnMap(e,n),o=this.getColumnMap(e,n).get(a);return o||(o={version:this.transformingService.version(),index:[]},i.set(a,o)),o}},{key:"ensureRecentData",value:function(e,n,a){var i=this.getValueIndex(e,n,a),o=this.transformingService.version();if(i.version!==o){var u=this.transformingService.getTransformationsFrom(i.version,function(c){return c.sheet===e&&(c instanceof V1||c instanceof q1)}),s=Ba(u),l;try{for(s.s();!(l=s.n()).done;){var f=l.value;f instanceof V1?this.addRows(n,f.rowsSpan,a):f instanceof q1&&this.removeRows(n,f.rowsSpan,a)}}catch(c){s.e(c)}finally{s.f()}i.version=o}}},{key:"addSingleCellValue",value:function(e,n){var a=this;this.stats.measure(X.BUILD_COLUMN_INDEX,function(){a.ensureRecentData(n.sheet,n.col,e),typeof e=="string"&&(e=yn(e));var i=a.getValueIndex(n.sheet,n.col,e);a.addValue(i,n.row)})}},{key:"removeSingleValue",value:function(e,n){var a=this;this.stats.measure(X.BUILD_COLUMN_INDEX,function(){a.ensureRecentData(n.sheet,n.col,e);var i=a.getColumnMap(n.sheet,n.col);typeof e=="string"&&(e=yn(e));var o=i.get(e);if(!!o){var u=Us(o.index,n.row);o.index.splice(u,1),o.index.length===0&&i.delete(e),i.size===0&&delete a.index.get(n.sheet)[n.col]}})}},{key:"addRows",value:function(e,n,a){var i=this.getValueIndex(n.sheet,e,a);this.shiftRows(i,n.rowStart,n.numberOfRows)}},{key:"removeRows",value:function(e,n,a){var i=this.getValueIndex(n.sheet,e,a);this.removeRowsFromValues(i,n),this.shiftRows(i,n.rowEnd+1,-n.numberOfRows)}},{key:"addValue",value:function(e,n){var a=g3(e.index,n),i=e.index[a];i!==n&&(a===e.index.length-1?e.index.push(n):e.index.splice(a+1,0,n))}},{key:"removeRowsFromValues",value:function(e,n){var a=Us(e.index,n.rowStart),i=g3(e.index,n.rowEnd);e.index[a]<=n.rowEnd&&e.index.splice(a,i-a+1)}},{key:"shiftRows",value:function(e,n,a){for(var i=Us(e.index,n),o=i;o<e.index.length;++o)e.index[o]+=a}}]),r}();function Us(r,t){for(var e=0,n=r.length-1;e<=n;){var a=Math.floor((e+n)/2);if(t>r[a])e=a+1;else if(t<r[a])n=a-1;else return a}return e}function g3(r,t){for(var e=0,n=r.length-1;e<=n;){var a=Math.floor((e+n)/2);if(t>r[a])e=a+1;else if(t<r[a])n=a-1;else return a}return n}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function $K(r,t,e){return t.useColumnIndex?new PK(r,t,e):new y3(r,t)}function DK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function E3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function LK(r,t,e){return t&&E3(r.prototype,t),e&&E3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var UK=function(){function r(t){DK(this,r),this.config=t;var e=this.config.thousandSeparator==="."?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,n=this.config.decimalSeparator==="."?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(n,"\\d+)|(\\d+(").concat(e,"\\d{3,})*(").concat(n,"\\d*)?)))(e[+-]?\\d+)?$")),this.allThousandSeparatorsRegex=new RegExp("".concat(e),"g")}return LK(r,[{key:"numericStringToMaybeNumber",value:function(e){if(this.numberPattern.test(e)){var n=this.numericStringToNumber(e);return isNaN(n)?void 0:n}}},{key:"numericStringToNumber",value:function(e){var n=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(n)}}]),r}();function R3(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=xK(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function xK(r,t){if(!!r){if(typeof r=="string")return b3(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b3(r,t)}}function b3(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function BK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function S3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function VK(r,t,e){return t&&S3(r.prototype,t),e&&S3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var GK=function(){function r(t,e,n){BK(this,r),this.dependencyGraph=t,this.unparser=e,this.exporter=n}return VK(r,[{key:"getCellFormula",value:function(e,n){var a=this.dependencyGraph.getCell(e);if(a instanceof Vr){var i=a.getFormula(this.dependencyGraph.lazilyTransformingAstService);return n=n!=null?n:e,this.unparser.unparse(i,n)}else if(a instanceof Fe){var o=a.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(o.row!==e.row||o.col!==e.col||o.sheet!==e.sheet)return;n=n!=null?n:e;var u=a.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(u!==void 0)return this.unparser.unparse(u,n)}else if(a instanceof Ma)return a.getFormula()}},{key:"getCellSerialized",value:function(e,n){var a;return(a=this.getCellFormula(e,n))!==null&&a!==void 0?a:this.getRawValue(e)}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getRawValue",value:function(e){return this.dependencyGraph.getRawValue(e)}},{key:"getSheetValues",value:function(e){var n=this;return this.genericSheetGetter(e,function(a){return n.getCellValue(a)})}},{key:"getSheetFormulas",value:function(e){var n=this;return this.genericSheetGetter(e,function(a){return n.getCellFormula(a)})}},{key:"genericSheetGetter",value:function(e,n){for(var a=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),o=new Array(a),u=0;u<a;u++){o[u]=new Array(i);for(var s=0;s<i;s++){var l=P(e,s,u);o[u][s]=n(l)}for(var f=i-1;f>=0&&(o[u][f]===null||o[u][f]===void 0);f--)o[u].pop()}for(var c=a-1;c>=0&&o[c].length===0;c--)o.pop();return o}},{key:"genericAllSheetsGetter",value:function(e){var n={},a=R3(this.dependencyGraph.sheetMapping.displayNames()),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.dependencyGraph.sheetMapping.fetch(o);n[o]=e(u)}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"getSheetSerialized",value:function(e){var n=this;return this.genericSheetGetter(e,function(a){return n.getCellSerialized(a)})}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter(function(n){return e.getSheetValues(n)})}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter(function(n){return e.getSheetFormulas(n)})}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter(function(n){return e.getSheetSerialized(n)})}},{key:"getAllNamedExpressionsSerialized",value:function(){var e=this,n=[],a=0,i=R3(this.dependencyGraph.sheetMapping.displayNames()),o;try{for(i.s();!(o=i.n()).done;){var u=o.value,s=this.dependencyGraph.sheetMapping.fetch(u);n[s]=a,a++}}catch(l){i.e(l)}finally{i.f()}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(function(l){return{name:l.expression.displayName,expression:e.getCellSerialized(l.expression.address),scope:l.scope!==void 0?n[l.scope]:void 0,options:l.expression.options}})}},{key:"withNewConfig",value:function(e,n){var a=new Sg(e,_h(e),this.dependencyGraph.sheetMapping.fetchDisplayName,n);return new r(this.dependencyGraph,a,this.exporter)}}]),r}();function jK(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function HK(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function A3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function WK(r,t,e){return t&&A3(r.prototype,t),e&&A3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var xs=function(){function r(){HK(this,r)}return WK(r,null,[{key:"buildFromSheets",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=new zr(n);return this.buildEngine(i,e,a)}},{key:"buildFromSheet",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=new zr(n),o=i.translationPackage.getUITranslation(to.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,jK({},o,e),a)}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return this.buildEngine(new zr(e),{},n)}},{key:"rebuildWithConfig",value:function(e,n,a,i){return this.buildEngine(e,n,a,i)}},{key:"buildEngine",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.useStats?new p7:new MB;i.start(X.BUILD_ENGINE_TOTAL);var o=new gs,u=new Jt(e),s=new fK(i),l=RG.buildEmpty(s,e,u,o,i),f=$K(l,e,i),c=l.sheetMapping,h=l.addressMapping;for(var p in n)if(Object.prototype.hasOwnProperty.call(n,p)){var y=n[p];_8(y);var v=ws(y);if(v.height>e.maxRows||v.width>e.maxColumns)throw new $n;var R=c.addSheet(p);h.autoAddSheet(R,y,v)}var g=new lx(e,u,c.get);s.parser=g;var A=new Sg(e,_h(e),c.fetchDisplayName,o),T=new Uj(e),N=new UK(e),M=new qx(e,T,N),_=new ZH(e,T,N),$=new vB(e,u),x=new yz(e,l,f,_,g,i,s,o,$),D=new Hz(e,x);s.undoRedo=D;var K=new JH(e,l,x),Z=new qz(e,x,D,K,l,f,g,_,s,o);a.forEach(function(Re){Z.ensureItIsPossibleToAddNamedExpression(Re.name,Re.expression,Re.scope),Z.operations.addNamedExpression(Re.name,Re.expression,Re.scope,Re.options)});var ie=new hY(e,o,c.fetchDisplayName,s),q=new GK(l,A,ie),le=new YY(e,l,f,i,M,u,o,q,$,T);i.measure(X.GRAPH_BUILD,function(){var Re=new pY(l,f,g,_,i,$);Re.buildGraph(n,i)});var pe=new tY(e,i,le,s,l,f);return pe.run(),i.end(X.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:f,parser:g,unparser:A,cellContentParser:_,evaluator:pe,lazilyTransformingAstService:s,crudOperations:Z,exporter:ie,namedExpressions:o,serialization:q,functionRegistry:u}}}]),r}(),zK=z,YK=B7.entries;zK({target:"Object",stat:!0},{entries:function(t){return YK(t)}});function KK(r,t){return ZK(r)||QK(r,t)||qK(r,t)||XK()}function XK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qK(r,t){if(!!r){if(typeof r=="string")return T3(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return T3(r,t)}}function T3(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function QK(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function ZK(r){if(Array.isArray(r))return r}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function JK(r){for(var t=0,e=Object.entries(r);t<e.length;t++){var n=KK(e[t],2),a=n[0],i=n[1];i instanceof Function?r[a]=eX(i):delete r[a]}}function eX(r){return function(){throw new Error('The "'.concat(r,'" method cannot be called because this HyperFormula instance has been destroyed'))}}var O3={exports:{}};function R2(){}R2.prototype={on:function(r,t,e){var n=this.e||(this.e={});return(n[r]||(n[r]=[])).push({fn:t,ctx:e}),this},once:function(r,t,e){var n=this;function a(){n.off(r,a),t.apply(e,arguments)}return a._=t,this.on(r,a,e)},emit:function(r){var t=[].slice.call(arguments,1),e=((this.e||(this.e={}))[r]||[]).slice(),n=0,a=e.length;for(n;n<a;n++)e[n].fn.apply(e[n].ctx,t);return this},off:function(r,t){var e=this.e||(this.e={}),n=e[r],a=[];if(n&&t)for(var i=0,o=n.length;i<o;i++)n[i].fn!==t&&n[i].fn._!==t&&a.push(n[i]);return a.length?e[r]=a:delete e[r],this}};O3.exports=R2;var tX=O3.exports.TinyEmitter=R2;function b2(r){return b2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b2(r)}function rX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function w3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function nX(r,t,e){return t&&w3(r.prototype,t),e&&w3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Bs(){return typeof Reflect!="undefined"&&Reflect.get?Bs=Reflect.get:Bs=function(t,e,n){var a=aX(t,e);if(!!a){var i=Object.getOwnPropertyDescriptor(a,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Bs.apply(this,arguments)}function aX(r,t){for(;!Object.prototype.hasOwnProperty.call(r,t)&&(r=Va(r),r!==null););return r}function iX(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&S2(r,t)}function S2(r,t){return S2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},S2(r,t)}function oX(r){var t=lX();return function(){var n=Va(r),a;if(t){var i=Va(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return uX(this,a)}}function uX(r,t){if(t&&(b2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sX(r)}function sX(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function lX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(r){return Va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Va(r)}var wr;(function(r){r.SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed"})(wr||(wr={}));var fX=function(r){iX(e,r);var t=oX(e);function e(){return rX(this,e),t.apply(this,arguments)}return nX(e,[{key:"emit",value:function(a){for(var i,o=arguments.length,u=new Array(o>1?o-1:0),s=1;s<o;s++)u[s-1]=arguments[s];return(i=Bs(Va(e.prototype),"emit",this)).call.apply(i,[this,a].concat(u)),this}}]),e}(tX);function Vs(r){return pX(r)||hX(r)||N3(r)||cX()}function cX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hX(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function pX(r){if(Array.isArray(r))return A2(r)}function dX(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=N3(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function N3(r,t){if(!!r){if(typeof r=="string")return A2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return A2(r,t)}}function A2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function vX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function C3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function yX(r,t,e){return t&&C3(r.prototype,t),e&&C3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Dt=function(){function r(t,e,n,a,i,o,u,s,l,f,c,h,p,y){vX(this,r),this._config=t,this._stats=e,this._dependencyGraph=n,this._columnSearch=a,this._parser=i,this._unparser=o,this._cellContentParser=u,this._evaluator=s,this._lazilyTransformingAstService=l,this._crudOperations=f,this._exporter=c,this._namedExpressions=h,this._serialization=p,this._functionRegistry=y,this._emitter=new fX,this._evaluationSuspended=!1}return yX(r,[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"arrayMapping",get:function(){return this.dependencyGraph.arrayMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"getCellFormula",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return I(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return I(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return I(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter(function(n){return e.getSheetDimensions(n)})}},{key:"getSheetDimensions",value:function(e){return I(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var n=this._config.mergeConfig(e),a=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(a,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),u=xs.rebuildWithConfig(n,i,o,this._stats);this._config=u.config,this._stats=u.stats,this._dependencyGraph=u.dependencyGraph,this._columnSearch=u.columnSearch,this._parser=u.parser,this._unparser=u.unparser,this._cellContentParser=u.cellContentParser,this._evaluator=u.evaluator,this._lazilyTransformingAstService=u.lazilyTransformingAstService,this._crudOperations=u.crudOperations,this._exporter=u.exporter,this._namedExpressions=u.namedExpressions,this._serialization=u.serialization,this._functionRegistry=u.functionRegistry}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var n;if(He(e))n=new Y(e,e);else if(Gt(e))n=new Y(e.start,e.end);else throw new he("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(n);var a=dX(n.addresses(this._dependencyGraph)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._crudOperations.ensureItIsPossibleToChangeContent(o)}}catch(u){a.e(u)}finally{a.f()}}catch{return!1}return!0}},{key:"setCellContents",value:function(e,n){return this._crudOperations.setCellContents(e,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,n){return I(e,"number","sheetId"),this._crudOperations.setRowOrder(e,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,n){I(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}},{key:"setRowOrder",value:function(e,n){I(e,"number","sheetId");var a=this._crudOperations.mappingFromOrder(e,n,"row");return this.swapRowIndexes(e,a)}},{key:"isItPossibleToSetRowOrder",value:function(e,n){I(e,"number","sheetId");try{var a=this._crudOperations.mappingFromOrder(e,n,"row");return this._crudOperations.validateSwapRowIndexes(e,a),this._crudOperations.testRowOrderForArrays(e,a),!0}catch{return!1}}},{key:"swapColumnIndexes",value:function(e,n){return I(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,n){I(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}},{key:"setColumnOrder",value:function(e,n){I(e,"number","sheetId");var a=this._crudOperations.mappingFromOrder(e,n,"column");return this.swapColumnIndexes(e,a)}},{key:"isItPossibleToSetColumnOrder",value:function(e,n){I(e,"number","sheetId");try{var a=this._crudOperations.mappingFromOrder(e,n,"column");return this._crudOperations.validateSwapColumnIndexes(e,a),this._crudOperations.testColumnOrderForArrays(e,a),!0}catch{return!1}}},{key:"isItPossibleToAddRows",value:function(e){I(e,"number","sheetId");for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=_s(a);try{var u;return(u=this._crudOperations).ensureItIsPossibleToAddRows.apply(u,[e].concat(Vs(o))),!0}catch{return!1}}},{key:"addRows",value:function(e){var n;I(e,"number","sheetId");for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(n=this._crudOperations).addRows.apply(n,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){I(e,"number","sheetId");for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=Cs(a);try{var u;return(u=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(u,[e].concat(Vs(o))),!0}catch{return!1}}},{key:"removeRows",value:function(e){var n;I(e,"number","sheetId");for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(n=this._crudOperations).removeRows.apply(n,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){I(e,"number","sheetId");for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=_s(a);try{var u;return(u=this._crudOperations).ensureItIsPossibleToAddColumns.apply(u,[e].concat(Vs(o))),!0}catch{return!1}}},{key:"addColumns",value:function(e){var n;I(e,"number","sheetId");for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(n=this._crudOperations).addColumns.apply(n,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){I(e,"number","sheetId");for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o=Cs(a);try{var u;return(u=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(u,[e].concat(Vs(o))),!0}catch{return!1}}},{key:"removeColumns",value:function(e){var n;I(e,"number","sheetId");for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(n=this._crudOperations).removeColumns.apply(n,[e].concat(i)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,n){if(!He(n))throw new he("SimpleCellAddress","destinationLeftCorner");if(!Gt(e))throw new he("SimpleCellRange","source");try{var a=new Y(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(a.start,a.width(),a.height(),n),!0}catch{return!1}}},{key:"moveCells",value:function(e,n){if(!He(n))throw new he("SimpleCellAddress","destinationLeftCorner");if(!Gt(e))throw new he("SimpleCellRange","source");var a=new Y(e.start,e.end);return this._crudOperations.moveCells(a.start,a.width(),a.height(),n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,n,a,i){I(e,"number","sheetId"),I(n,"number","startRow"),I(a,"number","numberOfRows"),I(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,n,a,i),!0}catch{return!1}}},{key:"moveRows",value:function(e,n,a,i){return I(e,"number","sheetId"),I(n,"number","startRow"),I(a,"number","numberOfRows"),I(i,"number","targetRow"),this._crudOperations.moveRows(e,n,a,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,n,a,i){I(e,"number","sheetId"),I(n,"number","startColumn"),I(a,"number","numberOfColumns"),I(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,n,a,i),!0}catch{return!1}}},{key:"moveColumns",value:function(e,n,a,i){return I(e,"number","sheetId"),I(n,"number","startColumn"),I(a,"number","numberOfColumns"),I(i,"number","targetColumn"),this._crudOperations.moveColumns(e,n,a,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e){if(!Gt(e))throw new he("SimpleCellRange","source");var n=new Y(e.start,e.end);return this._crudOperations.copy(n.start,n.width(),n.height()),this.getRangeValues(e)}},{key:"cut",value:function(e){if(!Gt(e))throw new he("SimpleCellRange","source");var n=new Y(e.start,e.end);return this._crudOperations.cut(n.start,n.width(),n.height()),this.getRangeValues(e)}},{key:"paste",value:function(e){if(!He(e))throw new he("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e){var n=this;if(!Gt(e))throw new he("SimpleCellRange","source");var a=new Y(e.start,e.end);return a.arrayOfAddressesInRange().map(function(i){return i.map(function(o){return n.getCellValue(o)})})}},{key:"getRangeFormulas",value:function(e){var n=this;if(!Gt(e))throw new he("SimpleCellRange","source");var a=new Y(e.start,e.end);return a.arrayOfAddressesInRange().map(function(i){return i.map(function(o){return n.getCellFormula(o)})})}},{key:"getRangeSerialized",value:function(e){var n=this;if(!Gt(e))throw new he("SimpleCellRange","source");var a=new Y(e.start,e.end);return a.arrayOfAddressesInRange().map(function(i){return i.map(function(o){return n.getCellSerialized(o)})})}},{key:"getFillRangeData",value:function(e,n){var a=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!Gt(e))throw new he("SimpleCellRange","source");if(!Gt(n))throw new he("SimpleCellRange","target");var o=new Y(e.start,e.end),u=new Y(n.start,n.end);return this.ensureEvaluationIsNotSuspended(),u.arrayOfAddressesInRange().map(function(s){return s.map(function(l){var f=((l.row-(i?n:e).start.row)%o.height()+o.height())%o.height()+e.start.row,c=((l.col-(i?n:e).start.col)%o.width()+o.width())%o.width()+e.start.col;return a._serialization.getCellSerialized({row:f,col:c,sheet:o.sheet},l)})})}},{key:"isItPossibleToAddSheet",value:function(e){I(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}},{key:"addSheet",value:function(e){e!==void 0&&I(e,"string","sheetName");var n=this._crudOperations.addSheet(e);return this._emitter.emit(wr.SheetAdded,n),n}},{key:"isItPossibleToRemoveSheet",value:function(e){I(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}},{key:"removeSheet",value:function(e){I(e,"number","sheetId");var n=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);var a=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(wr.SheetRemoved,n,a),a}},{key:"isItPossibleToClearSheet",value:function(e){I(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}},{key:"clearSheet",value:function(e){return I(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,n){I(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,n),!0}catch{return!1}}},{key:"setSheetContent",value:function(e,n){return I(e,"number","sheetId"),this._crudOperations.setSheetContent(e,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,n){return I(e,"string","cellAddress"),I(n,"number","sheetId"),Ih(this.sheetMapping.get,e,n)}},{key:"simpleCellRangeFromString",value:function(e,n){return I(e,"string","cellRange"),I(n,"number","sheetId"),mL(this.sheetMapping.get,e,n)}},{key:"simpleCellAddressToString",value:function(e,n){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return I(n,"number","sheetId"),xu(this.sheetMapping.fetchDisplayName,e,n)}},{key:"simpleCellRangeToString",value:function(e,n){if(!Gt(e))throw new he("SimpleCellRange","cellRange");return I(n,"number","sheetId"),gL(this.sheetMapping.fetchDisplayName,e,n)}},{key:"getCellDependents",value:function(e){var n;if(He(e))n=this._dependencyGraph.addressMapping.getCell(e);else if(Gt(e))n=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new he("SimpleCellAddress | SimpleCellRange",e);return n===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(n)}},{key:"getCellPrecedents",value:function(e){var n;if(He(e))n=this._dependencyGraph.addressMapping.getCell(e);else if(Gt(e))n=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new he("SimpleCellAddress | SimpleCellRange",e);return n===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(n)}},{key:"getSheetName",value:function(e){return I(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return I(e,"string","sheetName"),this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return I(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");var n=this.dependencyGraph.getCell(e);return jG(n,e)}},{key:"doesCellHaveSimpleValue",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return this.getCellType(e)===kt.VALUE}},{key:"doesCellHaveFormula",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");var n=this.getCellType(e);return n===kt.FORMULA||n===kt.ARRAYFORMULA}},{key:"isCellEmpty",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");return this.getCellType(e)===kt.EMPTY}},{key:"isCellPartOfArray",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");var n=this.getCellType(e);return n===kt.ARRAY||n===kt.ARRAYFORMULA}},{key:"getCellValueType",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var n=this.dependencyGraph.getCellValue(e);return ts(n)}},{key:"getCellValueDetailedType",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var n=this.dependencyGraph.getCellValue(e);return WG(n)}},{key:"getCellValueFormat",value:function(e){if(!He(e))throw new he("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var n=this.dependencyGraph.getCellValue(e);return zG(n)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,n){I(e,"number","sheetId"),I(n,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,n),!0}catch{return!1}}},{key:"renameSheet",value:function(e,n){I(e,"number","sheetId"),I(n,"string","newName");var a=this._crudOperations.renameSheet(e,n);a!==void 0&&this._emitter.emit(wr.SheetRenamed,a,n)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(n){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),n}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(wr.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(wr.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,n,a){I(e,"string","expressionName"),a!==void 0&&I(a,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,n,a),!0}catch{return!1}}},{key:"addNamedExpression",value:function(e,n,a,i){I(e,"string","expressionName"),a!==void 0&&I(a,"number","scope"),this._crudOperations.addNamedExpression(e,n,a,i);var o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(wr.NamedExpressionAdded,e,o),o}},{key:"getNamedExpressionValue",value:function(e,n){I(e,"string","expressionName"),n!==void 0&&I(n,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(n);var a=this._namedExpressions.namedExpressionForScope(e,n);if(a)return this._serialization.getCellValue(a.address)}},{key:"getNamedExpressionFormula",value:function(e,n){I(e,"string","expressionName"),n!==void 0&&I(n,"number","scope"),this._crudOperations.ensureScopeIdIsValid(n);var a=this._namedExpressions.namedExpressionForScope(e,n);if(a!==void 0)return this._serialization.getCellFormula(a.address)}},{key:"getNamedExpression",value:function(e,n){I(e,"string","expressionName"),n!==void 0&&I(n,"number","scope");var a=this._namedExpressions.namedExpressionForScope(e,n);if(a!==void 0){var i=this._serialization.getCellFormula(a.address);return{name:e,scope:n,expression:i,options:a.options}}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,n,a){I(e,"string","expressionName"),a!==void 0&&I(a,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,n,a),!0}catch{return!1}}},{key:"changeNamedExpression",value:function(e,n,a,i){return I(e,"string","expressionName"),a!==void 0&&I(a,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,a,n,i),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,n){I(e,"string","expressionName"),n!==void 0&&I(n,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,n),!0}catch{return!1}}},{key:"removeNamedExpression",value:function(e,n){I(e,"string","expressionName"),n!==void 0&&I(n,"number","scope");var a=this._crudOperations.removeNamedExpression(e,n);if(a){var i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(wr.NamedExpressionRemoved,a.displayName,i),i}else return[]}},{key:"listNamedExpressions",value:function(e){return e!==void 0&&I(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}},{key:"getAllNamedExpressionsSerialized",value:function(){return this._serialization.getAllNamedExpressionsSerialized()}},{key:"normalizeFormula",value:function(e){I(e,"string","formulaString");var n=this.extractTemporaryFormula(e),a=n.ast,i=n.address;if(a===void 0)throw new Bc;return this._unparser.unparse(a,i)}},{key:"calculateFormula",value:function(e,n){I(e,"string","formulaString"),I(n,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(n);var a=this.extractTemporaryFormula(e,n),i=a.ast,o=a.address,u=a.dependencies;if(i===void 0)throw new Bc;var s=this.evaluator.runAndForget(i,o,u);return this._exporter.exportScalarOrRange(s)}},{key:"validateFormula",value:function(e){I(e,"string","formulaString");var n=this.extractTemporaryFormula(e),a=n.ast;return!(a===void 0||a.type===b.ERROR&&!a.error)}},{key:"getRegisteredFunctionNames",value:function(){var e=r.getLanguage(this._config.language);return e.getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return I(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return I(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return I(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return I(e,"number","val"),Pa(e)}},{key:"on",value:function(e,n){this._emitter.on(e,n)}},{key:"once",value:function(e,n){this._emitter.once(e,n)}},{key:"off",value:function(e,n){this._emitter.off(e,n)}},{key:"destroy",value:function(){JK(this)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new zy}},{key:"extractTemporaryFormula",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=this._cellContentParser.parse(e),i={sheet:n,col:0,row:0};if(!(a instanceof _e.Formula))return{address:i,dependencies:[]};var o=this._parser.parse(a.formula,i),u=o.ast,s=o.errors,l=o.dependencies;return s.length>0?{address:i,dependencies:[]}:{ast:u,address:i,dependencies:l}}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),n=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),n.length>0&&e.addAll(this.evaluator.partialRun(n));var a=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(wr.ValuesUpdated,a),a}}],[{key:"defaultConfig",get:function(){return AX()}},{key:"buildFromArray",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return this.buildFromEngineState(xs.buildFromSheet(e,n,a))}},{key:"buildFromSheets",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return this.buildFromEngineState(xs.buildFromSheets(e,n,a))}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return this.buildFromEngineState(xs.buildEmpty(e,n))}},{key:"getLanguage",value:function(e){I(e,"string","languageCode");var n=this.registeredLanguages.get(e);if(n===void 0)throw new Vc;return n}},{key:"registerLanguage",value:function(e,n){if(I(e,"string","languageCode"),this.registeredLanguages.has(e))throw new Ky;this.registeredLanguages.set(e,oG(n))}},{key:"unregisterLanguage",value:function(e){if(I(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new Vc}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,n){Jt.registerFunctionPlugin(e,n)}},{key:"unregisterFunctionPlugin",value:function(e){Jt.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,n,a){I(e,"string","functionId"),Jt.registerFunction(e,n,a)}},{key:"unregisterFunction",value:function(e){I(e,"string","functionId"),Jt.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){Jt.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){I(e,"string","code");var n=Jt.getRegisteredFunctionIds(),a=this.getLanguage(e);return a.getFunctionTranslations(n)}},{key:"getFunctionPlugin",value:function(e){return I(e,"string","functionId"),Jt.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return Jt.getPlugins()}},{key:"buildFromEngineState",value:function(e){return new r(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}}]),r}();Dt.version="2.0.0";Dt.buildDate="14/04/2022 09:14:09";Dt.releaseDate="14/04/2022";Dt.languages={};Dt.registeredLanguages=new Map;function fo(r){return RX(r)||EX(r)||gX(r)||mX()}function mX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gX(r,t){if(!!r){if(typeof r=="string")return T2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return T2(r,t)}}function EX(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function RX(r){if(Array.isArray(r))return T2(r)}function T2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function bX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function SX(r,t,e){return t&&_3(r.prototype,t),e&&_3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var I3=new WeakMap,zr=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;bX(this,r);var n=t.accentSensitive,a=t.binarySearchThreshold,i=t.caseSensitive,o=t.caseFirst,u=t.chooseAddressMappingPolicy,s=t.currencySymbol,l=t.dateFormats,f=t.decimalSeparator,c=t.evaluateNullToZero,h=t.functionArgSeparator,p=t.functionPlugins,y=t.ignorePunctuation,v=t.leapYear1900,R=t.localeLang,g=t.language,A=t.ignoreWhiteSpace,T=t.licenseKey,N=t.matchWholeCell,M=t.arrayColumnSeparator,_=t.arrayRowSeparator,$=t.maxRows,x=t.maxColumns,D=t.nullYear,K=t.nullDate,Z=t.parseDateTime,ie=t.precisionEpsilon,q=t.precisionRounding,le=t.stringifyDateTime,pe=t.stringifyDuration,Re=t.smartRounding,we=t.timeFormats,w=t.thousandSeparator,O=t.useArrayArithmetic,C=t.useStats,k=t.undoLimit,B=t.useColumnIndex,ae=t.useRegularExpressions,J=t.useWildcards;e&&r.warnDeprecatedOptions(t),this.useArrayArithmetic=Ee(O,"boolean","useArrayArithmetic"),this.accentSensitive=Ee(n,"boolean","accentSensitive"),this.caseSensitive=Ee(i,"boolean","caseSensitive"),this.caseFirst=Ee(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Ee(y,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=u!=null?u:r.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=fo(cs(l,Array.isArray,"array","dateFormats")),this.timeFormats=fo(cs(we,Array.isArray,"array","timeFormats")),this.functionArgSeparator=Ee(h,"string","functionArgSeparator"),this.decimalSeparator=Ee(f,[".",","],"decimalSeparator"),this.language=Ee(g,"string","language"),this.ignoreWhiteSpace=Ee(A,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Ee(T,"string","licenseKey"),this.thousandSeparator=Ee(w,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Ee(M,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Ee(_,[";","|"],"arrayRowSeparator"),this.localeLang=Ee(R,"string","localeLang"),this.functionPlugins=fo(p!=null?p:r.defaultConfig.functionPlugins),this.smartRounding=Ee(Re,"boolean","smartRounding"),this.evaluateNullToZero=Ee(c,"boolean","evaluateNullToZero"),this.nullYear=Ee(D,"number","nullYear"),ka(this.nullYear,"nullYear",0),Aj(this.nullYear,"nullYear",100),this.precisionRounding=Ee(q,"number","precisionRounding"),ka(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Ee(ie,"number","precisionEpsilon"),ka(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Ee(B,"boolean","useColumnIndex"),this.useStats=Ee(C,"boolean","useStats"),this.binarySearchThreshold=a!=null?a:r.defaultConfig.binarySearchThreshold,this.parseDateTime=Ee(Z,"function","parseDateTime"),this.stringifyDateTime=Ee(le,"function","stringifyDateTime"),this.stringifyDuration=Ee(pe,"function","stringifyDuration"),this.translationPackage=Dt.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=cs(K,io,"IDate","nullDate"),this.leapYear1900=Ee(v,"boolean","leapYear1900"),this.undoLimit=Ee(k,"number","undoLimit"),this.useRegularExpressions=Ee(ae,"boolean","useRegularExpressions"),this.useWildcards=Ee(J,"boolean","useWildcards"),this.matchWholeCell=Ee(N,"boolean","matchWholeCell"),ka(this.undoLimit,"undoLimit",0),this.maxRows=Ee($,"number","maxRows"),ka(this.maxRows,"maxRows",1),this.maxColumns=Ee(x,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(s),ka(this.maxColumns,"maxColumns",1),I3.set(this,{licenseKeyValidityState:GH(this.licenseKey)}),b4({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),b4({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}return SX(r,[{key:"setupCurrencySymbol",value:function(e){var n=fo(cs(e,Array.isArray,"array","currencySymbol"));return n.forEach(function(a){if(typeof a!="string")throw new he("string[]","currencySymbol");if(a==="")throw new pF("currencySymbol")}),n}},{key:"licenseKeyValidityState",get:function(){return I3.get(this).licenseKeyValidityState}},{key:"getConfig",value:function(){return M3(this)}},{key:"mergeConfig",value:function(e){var n=Object.assign({},this.getConfig(),e);return r.warnDeprecatedOptions(e),new r(n,!1)}}],[{key:"warnDeprecatedOptions",value:function(e){r.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}},{key:"warnDeprecatedIfUsed",value:function(e,n,a,i){e!==void 0&&console.warn(i===void 0?"".concat(n," option is deprecated since ").concat(a):"".concat(n," option is deprecated since ").concat(a,", please use ").concat(i))}}]),r}();zr.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new jj,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:Fj,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:dH,stringifyDuration:pH,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function M3(r){var t,e={};for(var n in zr.defaultConfig){var a=(t=r[n])!==null&&t!==void 0?t:zr.defaultConfig[n];Array.isArray(a)?e[n]=fo(a):e[n]=a}return e}function AX(){return M3({})}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var O2={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};function w2(r){return w2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w2(r)}function k3(r){return wX(r)||OX(r)||F3(r)||TX()}function TX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OX(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wX(r){if(Array.isArray(r))return N2(r)}function NX(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=F3(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function F3(r,t){if(!!r){if(typeof r=="string")return N2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N2(r,t)}}function N2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function CX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function P3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _X(r,t,e){return t&&P3(r.prototype,t),e&&P3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function IX(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&C2(r,t)}function C2(r,t){return C2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},C2(r,t)}function MX(r){var t=PX();return function(){var n=Gs(r),a;if(t){var i=Gs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return kX(this,a)}}function kX(r,t){if(t&&(w2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FX(r)}function FX(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function PX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gs(r){return Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gs(r)}var $3=function(r){IX(e,r);var t=MX(e);function e(){return CX(this,e),t.apply(this,arguments)}return _X(e,[{key:"arrayformula",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ARRAYFORMULA"),function(o){return o})}},{key:"arrayformulaArraySize",value:function(a,i){var o=this;if(a.args.length!==1)return ue.error();var u=this.metadata("ARRAYFORMULA"),s=a.args.map(function(l){var f;return o.arraySizeForAst(l,new Sr(i.formulaAddress,i.arraysFlag||((f=u==null?void 0:u.arrayFunction)!==null&&f!==void 0?f:!1)))});return s[0]}},{key:"arrayconstrain",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ARRAY_CONSTRAIN"),function(o,u,s){u=Math.min(u,o.height()),s=Math.min(s,o.width());for(var l=o.data,f=[],c=0;c<u;c++)f.push(l[c].slice(0,s));return V.onlyValues(f)})}},{key:"arrayconstrainArraySize",value:function(a,i){var o=this;if(a.args.length!==3)return ue.error();var u=this.metadata("ARRAY_CONSTRAIN"),s=a.args.map(function(h){var p;return o.arraySizeForAst(h,new Sr(i.formulaAddress,i.arraysFlag||((p=u==null?void 0:u.arrayFunction)!==null&&p!==void 0?p:!1)))}),l=s[0],f=l.height,c=l.width;return a.args[1].type===b.NUMBER&&(f=Math.min(f,a.args[1].value)),a.args[2].type===b.NUMBER&&(c=Math.min(c,a.args[2].value)),f<1||c<1||!Number.isInteger(f)||!Number.isInteger(c)?ue.error():new ue(c,f)}},{key:"filter",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FILTER"),function(o){for(var u=arguments.length,s=new Array(u>1?u-1:0),l=1;l<u;l++)s[l-1]=arguments[l];for(var f=0,c=s;f<c.length;f++){var h=c[f];if(o.width()!==h.width()||o.height()!==h.height())return new m(E.NA,S.EqualLength)}if(o.width()>1&&o.height()>1)return new m(E.NA,S.WrongDimension);for(var p=o.data,y=[],v=0;v<o.height();v++){for(var R=[],g=0;g<o.width();g++){var A=!0,T=NX(s),N;try{for(T.s();!(N=T.n()).done;){var M=N.value,_=Wg(M.data[v][g]);if(_!==!0){A=!1;break}}}catch($){T.e($)}finally{T.f()}A&&R.push(p[v][g])}R.length>0&&y.push(R)}return y.length>0?V.onlyValues(y):new m(E.NA,S.EmptyRange)})}},{key:"filterArraySize",value:function(a,i){var o=this;if(a.args.length<=1)return ue.error();var u=this.metadata("FILTER"),s=a.args.map(function(c){var h;return o.arraySizeForAst(c,new Sr(i.formulaAddress,i.arraysFlag||((h=u==null?void 0:u.arrayFunction)!==null&&h!==void 0?h:!1)))}),l=Math.max.apply(Math,k3(s.map(function(c){return c.width}))),f=Math.max.apply(Math,k3(s.map(function(c){return c.height})));return new ue(l,f)}}]),e}(ee);$3.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:d.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:d.RANGE},{argumentType:d.INTEGER,minValue:1},{argumentType:d.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}],repeatLastArgs:1}};function _2(r){return _2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_2(r)}function $X(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function D3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function DX(r,t,e){return t&&D3(r.prototype,t),e&&D3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function LX(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&I2(r,t)}function I2(r,t){return I2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},I2(r,t)}function UX(r){var t=VX();return function(){var n=js(r),a;if(t){var i=js(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return xX(this,a)}}function xX(r,t){if(t&&(_2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BX(r)}function BX(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function VX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(r){return js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},js(r)}var L3=function(r){LX(e,r);var t=UX(e);function e(){return $X(this,e),t.apply(this,arguments)}return DX(e,[{key:"abs",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ABS"),Math.abs)}}]),e}(ee);L3.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:d.NUMBER}]}};function M2(r){return M2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M2(r)}function GX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function U3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function jX(r,t,e){return t&&U3(r.prototype,t),e&&U3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function HX(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&k2(r,t)}function k2(r,t){return k2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},k2(r,t)}function WX(r){var t=KX();return function(){var n=Hs(r),a;if(t){var i=Hs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return zX(this,a)}}function zX(r,t){if(t&&(M2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YX(r)}function YX(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function KX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hs(r){return Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hs(r)}var XX=281474976710655,x3=-53,B3=53,V3=function(r){HX(e,r);var t=WX(e);function e(){return GX(this,e),t.apply(this,arguments)}return jX(e,[{key:"bitlshift",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BITLSHIFT"),G3)}},{key:"bitrshift",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BITRSHIFT"),j3)}}]),e}(ee);V3.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:x3,maxValue:B3}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:x3,maxValue:B3}]}};function G3(r,t){return t<0?j3(r,-t):H3(r*Math.pow(2,t))}function j3(r,t){return t<0?G3(r,-t):H3(Math.floor(r/Math.pow(2,t)))}function H3(r){return r>XX?new m(E.NUM,S.BitshiftLong):r}function F2(r){return F2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F2(r)}function qX(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function W3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function QX(r,t,e){return t&&W3(r.prototype,t),e&&W3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ZX(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&P2(r,t)}function P2(r,t){return P2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},P2(r,t)}function JX(r){var t=rq();return function(){var n=Ws(r),a;if(t){var i=Ws(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return eq(this,a)}}function eq(r,t){if(t&&(F2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tq(r)}function tq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function rq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ws(r){return Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ws(r)}var z3=function(r){ZX(e,r);var t=JX(e);function e(){return qX(this,e),t.apply(this,arguments)}return QX(e,[{key:"bitand",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BITAND"),function(o,u){return o&u})}},{key:"bitor",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BITOR"),function(o,u){return o|u})}},{key:"bitxor",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BITXOR"),function(o,u){return o^u})}}]),e}(ee);z3.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:0}]}};function $2(r){return $2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$2(r)}function nq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Y3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function aq(r,t,e){return t&&Y3(r.prototype,t),e&&Y3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function iq(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&D2(r,t)}function D2(r,t){return D2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},D2(r,t)}function oq(r){var t=lq();return function(){var n=zs(r),a;if(t){var i=zs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return uq(this,a)}}function uq(r,t){if(t&&($2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sq(r)}function sq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function lq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(r){return zs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zs(r)}var K3=function(r){iq(e,r);var t=oq(e);function e(){return nq(this,e),t.apply(this,arguments)}return aq(e,[{key:"literalTrue",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TRUE"),function(){return!0})}},{key:"literalFalse",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FALSE"),function(){return!1})}},{key:"conditionalIf",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IF"),function(o,u,s){return o?u:s})}},{key:"and",value:function(a,i){return this.runFunction(a.args,i,this.metadata("AND"),function(){for(var o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];return!u.some(function(l){return!l})})}},{key:"or",value:function(a,i){return this.runFunction(a.args,i,this.metadata("OR"),function(){for(var o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];return u.some(function(l){return l})})}},{key:"not",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NOT"),function(o){return!o})}},{key:"xor",value:function(a,i){return this.runFunction(a.args,i,this.metadata("XOR"),function(){for(var o=0,u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];return s.forEach(function(f){f&&o++}),o%2==1})}},{key:"switch",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SWITCH"),function(u){for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];for(var c=l.length,h=0;h+1<c;h+=2)if(!(l[h]instanceof m)&&o.arithmeticHelper.eq(u,l[h]))return l[h+1];return h<c?l[h]:new m(E.NA,S.NoDefault)})}},{key:"iferror",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IFERROR"),function(o,u){return o instanceof m?u:o})}},{key:"ifna",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IFNA"),function(o,u){return o instanceof m&&o.type===E.NA?u:o})}},{key:"choose",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHOOSE"),function(o){return o>(arguments.length<=1?0:arguments.length-1)?new m(E.NUM,S.Selector):o-1+1<1||arguments.length<=o-1+1?void 0:arguments[o-1+1]})}}]),e}(ee);K3.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:d.BOOLEAN},{argumentType:d.SCALAR,passSubtype:!0},{argumentType:d.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:d.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:d.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:d.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:d.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:d.NOERROR},{argumentType:d.SCALAR,passSubtype:!0},{argumentType:d.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:d.SCALAR,passSubtype:!0},{argumentType:d.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:d.SCALAR,passSubtype:!0},{argumentType:d.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:d.INTEGER,minValue:1},{argumentType:d.SCALAR,passSubtype:!0}],repeatLastArgs:1}};var fq=z,cq=Math.ceil,hq=Math.floor;fq({target:"Math",stat:!0},{trunc:function(t){return(t>0?hq:cq)(t)}});var pq=z,dq=H,vq=Q,yq=na,mq=dq.RangeError,X3=String.fromCharCode,q3=String.fromCodePoint,gq=vq([].join),Eq=!!q3&&q3.length!=1;pq({target:"String",stat:!0,forced:Eq},{fromCodePoint:function(t){for(var e=[],n=arguments.length,a=0,i;n>a;){if(i=+arguments[a++],yq(i,1114111)!==i)throw mq(i+" is not a valid code point");e[a]=i<65536?X3(i):X3(((i-=65536)>>10)+55296,i%1024+56320)}return gq(e,"")}});function L2(r){return L2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L2(r)}function Rq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Q3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function bq(r,t,e){return t&&Q3(r.prototype,t),e&&Q3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Sq(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&U2(r,t)}function U2(r,t){return U2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},U2(r,t)}function Aq(r){var t=wq();return function(){var n=Ys(r),a;if(t){var i=Ys(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Tq(this,a)}}function Tq(r,t){if(t&&(L2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oq(r)}function Oq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function wq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ys(r){return Ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ys(r)}var Z3=function(r){Sq(e,r);var t=Aq(e);function e(){return Rq(this,e),t.apply(this,arguments)}return bq(e,[{key:"char",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHAR"),function(o){return o<1||o>=256?new m(E.VALUE,S.CharacterCodeBounds):String.fromCharCode(Math.trunc(o))})}},{key:"unichar",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHAR"),function(o){return o<1||o>=1114112?new m(E.VALUE,S.CharacterCodeBounds):String.fromCodePoint(Math.trunc(o))})}}]),e}(ee);Z3.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:d.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:d.NUMBER}]}};function x2(r){return x2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x2(r)}function Nq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function J3(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Cq(r,t,e){return t&&J3(r.prototype,t),e&&J3(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function _q(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&B2(r,t)}function B2(r,t){return B2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},B2(r,t)}function Iq(r){var t=Fq();return function(){var n=Ks(r),a;if(t){var i=Ks(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Mq(this,a)}}function Mq(r,t){if(t&&(x2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kq(r)}function kq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Fq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ks(r){return Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ks(r)}var eE=function(r){_q(e,r);var t=Iq(e);function e(){return Nq(this,e),t.apply(this,arguments)}return Cq(e,[{key:"code",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CODE"),function(o){return o.length===0?new m(E.VALUE,S.EmptyString):o.charCodeAt(0)})}},{key:"unicode",value:function(a,i){return this.runFunction(a.args,i,this.metadata("UNICODE"),function(o){var u;return(u=o.codePointAt(0))!==null&&u!==void 0?u:new m(E.VALUE,S.EmptyString)})}}]),e}(ee);eE.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:d.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:d.STRING}]}};function V2(r){return V2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V2(r)}function Pq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function tE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function $q(r,t,e){return t&&tE(r.prototype,t),e&&tE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Dq(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&G2(r,t)}function G2(r,t){return G2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},G2(r,t)}function Lq(r){var t=Bq();return function(){var n=Xs(r),a;if(t){var i=Xs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Uq(this,a)}}function Uq(r,t){if(t&&(V2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xq(r)}function xq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Bq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xs(r){return Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xs(r)}var rE=function(r){Dq(e,r);var t=Lq(e);function e(){return Pq(this,e),t.apply(this,arguments)}return $q(e,[{key:"countblank",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COUNTBLANK"),function(){for(var o=0,u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];return s.forEach(function(f){f===ne&&o++}),o})}}]),e}(ee);rE.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:d.SCALAR}],repeatLastArgs:1,expandRanges:!0}};function j2(r){return j2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j2(r)}function Vq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function nE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Gq(r,t,e){return t&&nE(r.prototype,t),e&&nE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function jq(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&H2(r,t)}function H2(r,t){return H2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},H2(r,t)}function Hq(r){var t=Yq();return function(){var n=qs(r),a;if(t){var i=qs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Wq(this,a)}}function Wq(r,t){if(t&&(j2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zq(r)}function zq(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Yq(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qs(r){return qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qs(r)}var aE=function(r){jq(e,r);var t=Hq(e);function e(){return Vq(this,e),t.apply(this,arguments)}return Gq(e,[{key:"countunique",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COUNTUNIQUE"),function(){for(var o=new Set,u=new Set,s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];for(var c=0,h=l;c<h.length;c++){var p=h[c];p instanceof m?u.add(p.type):p!==""&&o.add(p)}return o.size+u.size})}}]),e}(ee);aE.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:d.SCALAR}],repeatLastArgs:1,expandRanges:!0}};function W2(r){return W2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W2(r)}function Kq(r){return Qq(r)||qq(r)||z2(r)||Xq()}function Xq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qq(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Qq(r){if(Array.isArray(r))return Y2(r)}function iE(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=z2(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Zq(r,t){return tQ(r)||eQ(r,t)||z2(r,t)||Jq()}function Jq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z2(r,t){if(!!r){if(typeof r=="string")return Y2(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Y2(r,t)}}function Y2(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function eQ(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function tQ(r){if(Array.isArray(r))return r}function rQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function oE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function nQ(r,t,e){return t&&oE(r.prototype,t),e&&oE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function aQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&K2(r,t)}function K2(r,t){return K2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},K2(r,t)}function iQ(r){var t=sQ();return function(){var n=Qs(r),a;if(t){var i=Qs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return oQ(this,a)}}function oQ(r,t){if(t&&(W2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uQ(r)}function uQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function sQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qs(r){return Qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qs(r)}var uE=function(r){aQ(e,r);var t=iQ(e);function e(){var n;return rQ(this,e),n=t.apply(this,arguments),n.isoweeknumCore=function(a){var i=Math.floor(n.dateTimeHelper.relativeNumberToAbsoluteNumber(a)),o=n.dateTimeHelper.numberToSimpleDate(a),u=n.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),s=n.dateTimeHelper.relativeNumberToAbsoluteNumber(u),l=s+((4-s)%7+7)%7,f=Math.floor((i-1)/7)-Math.floor((l-1)/7)+1;return f===0?n.isoweeknumCore(a-7)+1:f},n.days360Core=function(a,i,o){var u=n.dateTimeHelper.numberToSimpleDate(a),s=n.dateTimeHelper.numberToSimpleDate(i),l,f;if(o)l=F4(u),f=F4(s);else{var c=n.dateTimeHelper.toBasisUS(u,s),h=Zq(c,2);l=h[0],f=h[1]}return 360*(f.year-l.year)+30*(f.month-l.month)+f.day-l.day},n}return nQ(e,[{key:"date",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("DATE"),function(u,s,l){var f=Math.trunc(l),c=Math.trunc(s),h=Math.trunc(u);h<o.dateTimeHelper.getEpochYearZero()&&(h+=o.dateTimeHelper.getEpochYearZero());var p=Math.floor((c-1)/12);h+=p,c-=p*12;var y={year:h,month:c,day:1};if(o.dateTimeHelper.isValidDate(y)){var v=o.dateTimeHelper.dateToNumber(y)+(f-1);return v=o.dateTimeHelper.getWithinBounds(v),v===void 0?new m(E.NUM,S.DateBounds):v}return new m(E.VALUE,S.InvalidDate)})}},{key:"time",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TIME"),function(o,u,s){var l=$a({hours:Math.trunc(o),minutes:Math.trunc(u),seconds:Math.trunc(s)});return l<0?new m(E.NUM,S.NegativeTime):l%1})}},{key:"eomonth",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("EOMONTH"),function(u,s){var l=o.dateTimeHelper.numberToSimpleDate(u),f=o.dateTimeHelper.dateToNumber(o.dateTimeHelper.endOfMonth(k4(l,s)));return f=o.dateTimeHelper.getWithinBounds(f),f===void 0?new m(E.NUM,S.DateBounds):f})}},{key:"day",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("DAY"),function(u){return o.dateTimeHelper.numberToSimpleDate(u).day})}},{key:"days",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DAYS"),function(o,u){return Math.trunc(o)-Math.trunc(u)})}},{key:"month",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MONTH"),function(u){return o.dateTimeHelper.numberToSimpleDate(u).month})}},{key:"year",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("YEAR"),function(u){return o.dateTimeHelper.numberToSimpleDate(u).year})}},{key:"hour",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HOUR"),function(o){return Pa(I1(o)%1).hours})}},{key:"minute",value:function(a,i){return this.runFunction(a.args,i,this.metadata("MINUTE"),function(o){return Pa(I1(o)%1).minutes})}},{key:"second",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SECOND"),function(o){return Pa(I1(o)%1).seconds})}},{key:"text",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TEXT"),function(u,s){return fH(u,s,o.config,o.dateTimeHelper)})}},{key:"weekday",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("WEEKDAY"),function(u,s){var l=Math.floor(o.dateTimeHelper.relativeNumberToAbsoluteNumber(u));if(s===3)return(l-1)%7;var f=fE.get(s);return f===void 0?new m(E.NUM,S.BadMode):(l-f)%7+1})}},{key:"weeknum",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("WEEKNUM"),function(u,s){var l=Math.floor(o.dateTimeHelper.relativeNumberToAbsoluteNumber(u)),f=o.dateTimeHelper.numberToSimpleDate(u),c=o.dateTimeHelper.dateToNumber({year:f.year,month:1,day:1}),h=o.dateTimeHelper.relativeNumberToAbsoluteNumber(c);if(s===21)return o.isoweeknumCore(u);var p=fE.get(s);return p===void 0?new m(E.NUM,S.BadMode):Math.floor((l-p)/7)-Math.floor((h-p)/7)+1})}},{key:"isoweeknum",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("DATEVALUE"),function(u){var s=o.dateTimeHelper.parseDateTimeFromConfigFormats(u),l=s.dateTime;return l===void 0?new m(E.VALUE,S.IncorrectDateTime):io(l)?(M4(l)?Math.trunc($a(l)):0)+o.dateTimeHelper.dateToNumber(l):0})}},{key:"timevalue",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TIMEVALUE"),function(u){var s=o.dateTimeHelper.dateStringToDateNumber(u);return s===void 0?new m(E.VALUE,S.IncorrectDateTime):F(s)%1})}},{key:"now",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("NOW"),function(){var u=new Date(Date.now());return $a({hours:u.getHours(),minutes:u.getMinutes(),seconds:u.getSeconds()})+o.dateTimeHelper.dateToNumber({year:u.getFullYear(),month:u.getMonth()+1,day:u.getDate()})})}},{key:"today",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TODAY"),function(){var u=new Date(Date.now());return o.dateTimeHelper.dateToNumber({year:u.getFullYear(),month:u.getMonth()+1,day:u.getDate()})})}},{key:"edate",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("EDATE"),function(u,s){var l=o.dateTimeHelper.numberToSimpleDate(u),f=Bj(k4(l,s)),c=o.dateTimeHelper.dateToNumber(f);return c=o.dateTimeHelper.getWithinBounds(c),c===void 0?new m(E.NUM,S.DateBounds):c})}},{key:"datedif",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("DATEDIF"),function(u,s,l){if(u>s)return new m(E.NUM,S.StartEndDate);if(l==="D")return Math.floor(s)-Math.floor(u);var f=o.dateTimeHelper.numberToSimpleDate(u),c=o.dateTimeHelper.numberToSimpleDate(s);switch(l){case"M":return(c.year-f.year)*12+(c.month-f.month)-(c.day<f.day?1:0);case"YM":return(12+(c.month-f.month)-(c.day<f.day?1:0))%12;case"Y":return c.month>f.month||c.month===f.month&&c.day>=f.day?c.year-f.year:c.year-f.year-1;case"MD":if(c.day>=f.day)return c.day-f.day;var h=c.month===1?12:c.month-1,p=c.month===1?c.year-1:c.year;return o.dateTimeHelper.daysInMonth(p,h)+c.day-f.day;case"YD":return c.month>f.month||c.month===f.month&&c.day>=f.day?Math.floor(s)-o.dateTimeHelper.dateToNumber({year:c.year,month:f.month,day:f.day}):Math.floor(s)-Math.floor(u)-365*(c.year-f.year-1)-o.dateTimeHelper.leapYearsCount(c.year-1)+o.dateTimeHelper.leapYearsCount(f.year);default:return new m(E.NUM,S.BadMode)}})}},{key:"days360",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("YEARFRAC"),function(u,s,l){if(u=Math.trunc(u),s=Math.trunc(s),u>s){var f=[s,u];u=f[0],s=f[1]}switch(l){case 0:return o.days360Core(u,s,!1)/360;case 1:return(s-u)/o.dateTimeHelper.yearLengthForBasis(o.dateTimeHelper.numberToSimpleDate(u),o.dateTimeHelper.numberToSimpleDate(s));case 2:return(s-u)/360;case 3:return(s-u)/365;case 4:return o.days360Core(u,s,!0)/360}throw new Error("Should not be reachable.")})}},{key:"interval",value:function(a,i){return this.runFunction(a.args,i,this.metadata("INTERVAL"),function(o){o=Math.trunc(o);var u=o%60;o=Math.trunc(o/60);var s=o%60;o=Math.trunc(o/60);var l=o%24;o=Math.trunc(o/24);var f=o%30;o=Math.trunc(o/30);var c=o%12,h=Math.trunc(o/12);return"P"+(h>0?h+"Y":"")+(c>0?c+"M":"")+(f>0?f+"D":"")+"T"+(l>0?l+"H":"")+(s>0?s+"M":"")+(u>0?u+"S":"")})}},{key:"networkdays",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("NETWORKDAYS"),function(u,s,l){return o.networkdayscore(u,s,1,l)})}},{key:"networkdaysintl",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("NETWORKDAYS.INTL"),function(u,s,l,f){return o.networkdayscore(u,s,l,f)})}},{key:"workday",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("WORKDAY"),function(u,s,l){return o.workdaycore(u,s,1,l)})}},{key:"workdayintl",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("WORKDAY.INTL"),function(u,s,l,f){return o.workdaycore(u,s,l,f)})}},{key:"networkdayscore",value:function(a,i,o,u){a=Math.trunc(a),i=Math.trunc(i);var s=1;if(a>i){var l=[i,a];a=l[0],i=l[1],s=-1}var f=lE(o);if(f instanceof m)return f;var c=this.simpleRangeToFilteredHolidays(f,u);return c instanceof m?c:s*this.countWorkdays(a,i,f,c)}},{key:"workdaycore",value:function(a,i,o,u){a=Math.trunc(a),i=Math.trunc(i);var s=lE(o);if(s instanceof m)return s;var l=this.simpleRangeToFilteredHolidays(s,u);if(l instanceof m)return l;if(i>0){for(var f=1;this.countWorkdays(a+1,a+f,s,l)<i;)f*=2;for(var c=1;c+1<f;){var h=Math.trunc((c+f)/2);this.countWorkdays(a+1,a+h,s,l)<i?c=h:f=h}return a+f}else if(i<0){i*=-1;for(var p=1;this.countWorkdays(a-p,a-1,s,l)<i;)p*=2;for(var y=1;y+1<p;){var v=Math.trunc((y+p)/2);this.countWorkdays(a-v,a-1,s,l)<i?y=v:p=v}return a-p}else return a}},{key:"countWorkdays",value:function(a,i,o,u){for(var s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(i)),l=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)),f=0,c=0;c<7;c++)o.charAt(c)==="0"&&(f+=Math.floor((s+6-c)/7),f-=Math.floor((l-1+6-c)/7));return f-=sE(i+1,u)-sE(a,u),f}},{key:"simpleRangeToFilteredHolidays",value:function(a,i){var o=this,u,s=(u=i==null?void 0:i.valuesFromTopLeftCorner())!==null&&u!==void 0?u:[],l=iE(s),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;if(c instanceof m)return c}}catch(R){l.e(R)}finally{l.f()}var h=[],p=iE(s),y;try{for(p.s();!(y=p.n()).done;){var v=y.value;if(v!==ne)if(de(v))h.push(Math.trunc(F(v)));else return new m(E.VALUE,S.WrongType)}}catch(R){p.e(R)}finally{p.f()}return Kq(new Set(h)).sort(function(R,g){return R-g}).filter(function(R){var g=o.dateTimeHelper.relativeNumberToAbsoluteNumber(R),A=(g-1)%7;return a.charAt(A)==="0"})}}]),e}(ee);uE.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:d.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:d.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:d.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:d.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:d.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:d.NUMBER},{argumentType:d.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:d.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:d.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:d.STRING}],returnNumberType:U.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:d.STRING}],returnNumberType:U.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:U.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:U.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:d.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NOERROR,defaultValue:1},{argumentType:d.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER},{argumentType:d.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER},{argumentType:d.NOERROR,defaultValue:1},{argumentType:d.RANGE,optionalArg:!0}]}};function sE(r,t){if(t.length===0||r<=t[0])return 0;if(t[t.length-1]<r)return t.length;for(var e=0,n=t.length-1;e+1<n;){var a=Math.floor((n+e)/2);t[a]>=r?n=a:e=a}return n}function lE(r){var t;return typeof r!="number"&&typeof r!="string"?new m(E.VALUE,S.WrongType):typeof r=="string"?r.length!==7||!/^(0|1)*$/.test(r)||r==="1111111"?new m(E.NUM,S.WeekendString):r:(t=lQ.get(r))!==null&&t!==void 0?t:new m(E.NUM,S.BadMode)}var fE=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),lQ=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);function X2(r){return X2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X2(r)}function fQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function cE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function cQ(r,t,e){return t&&cE(r.prototype,t),e&&cE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function hQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&q2(r,t)}function q2(r,t){return q2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},q2(r,t)}function pQ(r){var t=yQ();return function(){var n=Zs(r),a;if(t){var i=Zs(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return dQ(this,a)}}function dQ(r,t){if(t&&(X2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vQ(r)}function vQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function yQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zs(r){return Zs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zs(r)}var hE=function(r){hQ(e,r);var t=pQ(e);function e(){return fQ(this,e),t.apply(this,arguments)}return cQ(e,[{key:"degrees",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DEGREES"),function(o){return o*(180/Math.PI)})}}]),e}(ee);hE.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:d.NUMBER}]}};function Q2(r){return Q2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q2(r)}function mQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function pE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function gQ(r,t,e){return t&&pE(r.prototype,t),e&&pE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function EQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Z2(r,t)}function Z2(r,t){return Z2=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Z2(r,t)}function RQ(r){var t=AQ();return function(){var n=Js(r),a;if(t){var i=Js(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return bQ(this,a)}}function bQ(r,t){if(t&&(Q2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SQ(r)}function SQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function AQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(r){return Js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Js(r)}var dE=function(r){EQ(e,r);var t=RQ(e);function e(){return mQ(this,e),t.apply(this,arguments)}return gQ(e,[{key:"delta",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DELTA"),function(o,u){return o===u?1:0})}}]),e}(ee);dE.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0}]}};function J2(r){return J2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J2(r)}function TQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function vE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function OQ(r,t,e){return t&&vE(r.prototype,t),e&&vE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function wQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&ep(r,t)}function ep(r,t){return ep=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},ep(r,t)}function NQ(r){var t=IQ();return function(){var n=el(r),a;if(t){var i=el(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return CQ(this,a)}}function CQ(r,t){if(t&&(J2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Q(r)}function _Q(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function IQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function el(r){return el=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},el(r)}var yE=function(r){wQ(e,r);var t=NQ(e);function e(){return TQ(this,e),t.apply(this,arguments)}return OQ(e,[{key:"exp",value:function(a,i){return this.runFunction(a.args,i,this.metadata("EXP"),Math.exp)}}]),e}(ee);yE.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:d.NUMBER}]}};function tp(r){return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(r)}function co(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=MQ(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function MQ(r,t){if(!!r){if(typeof r=="string")return mE(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mE(r,t)}}function mE(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function kQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function gE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function FQ(r,t,e){return t&&gE(r.prototype,t),e&&gE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function PQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&rp(r,t)}function rp(r,t){return rp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},rp(r,t)}function $Q(r){var t=UQ();return function(){var n=tl(r),a;if(t){var i=tl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return DQ(this,a)}}function DQ(r,t){if(t&&(tp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LQ(r)}function LQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function UQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(r){return tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tl(r)}var EE=function(r){PQ(e,r);var t=$Q(e);function e(){return kQ(this,e),t.apply(this,arguments)}return FQ(e,[{key:"pmt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PMT"),np)}},{key:"ipmt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IPMT"),ap)}},{key:"ppmt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PPMT"),RE)}},{key:"fv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FV"),ip)}},{key:"cumipmt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CUMIPMT"),function(o,u,s,l,f,c){if(l>f)return new m(E.NUM,S.EndStartPeriod);for(var h=0,p=l;p<=f;p++)h+=ap(o,p,u,s,0,c);return h})}},{key:"cumprinc",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CUMPRINC"),function(o,u,s,l,f,c){if(l>f)return new m(E.NUM,S.EndStartPeriod);for(var h=0,p=l;p<=f;p++)h+=RE(o,p,u,s,0,c);return h})}},{key:"db",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DB"),function(o,u,s,l,f){if(f===12&&l>s||l>s+1)return new m(E.NUM,S.PeriodLong);if(u>=o)return 0;var c=Math.round((1-Math.pow(u/o,1/s))*1e3)/1e3,h=o*c*f/12;if(l===1)return h;for(var p=h,y=0;y<l-2;y++)p+=(o-p)*c;return l===s+1?(o-p)*c*(12-f)/12:(o-p)*c})}},{key:"ddb",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DDB"),function(o,u,s,l,f){if(l>s)return new m(E.NUM);var c=f/s,h;c>=1?(c=1,l===1?h=o:h=0):h=o*Math.pow(1-c,l-1);var p=o*Math.pow(1-c,l);return Math.max(h-Math.max(u,p),0)})}},{key:"dollarde",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DOLLARDE"),function(o,u){if(u<1)return new m(E.DIV_BY_ZERO);for(u=Math.trunc(u);u>10;)u/=10;return Math.trunc(o)+(o-Math.trunc(o))*10/u})}},{key:"dollarfr",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DOLLARFR"),function(o,u){if(u<1)return new m(E.DIV_BY_ZERO);for(u=Math.trunc(u);u>10;)u/=10;return Math.trunc(o)+(o-Math.trunc(o))*u/10})}},{key:"effect",value:function(a,i){return this.runFunction(a.args,i,this.metadata("EFFECT"),function(o,u){return u=Math.trunc(u),Math.pow(1+o/u,u)-1})}},{key:"ispmt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISPMT"),function(o,u,s,l){return s===0?new m(E.DIV_BY_ZERO):l*o*(u/s-1)})}},{key:"nominal",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NOMINAL"),function(o,u){return u=Math.trunc(u),(Math.pow(o+1,1/u)-1)*u})}},{key:"nper",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NPER"),function(o,u,s,l,f){return o===0?u===0?new m(E.DIV_BY_ZERO):(-s-l)/u:(f&&(u*=1+o),Math.log((u-l*o)/(s*o+u))/Math.log(1+o))})}},{key:"rate",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RATE"),function(o,u,s,l,f,c){if(c<=-1)return new m(E.VALUE);var h=1e-7,p=50,y=c;f=f?1:0;for(var v=0;v<p;v++){if(y<=-1)return new m(E.NUM);var R=void 0;if(Math.abs(y)<h)R=s*(1+o*y)+u*(1+y*f)*o+l;else{var g=Math.pow(1+y,o);R=s*g+u*(1/y+f)*(g-1)+l}if(Math.abs(R)<h)return y;var A=void 0;if(Math.abs(y)<h)A=s*o+u*f*o;else{var T=Math.pow(1+y,o),N=o*Math.pow(1+y,o-1);A=s*N+u*(1/y+f)*N+u*(-1/(y*y))*(T-1)}y-=R/A}return new m(E.NUM)})}},{key:"pv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PV"),function(o,u,s,l,f){return f=f?1:0,o===-1?u===0?new m(E.NUM):new m(E.DIV_BY_ZERO):o===0?-s*u-l:((1-Math.pow(1+o,u))*s*(1+o*f)/o-l)/Math.pow(1+o,u)})}},{key:"rri",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RRI"),function(o,u,s){return u===0||s<0&&u>0||s>0&&u<0?new m(E.NUM):Math.pow(s/u,1/o)-1})}},{key:"sln",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SLN"),function(o,u,s){return s===0?new m(E.DIV_BY_ZERO):(o-u)/s})}},{key:"syd",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SYD"),function(o,u,s,l){return l>s?new m(E.NUM):(o-u)*(s-l+1)*2/(s*(s+1))})}},{key:"tbilleq",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TBILLEQ"),function(u,s,l){if(u=Math.round(u),s=Math.round(s),u>=s)return new m(E.NUM);var f=o.dateTimeHelper.numberToSimpleDate(u),c=o.dateTimeHelper.numberToSimpleDate(s);if(c.year>f.year+1||c.year===f.year+1&&(c.month>f.month||c.month===f.month&&c.day>f.day))return new m(E.NUM);var h=360-l*(s-u);return h===0?0:h<0?new m(E.NUM):365*l/h})}},{key:"tbillprice",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TBILLPRICE"),function(u,s,l){if(u=Math.round(u),s=Math.round(s),u>=s)return new m(E.NUM);var f=o.dateTimeHelper.numberToSimpleDate(u),c=o.dateTimeHelper.numberToSimpleDate(s);if(c.year>f.year+1||c.year===f.year+1&&(c.month>f.month||c.month===f.month&&c.day>f.day))return new m(E.NUM);var h=360-l*(s-u);return h===0?0:h<0?new m(E.NUM):100*(1-l*(s-u)/360)})}},{key:"tbillyield",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("TBILLYIELD"),function(u,s,l){if(u=Math.round(u),s=Math.round(s),u>=s)return new m(E.NUM);var f=o.dateTimeHelper.numberToSimpleDate(u),c=o.dateTimeHelper.numberToSimpleDate(s);return c.year>f.year+1||c.year===f.year+1&&(c.month>f.month||c.month===f.month&&c.day>f.day)?new m(E.NUM):(100-l)*360/(l*(s-u))})}},{key:"fvschedule",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FVSCHEDULE"),function(o,u){var s=u.valuesFromTopLeftCorner(),l=co(s),f;try{for(l.s();!(f=l.n()).done;){var c=f.value;if(c instanceof m)return c}}catch(v){l.e(v)}finally{l.f()}var h=co(s),p;try{for(h.s();!(p=h.n()).done;){var y=p.value;if(de(y))o*=1+F(y);else if(y!==ne)return new m(E.VALUE,S.NumberExpected)}}catch(v){h.e(v)}finally{h.f()}return o})}},{key:"npv",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("NPV"),function(u){for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];var c=o.arithmeticHelper.coerceNumbersExactRanges(l);return c instanceof m?c:op(u,c)})}},{key:"mirr",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MIRR"),function(u,s,l){var f=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner());if(f instanceof m)return f;var c=!1,h=!1,p=[],y=[],v=co(f),R;try{for(v.s();!(R=v.n()).done;){var g=R.value;g>0?(c=!0,p.push(g),y.push(0)):g<0?(h=!0,y.push(g),p.push(0)):(y.push(0),p.push(0))}}catch(M){v.e(M)}finally{v.f()}if(!c||!h)return new m(E.DIV_BY_ZERO);var A=f.length,T=op(l,p);if(T instanceof m)return T;var N=op(s,y);return N instanceof m?N:Math.pow(-T*Math.pow(1+l,A)/N/(1+s),1/(A-1))-1})}},{key:"pduration",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PDURATION"),function(o,u,s){return(Math.log(s)-Math.log(u))/Math.log(1+o)})}},{key:"xnpv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("XNPV"),function(o,u,s){var l=u.valuesFromTopLeftCorner(),f=co(l),c;try{for(f.s();!(c=f.n()).done;){var h=c.value;if(typeof h!="number")return new m(E.VALUE,S.NumberExpected)}}catch(_){f.e(_)}finally{f.f()}var p=l,y=s.valuesFromTopLeftCorner(),v=co(y),R;try{for(v.s();!(R=v.n()).done;){var g=R.value;if(typeof g!="number")return new m(E.VALUE,S.NumberExpected)}}catch(_){v.e(_)}finally{v.f()}var A=y;if(A.length!==p.length)return new m(E.NUM,S.EqualLength);var T=A.length,N=0;if(A[0]<0)return new m(E.NUM,S.ValueSmall);for(var M=0;M<T;M++){if(A[M]=Math.floor(A[M]),A[M]<A[0])return new m(E.NUM,S.ValueSmall);N+=p[M]/Math.pow(1+o,(A[M]-A[0])/365)}return N})}}]),e}(ee);EE.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}],returnNumberType:U.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}],returnNumberType:U.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}],returnNumberType:U.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}],returnNumberType:U.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.INTEGER,minValue:1},{argumentType:d.INTEGER,minValue:1},{argumentType:d.INTEGER,minValue:0,maxValue:1}],returnNumberType:U.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.INTEGER,minValue:1},{argumentType:d.INTEGER,minValue:1},{argumentType:d.INTEGER,minValue:0,maxValue:1}],returnNumberType:U.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:0},{argumentType:d.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:U.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.INTEGER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:U.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1}],returnNumberType:U.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1}],returnNumberType:U.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0}],returnNumberType:U.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:.1}],returnNumberType:U.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0}],returnNumberType:U.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0}],returnNumberType:U.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0}],returnNumberType:U.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0}],returnNumberType:U.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:d.NUMBER},{argumentType:d.RANGE}],returnNumberType:U.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:d.NUMBER},{argumentType:d.ANY}],repeatLastArgs:1,returnNumberType:U.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.NUMBER}],returnNumberType:U.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:d.NUMBER,greaterThan:-1},{argumentType:d.RANGE},{argumentType:d.RANGE}]}};function np(r,t,e,n,a){if(r===0)return(-e-n)/t;var i=Math.pow(1+r,t);return(n*r+e*r*i)*(a?1/(1+r):1)/(1-i)}function ap(r,t,e,n,a,i){var o=np(r,e,n,a,i);return t===1?r*(i?0:-n):r*(i?ip(r,t-2,o,n,i)-o:ip(r,t-1,o,n,i))}function ip(r,t,e,n,a){if(r===0)return-n-e*t;var i=Math.pow(1+r,t);return e*(a?1+r:1)*(1-i)/r-n*i}function RE(r,t,e,n,a,i){return np(r,e,n,a,i)-ap(r,t,e,n,a,i)}function op(r,t){for(var e=0,n=t.length-1;n>=0;n--){if(e+=t[n],r===-1){if(e===0)continue;return new m(E.DIV_BY_ZERO)}e/=1+r}return e}function up(r){return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(r)}function xQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function BQ(r,t,e){return t&&bE(r.prototype,t),e&&bE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function VQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&sp(r,t)}function sp(r,t){return sp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},sp(r,t)}function GQ(r){var t=WQ();return function(){var n=rl(r),a;if(t){var i=rl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return jQ(this,a)}}function jQ(r,t){if(t&&(up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HQ(r)}function HQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function WQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rl(r){return rl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rl(r)}var SE=function(r){VQ(e,r);var t=GQ(e);function e(){return xQ(this,e),t.apply(this,arguments)}return BQ(e,[{key:"formulatext",value:function(a,i){var o=this;return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("FORMULATEXT"),function(){return new m(E.NA,S.WrongArgNumber)},function(u){var s;return(s=o.serialization.getCellFormula(u))!==null&&s!==void 0?s:new m(E.NA,S.Formula)})}}]),e}(ee);SE.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:d.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};function lp(r){return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(r)}function zQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function AE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function YQ(r,t,e){return t&&AE(r.prototype,t),e&&AE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function KQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&fp(r,t)}function fp(r,t){return fp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},fp(r,t)}function XQ(r){var t=ZQ();return function(){var n=nl(r),a;if(t){var i=nl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return qQ(this,a)}}function qQ(r,t){if(t&&(lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QQ(r)}function QQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ZQ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nl(r){return nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nl(r)}var TE=function(r){KQ(e,r);var t=XQ(e);function e(){return zQ(this,e),t.apply(this,arguments)}return YQ(e,[{key:"isbinary",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISBINARY"),function(o){return/^[01]{1,10}$/.test(o)})}},{key:"iserr",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISERR"),function(o){return o instanceof m&&o.type!==E.NA})}},{key:"iserror",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISERROR"),function(o){return o instanceof m})}},{key:"isformula",value:function(a,i){var o=this;return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("ISFORMULA"),function(){return new m(E.NA,S.WrongArgNumber)},function(u){var s=o.dependencyGraph.addressMapping.getCell(u);return s instanceof jt})}},{key:"isblank",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISBLANK"),function(o){return o===ne})}},{key:"isna",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISNA"),function(o){return o instanceof m&&o.type==E.NA})}},{key:"isnumber",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISNUMBER"),de)}},{key:"islogical",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISLOGICAL"),function(o){return typeof o=="boolean"})}},{key:"isref",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISREF"),function(o){return o instanceof m&&(o.type==E.REF||o.type==E.CYCLE)})}},{key:"istext",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISTEXT"),function(o){return typeof o=="string"})}},{key:"isnontext",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISNONTEXT"),function(o){return typeof o!="string"})}},{key:"column",value:function(a,i){return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("COLUMN"),function(){return i.formulaAddress.col+1},function(o){return o.col+1})}},{key:"columns",value:function(a,i){if(a.args.length!==1)return new m(E.NA,S.WrongArgNumber);if(a.args.some(function(s){return s.type===b.EMPTY}))return new m(E.NUM,S.EmptyArg);for(var o=a.args[0];o.type===b.PARENTHESIS;)o=o.expression;if(o.type===b.CELL_RANGE||o.type===b.COLUMN_RANGE)return o.end.col-o.start.col+1;if(o.type===b.CELL_REFERENCE)return 1;if(o.type===b.ROW_RANGE)return this.config.maxColumns;var u=this.evaluateAst(o,i);return u instanceof V?u.width():u instanceof m?u:1}},{key:"row",value:function(a,i){return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("ROW"),function(){return i.formulaAddress.row+1},function(o){return o.row+1})}},{key:"rows",value:function(a,i){if(a.args.length!==1)return new m(E.NA,S.WrongArgNumber);if(a.args.some(function(s){return s.type===b.EMPTY}))return new m(E.NUM,S.EmptyArg);for(var o=a.args[0];o.type===b.PARENTHESIS;)o=o.expression;if(o.type===b.CELL_RANGE||o.type===b.ROW_RANGE)return o.end.row-o.start.row+1;if(o.type===b.CELL_REFERENCE)return 1;if(o.type===b.COLUMN_RANGE)return this.config.maxRows;var u=this.evaluateAst(o,i);return u instanceof V?u.height():u instanceof m?u:1}},{key:"index",value:function(a,i){return this.runFunction(a.args,i,this.metadata("INDEX"),function(o,u,s){var l,f,c,h,p,y;return s<1||u<1?new m(E.VALUE,S.LessThanOne):s>o.width()||u>o.height()?new m(E.NUM,S.ValueLarge):(y=(c=(f=(l=o==null?void 0:o.data)===null||l===void 0?void 0:l[u-1])===null||f===void 0?void 0:f[s-1])!==null&&c!==void 0?c:(p=(h=o==null?void 0:o.data)===null||h===void 0?void 0:h[0])===null||p===void 0?void 0:p[0])!==null&&y!==void 0?y:new m(E.VALUE,S.CellRangeExpected)})}},{key:"na",value:function(a,i){return new m(E.NA)}},{key:"sheet",value:function(a,i){var o=this;return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("SHEET"),function(){return i.formulaAddress.sheet+1},function(u){return u.sheet+1},function(u){var s=o.dependencyGraph.sheetMapping.get(u);return s!==void 0?s+1:new m(E.NA,S.SheetRef)})}},{key:"sheets",value:function(a,i){var o=this;return this.runFunctionWithReferenceArgument(a.args,i,this.metadata("SHEETS"),function(){return o.dependencyGraph.sheetMapping.numberOfSheets()},function(){return 1},function(){return new m(E.VALUE,S.CellRefExpected)})}}]),e}(ee);TE.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:d.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:d.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:d.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:d.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:d.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:d.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:d.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:d.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:d.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:d.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:d.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:d.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:d.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:d.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:d.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:d.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:d.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};function cp(r){return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(r)}function JQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function OE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function eZ(r,t,e){return t&&OE(r.prototype,t),e&&OE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function tZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&hp(r,t)}function hp(r,t){return hp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},hp(r,t)}function rZ(r){var t=iZ();return function(){var n=al(r),a;if(t){var i=al(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return nZ(this,a)}}function nZ(r,t){if(t&&(cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aZ(r)}function aZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function iZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function al(r){return al=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},al(r)}var wE=function(r){tZ(e,r);var t=rZ(e);function e(){return JQ(this,e),t.apply(this,arguments)}return eZ(e,[{key:"iseven",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISEVEN"),function(o){return o%2==0})}}]),e}(ee);wE.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:d.NUMBER}]}};function pp(r){return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(r)}function oZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function NE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function uZ(r,t,e){return t&&NE(r.prototype,t),e&&NE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function sZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&dp(r,t)}function dp(r,t){return dp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},dp(r,t)}function lZ(r){var t=hZ();return function(){var n=il(r),a;if(t){var i=il(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return fZ(this,a)}}function fZ(r,t){if(t&&(pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cZ(r)}function cZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function hZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function il(r){return il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},il(r)}var CE=function(r){sZ(e,r);var t=lZ(e);function e(){return oZ(this,e),t.apply(this,arguments)}return uZ(e,[{key:"isodd",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ISODD"),function(o){return o%2==1})}}]),e}(ee);CE.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:d.NUMBER}]}};function vp(r){return vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(r)}function pZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _E(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function dZ(r,t,e){return t&&_E(r.prototype,t),e&&_E(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function vZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&yp(r,t)}function yp(r,t){return yp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},yp(r,t)}function yZ(r){var t=EZ();return function(){var n=ol(r),a;if(t){var i=ol(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return mZ(this,a)}}function mZ(r,t){if(t&&(vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gZ(r)}function gZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function EZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ol(r){return ol=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ol(r)}var IE=function(r){vZ(e,r);var t=yZ(e);function e(){return pZ(this,e),t.apply(this,arguments)}return dZ(e,[{key:"log10",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LOG"),function(o,u){return Math.log(o)/Math.log(u)})}},{key:"ln",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LN"),Math.log)}}]),e}(ee);IE.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:d.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:d.NUMBER}]}};function mp(r){return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(r)}function RZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function ME(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function bZ(r,t,e){return t&&ME(r.prototype,t),e&&ME(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function SZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&gp(r,t)}function gp(r,t){return gp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},gp(r,t)}function AZ(r){var t=wZ();return function(){var n=ul(r),a;if(t){var i=ul(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return TZ(this,a)}}function TZ(r,t){if(t&&(mp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OZ(r)}function OZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function wZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ul(r){return ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ul(r)}var Ep=parseFloat(Math.PI.toFixed(14)),kE=function(r){SZ(e,r);var t=AZ(e);function e(){return RZ(this,e),t.apply(this,arguments)}return bZ(e,[{key:"pi",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PI"),function(){return Ep})}},{key:"sqrtpi",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SQRTPI"),function(o){return Math.sqrt(Ep*o)})}}]),e}(ee);kE.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:d.NUMBER,minValue:0}]}};function Rp(r){return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(r)}function FE(r,t){return IZ(r)||_Z(r,t)||CZ(r,t)||NZ()}function NZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CZ(r,t){if(!!r){if(typeof r=="string")return PE(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return PE(r,t)}}function PE(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function _Z(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function IZ(r){if(Array.isArray(r))return r}function MZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function $E(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function kZ(r,t,e){return t&&$E(r.prototype,t),e&&$E(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function FZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&bp(r,t)}function bp(r,t){return bp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},bp(r,t)}function PZ(r){var t=LZ();return function(){var n=sl(r),a;if(t){var i=sl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $Z(this,a)}}function $Z(r,t){if(t&&(Rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DZ(r)}function DZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function LZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sl(r){return sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sl(r)}function DE(r,t){return new ue(t.width,r.height)}function Sp(r,t,e){return new ue(1+(r.width-t)/e,1+(r.height-t)/e)}var LE=function(r){FZ(e,r);var t=PZ(e);function e(){return MZ(this,e),t.apply(this,arguments)}return kZ(e,[{key:"mmult",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MMULT"),function(u,s){if(!u.hasOnlyNumbers()||!s.hasOnlyNumbers())return new m(E.VALUE,S.NumberRange);if(s.height()!==u.width())return new m(E.VALUE,S.ArrayDimensions);var l=DE(u.size,s.size),f=o.createKernel(function(c,h,p){for(var y=0,v=0;v<p;++v)y+=c[this.thread.y][v]*h[v][this.thread.x];return y},l)(u.rawNumbers(),s.rawNumbers(),u.width());return V.onlyNumbers(f)})}},{key:"mmultArraySize",value:function(a,i){var o=this;if(a.args.length!==2)return ue.error();var u=this.metadata("MMULT"),s=a.args.map(function(h){var p;return o.arraySizeForAst(h,new Sr(i.formulaAddress,i.arraysFlag||((p=u==null?void 0:u.arrayFunction)!==null&&p!==void 0?p:!1)))}),l=FE(s,2),f=l[0],c=l[1];return DE(f,c)}},{key:"maxpool",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MAXPOOL"),function(u,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s;if(!u.hasOnlyNumbers())return new m(E.VALUE,S.NumberRange);var f=Sp(u.size,s,l),c=o.createKernel(function(h,p,y){for(var v=this.thread.x*y,R=this.thread.y*y,g=h[R][v],A=0;A<p;A++)for(var T=0;T<p;T++)g=Math.max(g,h[R+A][v+T]);return g},f)(u.rawNumbers(),s,l);return V.onlyNumbers(c)})}},{key:"medianpool",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MEDIANPOOL"),function(u,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s;if(!u.hasOnlyNumbers())return new m(E.VALUE,S.NumberRange);var f=Sp(u.size,s,l),c=o.createKernel(function(h,p,y){for(var v=this.thread.x*y,R=this.thread.y*y,g=h[R][v],A=0;A<p;A++)for(var T=0;T<p;T++)g=Math.max(g,h[R+A][v+T]);for(var N=h[R][v],M=0;M<p;M++)for(var _=0;_<p;_++)N=Math.min(N,h[R+M][v+_]);for(var $=p*p,x=N,D=g,K=42,Z=0;Z<32;Z++){for(var ie=(x+D)/2,q=0,le=0;le<p;le++)for(var pe=0;pe<p;pe++)h[R+le][v+pe]>ie&&q++;if(p%2==0)if(q===$/2){K=ie;break}else q>$/2?x=ie:D=ie;else if(q===($-1)/2){K=ie;break}else q>($-1)/2?x=ie:D=ie}return K},f)(u.rawNumbers(),s,l);return V.onlyNumbers(c)})}},{key:"maxpoolArraySize",value:function(a,i){var o=this;if(a.args.length<2||a.args.length>3)return ue.error();var u=this.metadata("MAXPOOL"),s=a.args.map(function(y){var v;return o.arraySizeForAst(y,new Sr(i.formulaAddress,i.arraysFlag||((v=u==null?void 0:u.arrayFunction)!==null&&v!==void 0?v:!1)))}),l=s[0],f=a.args[1],c;f.type===b.NUMBER?c=f.value:c=1;var h=c;if(a.args.length===3){var p=a.args[2];p.type===b.NUMBER?h=p.value:h=1}return c>l.width||c>l.height||h>c||(l.width-c)%h!=0||(l.height-c)%h!=0?ue.error():Sp(l,c,h)}},{key:"medianpoolArraySize",value:function(a,i){return this.maxpoolArraySize(a,i)}},{key:"transpose",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TRANSPOSE"),function(o){for(var u=o.rawData(),s=o.size,l=[],f=0;f<s.width;++f){l[f]=[];for(var c=0;c<s.height;++c)l[f][c]=u[c][f]}return V.onlyValues(l)})}},{key:"transposeArraySize",value:function(a,i){var o=this;if(a.args.length!==1)return ue.error();var u=this.metadata("MMULT"),s=a.args.map(function(c){var h;return o.arraySizeForAst(c,new Sr(i.formulaAddress,i.arraysFlag||((h=u==null?void 0:u.arrayFunction)!==null&&h!==void 0?h:!1)))}),l=FE(s,1),f=l[0];return new ue(f.height,f.width)}},{key:"createKernel",value:function(a,i){return function(){for(var o=[],u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];for(var f=0;f<i.height;++f){o.push([]);for(var c=0;c<i.width;++c)o[f][c]=a.apply({thread:{x:c,y:f}},s)}return o}}}]),e}(ee);LE.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:d.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};function Ap(r){return Ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ap(r)}function UZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function UE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function xZ(r,t,e){return t&&UE(r.prototype,t),e&&UE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function BZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Tp(r,t)}function Tp(r,t){return Tp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Tp(r,t)}function VZ(r){var t=HZ();return function(){var n=ll(r),a;if(t){var i=ll(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return GZ(this,a)}}function GZ(r,t){if(t&&(Ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jZ(r)}function jZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function HZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ll(r){return ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ll(r)}var xE=function(r){BZ(e,r);var t=VZ(e);function e(){return UZ(this,e),t.apply(this,arguments)}return xZ(e,[{key:"median",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MEDIAN"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);return f instanceof m?f:f.length===0?new m(E.NUM,S.OneValue):(f.sort(function(c,h){return c-h}),f.length%2==0?(f[f.length/2-1]+f[f.length/2])/2:f[Math.floor(f.length/2)])})}},{key:"large",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("LARGE"),function(u,s){var l=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner());return l instanceof m?l:(l.sort(function(f,c){return f-c}),s=Math.trunc(s),s>l.length?new m(E.NUM,S.ValueLarge):l[l.length-s])})}},{key:"small",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SMALL"),function(u,s){var l=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner());return l instanceof m?l:(l.sort(function(f,c){return f-c}),s=Math.trunc(s),s>l.length?new m(E.NUM,S.ValueLarge):l[s-1])})}}]),e}(ee);xE.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER,minValue:1}]}};function Op(r){return Op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Op(r)}function WZ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function BE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function zZ(r,t,e){return t&&BE(r.prototype,t),e&&BE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function YZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&wp(r,t)}function wp(r,t){return wp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},wp(r,t)}function KZ(r){var t=QZ();return function(){var n=fl(r),a;if(t){var i=fl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return XZ(this,a)}}function XZ(r,t){if(t&&(Op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qZ(r)}function qZ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function QZ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fl(r){return fl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fl(r)}var VE=function(r){YZ(e,r);var t=KZ(e);function e(){return WZ(this,e),t.apply(this,arguments)}return zZ(e,[{key:"mod",value:function(a,i){return this.runFunction(a.args,i,this.metadata("MOD"),function(o,u){return u===0?new m(E.DIV_BY_ZERO):o%u})}}]),e}(ee);VE.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]}};function Np(r){return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(r)}function GE(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=ZZ(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function ZZ(r,t){if(!!r){if(typeof r=="string")return jE(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return jE(r,t)}}function jE(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function JZ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Cp(r,t)}function Cp(r,t){return Cp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Cp(r,t)}function eJ(r){var t=nJ();return function(){var n=cl(r),a;if(t){var i=cl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return tJ(this,a)}}function tJ(r,t){if(t&&(Np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rJ(r)}function rJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function nJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(r){return cl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cl(r)}function HE(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function WE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function zE(r,t,e){return t&&WE(r.prototype,t),e&&WE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function hl(r){return de(r)&&!Number.isFinite(F(r))?0:r}var Rn=function(){function r(t,e,n){HE(this,r),this.sumsq=t,this.sum=e,this.count=n}return zE(r,[{key:"compose",value:function(e){return new r(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}},{key:"averageValue",value:function(){if(this.count>0)return this.sum/this.count}},{key:"varSValue",value:function(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}},{key:"varPValue",value:function(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}],[{key:"single",value:function(e){return new r(e*e,e,1)}}]),r}();Rn.empty=new Rn(0,0,0);var _p=function(r){JZ(e,r);var t=eJ(e);function e(){var n;return HE(this,e),n=t.apply(this,arguments),n.addWithEpsilonRaw=function(a,i){return n.arithmeticHelper.addWithEpsilonRaw(a,i)},n}return zE(e,[{key:"sum",value:function(a,i){return this.doSum(a.args,i)}},{key:"sumsq",value:function(a,i){return this.reduce(a.args,i,0,"SUMSQ",this.addWithEpsilonRaw,function(o){return Math.pow(F(o),2)},Ga)}},{key:"max",value:function(a,i){return this.doMax(a.args,i)}},{key:"maxa",value:function(a,i){var o=this.reduce(a.args,i,Number.NEGATIVE_INFINITY,"MAXA",function(u,s){return Math.max(u,s)},F,pl);return hl(o)}},{key:"min",value:function(a,i){return this.doMin(a.args,i)}},{key:"mina",value:function(a,i){var o=this.reduce(a.args,i,Number.POSITIVE_INFINITY,"MINA",function(u,s){return Math.min(u,s)},F,pl);return hl(o)}},{key:"count",value:function(a,i){return this.doCount(a.args,i)}},{key:"counta",value:function(a,i){return this.doCounta(a.args,i)}},{key:"average",value:function(a,i){return this.doAverage(a.args,i)}},{key:"averagea",value:function(a,i){var o,u=this.reduce(a.args,i,Rn.empty,"_AGGREGATE_A",function(s,l){return s.compose(l)},function(s){return Rn.single(F(s))},pl);return u instanceof m?u:(o=u.averageValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"vars",value:function(a,i){return this.doVarS(a.args,i)}},{key:"varp",value:function(a,i){return this.doVarP(a.args,i)}},{key:"vara",value:function(a,i){var o,u=this.reduceAggregateA(a.args,i);return u instanceof m?u:(o=u.varSValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"varpa",value:function(a,i){var o,u=this.reduceAggregateA(a.args,i);return u instanceof m?u:(o=u.varPValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"stdevs",value:function(a,i){return this.doStdevS(a.args,i)}},{key:"stdevp",value:function(a,i){return this.doStdevP(a.args,i)}},{key:"stdeva",value:function(a,i){var o=this.reduceAggregateA(a.args,i);if(o instanceof m)return o;var u=o.varSValue();return u===void 0?new m(E.DIV_BY_ZERO):Math.sqrt(u)}},{key:"stdevpa",value:function(a,i){var o=this.reduceAggregateA(a.args,i);if(o instanceof m)return o;var u=o.varPValue();return u===void 0?new m(E.DIV_BY_ZERO):Math.sqrt(u)}},{key:"product",value:function(a,i){return this.doProduct(a.args,i)}},{key:"subtotal",value:function(a,i){if(a.args.length<2)return new m(E.NA,S.WrongArgNumber);var o=this.coerceToType(this.evaluateAst(a.args[0],i),{argumentType:d.NUMBER},i),u=a.args.slice(1);switch(o){case 1:case 101:return this.doAverage(u,i);case 2:case 102:return this.doCount(u,i);case 3:case 103:return this.doCounta(u,i);case 4:case 104:return this.doMax(u,i);case 5:case 105:return this.doMin(u,i);case 6:case 106:return this.doProduct(u,i);case 7:case 107:return this.doStdevS(u,i);case 8:case 108:return this.doStdevP(u,i);case 9:case 109:return this.doSum(u,i);case 10:case 110:return this.doVarS(u,i);case 11:case 111:return this.doVarP(u,i);default:return new m(E.VALUE,S.BadMode)}}},{key:"reduceAggregate",value:function(a,i){return this.reduce(a,i,Rn.empty,"_AGGREGATE",function(o,u){return o.compose(u)},function(o){return Rn.single(F(o))},Ga)}},{key:"reduceAggregateA",value:function(a,i){return this.reduce(a,i,Rn.empty,"_AGGREGATE_A",function(o,u){return o.compose(u)},function(o){return Rn.single(F(o))},pl)}},{key:"doAverage",value:function(a,i){var o,u=this.reduceAggregate(a,i);return u instanceof m?u:(o=u.averageValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"doVarS",value:function(a,i){var o,u=this.reduceAggregate(a,i);return u instanceof m?u:(o=u.varSValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"doVarP",value:function(a,i){var o,u=this.reduceAggregate(a,i);return u instanceof m?u:(o=u.varPValue())!==null&&o!==void 0?o:new m(E.DIV_BY_ZERO)}},{key:"doStdevS",value:function(a,i){var o=this.reduceAggregate(a,i);if(o instanceof m)return o;var u=o.varSValue();return u===void 0?new m(E.DIV_BY_ZERO):Math.sqrt(u)}},{key:"doStdevP",value:function(a,i){var o=this.reduceAggregate(a,i);if(o instanceof m)return o;var u=o.varPValue();return u===void 0?new m(E.DIV_BY_ZERO):Math.sqrt(u)}},{key:"doCount",value:function(a,i){return this.reduce(a,i,0,"COUNT",function(o,u){return o+u},F,function(o){return de(o)?1:0})}},{key:"doCounta",value:function(a,i){return this.reduce(a,i,0,"COUNTA",function(o,u){return o+u},F,function(o){return o===ne?0:1})}},{key:"doMax",value:function(a,i){var o=this.reduce(a,i,Number.NEGATIVE_INFINITY,"MAX",function(u,s){return Math.max(u,s)},F,Ga);return hl(o)}},{key:"doMin",value:function(a,i){var o=this.reduce(a,i,Number.POSITIVE_INFINITY,"MIN",function(u,s){return Math.min(u,s)},F,Ga);return hl(o)}},{key:"doSum",value:function(a,i){return this.reduce(a,i,0,"SUM",this.addWithEpsilonRaw,F,Ga)}},{key:"doProduct",value:function(a,i){return this.reduce(a,i,1,"PRODUCT",function(o,u){return o*u},F,Ga)}},{key:"reduce",value:function(a,i,o,u,s,l,f){var c=this;return a.length<1?new m(E.NA,S.WrongArgNumber):a.reduce(function(h,p){if(h instanceof m)return h;if(p.type===b.CELL_RANGE||p.type===b.COLUMN_RANGE||p.type===b.ROW_RANGE){var y=c.evaluateRange(p,i,o,u,s,l,f);return y instanceof m?y:s(y,h)}var v;if(v=c.evaluateAst(p,i),v instanceof V){var R=Array.from(v.valuesFromTopLeftCorner()).map(f).filter(function(g){return g!==void 0});return R.map(function(g){return g instanceof m?g:l(g)}).reduce(function(g,A){return g instanceof m?g:A instanceof m?A:s(g,A)},h)}else if(p.type===b.CELL_REFERENCE){if(v=f(v),v===void 0)return h}else if(v=c.coerceScalarToNumberOrError(v),v=f(v),v===void 0)return h;return v instanceof m?v:s(h,l(v))},o)}},{key:"evaluateRange",value:function(a,i,o,u,s,l,f){var c;try{c=Y.fromAst(a,i.formulaAddress)}catch(g){if(g instanceof uu)return new m(E.REF,S.RangeManySheets);throw g}var h=c.start,p=c.end,y=this.dependencyGraph.getRange(h,p);if(y===void 0)throw new Error("Range does not exists in graph");var v=y.getFunctionValue(u);if(v===void 0){var R=this.getRangeValues(u,c,l,f);v=R.reduce(function(g,A){return g instanceof m?g:A instanceof m?A:s(g,A)},o),y.setFunctionValue(u,v)}return v}},{key:"getRangeValues",value:function(a,i,o,u){var s=[],l=this.dependencyGraph.rangeMapping.findSmallerRange(i),f=l.smallerRangeVertex,c=l.restRange,h=this.dependencyGraph.getRange(i.start,i.end),p;if(f!==void 0&&this.dependencyGraph.existsEdge(f,h)){var y=f.getFunctionValue(a);if(y!==void 0)s.push(y);else{var v=GE(f.range.addresses(this.dependencyGraph)),R;try{for(v.s();!(R=v.n()).done;){var g=R.value,A=u(this.dependencyGraph.getScalarValue(g));A instanceof m?s.push(A):A!==void 0&&s.push(o(A))}}catch($){v.e($)}finally{v.f()}}p=c}else p=i;var T=GE(p.addresses(this.dependencyGraph)),N;try{for(T.s();!(N=T.n()).done;){var M=N.value,_=u(this.dependencyGraph.getScalarValue(M));_ instanceof m?s.push(_):_!==void 0&&s.push(o(_))}}catch($){T.e($)}finally{T.f()}return s}}]),e}(ee);_p.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:d.NUMBER},{argumentType:d.ANY}],repeatLastArgs:1}};_p.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function Ga(r){if(de(r)||r instanceof m)return r}function pl(r){return typeof r=="boolean"?Jh(r):de(r)||r instanceof m?r:typeof r=="string"?0:void 0}function Ip(r){return Ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ip(r)}function aJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function YE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function iJ(r,t,e){return t&&YE(r.prototype,t),e&&YE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function oJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Mp(r,t)}function Mp(r,t){return Mp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Mp(r,t)}function uJ(r){var t=fJ();return function(){var n=dl(r),a;if(t){var i=dl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return sJ(this,a)}}function sJ(r,t){if(t&&(Ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lJ(r)}function lJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function fJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dl(r){return dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dl(r)}var KE=function(r){oJ(e,r);var t=uJ(e);function e(){return aJ(this,e),t.apply(this,arguments)}return iJ(e,[{key:"power",value:function(a,i){return this.runFunction(a.args,i,this.metadata("POWER"),Math.pow)}}]),e}(ee);KE.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]}};function kp(r){return kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kp(r)}function cJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function XE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function hJ(r,t,e){return t&&XE(r.prototype,t),e&&XE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function pJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Fp(r,t)}function Fp(r,t){return Fp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Fp(r,t)}function dJ(r){var t=mJ();return function(){var n=vl(r),a;if(t){var i=vl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return vJ(this,a)}}function vJ(r,t){if(t&&(kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yJ(r)}function yJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function mJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vl(r){return vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vl(r)}var qE=function(r){pJ(e,r);var t=dJ(e);function e(){return cJ(this,e),t.apply(this,arguments)}return hJ(e,[{key:"radians",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RADIANS"),function(o){return o*(Math.PI/180)})}}]),e}(ee);qE.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:d.NUMBER}]}};function Pp(r){return Pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp(r)}function gJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function QE(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function EJ(r,t,e){return t&&QE(r.prototype,t),e&&QE(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function RJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&$p(r,t)}function $p(r,t){return $p=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},$p(r,t)}function bJ(r){var t=TJ();return function(){var n=yl(r),a;if(t){var i=yl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return SJ(this,a)}}function SJ(r,t){if(t&&(Pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AJ(r)}function AJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function TJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yl(r){return yl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yl(r)}var ut=10,ZE=255,JE=2,e9=36,OJ="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",t9=function(r){RJ(e,r);var t=bJ(e);function e(){return gJ(this,e),t.apply(this,arguments)}return EJ(e,[{key:"dec2bin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DEC2BIN"),function(o,u){return Yr(o,2,u)})}},{key:"dec2oct",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DEC2OCT"),function(o,u){return Yr(o,8,u)})}},{key:"dec2hex",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DEC2HEX"),function(o,u){return Yr(o,16,u)})}},{key:"bin2dec",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BIN2DEC"),function(o){var u=Nr(o,2,ut);return u===void 0?new m(E.NUM,S.NotBinary):Kr(u,2)})}},{key:"bin2oct",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BIN2OCT"),function(o,u){var s=Nr(o,2,ut);return s===void 0?new m(E.NUM,S.NotBinary):Yr(Kr(s,2),8,u)})}},{key:"bin2hex",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BIN2HEX"),function(o,u){var s=Nr(o,2,ut);return s===void 0?new m(E.NUM,S.NotBinary):Yr(Kr(s,2),16,u)})}},{key:"oct2dec",value:function(a,i){return this.runFunction(a.args,i,this.metadata("OCT2DEC"),function(o){var u=Nr(o,8,ut);return u===void 0?new m(E.NUM,S.NotOctal):Kr(u,8)})}},{key:"oct2bin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("OCT2BIN"),function(o,u){var s=Nr(o,8,ut);return s===void 0?new m(E.NUM,S.NotOctal):Yr(Kr(s,8),2,u)})}},{key:"oct2hex",value:function(a,i){return this.runFunction(a.args,i,this.metadata("OCT2HEX"),function(o,u){var s=Nr(o,8,ut);return s===void 0?new m(E.NUM,S.NotOctal):Yr(Kr(s,8),16,u)})}},{key:"hex2dec",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HEX2DEC"),function(o){var u=Nr(o,16,ut);return u===void 0?new m(E.NUM,S.NotHex):Kr(u,16)})}},{key:"hex2bin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HEX2BIN"),function(o,u){var s=Nr(o,16,ut);return s===void 0?new m(E.NUM,S.NotHex):Yr(Kr(s,16),2,u)})}},{key:"hex2oct",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HEX2OCT"),function(o,u){var s=Nr(o,16,ut);return s===void 0?new m(E.NUM,S.NotHex):Yr(Kr(s,16),8,u)})}},{key:"base",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BASE"),NJ)}},{key:"decimal",value:function(a,i){return this.runFunction(a.args,i,this.metadata("DECIMAL"),function(o,u){var s=Nr(o,u,ZE);return s===void 0?new m(E.NUM,S.NotHex):parseInt(s,u)})}}]),e}(ee);t9.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:d.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:d.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:d.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ut}]},DECIMAL:{method:"decimal",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,minValue:JE,maxValue:e9}]},BASE:{method:"base",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:JE,maxValue:e9},{argumentType:d.NUMBER,optionalArg:!0,minValue:0,maxValue:ZE}]}};function Nr(r,t,e){var n=OJ.substr(0,t),a=new RegExp("^[".concat(n,"]+$"));if(!(r.length>e||!a.test(r)))return r}function Yr(r,t,e){if(r>wJ(t))return new m(E.NUM,S.ValueBaseLarge);if(r<r9(t))return new m(E.NUM,S.ValueBaseSmall);var n=n9(r,t);return e===void 0||r<0?n:n.length>e?new m(E.NUM,S.ValueBaseLong):Pt(n,e)}function r9(r){return-Math.pow(r,ut)/2}function wJ(r){return-r9(r)-1}function NJ(r,t,e){var n=n9(r,t);return e!==void 0&&e>n.length?Pt(n,e):n}function n9(r,t){var e=r<0?Math.pow(t,ut):0;return(r+e).toString(t).toUpperCase()}function Kr(r,t){var e=parseInt(r,t),n=Math.pow(t,ut);return e>=n/2?e-n:e}function Dp(r){return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(r)}function CJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function a9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _J(r,t,e){return t&&a9(r.prototype,t),e&&a9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function IJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Lp(r,t)}function Lp(r,t){return Lp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Lp(r,t)}function MJ(r){var t=PJ();return function(){var n=ml(r),a;if(t){var i=ml(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return kJ(this,a)}}function kJ(r,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FJ(r)}function FJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function PJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ml(r){return ml=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ml(r)}var i9=function(r){IJ(e,r);var t=MJ(e);function e(){return CJ(this,e),t.apply(this,arguments)}return _J(e,[{key:"rand",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RAND"),Math.random)}},{key:"randbetween",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RANDBETWEEN"),function(o,u){return u<o?new m(E.NUM,S.WrongOrder):(o=Math.ceil(o),u=Math.floor(u)+1,o===u&&(u+=1),o+Math.floor(Math.random()*(u-o)))})}}]),e}(ee);i9.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}],isVolatile:!0}};function Up(r){return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(r)}function $J(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function o9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function DJ(r,t,e){return t&&o9(r.prototype,t),e&&o9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function LJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&xp(r,t)}function xp(r,t){return xp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},xp(r,t)}function UJ(r){var t=VJ();return function(){var n=gl(r),a;if(t){var i=gl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return xJ(this,a)}}function xJ(r,t){if(t&&(Up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BJ(r)}function BJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function VJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gl(r){return gl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gl(r)}function u9(r){var t=Math.ceil(r);return t%2==1?t:t+1}function s9(r){var t=Math.ceil(r);return t%2==0?t:t+1}var Bp=function(r){LJ(e,r);var t=UJ(e);function e(){return $J(this,e),t.apply(this,arguments)}return DJ(e,[{key:"roundup",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ROUNDDOWN"),function(o,u){var s=Math.pow(10,u);return o<0?-Math.ceil(-o*s)/s:Math.ceil(o*s)/s})}},{key:"rounddown",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ROUNDDOWN"),function(o,u){var s=Math.pow(10,u);return o<0?-Math.floor(-o*s)/s:Math.floor(o*s)/s})}},{key:"round",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ROUND"),function(o,u){var s=Math.pow(10,u);return o<0?-Math.round(-o*s)/s:Math.round(o*s)/s})}},{key:"intFunc",value:function(a,i){return this.runFunction(a.args,i,this.metadata("INT"),function(o){return o<0?-Math.floor(-o):Math.floor(o)})}},{key:"even",value:function(a,i){return this.runFunction(a.args,i,this.metadata("EVEN"),function(o){return o<0?-s9(-o):s9(o)})}},{key:"odd",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ODD"),function(o){return o<0?-u9(-o):u9(o)})}},{key:"ceilingmath",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CEILING.MATH"),function(o,u,s){return u===0||o===0?0:(u=Math.abs(u),s===1&&o<0&&(u=-u),Math.ceil(o/u)*u)})}},{key:"ceiling",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CEILING"),function(o,u){return o===0?0:u===0?new m(E.DIV_BY_ZERO):o>0&&u<0?new m(E.NUM,S.DistinctSigns):Math.ceil(o/u)*u})}},{key:"ceilingprecise",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CEILING.PRECISE"),function(o,u){return u===0||o===0?0:(u=Math.abs(u),Math.ceil(o/u)*u)})}},{key:"floormath",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FLOOR.MATH"),function(o,u,s){return u===0||o===0?0:(u=Math.abs(u),s===1&&o<0&&(u*=-1),Math.floor(o/u)*u)})}},{key:"floor",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FLOOR"),function(o,u){return o===0?0:u===0?new m(E.DIV_BY_ZERO):o>0&&u<0?new m(E.NUM,S.DistinctSigns):Math.floor(o/u)*u})}},{key:"floorprecise",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FLOOR.PRECISE"),function(o,u){return u===0||o===0?0:(u=Math.abs(u),Math.floor(o/u)*u)})}}]),e}(ee);Bp.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:d.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:d.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:d.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:1},{argumentType:d.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:1},{argumentType:d.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,defaultValue:1}]}};Bp.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};function Vp(r){return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(r)}function GJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function l9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function jJ(r,t,e){return t&&l9(r.prototype,t),e&&l9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function HJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Gp(r,t)}function Gp(r,t){return Gp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Gp(r,t)}function WJ(r){var t=KJ();return function(){var n=El(r),a;if(t){var i=El(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return zJ(this,a)}}function zJ(r,t){if(t&&(Vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YJ(r)}function YJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function KJ(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function El(r){return El=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},El(r)}var f9=function(r){HJ(e,r);var t=WJ(e);function e(){return GJ(this,e),t.apply(this,arguments)}return jJ(e,[{key:"sqrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SQRT"),Math.sqrt)}}]),e}(ee);f9.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:d.NUMBER}]}};var XJ=regeneratorRuntime.mark(c9);/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function c9(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},XJ)}function qJ(r){var t=r[Symbol.iterator](),e=t.next(),n=e.done,a=e.value;return n?{rest:c9()}:{value:a,rest:t}}var QJ=regeneratorRuntime.mark(jp),ZJ=regeneratorRuntime.mark(Hp);function h9(r,t){return tee(r)||eee(r,t)||p9(r,t)||JJ()}function JJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eee(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function tee(r){if(Array.isArray(r))return r}function Rl(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=p9(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function p9(r,t){if(!!r){if(typeof r=="string")return d9(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return d9(r,t)}}function d9(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function v9(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function y9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function m9(r,t,e){return t&&y9(r.prototype,t),e&&y9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var ree=function(t,e,n){if(n.end.row>n.start.row){var a=P(n.end.sheet,n.end.col,n.end.row-1),i=t.getRange(n.start,a);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:n.withStart(P(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:e.map(function(o){return o.withStart(P(o.start.sheet,o.start.col,o.end.row))})}}return{restValuesRange:n,restConditionRanges:e}},ho=function(){function r(t,e,n,a,i){v9(this,r),this.interpreter=t,this.cacheKey=e,this.reduceInitialValue=n,this.composeFunction=a,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}return m9(r,[{key:"compute",value:function(e,n){var a=this,i=Rl(n),o;try{for(i.s();!(o=i.n()).done;){var u=o.value;if(!u.conditionRange.sameDimensionsAs(e))return new m(E.VALUE,S.EqualLength)}}catch(p){i.e(p)}finally{i.f()}var s=this.tryToGetRangeVertexForRangeValue(e),l=n.map(function(p){return a.tryToGetRangeVertexForRangeValue(p.conditionRange)});if(s&&l.every(function(p){return p!==void 0})){var f=n.map(function(p){return p.criterionPackage.raw}).join(","),c=this.findAlreadyComputedValueInCache(s,this.cacheKey(n),f);if(c!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),c;var h=this.buildNewCriterionCache(this.cacheKey(n),n.map(function(p){return p.conditionRange.range}),e.range);return h.has(f)||h.set(f,[this.evaluateRangeValue(e,n),n.map(function(p){return p.criterionPackage.lambda})]),s.setCriterionFunctionValues(this.cacheKey(n),h),l.forEach(function(p){p!==void 0&&p.addDependentCacheRange(s)}),h.get(f)[0]}else return this.evaluateRangeValue(e,n)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var n=e.range;if(n!==void 0)return this.dependencyGraph.getRange(n.start,n.end)}},{key:"reduceFunction",value:function(e){var n=this.reduceInitialValue,a=Rl(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n=this.composeFunction(n,o)}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"findAlreadyComputedValueInCache",value:function(e,n,a){return e.getCriterionFunctionValue(n,a)}},{key:"evaluateRangeValue",value:function(e,n){var a=n.map(function(s){return s.criterionPackage.lambda}),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=n.map(function(s){return s.conditionRange.iterateValuesFromTopLeftCorner()}),u=Hp(a,o,i);return this.reduceFunction(u)}},{key:"buildNewCriterionCache",value:function(e,n,a){var i=this,o=this.dependencyGraph.getRange(a.start,a.end),u=ree(this.dependencyGraph,n,a),s=u.smallerRangeVertex,l=u.restConditionRanges,f=u.restValuesRange,c;s!==void 0&&this.dependencyGraph.existsEdge(s,o)?c=s.getCriterionFunctionValues(e):c=new Map;var h=new Map;return c.forEach(function(p,y){var v=h9(p,2),R=v[0],g=v[1],A=Hp(g,l.map(function(N){return jp(i.dependencyGraph,N)}),Array.from(jp(i.dependencyGraph,f)).map(i.mapFunction)[Symbol.iterator]()),T=i.composeFunction(R,i.reduceFunction(A));i.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),h.set(y,[T,g])}),h}}]),r}(),po=m9(function r(t,e){v9(this,r),this.conditionRange=t,this.criterionPackage=e});function jp(r,t){var e,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=Rl(t.addresses(r)),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=9;break}return a=n.value,o.next=7,F(r.getScalarValue(a));case 7:o.next=3;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),e.e(o.t0);case 14:return o.prev=14,e.f(),o.finish(14);case 17:case"end":return o.stop()}},QJ,null,[[1,11,14,17]])}function Hp(r,t,e){var n,a,i,o,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=Rl(e),l.prev=1,n.s();case 3:if((a=n.n()).done){l.next=15;break}if(i=a.value,o=t.map(function(f){return qJ(f)}),o.every(function(f){return Object.prototype.hasOwnProperty.call(f,"value")})){l.next=8;break}return l.abrupt("return");case 8:if(u=o.map(function(f){return f.value}),!nee(u,r).every(function(f){var c=h9(f,2),h=c[0],p=c[1];return p(h)})){l.next=12;break}return l.next=12,i;case 12:t=o.map(function(f){return f.rest});case 13:l.next=3;break;case 15:l.next=20;break;case 17:l.prev=17,l.t0=l.catch(1),n.e(l.t0);case 20:return l.prev=20,n.f(),l.finish(20);case 23:case"end":return l.stop()}},ZJ,null,[[1,17,20,23]])}function nee(r,t){for(var e=[],n=0;n<Math.min(r.length,t.length);n++)e.push([r[n],t[n]]);return e}function Wp(r){return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(r)}function aee(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&zp(r,t)}function zp(r,t){return zp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},zp(r,t)}function iee(r){var t=see();return function(){var n=bl(r),a;if(t){var i=bl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return oee(this,a)}}function oee(r,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uee(r)}function uee(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function see(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bl(r){return bl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bl(r)}function Yp(r){return hee(r)||cee(r)||fee(r)||lee()}function lee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fee(r,t){if(!!r){if(typeof r=="string")return Kp(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Kp(r,t)}}function cee(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function hee(r){if(Array.isArray(r))return Kp(r)}function Kp(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function g9(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function E9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function R9(r,t,e){return t&&E9(r.prototype,t),e&&E9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var vo=function(){function r(t,e){g9(this,r),this.sum=t,this.count=e}return R9(r,[{key:"compose",value:function(e){return new r(this.sum+e.sum,this.count+e.count)}},{key:"averageValue",value:function(){if(this.count>0)return this.sum/this.count}}],[{key:"single",value:function(e){return new r(e,1)}}]),r}();vo.empty=new vo(0,0);function b9(r){var t=r.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["SUMIF"].concat(Yp(t)).join(",")}function pee(r){var t=r.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["AVERAGEIF"].concat(Yp(t)).join(",")}function dee(r){var t=r.map(function(e){return"".concat(e.conditionRange.range.sheet,",").concat(e.conditionRange.range.start.col,",").concat(e.conditionRange.range.start.row)});return["COUNTIFS"].concat(Yp(t)).join(",")}var S9=function(r){aee(e,r);var t=iee(e);function e(){return g9(this,e),t.apply(this,arguments)}return R9(e,[{key:"sumif",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SUMIF"),function(u,s,l){var f=o.interpreter.criterionBuilder.fromCellValue(s,o.arithmeticHelper);return f===void 0?new m(E.VALUE,S.BadCriterion):(l=l!=null?l:u,new ho(o.interpreter,b9,0,function(c,h){return o.arithmeticHelper.nonstrictadd(c,h)},function(c){return F(c)}).compute(l,[new po(u,f)]))})}},{key:"sumifs",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SUMIFS"),function(u){for(var s=[],l=0;l<(arguments.length<=1?0:arguments.length-1);l+=2){var f=l+1<1||arguments.length<=l+1?void 0:arguments[l+1],c=o.interpreter.criterionBuilder.fromCellValue(l+1+1<1||arguments.length<=l+1+1?void 0:arguments[l+1+1],o.arithmeticHelper);if(c===void 0)return new m(E.VALUE,S.BadCriterion);s.push(new po(f,c))}return new ho(o.interpreter,b9,0,function(h,p){return o.arithmeticHelper.nonstrictadd(h,p)},function(h){return F(h)}).compute(u,s)})}},{key:"averageif",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("AVERAGEIF"),function(u,s,l){var f=o.interpreter.criterionBuilder.fromCellValue(s,o.arithmeticHelper);if(f===void 0)return new m(E.VALUE,S.BadCriterion);l=l!=null?l:u;var c=new ho(o.interpreter,pee,vo.empty,function(h,p){return h.compose(p)},function(h){return de(h)?vo.single(F(h)):vo.empty}).compute(l,[new po(u,f)]);return c instanceof m?c:c.averageValue()||new m(E.DIV_BY_ZERO)})}},{key:"countif",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("COUNTIF"),function(u,s){var l=o.interpreter.criterionBuilder.fromCellValue(s,o.arithmeticHelper);return l===void 0?new m(E.VALUE,S.BadCriterion):new ho(o.interpreter,function(){return"COUNTIF"},0,function(f,c){return f+c},function(){return 1}).compute(u,[new po(u,l)])})}},{key:"countifs",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("COUNTIFS"),function(){for(var u=[],s=0;s<arguments.length;s+=2){var l=s<0||arguments.length<=s?void 0:arguments[s],f=o.interpreter.criterionBuilder.fromCellValue(s+1<0||arguments.length<=s+1?void 0:arguments[s+1],o.arithmeticHelper);if(f===void 0)return new m(E.VALUE,S.BadCriterion);u.push(new po(l,f))}return new ho(o.interpreter,dee,0,function(c,h){return c+h},function(){return 1}).compute(u[0].conditionRange,u)})}}]),e}(ee);S9.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:d.RANGE},{argumentType:d.NOERROR},{argumentType:d.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:d.RANGE},{argumentType:d.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:d.RANGE},{argumentType:d.NOERROR},{argumentType:d.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE},{argumentType:d.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:d.RANGE},{argumentType:d.NOERROR}],repeatLastArgs:2}};function Xp(r){return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(r)}function vee(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=yee(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function yee(r,t){if(!!r){if(typeof r=="string")return A9(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return A9(r,t)}}function A9(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function mee(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function T9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function gee(r,t,e){return t&&T9(r.prototype,t),e&&T9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Eee(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&qp(r,t)}function qp(r,t){return qp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},qp(r,t)}function Ree(r){var t=Aee();return function(){var n=Sl(r),a;if(t){var i=Sl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return bee(this,a)}}function bee(r,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return See(r)}function See(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Aee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sl(r){return Sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sl(r)}var O9=function(r){Eee(e,r);var t=Ree(e);function e(){return mee(this,e),t.apply(this,arguments)}return gee(e,[{key:"sumproduct",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SUMPRODUCT"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];for(var f=s[0].width(),c=s[0].height(),h=0,p=s;h<p.length;h++){var y=p[h];if(y.width()!==f||y.height()!==c)return new m(E.VALUE,S.EqualLength)}for(var v=0,R=s.map(function(x){return x.iterateValuesFromTopLeftCorner()}),g=0;g<f*c;g++){var A=1,T=vee(R),N;try{for(T.s();!(N=T.n()).done;){var M=N.value,_=M.next().value;if(_ instanceof m)return _;var $=o.coerceScalarToNumberOrError(_);de($)?A*=F($):A=0}}catch(x){T.e(x)}finally{T.f()}v+=A}return v})}}]),e}(ee);O9.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:d.RANGE}],repeatLastArgs:1}};var Tee=z,Oee=M1;Tee({target:"String",proto:!0},{repeat:Oee});function Qp(r){return Qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qp(r)}function wee(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function w9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Nee(r,t,e){return t&&w9(r.prototype,t),e&&w9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Cee(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Zp(r,t)}function Zp(r,t){return Zp=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Zp(r,t)}function _ee(r){var t=kee();return function(){var n=Al(r),a;if(t){var i=Al(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Iee(this,a)}}function Iee(r,t){if(t&&(Qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mee(r)}function Mee(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function kee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Al(r){return Al=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Al(r)}var N9=function(r){Cee(e,r);var t=_ee(e);function e(){return wee(this,e),t.apply(this,arguments)}return Nee(e,[{key:"concatenate",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CONCATENATE"),function(){var o;return(o="").concat.apply(o,arguments)})}},{key:"split",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SPLIT"),function(o,u){var s=o.split(" ");return u>=s.length||u<0?new m(E.VALUE,S.IndexBounds):s[u]})}},{key:"len",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LEN"),function(o){return o.length})}},{key:"lower",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LOWER"),function(o){return o.toLowerCase()})}},{key:"trim",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TRIM"),function(o){return o.replace(/^ +| +$/g,"").replace(/ +/g," ")})}},{key:"proper",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PROPER"),function(o){return o.replace(/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])+/g,function(u){return u.charAt(0).toUpperCase()+u.substring(1).toLowerCase()})})}},{key:"clean",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CLEAN"),function(o){return o.replace(/[\u0000-\u001F]/g,"")})}},{key:"exact",value:function(a,i){return this.runFunction(a.args,i,this.metadata("EXACT"),function(o,u){return o===u})}},{key:"rept",value:function(a,i){return this.runFunction(a.args,i,this.metadata("REPT"),function(o,u){return u<0?new m(E.VALUE,S.NegativeCount):o.repeat(u)})}},{key:"right",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RIGHT"),function(o,u){return u<0?new m(E.VALUE,S.NegativeLength):u===0?"":o.slice(-u)})}},{key:"left",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LEFT"),function(o,u){return u<0?new m(E.VALUE,S.NegativeLength):o.slice(0,u)})}},{key:"mid",value:function(a,i){return this.runFunction(a.args,i,this.metadata("MID"),function(o,u,s){return u<1?new m(E.VALUE,S.LessThanOne):s<0?new m(E.VALUE,S.NegativeLength):o.substring(u-1,u+s-1)})}},{key:"replace",value:function(a,i){return this.runFunction(a.args,i,this.metadata("REPLACE"),function(o,u,s,l){return u<1?new m(E.VALUE,S.LessThanOne):s<0?new m(E.VALUE,S.NegativeLength):o.substring(0,u-1)+l+o.substring(u+s-1)})}},{key:"search",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SEARCH"),function(u,s,l){if(l<1||l>s.length)return new m(E.VALUE,S.LengthBounds);var f=s.substring(l-1).toLowerCase(),c;return o.arithmeticHelper.requiresRegex(u)?c=o.arithmeticHelper.searchString(u,f):c=f.indexOf(u.toLowerCase()),c=c+l,c>0?c:new m(E.VALUE,S.PatternNotFound)})}},{key:"substitute",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SUBSTITUTE"),function(o,u,s,l){var f=new RegExp(u,"g");if(l===void 0)return o.replace(f,s);if(l<1)return new m(E.VALUE,S.LessThanOne);for(var c,h=0;(c=f.exec(o))!==null;)if(l===++h)return o.substring(0,c.index)+s+o.substring(f.lastIndex);return o})}},{key:"find",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FIND"),function(o,u,s){if(s<1||s>u.length)return new m(E.VALUE,S.IndexBounds);var l=u.substring(s-1),f=l.indexOf(o)+s;return f>0?f:new m(E.VALUE,S.PatternNotFound)})}},{key:"t",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T"),function(o){return o instanceof m||typeof o=="string"?o:""})}},{key:"upper",value:function(a,i){return this.runFunction(a.args,i,this.metadata("UPPER"),function(o){return o.toUpperCase()})}}]),e}(ee);N9.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:d.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:d.STRING},{argumentType:d.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:d.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:d.STRING}]},MID:{method:"mid",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:d.STRING}]},T:{method:"t",parameters:[{argumentType:d.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:d.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:d.STRING}]},REPT:{method:"rept",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:d.STRING},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:d.STRING},{argumentType:d.STRING},{argumentType:d.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:d.STRING},{argumentType:d.STRING},{argumentType:d.STRING},{argumentType:d.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:d.STRING},{argumentType:d.STRING},{argumentType:d.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:d.STRING}]}};var yo=Math.expm1,Fee=Math.exp,Jp=!yo||yo(10)>22025.465794806718||yo(10)<22025.465794806718||yo(-2e-17)!=-2e-17?function(t){return(t=+t)==0?t:t>-1e-6&&t<1e-6?t+t*t/2:Fee(t)-1}:yo,Pee=z,$ee=re,C9=Jp,Dee=Math.abs,_9=Math.exp,Lee=Math.E,Uee=$ee(function(){return Math.sinh(-2e-17)!=-2e-17});Pee({target:"Math",stat:!0,forced:Uee},{sinh:function(t){return Dee(t=+t)<1?(C9(t)-C9(-t))/2:(_9(t-1)-_9(-t-1))*(Lee/2)}});var xee=z,I9=Math.asinh,Bee=Math.log,Vee=Math.sqrt;function M9(r){return!isFinite(r=+r)||r==0?r:r<0?-M9(-r):Bee(r+Vee(r*r+1))}xee({target:"Math",stat:!0,forced:!(I9&&1/I9(0)>0)},{asinh:M9});var Gee=z,jee=Jp,k9=Math.cosh,Hee=Math.abs,ed=Math.E;Gee({target:"Math",stat:!0,forced:!k9||k9(710)===1/0},{cosh:function(t){var e=jee(Hee(t)-1)+1;return(e+1/(e*ed*ed))*(ed/2)}});var Wee=Math.log,zee=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Wee(1+t)},Yee=z,Kee=zee,td=Math.acosh,Xee=Math.log,F9=Math.sqrt,qee=Math.LN2,Qee=!td||Math.floor(td(Number.MAX_VALUE))!=710||td(1/0)!=1/0;Yee({target:"Math",stat:!0,forced:Qee},{acosh:function(t){return(t=+t)<1?NaN:t>9490626562425156e-8?Xee(t)+qee:Kee(t-1+F9(t-1)*F9(t+1))}});var Zee=z,P9=Jp,$9=Math.exp;Zee({target:"Math",stat:!0},{tanh:function(t){var e=P9(t=+t),n=P9(-t);return e==1/0?1:n==1/0?-1:(e-n)/($9(t)+$9(-t))}});var Jee=z,D9=Math.atanh,ete=Math.log;Jee({target:"Math",stat:!0,forced:!(D9&&1/D9(-0)<0)},{atanh:function(t){return(t=+t)==0?t:ete((1+t)/(1-t))/2}});function rd(r){return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(r)}function tte(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function L9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function rte(r,t,e){return t&&L9(r.prototype,t),e&&L9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function nte(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&nd(r,t)}function nd(r,t){return nd=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},nd(r,t)}function ate(r){var t=ute();return function(){var n=Tl(r),a;if(t){var i=Tl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ite(this,a)}}function ite(r,t){if(t&&(rd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ote(r)}function ote(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ute(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tl(r){return Tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tl(r)}var U9=function(r){nte(e,r);var t=ate(e);function e(){return tte(this,e),t.apply(this,arguments)}return rte(e,[{key:"acos",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ATAN2"),function(o,u){return o===0&&u===0?new m(E.DIV_BY_ZERO):Math.atan2(u,o)})}},{key:"cot",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COT"),function(o){return o===0?new m(E.DIV_BY_ZERO):1/Math.tan(o)})}},{key:"acot",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ACOT"),function(o){return o===0?Ep/2:Math.atan(1/o)})}},{key:"sec",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SEC"),function(o){return 1/Math.cos(o)})}},{key:"csc",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CSC"),function(o){return o===0?new m(E.DIV_BY_ZERO):1/Math.sin(o)})}},{key:"sinh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COTH"),function(o){return o===0?new m(E.DIV_BY_ZERO):1/Math.tanh(o)})}},{key:"acoth",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ACOTH"),function(o){return o===0?new m(E.NUM,S.NonZero):Math.atanh(1/o)})}},{key:"sech",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SECH"),function(o){return 1/Math.cosh(o)})}},{key:"csch",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CSCH"),function(o){return o===0?new m(E.DIV_BY_ZERO):1/Math.sinh(o)})}}]),e}(ee);U9.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:d.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:d.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:d.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:d.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:d.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:d.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:d.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:d.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:d.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:d.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:d.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:d.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:d.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:d.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:d.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:d.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:d.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:d.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:d.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:d.NUMBER}]}};function ad(r){return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(r)}function ste(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function x9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function lte(r,t,e){return t&&x9(r.prototype,t),e&&x9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function fte(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&id(r,t)}function id(r,t){return id=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},id(r,t)}function cte(r){var t=dte();return function(){var n=Ol(r),a;if(t){var i=Ol(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return hte(this,a)}}function hte(r,t){if(t&&(ad(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pte(r)}function pte(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function dte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ol(r){return Ol=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ol(r)}var vte=function(r){fte(e,r);var t=cte(e);function e(n,a){var i;return ste(this,e),i=t.call(this,a),i.config=n,i.dependencyGraph=a,i}return lte(e,[{key:"find",value:function(a,i,o){typeof a=="string"&&(a=yn(a));var u=i.range;return u===void 0?i.valuesFromTopLeftCorner().map(F).indexOf(a):o?h3(u,a,this.dependencyGraph,"col"):this.dependencyGraph.computeListOfValuesInRange(u).findIndex(function(s){return s=F(s),s=typeof s=="string"?yn(s):s,s===a})}}]),e}(d3);function od(r){return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(r)}function yte(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function B9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function mte(r,t,e){return t&&B9(r.prototype,t),e&&B9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function gte(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&ud(r,t)}function ud(r,t){return ud=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},ud(r,t)}function Ete(r){var t=Ste();return function(){var n=wl(r),a;if(t){var i=wl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Rte(this,a)}}function Rte(r,t){if(t&&(od(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bte(r)}function bte(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ste(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wl(r){return wl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wl(r)}var V9=function(r){gte(e,r);var t=Ete(e);function e(){var n;return yte(this,e),n=t.apply(this,arguments),n.rowSearch=new vte(n.config,n.dependencyGraph),n}return mte(e,[{key:"vlookup",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("VLOOKUP"),function(u,s,l,f){var c=s.range;return c===void 0?new m(E.VALUE,S.WrongType):l<1?new m(E.VALUE,S.LessThanOne):l>c.width()?new m(E.REF,S.IndexLarge):o.doVlookup(t1(u),s,l-1,f)})}},{key:"hlookup",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("HLOOKUP"),function(u,s,l,f){var c=s.range;return c===void 0?new m(E.VALUE,S.WrongType):l<1?new m(E.VALUE,S.LessThanOne):l>c.height()?new m(E.REF,S.IndexLarge):o.doHlookup(t1(u),s,l-1,f)})}},{key:"match",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("MATCH"),function(u,s,l){return o.doMatch(t1(u),s,l)})}},{key:"searchInRange",value:function(a,i,o,u){return!o&&typeof a=="string"&&this.arithmeticHelper.requiresRegex(a)?u.advancedFind(this.arithmeticHelper.eqMatcherFunction(a),i):u.find(a,i,o)}},{key:"doVlookup",value:function(a,i,o,u){this.dependencyGraph.stats.start(X.VLOOKUP);var s=i.range,l;s===void 0?l=V.onlyValues(i.data.map(function(p){return[p[0]]})):l=V.onlyRange(Y.spanFrom(s.start,1,s.height()),this.dependencyGraph);var f=this.searchInRange(a,l,u,this.columnSearch);if(this.dependencyGraph.stats.end(X.VLOOKUP),f===-1)return new m(E.NA,S.ValueNotFound);var c;if(s===void 0)c=i.data[f][o];else{var h=P(s.sheet,s.start.col+o,s.start.row+f);c=this.dependencyGraph.getCellValue(h)}return c instanceof V?new m(E.VALUE,S.WrongType):c}},{key:"doHlookup",value:function(a,i,o,u){var s=i.range,l;s===void 0?l=V.onlyValues([i.data[0]]):l=V.onlyRange(Y.spanFrom(s.start,s.width(),1),this.dependencyGraph);var f=this.searchInRange(a,l,u,this.rowSearch);if(f===-1)return new m(E.NA,S.ValueNotFound);var c;if(s===void 0)c=i.data[o][f];else{var h=P(s.sheet,s.start.col+f,s.start.row+o);c=this.dependencyGraph.getCellValue(h)}return c instanceof V?new m(E.VALUE,S.WrongType):c}},{key:"doMatch",value:function(a,i,o){if(i.width()>1&&i.height()>1)return new m(E.NA);if(i.width()===1){var u=this.columnSearch.find(a,i,o!==0);return u===-1?new m(E.NA,S.ValueNotFound):u+1}else{var s=this.rowSearch.find(a,i,o!==0);return s===-1?new m(E.NA,S.ValueNotFound):s+1}}}]),e}(ee);V9.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:d.NOERROR},{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:d.NOERROR},{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:d.NOERROR},{argumentType:d.RANGE},{argumentType:d.NUMBER,defaultValue:1}]}};function sd(r){return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(r)}function Ate(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function G9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Tte(r,t,e){return t&&G9(r.prototype,t),e&&G9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ote(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&ld(r,t)}function ld(r,t){return ld=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},ld(r,t)}function wte(r){var t=_te();return function(){var n=Nl(r),a;if(t){var i=Nl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Nte(this,a)}}function Nte(r,t){if(t&&(sd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cte(r)}function Cte(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nl(r){return Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Nl(r)}var j9=function(r){Ote(e,r);var t=wte(e);function e(){return Ate(this,e),t.apply(this,arguments)}return Tte(e,[{key:"roman",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("ROMAN"),function(u,s){return u=Math.trunc(u),s===!1?s=4:s===!0&&(s=0),s=F(o.coerceScalarToNumberOrError(s)),s instanceof m?s:(s=Math.trunc(s),s<0?new m(E.VALUE,S.ValueSmall):s>4?new m(E.VALUE,S.ValueLarge):Ite(u,s))})}},{key:"arabic",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ARABIC"),function(o){o=o.trim().toUpperCase();var u=!1;if(o.startsWith("-")&&(o=o.slice(1),u=!0,o===""))return new m(E.VALUE,S.InvalidRoman);var s={input:o,acc:0};return Cr(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Cr(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Cr(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Cr(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Cr(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Cr(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Cr(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Cr(s,{token:"IX",val:9}),Cr(s,{token:"V",val:5},{token:"IV",val:4}),Cr(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new m(E.VALUE,S.InvalidRoman):u?-s.acc:s.acc})}}]),e}(ee);j9.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:d.NUMBER,minValue:1,lessThan:4e3},{argumentType:d.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:d.STRING}]}};function Cr(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];for(var a=0,i=e;a<i.length;a++){var o=i[a];if(r.input.startsWith(o.token)){r.input=r.input.slice(o.token.length),r.acc+=o.val;break}}}function Ite(r,t){var e={val:r%1e3,acc:"M".repeat(Math.floor(r/1e3))};return t===4&&(We(e,"IM",999,1e3),We(e,"ID",499,500)),t>=3&&(We(e,"VM",995,1e3),We(e,"VD",495,500)),t>=2&&(We(e,"XM",990,1e3),We(e,"XD",490,500)),t>=1&&(We(e,"LM",950,1e3),We(e,"LD",450,500)),We(e,"CM",900,1e3),We(e,"CD",400,500),We(e,"D",500,900),e.acc+="C".repeat(Math.floor(e.val/100)),e.val%=100,t>=2&&(We(e,"IC",99,100),We(e,"IL",49,50)),t>=1&&(We(e,"VC",95,100),We(e,"VL",45,50)),We(e,"XC",90,100),We(e,"XL",40,50),We(e,"L",50,90),e.acc+="X".repeat(Math.floor(e.val/10)),e.val%=10,We(e,"IX",9,10),We(e,"IV",4,5),We(e,"V",5,9),e.acc+="I".repeat(e.val),e.acc}function We(r,t,e,n){r.val>=e&&r.val<n&&(r.val-=e,r.acc+=t)}function fd(r){return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(r)}function Mte(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function H9(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function kte(r,t,e){return t&&H9(r.prototype,t),e&&H9(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Fte(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&cd(r,t)}function cd(r,t){return cd=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},cd(r,t)}function Pte(r){var t=Lte();return function(){var n=Cl(r),a;if(t){var i=Cl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $te(this,a)}}function $te(r,t){if(t&&(fd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dte(r)}function Dte(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Lte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cl(r){return Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Cl(r)}var W9=function(r){Fte(e,r);var t=Pte(e);function e(){return Mte(this,e),t.apply(this,arguments)}return kte(e,[{key:"add",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}},{key:"divide",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}},{key:"eq",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}},{key:"gt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.GT"),this.arithmeticHelper.gt)}},{key:"gte",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}},{key:"lt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.LT"),this.arithmeticHelper.lt)}},{key:"lte",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}},{key:"minus",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}},{key:"multiply",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}},{key:"ne",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.NE"),this.arithmeticHelper.neq)}},{key:"pow",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.POW"),this.arithmeticHelper.pow)}},{key:"uminus",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}]),e}(ee);W9.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:d.NUMBER,passSubtype:!0},{argumentType:d.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:d.STRING,passSubtype:!0},{argumentType:d.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:d.NUMBER,passSubtype:!0},{argumentType:d.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:d.NUMBER,passSubtype:!0},{argumentType:d.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:d.NUMBER,passSubtype:!0},{argumentType:d.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:d.NOERROR,passSubtype:!0},{argumentType:d.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:d.NUMBER,passSubtype:!0},{argumentType:d.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:d.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:d.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:d.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var te=Math;function Ie(r,t){for(var e=0,n=0;e<r.length;++e)n=t*n+r[e];return n}function z9(r,t,e,n,a){if(t===0)return e;if(t===1)return n;for(var i=2/r,o=n,u=1;u<t;++u)o=n*u*i+a*e,e=n,n=o;return o}function Y9(r,t,e,n,a){return function(o,u){if(n){if(o===0)return n==1?-1/0:1/0;if(o<0)return NaN}if(u===0)return r(o);if(u===1)return t(o);if(u<0)return NaN;u|=0;var s=r(o),l=t(o);return z9(o,u,s,l,a)}}var hd=function(){var r=.636619772,t=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),e=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function i(c){var h=0,p=0,y=0,v=c*c;if(c<8)p=Ie(t,v),y=Ie(e,v),h=p/y;else{var R=c-.785398164;v=64/v,p=Ie(n,v),y=Ie(a,v),h=te.sqrt(r/c)*(te.cos(R)*p-te.sin(R)*y*8/c)}return h}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function f(c){var h=0,p=0,y=0,v=c*c,R=te.abs(c)-2.356194491;return Math.abs(c)<8?(p=c*Ie(o,v),y=Ie(u,v),h=p/y):(v=64/v,p=Ie(s,v),y=Ie(l,v),h=te.sqrt(r/te.abs(c))*(te.cos(R)*p-te.sin(R)*y*8/te.abs(c)),c<0&&(h=-h)),h}return function c(h,p){if(p=Math.round(p),!isFinite(h))return isNaN(h)?h:0;if(p<0)return(p%2?-1:1)*c(h,-p);if(h<0)return(p%2?-1:1)*c(-h,p);if(p===0)return i(h);if(p===1)return f(h);if(h===0)return 0;var y=0;if(h>p)y=z9(h,p,i(h),f(h),-1);else{for(var v=2*te.floor((p+te.floor(te.sqrt(40*p)))/2),R=!1,g=0,A=0,T=1,N=0,M=2/h,_=v;_>0;_--)N=_*M*T-g,g=T,T=N,te.abs(T)>1e10&&(T*=1e-10,g*=1e-10,y*=1e-10,A*=1e-10),R&&(A+=T),R=!R,_==p&&(y=g);A=2*A-T,y/=A}return y}}(),Ute=function(){var r=.636619772,t=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),e=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function i(c){var h=0,p=0,y=0,v=c*c,R=c-.785398164;return c<8?(p=Ie(t,v),y=Ie(e,v),h=p/y+r*hd(c,0)*te.log(c)):(v=64/v,p=Ie(n,v),y=Ie(a,v),h=te.sqrt(r/c)*(te.sin(R)*p+te.cos(R)*y*8/c)),h}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),u=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function f(c){var h=0,p=0,y=0,v=c*c,R=c-2.356194491;return c<8?(p=c*Ie(o,v),y=Ie(u,v),h=p/y+r*(hd(c,1)*te.log(c)-1/c)):(v=64/v,p=Ie(s,v),y=Ie(l,v),h=te.sqrt(r/c)*(te.sin(R)*p+te.cos(R)*y*8/c)),h}return Y9(i,f,"BESSELY",1,-1)}(),pd=function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function e(o){return o<=3.75?Ie(r,o*o/(3.75*3.75)):te.exp(te.abs(o))/te.sqrt(te.abs(o))*Ie(t,3.75/te.abs(o))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function i(o){return o<3.75?o*Ie(n,o*o/(3.75*3.75)):(o<0?-1:1)*te.exp(te.abs(o))/te.sqrt(te.abs(o))*Ie(a,3.75/te.abs(o))}return function o(u,s){if(s=Math.round(s),s===0)return e(u);if(s===1)return i(u);if(s<0)return NaN;if(te.abs(u)===0)return 0;if(u==1/0)return 1/0;var l=0,f,c=2/te.abs(u),h=0,p=1,y=0,v=2*te.round((s+te.round(te.sqrt(40*s)))/2);for(f=v;f>0;f--)y=f*c*p+h,h=p,p=y,te.abs(p)>1e10&&(p*=1e-10,h*=1e-10,l*=1e-10),f==s&&(l=h);return l*=o(u,0)/p,u<0&&s%2?-l:l}}(),xte=function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function e(o){return o<=2?-te.log(o/2)*pd(o,0)+Ie(r,o*o/4):te.exp(-o)/te.sqrt(o)*Ie(t,2/o)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function i(o){return o<=2?te.log(o/2)*pd(o,1)+1/o*Ie(n,o*o/4):te.exp(-o)/te.sqrt(o)*Ie(a,2/o)}return Y9(e,i,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function ja(r){var t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],e=t.length-1,n=!1,a=0,i=0,o,u,s,l;if(r===0)return 0;for(r<0&&(r=-r,n=!0),o=2/(2+r),u=4*o-2;e>0;e--)s=a,a=u*a-i+t[e],i=s;return l=o*Math.exp(-r*r+.5*(t[0]+u*a)-i),n?l-1:1-l}function K9(r){return 1-ja(r)}function X9(r){var t=0,e,n,a,i;if(r>=2)return-100;if(r<=0)return 100;for(i=r<1?r:2-r,a=Math.sqrt(-2*Math.log(i/2)),e=-.70711*((2.30753+a*.27061)/(1+a*(.99229+a*.04481))-a);t<2;t++)n=K9(e)-i,e+=n/(1.1283791670955126*Math.exp(-e*e)-e*n);return r<1?e:-e}var q9={pdf:function(t,e){return t<0?0:e*Math.exp(-e*t)},cdf:function(t,e){return t<0?0:1-Math.exp(-e*t)}};function mo(r){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],e=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],n=!1,a=0,i=0,o=0,u=r,s,l,f,c;if(r>171.6243769536076)return 1/0;if(u<=0)if(c=u%1,c)n=(u&1?-1:1)*Math.PI/Math.sin(Math.PI*c),u=1-u;else return 1/0;for(f=u,u<1?l=u++:l=(u-=a=(u|0)-1)-1,s=0;s<8;++s)o=(o+t[s])*l,i=i*l+e[s];if(c=o/i+1,f<u)c/=f;else if(f>u)for(s=0;s<a;++s)c*=u,u++;return n&&(c=n/c),c}var dd={pdf:function(t,e,n){return t<0?0:t===0&&e===1?1/n:Math.exp((e-1)*Math.log(t)-t/n-st(e)-e*Math.log(n))},cdf:function(t,e,n){return t<0?0:vd(e,t/n)},inv:function(t,e,n){return Q9(t,e)*n}};function st(r){var t=0,e=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,a,i,o;for(o=(i=a=r)+5.5,o-=(a+.5)*Math.log(o);t<6;t++)n+=e[t]/++i;return Math.log(2.5066282746310007*n/a)-o}function vd(r,t){var e=st(r),n=r,a=1/r,i=a,o=t+1-r,u=1/1e-30,s=1/o,l=s,f=1,c=-~(Math.log(r>=1?r:1/r)*8.5+r*.4+17),h;if(t<0||r<=0)return NaN;if(t<r+1){for(;f<=c;f++)a+=i*=t/++n;return a*Math.exp(-t+r*Math.log(t)-e)}for(;f<=c;f++)h=-f*(f-r),o+=2,s=h*s+o,u=o+h/u,s=1/s,l*=s*u;return 1-l*Math.exp(-t+r*Math.log(t)-e)}function Q9(r,t){var e=0,n=t-1,a=1e-8,i=st(t),o,u,s,l,f,c,h;if(r>=1)return Math.max(100,t+100*Math.sqrt(t));if(r<=0)return 0;for(t>1?(c=Math.log(n),h=Math.exp(n*(c-1)-i),f=r<.5?r:1-r,s=Math.sqrt(-2*Math.log(f)),o=(2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s,r<.5&&(o=-o),o=Math.max(.001,t*Math.pow(1-1/(9*t)-o/(3*Math.sqrt(t)),3))):(s=1-t*(.253+t*.12),r<s?o=Math.pow(r/s,1/t):o=1-Math.log(1-(r-s)/(1-s)));e<12;e++){if(o<=0)return 0;if(u=vd(t,o)-r,t>1?s=h*Math.exp(-(o-n)+n*(Math.log(o)-c)):s=Math.exp(-o+n*Math.log(o)-i),l=u/s,o-=s=l/(1-.5*Math.min(1,l*((t-1)/o-1))),o<=0&&(o=.5*(o+s)),Math.abs(s)<a*o)break}return o}var vr={pdf:function(t,e,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(t-e,2)/(2*n*n))},cdf:function(t,e,n){return .5*(1+ja((t-e)/Math.sqrt(2*n*n)))},inv:function(t,e,n){return-1.4142135623730951*n*X9(2*t)+e}},yd={pdf:function(t,e,n){return t>1||t<0?0:e==1&&n==1?1:e<512&&n<512?Math.pow(t,e-1)*Math.pow(1-t,n-1)/md(e,n):Math.exp((e-1)*Math.log(t)+(n-1)*Math.log(1-t)-Z9(e,n))},cdf:function(t,e,n){return t>1||t<0?+(t>1):_l(t,e,n)},inv:function(t,e,n){return gd(t,e,n)}};function md(r,t){if(!(r<=0||t<=0))return r+t>170?Math.exp(Z9(r,t)):mo(r)*mo(t)/mo(r+t)}function Z9(r,t){return st(r)+st(t)-st(r+t)}function gd(r,t,e){var n=1e-8,a=t-1,i=e-1,o=0,u,s,l,f,c,h,p,y,v,R,g;if(r<=0)return 0;if(r>=1)return 1;for(t>=1&&e>=1?(l=r<.5?r:1-r,f=Math.sqrt(-2*Math.log(l)),p=(2.30753+f*.27061)/(1+f*(.99229+f*.04481))-f,r<.5&&(p=-p),y=(p*p-3)/6,v=2/(1/(2*t-1)+1/(2*e-1)),R=p*Math.sqrt(y+v)/v-(1/(2*e-1)-1/(2*t-1))*(y+5/6-2/(3*v)),p=t/(t+e*Math.exp(2*R))):(u=Math.log(t/(t+e)),s=Math.log(e/(t+e)),f=Math.exp(t*u)/t,c=Math.exp(e*s)/e,R=f+c,r<f/R?p=Math.pow(t*R*r,1/t):p=1-Math.pow(e*R*(1-r),1/e)),g=-st(t)-st(e)+st(t+e);o<10;o++){if(p===0||p===1)return p;if(h=_l(p,t,e)-r,f=Math.exp(a*Math.log(p)+i*Math.log(1-p)+g),c=h/f,p-=f=c/(1-.5*Math.min(1,c*(a/p-i/(1-p)))),p<=0&&(p=.5*(p+f)),p>=1&&(p=.5*(p+f+1)),Math.abs(f)<n*p&&o>0)break}return p}function _l(r,t,e){var n=r===0||r===1?0:Math.exp(st(t+e)-st(t)-st(e)+t*Math.log(r)+e*Math.log(1-r));return r<0||r>1?!1:r<(t+1)/(t+e+2)?n*J9(r,t,e)/t:1-n*J9(1-r,e,t)/e}function J9(r,t,e){var n=1e-30,a=1,i=t+e,o=t+1,u=t-1,s=1,l=1-i*r/o,f,c,h,p;for(Math.abs(l)<n&&(l=n),l=1/l,p=l;a<=100&&(f=2*a,c=a*(e-a)*r/((u+f)*(t+f)),l=1+c*l,Math.abs(l)<n&&(l=n),s=1+c/s,Math.abs(s)<n&&(s=n),l=1/l,p*=l*s,c=-(t+a)*(i+a)*r/((t+f)*(o+f)),l=1+c*l,Math.abs(l)<n&&(l=n),s=1+c/s,Math.abs(s)<n&&(s=n),l=1/l,h=l*s,p*=h,!(Math.abs(h-1)<3e-7));a++);return p}var Il={pdf:function(t,e,n){return n===0||n===1?e*n===t?1:0:tR(e,t)*Math.pow(n,t)*Math.pow(1-n,e-t)},cdf:function(t,e,n){var a,i=1e-10;if(t<0)return 0;if(t>=e)return 1;if(n<0||n>1||e<=0)return NaN;t=Math.floor(t);var o=n,u=t+1,s=e-t,l=u+s,f=Math.exp(st(l)-st(s)-st(u)+u*Math.log(o)+s*Math.log(1-o));return o<(u+1)/(l+2)?a=f*eR(o,u,s,i):a=1-f*eR(1-o,s,u,i),Math.round((1-a)*(1/i))/(1/i)}};function eR(r,t,e,n){for(var a=0,i=1,o=1,u=1,s=0,l=0,f;Math.abs((o-l)/o)>n;)l=o,f=-(t+s)*(t+e+s)*r/(t+2*s)/(t+2*s+1),a=o+f*a,i=u+f*i,s=s+1,f=s*(e-s)*r/(t+2*s-1)/(t+2*s),o=a+f*o,u=i+f*u,a=a/u,i=i/u,o=o/u,u=1;return o/t}function tR(r,t){return r>170||t>170?Math.exp(Bte(r,t)):Ml(r)/Ml(t)/Ml(r-t)}function Bte(r,t){return Ed(r)-Ed(t)-Ed(r-t)}function Ed(r){return r<0?NaN:st(r+1)}function Ml(r){return r<0?NaN:mo(r+1)}var Ha={pdf:function(t,e){return t<0?0:t===0&&e===2?.5:Math.exp((e/2-1)*Math.log(t)-t/2-e/2*Math.log(2)-st(e/2))},cdf:function(t,e){return t<0?0:vd(e/2,t/2)},inv:function(t,e){return 2*Q9(t,.5*e)}},Wa={pdf:function(t,e,n){var a,i,o;return t<0?0:e<=2?t===0&&e<2?1/0:t===0&&e===2?1:1/md(e/2,n/2)*Math.pow(e/n,e/2)*Math.pow(t,e/2-1)*Math.pow(1+e/n*t,-(e+n)/2):(a=e*t/(n+t*e),i=n/(n+t*e),o=e*i/2,o*Il.pdf((e-2)/2,(e+n-2)/2,a))},cdf:function(t,e,n){return t<0?0:_l(e*t/(e*t+n),e/2,n/2)},inv:function(t,e,n){return n/(e*(1/gd(t,e/2,n/2)-1))}},rR={pdf:function(t,e,n){return t<0||e<0||n<0?0:n/e*Math.pow(t/e,n-1)*Math.exp(-Math.pow(t/e,n))},cdf:function(t,e,n){return t<0?0:1-Math.exp(-Math.pow(t/e,n))}},Rd={pdf:function(t,e){return e<0||t%1!=0||t<0?0:Math.pow(e,t)*Math.exp(-e)/Ml(t)},cdf:function(t,e){var n=0;if(t<0)return 0;for(var a=0;n<=t;n++)a+=Rd.pdf(n,e);return a}},Xr={pdf:function(t,e,n,a){if(t<0||t<n-(e-a))return 0;if(t>a||t>n)return 0;if(n*2>e)return a*2>e?Xr.pdf(e-n-a+t,e,e-n,e-a):Xr.pdf(a-t,e,e-n,a);if(a*2>e)return Xr.pdf(n-t,e,n,e-a);if(n<a)return Xr.pdf(t,e,a,n);for(var i=1,o=0,u=0;u<t;u++){for(;i>1&&o<a;)i*=1-n/(e-o),o++;i*=(a-u)*(n-u)/((u+1)*(e-n-a+u+1))}for(;o<a;o++)i*=1-n/(e-o);return Math.min(1,Math.max(0,i))},cdf:function r(t,e,n,a){if(t<0||t<n-(e-a))return 0;if(t>=a||t>=n)return 1;if(n*2>e)return a*2>e?r(e-n-a+t,e,e-n,e-a):1-Xr.cdf(a-t-1,e,e-n,a);if(a*2>e)return 1-Xr.cdf(n-t-1,e,n,e-a);if(n<a)return Xr.cdf(t,e,a,n);for(var i=1,o=1,u=0,s=0;s<t;s++){for(;i>1&&u<a;){var l=1-n/(e-u);o*=l,i*=l,u++}o*=(a-s)*(n-s)/((s+1)*(e-n-a+s+1)),i+=o}for(;u<a;u++)i*=1-n/(e-u);return Math.min(1,Math.max(0,i))}},tr={pdf:function(t,e){return e=e>1e100?1e100:e,1/(Math.sqrt(e)*md(.5,e/2))*Math.pow(1+t*t/e,-((e+1)/2))},cdf:function(t,e){var n=e/2;return _l((t+Math.sqrt(t*t+e))/(2*Math.sqrt(t*t+e)),n,n)},inv:function(t,e){var n=gd(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}},bd={pdf:function(t,e,n){return t<=0?0:Math.exp(-Math.log(t)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(t)-e,2)/(2*n*n))},cdf:function(t,e,n){return t<0?0:.5+.5*ja((Math.log(t)-e)/Math.sqrt(2*n*n))},inv:function(t,e,n){return Math.exp(-1.4142135623730951*n*X9(2*t)+e)}},Sd={pdf:function(t,e,n){return t!==t>>>0?!1:t<0?0:tR(t+e-1,e-1)*Math.pow(1-n,t)*Math.pow(n,e)},cdf:function(t,e,n){var a=0,i=0;if(t<0)return 0;for(;i<=t;i++)a+=Sd.pdf(i,e,n);return a}};function nR(r){for(var t=0,e=r.length;--e>=0;)t+=r[e];return t}function rr(r){return nR(r)/r.length}function Yn(r){for(var t=rr(r),e=0,n=r.length,a;--n>=0;)a=r[n]-t,e+=a*a;return e}function go(r,t){return Yn(r)/(r.length-(t?1:0))}function bn(r,t){return Math.sqrt(go(r,t))}function Vte(){var r=[].slice.call(arguments),t=new Array(2),e;return r.length===4?e=Math.abs(vr.inv(r[1]/2,0,1)*r[2]/Math.sqrt(r[3])):e=Math.abs(vr.inv(r[1]/2,0,1)*bn(r[2])/Math.sqrt(r[2].length)),t[0]=r[0]-e,t[1]=r[0]+e,t}function Gte(){var r=[].slice.call(arguments),t=new Array(2),e;return r.length===4?e=Math.abs(tr.inv(r[1]/2,r[3]-1)*r[2]/Math.sqrt(r[3])):e=Math.abs(tr.inv(r[1]/2,r[2].length-1)*bn(r[2],!0)/Math.sqrt(r[2].length)),t[0]=r[0]-e,t[1]=r[0]+e,t}function jte(r){for(var t=1,e=r.length;--e>=0;)t*=r[e];return t}function Hte(r){return Math.pow(jte(r),1/r.length)}function Eo(r,t){var e=rr(r),n=rr(t),a=r.length,i=new Array(a),o;for(o=0;o<a;o++)i[o]=(r[o]-e)*(t[o]-n);return nR(i)/(a-1)}function aR(r,t){return Eo(r,t)/bn(r,1)/bn(t,1)}function Ad(r){return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(r)}function Wte(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function iR(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function zte(r,t,e){return t&&iR(r.prototype,t),e&&iR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Yte(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Td(r,t)}function Td(r,t){return Td=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Td(r,t)}function Kte(r){var t=Qte();return function(){var n=kl(r),a;if(t){var i=kl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Xte(this,a)}}function Xte(r,t){if(t&&(Ad(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qte(r)}function qte(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Qte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kl(r){return kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kl(r)}var Od=function(r){Yte(e,r);var t=Kte(e);function e(){return Wte(this,e),t.apply(this,arguments)}return zte(e,[{key:"erf",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ERF"),function(o,u){return u===void 0?ja(o):ja(u)-ja(o)})}},{key:"erfc",value:function(a,i){return this.runFunction(a.args,i,this.metadata("ERFC"),K9)}},{key:"expondist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("EXPON.DIST"),function(o,u,s){return s?q9.cdf(o,u):q9.pdf(o,u)})}},{key:"fisher",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FISHER"),function(o){return Math.log((1+o)/(1-o))/2})}},{key:"fisherinv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FISHERINV"),function(o){return 1-2/(Math.exp(2*o)+1)})}},{key:"gamma",value:function(a,i){return this.runFunction(a.args,i,this.metadata("GAMMA"),mo)}},{key:"gammadist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("GAMMA.DIST"),function(o,u,s,l){return l?dd.cdf(o,u,s):dd.pdf(o,u,s)})}},{key:"gammaln",value:function(a,i){return this.runFunction(a.args,i,this.metadata("GAMMALN"),st)}},{key:"gammainv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("GAMMA.INV"),dd.inv)}},{key:"gauss",value:function(a,i){return this.runFunction(a.args,i,this.metadata("GAUSS"),function(o){return vr.cdf(o,0,1)-.5})}},{key:"betadist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BETA.DIST"),function(o,u,s,l,f,c){return o<=f?new m(E.NUM,S.ValueSmall):o>=c?new m(E.NUM,S.ValueLarge):(o=(o-f)/(c-f),l?yd.cdf(o,u,s):yd.pdf(o,u,s))})}},{key:"betainv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BETA.INV"),function(o,u,s,l,f){return l>=f?new m(E.NUM,S.WrongOrder):yd.inv(o,u,s)*(f-l)+l})}},{key:"binomialdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BINOM.DIST"),function(o,u,s,l){return o>u?new m(E.NUM,S.WrongOrder):(o=Math.trunc(o),u=Math.trunc(u),l?Il.cdf(o,u,s):Il.pdf(o,u,s))})}},{key:"binomialinv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BINOM.INV"),function(o,u,s){o=Math.trunc(o);for(var l=-1,f=o;f>l+1;){var c=Math.trunc((l+f)/2);Il.cdf(c,o,u)>=s?f=c:l=c}return f})}},{key:"besselifn",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BESSELI"),function(o,u){return pd(o,Math.trunc(u))})}},{key:"besseljfn",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BESSELJ"),function(o,u){return hd(o,Math.trunc(u))})}},{key:"besselkfn",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BESSELK"),function(o,u){return xte(o,Math.trunc(u))})}},{key:"besselyfn",value:function(a,i){return this.runFunction(a.args,i,this.metadata("BESSELY"),function(o,u){return Ute(o,Math.trunc(u))})}},{key:"chisqdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHISQ.DIST"),function(o,u,s){return u=Math.trunc(u),s?Ha.cdf(o,u):Ha.pdf(o,u)})}},{key:"chisqdistrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHISQ.DIST.RT"),function(o,u){return 1-Ha.cdf(o,Math.trunc(u))})}},{key:"chisqinv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHISQ.INV"),function(o,u){return Ha.inv(o,Math.trunc(u))})}},{key:"chisqinvrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHISQ.INV.RT"),function(o,u){return Ha.inv(1-o,Math.trunc(u))})}},{key:"fdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("F.DIST"),function(o,u,s,l){return u=Math.trunc(u),s=Math.trunc(s),l?Wa.cdf(o,u,s):Wa.pdf(o,u,s)})}},{key:"fdistrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("F.DIST.RT"),function(o,u,s){return 1-Wa.cdf(o,Math.trunc(u),Math.trunc(s))})}},{key:"finv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("F.INV"),function(o,u,s){return Wa.inv(o,Math.trunc(u),Math.trunc(s))})}},{key:"finvrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("F.INV.RT"),function(o,u,s){return Wa.inv(1-o,Math.trunc(u),Math.trunc(s))})}},{key:"weibulldist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("WEIBULL.DIST"),function(o,u,s,l){return l?rR.cdf(o,s,u):rR.pdf(o,s,u)})}},{key:"poissondist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("POISSON.DIST"),function(o,u,s){return o=Math.trunc(o),s?Rd.cdf(o,u):Rd.pdf(o,u)})}},{key:"hypgeomdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("HYPGEOM.DIST"),function(o,u,s,l,f){return o>u||o>s||u>l||s>l?new m(E.NUM,S.ValueLarge):o+l<s+u?new m(E.NUM,S.ValueLarge):(o=Math.trunc(o),u=Math.trunc(u),s=Math.trunc(s),l=Math.trunc(l),f?Xr.cdf(o,l,s,u):Xr.pdf(o,l,s,u))})}},{key:"tdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T.DIST"),function(o,u,s){return u=Math.trunc(u),s?tr.cdf(o,u):tr.pdf(o,u)})}},{key:"tdist2t",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T.DIST.2T"),function(o,u){return(1-tr.cdf(o,Math.trunc(u)))*2})}},{key:"tdistrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T.DIST.RT"),function(o,u){return 1-tr.cdf(o,Math.trunc(u))})}},{key:"tdistold",value:function(a,i){return this.runFunction(a.args,i,this.metadata("TDIST"),function(o,u,s){return s*(1-tr.cdf(o,Math.trunc(u)))})}},{key:"tinv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T.INV"),function(o,u){return tr.inv(o,Math.trunc(u))})}},{key:"tinv2t",value:function(a,i){return this.runFunction(a.args,i,this.metadata("T.INV.2T"),function(o,u){return tr.inv(1-o/2,Math.trunc(u))})}},{key:"lognormdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LOGNORM.DIST"),function(o,u,s,l){return l?bd.cdf(o,u,s):bd.pdf(o,u,s)})}},{key:"lognorminv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("LOGNORM.INV"),function(o,u,s){return bd.inv(o,u,s)})}},{key:"normdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NORM.DIST"),function(o,u,s,l){return l?vr.cdf(o,u,s):vr.pdf(o,u,s)})}},{key:"norminv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NORM.INV"),function(o,u,s){return vr.inv(o,u,s)})}},{key:"normsdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NORM.S.DIST"),function(o,u){return u?vr.cdf(o,0,1):vr.pdf(o,0,1)})}},{key:"normsinv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NORM.S.INV"),function(o){return vr.inv(o,0,1)})}},{key:"phi",value:function(a,i){return this.runFunction(a.args,i,this.metadata("PHI"),function(o){return vr.pdf(o,0,1)})}},{key:"negbinomdist",value:function(a,i){return this.runFunction(a.args,i,this.metadata("NEGBINOM.DIST"),function(o,u,s,l){return o=Math.trunc(o),u=Math.trunc(u),l?Sd.cdf(o,u,s):Sd.pdf(o,u,s)})}},{key:"confidencenorm",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CONFIDENCE.NORM"),function(o,u,s){return Vte(1,o,u,Math.trunc(s))[1]-1})}},{key:"confidencet",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CONFIDENCE.T"),function(o,u,s){return s=Math.trunc(s),s===1?new m(E.DIV_BY_ZERO):Gte(1,o,u,s)[1]-1})}},{key:"standardize",value:function(a,i){return this.runFunction(a.args,i,this.metadata("STANDARDIZE"),function(o,u,s){return(o-u)/s})}}]),e}(ee);Od.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:d.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:d.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:d.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:d.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:d.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:d.NUMBER,minValue:0,lessThan:1},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:d.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:d.NUMBER,greaterThan:0,maxValue:1},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,defaultValue:0},{argumentType:d.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:1,maxValue:1e10},{argumentType:d.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1},{argumentType:d.NUMBER,minValue:1},{argumentType:d.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1},{argumentType:d.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.NUMBER,minValue:1},{argumentType:d.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.NUMBER,minValue:1},{argumentType:d.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0},{argumentType:d.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:1},{argumentType:d.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1},{argumentType:d.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1},{argumentType:d.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:d.NUMBER,greaterThan:0,maxValue:1},{argumentType:d.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:d.NUMBER},{argumentType:d.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:d.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:1},{argumentType:d.NUMBER,minValue:0,maxValue:1},{argumentType:d.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:d.NUMBER,greaterThan:0,lessThan:1},{argumentType:d.NUMBER,greaterThan:0},{argumentType:d.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER,greaterThan:0}]}};Od.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};var Zte=z;Zte({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});function wd(r){return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(r)}function Nd(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Jte(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Jte(r,t){if(!!r){if(typeof r=="string")return oR(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return oR(r,t)}}function oR(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function ere(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function uR(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function tre(r,t,e){return t&&uR(r.prototype,t),e&&uR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function rre(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Cd(r,t)}function Cd(r,t){return Cd=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Cd(r,t)}function nre(r){var t=ore();return function(){var n=Fl(r),a;if(t){var i=Fl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return are(this,a)}}function are(r,t){if(t&&(wd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ire(r)}function ire(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ore(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fl(r){return Fl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fl(r)}var sR=function(r){rre(e,r);var t=nre(e);function e(){return ere(this,e),t.apply(this,arguments)}return tre(e,[{key:"fact",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FACT"),function(o){o=Math.trunc(o);for(var u=1,s=1;s<=o;s++)u*=s;return u})}},{key:"factdouble",value:function(a,i){return this.runFunction(a.args,i,this.metadata("FACTDOUBLE"),function(o){o=Math.trunc(o);for(var u=1,s=o;s>=1;s-=2)u*=s;return u})}},{key:"combin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COMBIN"),function(o,u){return u>o?new m(E.NUM,S.WrongOrder):(o=Math.trunc(o),u=Math.trunc(u),lR(o,u))})}},{key:"combina",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COMBINA"),function(o,u){return o=Math.trunc(o),u=Math.trunc(u),o+u-1>=1030?new m(E.NUM,S.ValueLarge):o===0&&u===0?1:lR(o+u-1,u)})}},{key:"gcd",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("GCD"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(s);if(f instanceof m)return f;var c=0,h=Nd(f),p;try{for(h.s();!(p=h.n()).done;){var y=p.value;if(y<0)return new m(E.NUM,S.ValueSmall);c=fR(c,Math.trunc(y))}}catch(v){h.e(v)}finally{h.f()}return c>Number.MAX_SAFE_INTEGER?new m(E.NUM,S.ValueLarge):c})}},{key:"lcm",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("LCM"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(s);if(f instanceof m)return f;var c=1,h=Nd(f),p;try{for(h.s();!(p=h.n()).done;){var y=p.value;if(y<0)return new m(E.NUM,S.ValueSmall);c=ure(c,Math.trunc(y))}}catch(v){h.e(v)}finally{h.f()}return c>Number.MAX_SAFE_INTEGER?new m(E.NUM,S.ValueLarge):c})}},{key:"mround",value:function(a,i){return this.runFunction(a.args,i,this.metadata("MROUND"),function(o,u){return u===0?0:o>0&&u<0||o<0&&u>0?new m(E.NUM,S.DistinctSigns):Math.round(o/u)*u})}},{key:"multinomial",value:function(a,i){return this.runFunction(a.args,i,this.metadata("MULTINOMIAL"),function(){for(var o=0,u=1,s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];for(var c=0,h=l;c<h.length;c++){var p=h[c];if(p<0)return new m(E.NUM,S.ValueSmall);p=Math.trunc(p);for(var y=1;y<=p;y++)u*=(o+y)/y;o+=p}return Math.round(u)})}},{key:"quotient",value:function(a,i){return this.runFunction(a.args,i,this.metadata("QUOTIENT"),function(o,u){return u===0?new m(E.DIV_BY_ZERO):Math.trunc(o/u)})}},{key:"seriessum",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SERIESSUM"),function(u,s,l,f){var c=o.arithmeticHelper.manyToOnlyNumbersDropNulls(f.valuesFromTopLeftCorner());if(c instanceof m)return c;var h=0;c.reverse();var p=Nd(c),y;try{for(p.s();!(y=p.n()).done;){var v=y.value;h*=Math.pow(u,l),h+=v}}catch(R){p.e(R)}finally{p.f()}return h*Math.pow(u,s)})}},{key:"sign",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SIGN"),function(o){return o>0?1:o<0?-1:0})}},{key:"sumx2my2",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SUMX2MY2"),function(o,u){var s=o.valuesFromTopLeftCorner(),l=u.valuesFromTopLeftCorner();if(s.length!==l.length)return new m(E.NA,S.EqualLength);for(var f=s.length,c=0,h=0;h<f;h++){var p=s[h],y=l[h];if(p instanceof m)return p;if(y instanceof m)return y;typeof p=="number"&&typeof y=="number"&&(c+=Math.pow(p,2)-Math.pow(y,2))}return c})}},{key:"sumx2py2",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SUMX2PY2"),function(o,u){var s=o.valuesFromTopLeftCorner(),l=u.valuesFromTopLeftCorner();if(s.length!==l.length)return new m(E.NA,S.EqualLength);for(var f=s.length,c=0,h=0;h<f;h++){var p=s[h],y=l[h];if(p instanceof m)return p;if(y instanceof m)return y;typeof p=="number"&&typeof y=="number"&&(c+=Math.pow(p,2)+Math.pow(y,2))}return c})}},{key:"sumxmy2",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SUMXMY2"),function(o,u){var s=o.valuesFromTopLeftCorner(),l=u.valuesFromTopLeftCorner();if(s.length!==l.length)return new m(E.NA,S.EqualLength);for(var f=s.length,c=0,h=0;h<f;h++){var p=s[h],y=l[h];if(p instanceof m)return p;if(y instanceof m)return y;typeof p=="number"&&typeof y=="number"&&(c+=Math.pow(p-y,2))}return c})}}]),e}(ee);sR.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:d.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:d.NUMBER,minValue:0,lessThan:1030},{argumentType:d.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:d.NUMBER,minValue:0},{argumentType:d.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:d.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:d.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]}};function lR(r,t){2*t>r&&(t=r-t);for(var e=1,n=1;n<=t;n++)e*=(r-t+n)/n;return Math.round(e)}function fR(r,t){if(r<t){var e=[t,r];r=e[0],t=e[1]}for(;t>0;){var n=[t,r%t];r=n[0],t=n[1]}return r}function ure(r,t){return r===0||t===0?0:r*(t/fR(r,t))}function _d(r){return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(r)}function cR(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=hR(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Pe(r,t){return fre(r)||lre(r,t)||hR(r,t)||sre()}function sre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hR(r,t){if(!!r){if(typeof r=="string")return pR(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pR(r,t)}}function pR(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function lre(r,t){var e=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,u;try{for(e=e.call(r);!(a=(o=e.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(s){i=!0,u=s}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw u}}return n}}function fre(r){if(Array.isArray(r))return r}function cre(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function dR(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function hre(r,t,e){return t&&dR(r.prototype,t),e&&dR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function pre(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Id(r,t)}function Id(r,t){return Id=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Id(r,t)}function dre(r){var t=mre();return function(){var n=Pl(r),a;if(t){var i=Pl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return vre(this,a)}}function vre(r,t){if(t&&(_d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yre(r)}function yre(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function mre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pl(r){return Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pl(r)}var vR=function(r){pre(e,r);var t=dre(e);function e(){return cre(this,e),t.apply(this,arguments)}return hre(e,[{key:"complex",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COMPLEX"),function(o,u,s){return s!=="i"&&s!=="j"?new m(E.VALUE,S.ShouldBeIorJ):De([o,u],s)})}},{key:"imabs",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMABS"),RR)}},{key:"imaginary",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMAGINARY"),function(o){var u=Pe(o,2);u[0];var s=u[1];return s})}},{key:"imreal",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMREAL"),function(o){var u=Pe(o,2),s=u[0];return u[1],s})}},{key:"imargument",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMARGUMENT"),function(o){var u=Pe(o,2),s=u[0],l=u[1];return s===0&&l===0?new m(E.DIV_BY_ZERO):Math.atan2(l,s)})}},{key:"imconjugate",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCONJUGATE"),function(o){var u=Pe(o,2),s=u[0],l=u[1];return De([s,-l])})}},{key:"imcos",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCOS"),function(o){return De($l(o))})}},{key:"imcosh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCOSH"),function(o){return De(mR(o))})}},{key:"imcot",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCOT"),function(o){return De(Kn($l(o),Dl(o)))})}},{key:"imcsc",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCSC"),function(o){return De(Kn([1,0],Dl(o)))})}},{key:"imcsch",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMCSCH"),function(o){return De(Kn([1,0],gR(o)))})}},{key:"imsec",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSEC"),function(o){return De(Kn([1,0],$l(o)))})}},{key:"imsech",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSECH"),function(o){return De(Kn([1,0],mR(o)))})}},{key:"imsin",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSIN"),function(o){return De(Dl(o))})}},{key:"imsinh",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSINH"),function(o){return De(gR(o))})}},{key:"imtan",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMTAN"),function(o){return De(Kn(Dl(o),$l(o)))})}},{key:"imdiv",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMDIV"),function(o,u){return De(Kn(o,u))})}},{key:"improduct",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("IMPRODUCT"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceComplexExactRanges(s);if(f instanceof m)return f;var c=[1,0],h=cR(f),p;try{for(h.s();!(p=h.n()).done;){var y=p.value;c=yR(c,y)}}catch(v){h.e(v)}finally{h.f()}return De(c)})}},{key:"imsum",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("IMSUM"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceComplexExactRanges(s);if(f instanceof m)return f;var c=[0,0],h=cR(f),p;try{for(h.s();!(p=h.n()).done;){var y=p.value;c=gre(c,y)}}catch(v){h.e(v)}finally{h.f()}return De(c)})}},{key:"imsub",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSUB"),function(o,u){return De(Ere(o,u))})}},{key:"imexp",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMEXP"),function(o){return De(ER(o))})}},{key:"imln",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMLN"),function(o){return De(Ll(o))})}},{key:"imlog10",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMLOG10"),function(o){var u=Ll(o),s=Pe(u,2),l=s[0],f=s[1],c=Math.log(10);return De([l/c,f/c])})}},{key:"imlog2",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMLOG2"),function(o){var u=Ll(o),s=Pe(u,2),l=s[0],f=s[1],c=Math.log(2);return De([l/c,f/c])})}},{key:"impower",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMPOWER"),function(o,u){return De(bR(o,u))})}},{key:"imsqrt",value:function(a,i){return this.runFunction(a.args,i,this.metadata("IMSQRT"),function(o){return De(bR(o,.5))})}}]),e}(ee);vR.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:d.NUMBER},{argumentType:d.NUMBER},{argumentType:d.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:d.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:d.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:d.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:d.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:d.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:d.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:d.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:d.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:d.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:d.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:d.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:d.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:d.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:d.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:d.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:d.COMPLEX},{argumentType:d.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:d.COMPLEX},{argumentType:d.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:d.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:d.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:d.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:d.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:d.COMPLEX},{argumentType:d.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:d.COMPLEX}]}};function gre(r,t){var e=Pe(r,2),n=e[0],a=e[1],i=Pe(t,2),o=i[0],u=i[1];return[n+o,a+u]}function Ere(r,t){var e=Pe(r,2),n=e[0],a=e[1],i=Pe(t,2),o=i[0],u=i[1];return[n-o,a-u]}function yR(r,t){var e=Pe(r,2),n=e[0],a=e[1],i=Pe(t,2),o=i[0],u=i[1];return[n*o-a*u,n*u+o*a]}function Kn(r,t){var e=Pe(r,2),n=e[0],a=e[1],i=Pe(t,2),o=i[0],u=i[1],s=Math.pow(o,2)+Math.pow(u,2),l=yR([n,a],[o,-u]),f=Pe(l,2),c=f[0],h=f[1];return[c/s,h/s]}function $l(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.cos(e)*Math.cosh(n),-Math.sin(e)*Math.sinh(n)]}function mR(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.cosh(e)*Math.cos(n),Math.sinh(e)*Math.sin(n)]}function Dl(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.sin(e)*Math.cosh(n),Math.cos(e)*Math.sinh(n)]}function gR(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.sinh(e)*Math.cos(n),Math.cosh(e)*Math.sin(n)]}function ER(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.exp(e)*Math.cos(n),Math.exp(e)*Math.sin(n)]}function RR(r){var t=Pe(r,2),e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function Ll(r){var t=Pe(r,2),e=t[0],n=t[1];return[Math.log(RR([e,n])),Math.atan2(n,e)]}function bR(r,t){var e=Ll(r),n=Pe(e,2),a=n[0],i=n[1];return ER([t*a,t*i])}function Md(r){return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(r)}function SR(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Rre(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Rre(r,t){if(!!r){if(typeof r=="string")return AR(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return AR(r,t)}}function AR(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function bre(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function TR(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Sre(r,t,e){return t&&TR(r.prototype,t),e&&TR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Are(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&kd(r,t)}function kd(r,t){return kd=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},kd(r,t)}function Tre(r){var t=Nre();return function(){var n=Ul(r),a;if(t){var i=Ul(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ore(this,a)}}function Ore(r,t){if(t&&(Md(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wre(r)}function wre(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Nre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ul(r){return Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ul(r)}var Fd=function(r){Are(e,r);var t=Tre(e);function e(){return bre(this,e),t.apply(this,arguments)}return Sre(e,[{key:"avedev",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("AVEDEV"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);if(f instanceof m)return f;if(f.length===0)return new m(E.DIV_BY_ZERO);var c=rr(f);return f.reduce(function(h,p){return h+Math.abs(p-c)},0)/f.length})}},{key:"devsq",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("DEVSQ"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);return f instanceof m?f:f.length===0?0:Yn(f)})}},{key:"geomean",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("GEOMEAN"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);if(f instanceof m)return f;if(f.length===0)return new m(E.NUM,S.OneValue);var c=SR(f),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;if(p<=0)return new m(E.NUM,S.ValueSmall)}}catch(y){c.e(y)}finally{c.f()}return Hte(f)})}},{key:"harmean",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("HARMEAN"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);if(f instanceof m)return f;if(f.length===0)return new m(E.NUM,S.OneValue);var c=SR(f),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;if(p<=0)return new m(E.NUM,S.ValueSmall)}}catch(y){c.e(y)}finally{c.f()}return f.length/f.reduce(function(y,v){return y+1/v},0)})}},{key:"correl",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CORREL"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<=1?new m(E.DIV_BY_ZERO,S.TwoValues):aR(s[0],s[1])})}},{key:"rsq",value:function(a,i){return this.runFunction(a.args,i,this.metadata("RSQ"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<=1?new m(E.DIV_BY_ZERO,S.TwoValues):Math.pow(aR(s[0],s[1]),2)})}},{key:"covariancep",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COVARIANCE.P"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<1?new m(E.DIV_BY_ZERO,S.OneValue):l===1?0:Eo(s[0],s[1])*(l-1)/l})}},{key:"covariances",value:function(a,i){return this.runFunction(a.args,i,this.metadata("COVARIANCE.S"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<=1?new m(E.DIV_BY_ZERO,S.TwoValues):Eo(s[0],s[1])})}},{key:"ztest",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("Z.TEST"),function(u,s,l){var f=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner());if(f instanceof m)return f;var c=f.length;if(l===void 0){if(c<2)return new m(E.DIV_BY_ZERO,S.TwoValues);l=bn(f,!0)}return c<1?new m(E.NA,S.OneValue):l===0?new m(E.DIV_BY_ZERO):1-vr.cdf((rr(f)-s)/(l/Math.sqrt(c)),0,1)})}},{key:"ftest",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("F.TEST"),function(u,s){var l=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner()),f=o.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(l instanceof m)return l;if(f instanceof m)return f;if(l.length<=1||f.length<=1)return new m(E.DIV_BY_ZERO);var c=go(l,!0),h=go(f,!0);if(c===0||h===0)return new m(E.DIV_BY_ZERO);var p=c/h,y=Wa.cdf(p,l.length-1,f.length-1);return 2*Math.min(y,1-y)})}},{key:"steyx",value:function(a,i){return this.runFunction(a.args,i,this.metadata("STEYX"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<=2?new m(E.DIV_BY_ZERO,S.ThreeValues):Math.sqrt((Yn(s[0])-Math.pow(Eo(s[0],s[1])*(l-1),2)/Yn(s[1]))/(l-2))})}},{key:"slope",value:function(a,i){return this.runFunction(a.args,i,this.metadata("SLOPE"),function(o,u){if(o.numberOfElements()!==u.numberOfElements())return new m(E.NA,S.EqualLength);var s=Xn(o,u);if(s instanceof m)return s;var l=s[0].length;return l<=1?new m(E.DIV_BY_ZERO,S.TwoValues):Eo(s[0],s[1])*(l-1)/Yn(s[1])})}},{key:"chisqtest",value:function(a,i){return this.runFunction(a.args,i,this.metadata("CHISQ.TEST"),function(o,u){var s=o.height(),l=o.width();if(u.height()!==s||u.width()!==l)return new m(E.NA,S.EqualLength);var f=Xn(o,u);if(f instanceof m)return f;if(f[0].length<=1)return new m(E.DIV_BY_ZERO,S.TwoValues);for(var c=0,h=0;h<f[0].length;h++){if(f[1][h]===0)return new m(E.DIV_BY_ZERO);c+=Math.pow(f[0][h]-f[1][h],2)/f[1][h]}return c<0?new m(E.NUM,S.NaN):1-Ha.cdf(c,s>1&&l>1?(s-1)*(l-1):s*l-1)})}},{key:"ttest",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("T.TEST"),function(u,s,l,f){var c=o.arithmeticHelper.manyToExactNumbers(u.valuesFromTopLeftCorner()),h=o.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(c instanceof m)return c;if(h instanceof m)return h;var p=c.length,y=h.length;if(f===1){if(y!==p)return new m(E.NA,S.EqualLength);if(p<=1)return new m(E.DIV_BY_ZERO,S.TwoValues);for(var v=Array(p),R=0;R<p;R++)v[R]=c[R]-h[R];var g=bn(v,!0);if(g===0)return new m(E.DIV_BY_ZERO);var A=Math.abs(Math.sqrt(p)*rr(v)/g);return l*(1-tr.cdf(A,p-1))}else if(f===2){if(p<=1||y<=1)return new m(E.DIV_BY_ZERO,S.TwoValues);var T=(Yn(c)+Yn(h))/(p+y-2);if(T===0)return new m(E.DIV_BY_ZERO);var N=Math.abs((rr(c)-rr(h))/Math.sqrt(T*(1/p+1/y)));return l*(1-tr.cdf(N,p+y-2))}else{if(p<=1||y<=1)return new m(E.DIV_BY_ZERO,S.TwoValues);var M=go(c,!0),_=go(h,!0);if(M===0&&_===0)return new m(E.DIV_BY_ZERO);var $=Math.abs((rr(c)-rr(h))/Math.sqrt(M/p+_/y)),x=Math.pow(M/p+_/y,2)/(Math.pow(M/p,2)/(p-1)+Math.pow(_/y,2)/(y-1));return l*(1-tr.cdf($,x))}})}},{key:"skew",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SKEW"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);if(f instanceof m)return f;var c=f.length;if(c<3)return new m(E.DIV_BY_ZERO,S.ThreeValues);var h=rr(f),p=bn(f,!0);return p===0?new m(E.DIV_BY_ZERO):f.reduce(function(y,v){return y+Math.pow((v-h)/p,3)},0)*c/(c-1)/(c-2)})}},{key:"skewp",value:function(a,i){var o=this;return this.runFunction(a.args,i,this.metadata("SKEW.P"),function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=o.arithmeticHelper.coerceNumbersExactRanges(s);if(f instanceof m)return f;var c=f.length;if(c<3)return new m(E.DIV_BY_ZERO,S.ThreeValues);var h=rr(f),p=bn(f,!1);return p===0?new m(E.DIV_BY_ZERO):f.reduce(function(y,v){return y+Math.pow((v-h)/p,3)},0)/c})}}]),e}(ee);Fd.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:d.RANGE},{argumentType:d.NUMBER},{argumentType:d.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:d.RANGE},{argumentType:d.RANGE},{argumentType:d.INTEGER,minValue:1,maxValue:2},{argumentType:d.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:d.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:d.ANY}],repeatLastArgs:1}};Fd.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function Xn(r,t){for(var e=r.iterateValuesFromTopLeftCorner(),n=t.iterateValuesFromTopLeftCorner(),a,i,o=[],u=[];a=e.next(),i=n.next(),!a.done&&!i.done;){var s=a.value,l=i.value;if(s instanceof m)return s;if(l instanceof m)return l;de(s)&&de(l)&&(o.push(F(s)),u.push(F(l)))}return[o,u]}/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */var OR=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ArrayPlugin:$3,AbsPlugin:L3,BitShiftPlugin:V3,BitwiseLogicOperationsPlugin:z3,BooleanPlugin:K3,CharPlugin:Z3,CodePlugin:eE,CountBlankPlugin:rE,CountUniquePlugin:aE,DateTimePlugin:uE,DegreesPlugin:hE,DeltaPlugin:dE,ExpPlugin:yE,FinancialPlugin:EE,FormulaTextPlugin:SE,InformationPlugin:TE,IsEvenPlugin:wE,IsOddPlugin:CE,LogarithmPlugin:IE,MathConstantsPlugin:kE,MatrixPlugin:LE,MedianPlugin:xE,ModuloPlugin:VE,NumericAggregationPlugin:_p,PowerPlugin:KE,RadiansPlugin:qE,RadixConversionPlugin:t9,RandomPlugin:i9,RoundingPlugin:Bp,SqrtPlugin:f9,SumifPlugin:S9,SumprodPlugin:O9,TextPlugin:N9,TrigonometryPlugin:U9,LookupPlugin:V9,RomanPlugin:j9,SimpleArithmerticPlugin:W9,StatisticalPlugin:Od,MathPlugin:sR,ComplexPlugin:vR,StatisticalAggregationPlugin:Fd});function Pd(r){return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(r)}function Cre(r,t){var e=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=_re(r))||t&&r&&typeof r.length=="number"){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,u;return{s:function(){e=e.call(r)},n:function(){var l=e.next();return i=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function _re(r,t){if(!!r){if(typeof r=="string")return wR(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wR(r,t)}}function wR(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function NR(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Ire(r,t,e){return t&&NR(r.prototype,t),e&&NR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Mre(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function kre(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&$d(r,t)}function $d(r,t){return $d=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},$d(r,t)}function Fre(r){var t=Dre();return function(){var n=xl(r),a;if(t){var i=xl(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Pre(this,a)}}function Pre(r,t){if(t&&(Pd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $re(r)}function $re(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Dre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xl(r){return xl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xl(r)}var se=function(r){kre(e,r);var t=Fre(e);function e(){return Mre(this,e),t.apply(this,arguments)}return Ire(e)}(Dt);se.HyperFormula=Dt;se.ErrorType=E;se.CellType=kt;se.CellValueType=cr;se.CellValueDetailedType=HG;se.DetailedCellError=u4;se.ExportedCellChange=o2;se.ExportedNamedExpressionChange=z8;se.ConfigValueTooBigError=Hy;se.ConfigValueTooSmallError=jy;se.EvaluationSuspendedError=zy;se.ExpectedOneOfValuesError=Wy;se.ExpectedValueOfTypeError=he;se.FunctionPlugin=ee;se.FunctionPluginValidationError=Gc;se.InvalidAddressError=Dy;se.InvalidArgumentsError=Ye;se.LanguageNotRegisteredError=Vc;se.LanguageAlreadyRegisteredError=Ky;se.MissingTranslationError=ha;se.NamedExpressionDoesNotExistError=Ii;se.NamedExpressionNameIsAlreadyTakenError=Ly;se.NamedExpressionNameIsInvalidError=Uy;se.NoOperationToRedoError=By;se.NoOperationToUndoError=xy;se.NoRelativeAddressesAllowedError=Hc;se.NoSheetWithIdError=Me;se.NoSheetWithNameError=$y;se.NotAFormulaError=Bc;se.NothingToPasteError=Vy;se.ProtectedFunctionTranslationError=Yy;se.SheetNameAlreadyTakenError=_i;se.SheetSizeLimitExceededError=$n;se.SourceLocationHasArrayError=pa;se.TargetLocationHasArrayError=su;se.UnableToParseError=Gy;var Lre=zr.defaultConfig.language;Dt.registerLanguage(Lre,O2);Dt.languages[O2.langCode]=O2;var Bl=Cre(Object.getOwnPropertyNames(OR)),CR;try{for(Bl.s();!(CR=Bl.n()).done;){var _R=CR.value;_R.startsWith("_")||Dt.registerFunctionPlugin(OR[_R])}}catch(r){Bl.e(r)}finally{Bl.f()}export{Dt as H};
