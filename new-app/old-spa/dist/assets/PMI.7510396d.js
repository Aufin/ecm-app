var oe=Object.defineProperty,ae=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var H=(u,o,s)=>o in u?oe(u,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[o]=s,W=(u,o)=>{for(var s in o||(o={}))se.call(o,s)&&H(u,s,o[s]);if(E)for(var s of E(o))ne.call(o,s)&&H(u,s,o[s]);return u},$=(u,o)=>ae(u,le(o));import{r as a,o as i,A as c,j,C as A,c as D,q as ue,w as T,y as l,i as q,b as f,H as re,Z as b,ae as R,a as z,F as Y,af as Z,ag as ie,e as de,h as y}from"./vendor.7b6f695f.js";import{R as ce}from"./Report.99ffdd4b.js";import{_ as pe}from"./SelectSyndicate.9cf21e1b.js";import{_ as me,d as ve}from"./index.ad6f86f2.js";import{a as U}from"./axios.3fa379ca.js";import{k as ke}from"./@vueform/multiselect.69d395cc.js";import{_ as fe}from"./DateTimePicker.7ab0efe6.js";import{U as G}from"./uikit.bf3afdb6.js";import"./vue3-datepicker.8db1d195.js";import"./xlsx-js-style.0235676d.js";import"./exceljs.4eeb6046.js";import"./clusterize.js.78919985.js";import"./file-saver.55724082.js";import"./numfmt.50579c65.js";import"./hyperformula.40eff455.js";import"./SpreadSheet.5622495f.js";import"./vuex.df26a1fd.js";import"./@babel/core.ed44cf94.js";import"./vue3-date-time-picker.9548981a.js";import"./vue-cookie-next.8cb9bd86.js";import"./luxon.1f9cfc03.js";import"./react-cookie.6c5c119f.js";const _e={props:{modelValue:Object,allowNone:Boolean,usedCodesOnly:Boolean},emits:["update:modelValue"],setup(u,{emit:o}){const s=u,m=a(),h=n=>{o("update:modelValue",n),console.warn("Multi!",n)},v=a([]),p=a(),C=a();return U.get("/rpc/db/risk-codes").then(n=>{s.allowNone;const _=n.data.risk_codes.map(r=>$(W({},r),{label:r.risk_code+": "+r.description,value:r.risk_code}));v.value=[..._],console.warn("ricks codes",v.value)}).catch(n=>p.value=n),(n,_)=>(i(),c("div",null,[j(A(ke),{ref_key:"typeahead",ref:C,onChange:h,modelValue:m.value,"onUpdate:modelValue":_[0]||(_[0]=r=>m.value=r),options:v.value,mode:"tags",searchable:!0},null,8,["modelValue","options"])]))}},be={class:"uk-container-expand ecm-center-inputs"},ye={key:0,class:"uk-alert-danger","uk-alert":""},he=l("a",{class:"uk-alert-close","uk-close":""},null,-1),xe={style:{"text-align":"center"}},we={class:"uk-width-expand uk-text-center uk-margin"},ge=y("\xA0Syndicate"),Ve=y(" \xA0\xA0 "),je=y("\xA0Contract"),Re={key:0},Ue={class:"uk-margin"},Ce={class:"uk-margin uk-width-expand uk-text-center"},Be=y(" Filter by Line of Business?"),Me=l("option",null,"None",-1),Ne={class:"uk-margin uk-width-expand uk-text-center"},Se=y(" Filter by Risk Codes?"),De={key:0},Oe={class:"uk-margin uk-grid-small uk-child-width-auto uk-grid uk-align-center"},Fe=l("br",null,null,-1),Ie=y("Include Risks"),Le=y("Exclude Risks"),Pe={key:1,class:"uk-width-expand uk-text-center"},Ee=["onClick"],it={setup(u){const o=a(),s=a(),m=a(),h=a(),v=a(!1),p=a(),C=D(()=>o.value&&p.value),n=a(!1),_=new Date,r=_.getMonth(),B=1900+_.getYear(),J=r<3?r+9:r-3,K=r<3?B-1:B;a(new Date(K,J,1)),a(new Date(B,r,1));const Q=a([]),x=a(!1),M=a(),w=a("include");U.get("/rpc/report/pmi").then(d=>Q.value=d.data.syndicates).catch(d=>n.value=d);const O="Filter by line of business?",X="Remove LOB filter",F=a(O);ue(()=>{G.util.on("#lob","show",function(){F.value=X}),G.util.on("#lob","hide",function(){h.value=null,F.value=O})});const ee=async d=>{const e=await ve("/report/pmi/template.xlsx"),k=e.getWorksheet("US");return Object.entries(d).forEach(([g,t])=>k.getCell(g).value=t),e},I=a(),V=a();D(()=>V.value?V.value.getWorksheet("US"):void 0);const N=a(!1);function te(d,e){n.value=void 0,N.value=!0,d(),e(),console.warn("Reporting on",S.value),U.post("/rpc/report/pmi",S.value).then(k=>{e(),N.value=!1,I.value=k.data,ee(k.data).then(g=>V.value=g),window.testRep=I.value}).catch(k=>{e(),n.value=k,N.value=!1})}a("Performance Management Information.xlsx");const S=D(()=>({syndicate_id:o.value==="syndicate"&&m.value.syndicate_id,contract_id:o.value==="contract"&&s.value.contract_id,start_date:p.value&&p.value[0],end_date:p.value&&p.value[1],line_of_business:v.value&&(h.value||!1),risk_codes:x.value&&(M.value||!1),include_risk_codes:x.value&&(w.value=="include"||!1)})),L=a([]);function P(){U.post("/rpc/db/claim/lobs",S.value).then(d=>{L.value=d.data.lines_of_business})}return T(m,async()=>{P()}),T(s,async()=>{P()}),(d,e)=>(i(),c("div",be,[n.value?(i(),c("div",ye,[he,l("p",xe,q(n.value),1)])):f("",!0),j(ce,{title:"Performance Management Information",workbook:V.value,cardClass:"uk-width-2xlarge"},{default:re(({toggle:k,toggleLoading:g})=>[l("div",we,[l("label",null,[b(l("input",{class:"uk-radio",type:"radio",value:"syndicate","onUpdate:modelValue":e[0]||(e[0]=t=>o.value=t)},null,512),[[R,o.value]]),ge]),Ve,l("label",null,[b(l("input",{class:"uk-radio",type:"radio",value:"contract","onUpdate:modelValue":e[1]||(e[1]=t=>o.value=t)},null,512),[[R,o.value]]),je])]),o.value?(i(),c("div",Re,[l("div",Ue,[o.value==="syndicate"?(i(),z(pe,{key:0,modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t)},null,8,["modelValue"])):f("",!0),o.value==="contract"?(i(),z(me,{key:1,modelValue:s.value,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value=t)},null,8,["modelValue"])):f("",!0)]),m.value||s.value?(i(),c(Y,{key:0},[j(fe,{inputClassName:"uk-input foo",format:"yyyy-MM-dd HH:mm",modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=t=>p.value=t),placeholder:"Date Range for Reporting Period",range:"",twoCalendars:"",autoApply:""},null,8,["modelValue"]),l("div",Ce,[l("label",null,[b(l("input",{class:"uk-checkbox",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=t=>v.value=t)},null,512),[[Z,v.value]]),Be]),v.value?b((i(),c("select",{key:0,class:"uk-select","onUpdate:modelValue":e[6]||(e[6]=t=>h.value=t)},[(i(!0),c(Y,null,de(L.value,t=>(i(),c("option",null,q(t),1))),256)),Me],512)),[[ie,h.value]]):f("",!0)]),l("div",Ne,[l("label",null,[b(l("input",{class:"uk-checkbox",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>x.value=t)},null,512),[[Z,x.value]]),Se]),x.value?(i(),c("div",De,[l("div",Oe,[Fe,l("label",null,[b(l("input",{class:"uk-radio",type:"radio",name:"radio2",value:"include","onUpdate:modelValue":e[8]||(e[8]=t=>w.value=t),checked:""},null,512),[[R,w.value]]),Ie]),l("label",null,[b(l("input",{class:"uk-radio",type:"radio",name:"radio2",value:"exclude","onUpdate:modelValue":e[9]||(e[9]=t=>w.value=t)},null,512),[[R,w.value]]),Le])]),j(_e,{modelValue:M.value,"onUpdate:modelValue":e[10]||(e[10]=t=>M.value=t)},null,8,["modelValue"])])):f("",!0)])],64)):f("",!0),A(C)?(i(),c("div",Pe,[l("button",{onClick:t=>te(k,g),class:"uk-button uk-button-primary",type:"button"}," Run Report ",8,Ee)])):f("",!0)])):f("",!0)]),_:1},8,["workbook"])]))}};export{it as default};
