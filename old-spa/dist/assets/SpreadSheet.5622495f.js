import"./exceljs.4eeb6046.js";import{n as b}from"./numfmt.50579c65.js";import{o as c,A as i,e as j,L as _,i as F,F as p,q as D,y as I,a as V,h as N}from"./vendor.7b6f695f.js";import{H as v}from"./hyperformula.40eff455.js";const G={props:{richText:Object},setup(g){const u={Cambria:"Cambria, Georgia, Palatino, Times New Roman, serif","Trebuchet MS":"Trebuchet MS,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Tahoma,sans-serif",DEFAULT:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"'},d=s=>u[s.font.name]||u.DEFAULT,h=s=>"#"+s.argb.slice(2).concat(s.argb.slice(0,2)),x=s=>{const a={};return a.fontFamily=d(s),s.font.underline&&(a.textDecoration="underline"),a.fontSize=""+s.font.size+"pt",s.font.color&&(a.color=h(s.font.color)),s.font.bold&&(a.fontWeight="bold"),a};return(s,a)=>(c(!0),i(p,null,j(g.richText,f=>(c(),i("span",{key:f.text,style:_(x(f))},F(f.text),5))),128))}},q={class:"uk-table",style:{"border-collapse":"collapse"}},J=["colspan","rowspan","data-style"],Q={props:{sheet:Object},setup(g){const u=g;window.HyperFormula=v;const d='"\xA3"#,##0.00;[Red]-"\xA3"#,##0.00',h=12356789042e-2;b(d)(h),b.format(d,0-h);const s=()=>u.sheet.getRows(1,u.sheet.rowCount).map(t=>(C(t),t)),a=Object.freeze({value:new Map}),f=new Map,C=e=>{const t=[];let o=!1,r=1;return e.eachCell({includeEmpty:!0},function(l,n){if(l.master===l)t.push(l),o&&(f.set(o.address,r),window.master=o,o=!1,r=1);else if(o||(o=l.master),l.row===o.row)r=r+1;else{const m=1+l.row-o.row;a.value.set(o.address,m)}}),e.cells=t,t},E=e=>(e.address==="A1"&&console.warn("A1 cellspan",f.get(e.address)),f.get(e.address));function A(e){const t=a.value.get(e.address);if(window.cellRowSpans=a,t)return t}window.cellColSpans=f;const w=e=>{if(e.argb)return"#"+e.argb.slice(2).concat(e.argb.slice(0,2))},R=e=>{const t={};e.value===null&&(t.margin=0,t.padding=0);const o={fill:n=>{n.pattern!=="none"&&(t.backgroundColor=w(n.fgColor))},font(n){n.size&&(t.fontSize=""+n.size+"pt"),n.color&&(t.color=w(n.color))},border(n){Object.keys(n).length>0&&(t.borderStyle="solid"),Object.entries(n).forEach(([m,y])=>{const k="border-"+m+"-";Object.entries(y).forEach(([S,T])=>{S==="style"?t[k+"width"]=T:S==="color"&&(t[k+S]=w(T))})})}};Object.entries(e.style).forEach(([n,m])=>{const y=o[n];y&&y(m)});const r=b(e.numFmt),l=isNaN(e.value)?!1:r.color(e.value);return l&&(t.color=l),e.alignment&&e.alignment.wrapText&&(t.whiteSpace="pre-line"),t},O=e=>{const t=e.value;return isNaN(t)?t:b.format(e.numFmt,t)},z=e=>e.value!==null&&typeof e.value=="object"&&e.value.richText,L=e=>e.value!==null&&typeof e.value=="object"&&e.value.formula,M=e=>{const t=e.row-1,o=e.col-1;return H(u.sheet).getCellValue({col:o,row:t,sheet:0})},U=e=>{const t=[];return e.eachCell({includeEmpty:!0},o=>{o.value&&o.value.formula?t.push("="+o.formula):t.push(o.value)}),t},B=()=>{const e=[];return u.sheet.eachRow(t=>e.push(U(t))),e},H=e=>{if(e.hf)return e.hf;e.ss=B();const t={licenseKey:"gpl-v3"};return e.hf=v.buildFromArray(u.sheet.ss,t),e.hf};return D(()=>{}),(e,t)=>(c(),i("table",q,[I("tbody",null,[(c(!0),i(p,null,j(s(),o=>(c(),i("tr",{key:o.row},[(c(!0),i(p,null,j(C(o),r=>(c(),i("td",{style:_(R(r)),key:r.address,colspan:E(r),rowspan:A(r),"data-style":JSON.stringify(r.numFmt)},[z(r)?(c(),V(G,{key:0,"rich-text":r.value.richText},null,8,["rich-text"])):L(r)?(c(),i(p,{key:1},[N(F(M(r)),1)],64)):(c(),i(p,{key:2},[N(F(O(r)),1)],64))],12,J))),128))]))),128))])]))}};export{Q as _};
