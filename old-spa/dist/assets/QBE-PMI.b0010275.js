import{R as Q}from"./Report.99ffdd4b.js";import{_ as T}from"./SelectSyndicate.9cf21e1b.js";import{_ as Y,d as G,c as J,e as K,f as X}from"./index.ad6f86f2.js";import{a as j}from"./axios.3fa379ca.js";import"./@vueform/multiselect.69d395cc.js";import{_ as Z}from"./DateTimePicker.7ab0efe6.js";import{U as M}from"./uikit.bf3afdb6.js";import"./vue3-datepicker.8db1d195.js";import"./xlsx-js-style.0235676d.js";import"./exceljs.4eeb6046.js";import"./clusterize.js.78919985.js";import"./file-saver.55724082.js";import"./numfmt.50579c65.js";import"./hyperformula.40eff455.js";import{r as e,c as g,q as ee,w as O,o as r,A as v,y as k,i as te,b as u,j as oe,H as ae,a as x,C as se}from"./vendor.7b6f695f.js";import"./SpreadSheet.5622495f.js";import"./vuex.df26a1fd.js";import"./@babel/core.ed44cf94.js";import"./vue3-date-time-picker.9548981a.js";import"./vue-cookie-next.8cb9bd86.js";import"./luxon.1f9cfc03.js";import"./react-cookie.6c5c119f.js";const ne={class:"uk-container-expand ecm-center-inputs"},re={key:0,class:"uk-alert-danger","uk-alert":""},le=k("a",{class:"uk-alert-close","uk-close":""},null,-1),ce={style:{"text-align":"center"}},ue={key:0},ie={class:"uk-margin"},de={key:1,class:"uk-width-expand uk-text-center"},me=["onClick"],Pe={setup(fe){const l=e("syndicate"),i=e(),d=e(),R=e(),U=e(!1),n=e(),L=g(()=>l.value&&n.value),m=e(!1),V=new Date,f=V.getMonth(),_=1900+V.getYear(),P=f<3?f+9:f-3,q=f<3?_-1:_;e(new Date(q,P,1)),e(new Date(_,f,1));const E=e([]),B=e(!1),N=e(),A=e("include");j.get("/rpc/report/qbe-pmi").then(o=>E.value=o.data.syndicates).catch(o=>m.value=o);const C="Filter by line of business?",I="Remove LOB filter",D=e(C);ee(()=>{M.util.on("#lob","show",function(){D.value=I}),M.util.on("#lob","hide",function(){R.value=null,D.value=C})});const $=(o,t,a)=>{const s=o.workbook.addWorksheet(t);X(o,s),Object.entries(a).forEach(([y,w])=>{s.getCell(y).value=w})},z=async o=>{const t=await G("/report/qbe-pmi/template.xlsx"),a=t.getWorksheet("LOB1");console.log("sect merge",J(a,8)),Object.entries(o).forEach(([y,w])=>$(a,y,w));const c=t.getWorksheet("Property"),s=a.getRow(1);return K(s,8,{worksheet:c}),t.removeWorksheet("Claims Banding and Age Profile"),t.removeWorksheet("Drop Down Lists"),t},S=e(),p=e();g(()=>p.value?p.value.getWorksheet("US"):void 0);const b=e(!1);function F(o,t){m.value=void 0,b.value=!0,o(),t(),console.warn("Reporting on",h.value),j.post("/rpc/report/qbe-pmi",h.value).then(a=>{t(),b.value=!1,S.value=a.data,z(a.data).then(c=>p.value=c),window.testRep=S.value}).catch(a=>{t(),m.value=a,b.value=!1})}e("Performance Management Information.xlsx");const h=g(()=>({syndicate_id:l.value==="syndicate"&&d.value.syndicate_id,contract_id:l.value==="contract"&&i.value.contract_id,start_date:n.value&&n.value[0],end_date:n.value&&n.value[1],line_of_business:U.value&&(R.value||!1),risk_codes:B.value&&(N.value||!1),include_risk_codes:B.value&&(A.value=="include"||!1)})),H=e([]);function W(){j.post("/rpc/db/claim/lobs",h.value).then(o=>{H.value=o.data.lines_of_business})}return O(d,async()=>{W()}),O(i,async()=>{W()}),(o,t)=>(r(),v("div",ne,[m.value?(r(),v("div",re,[le,k("p",ce,te(m.value),1)])):u("",!0),oe(Q,{title:"QBE Management Information",workbook:p.value,cardClass:"uk-width-2xlarge"},{default:ae(({toggle:a,toggleLoading:c})=>[l.value?(r(),v("div",ue,[k("div",ie,[l.value==="syndicate"?(r(),x(T,{key:0,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s)},null,8,["modelValue"])):u("",!0),l.value==="contract"?(r(),x(Y,{key:1,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s)},null,8,["modelValue"])):u("",!0)]),d.value||i.value?(r(),x(Z,{key:0,inputClassName:"uk-input foo",format:"yyyy-MM-dd",modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=s=>n.value=s),placeholder:"Date Range for Reporting Period",range:"",twoCalendars:"",autoApply:""},null,8,["modelValue"])):u("",!0),se(L)?(r(),v("div",de,[k("button",{onClick:s=>F(a,c),class:"uk-button uk-button-primary",type:"button"}," Run Report ",8,me)])):u("",!0)])):u("",!0)]),_:1},8,["workbook"])]))}};export{Pe as default};
